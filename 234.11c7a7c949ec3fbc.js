"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[234],{29117:(e,n,t)=>{t.d(n,{Z:()=>Z});var a=t(31461),o=t(92794),l=t(66198),s=t(79536),i=t(36893),r=t(10618),c=t(26578),u=t(29432),d=t(52903);const p=["value","totals","onChange"],h=(0,r.X)([...i.yd]);function Z(e){let{value:n,totals:t,onChange:r}=e,Z=(0,a.Z)(e,p);return(0,d.tZ)(u.Z,Object.assign({exclusive:!0,value:n},Z,{children:i.yd.map((e=>{var a;return(0,d.BX)(o.Z,{value:e,sx:{minWidth:"7em"},onClick:()=>r(h(n,e)),children:[(0,d.tZ)(c.Z,{src:null==(a=s.Z.weaponTypes)?void 0:a[e],size:2})," ",(0,d.tZ)(l.Z,{label:t[e],size:"small"})]},e)}))}))}},61523:(e,n,t)=>{t.r(n),t.d(n,{default:()=>M});var a=t(92252),o=t(67550),l=t(7671),s=t(41075),i=t(30609),r=t(5896),c=t(79906),u=t(83249),d=t(62197),p=t(2784),h=t(61877),Z=t(21548),g=t(87985),w=t(46026),m=t(62978),f=t(29117),y=t(71026),v=t(25870),x=t(36617),W=t(82716),C=t(25434),b=t(36893),I=t(1661),k=t(40775),P=t(41015),S=t(77712),X=t(64120),E=t(3694),T=t(52903);const B=p.lazy((()=>t.e(592).then(t.bind(t,89431)))),$=(0,p.lazy)((()=>Promise.all([t.e(878),t.e(334)]).then(t.bind(t,15878)))),z={xs:1,sm:2,md:3,lg:3,xl:4},N={xs:10,sm:12,md:24,lg:24,xl:24},j=Object.keys(S.gd);function M(){const{t:e}=(0,Z.$G)(["page_weapon","ui","weaponNames_gen"]),{database:n}=(0,p.useContext)(v.t),[t,d]=(0,p.useState)(n.displayWeapon.get());(0,p.useEffect)((()=>n.displayWeapon.follow(((e,n)=>d(n)))),[n]);const[M,D]=(0,p.useState)(!1),[_,A]=(0,x.Z)(),G=(0,p.useRef)(null),[L,H]=(0,p.useState)(0);(0,p.useEffect)((()=>(h.ZP.send({hitType:"pageview",page:"/weapon"}),n.weapons.followAny(((e,n)=>("new"===n||"remove"===n)&&A())))),[A,n]);const K=(0,W.Z)(),V=N[K],q=(0,C.Z)((()=>y.Z.getAll),[]),F=(0,p.useCallback)((async a=>{const o=n.weapons.get(a);if(!o)return;const l=e(`weaponNames_gen:${o.key}`);window.confirm(e("removeWeapon",{value:l}))&&(n.weapons.remove(a),t.editWeaponId===a&&n.displayWeapon.set({editWeaponId:""}))}),[t.editWeaponId,n,e]),R=(0,p.useCallback)((e=>{n.displayWeapon.set({editWeaponId:e})}),[n]),J=(0,p.useCallback)((e=>{R(n.weapons.new((0,X.xg)(e)))}),[n,R]),[Q,U]=(0,p.useState)(""),Y=(0,p.useDeferredValue)(Q),{sortType:ee,ascending:ne,weaponType:te,rarity:ae}=t,{weaponIdList:oe,totalWeaponNum:le}=(0,p.useMemo)((()=>{var e;const t=n.weapons.values,a=t.length;if(!q)return{weaponIdList:[],totalWeaponNum:a};const o=t.filter((0,I.C)({weaponType:te,rarity:ae,name:Y},(0,S.Xg)(q))).sort((0,I.e)(null!=(e=S.gd[ee])?e:[],ne,(0,S.Sn)(q))).map((e=>e.id));return _&&{weaponIdList:o,totalWeaponNum:a}}),[_,n,q,ee,ne,ae,te,Y]),{weaponIdsToShow:se,numPages:ie,currentPageIndex:re}=(0,p.useMemo)((()=>{const e=Math.ceil(oe.length/V),n=(0,P.uZ)(L,0,e-1);return{weaponIdsToShow:oe.slice(n*V,(n+1)*V),numPages:e,currentPageIndex:n}}),[oe,L,V]),ce=oe.length!==le?`${oe.length}/${le}`:`${le}`,ue=(0,p.useCallback)(((e,n)=>{var t;null==(t=G.current)||t.scrollIntoView({behavior:"smooth"}),H(n-1)}),[H,G]),de=(0,p.useCallback)((()=>n.displayWeapon.set({editWeaponId:""})),[n]),{editWeaponId:pe}=t;(0,p.useEffect)((()=>{pe&&(n.weapons.get(pe)||de())}),[n,pe,de]);const he=(0,p.useMemo)((()=>(0,k.W)(b.yd,(e=>q&&Object.entries(n.weapons.data).forEach((([n,t])=>{const a=q(t.key).weaponType;e[a].total++,oe.includes(n)&&e[a].current++}))))),[q,n,oe]),Ze=(0,p.useMemo)((()=>(0,k.W)(b.wC,(e=>q&&Object.entries(n.weapons.data).forEach((([n,t])=>{const a=q(t.key).rarity;e[a].total++,oe.includes(n)&&e[a].current++}))))),[q,n,oe]);return(0,T.BX)(o.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:[(0,T.tZ)(p.Suspense,{fallback:!1,children:(0,T.tZ)(B,{show:M,onHide:()=>D(!1),onSelect:J})}),(0,T.tZ)(p.Suspense,{fallback:!1,children:(0,T.tZ)($,{weaponId:pe,footer:!0,onClose:de})}),(0,T.tZ)(g.Z,{ref:G,children:(0,T.BX)(l.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,T.BX)(s.ZP,{container:!0,spacing:1,children:[(0,T.tZ)(s.ZP,{item:!0,children:(0,T.tZ)(f.Z,{onChange:e=>n.displayWeapon.set({weaponType:e}),value:te,totals:he,size:"small"})}),(0,T.tZ)(s.ZP,{item:!0,children:(0,T.tZ)(m.Z,{sx:{height:"100%"},onChange:e=>n.displayWeapon.set({rarity:e}),value:ae,totals:Ze,size:"small"})}),(0,T.tZ)(s.ZP,{item:!0,flexGrow:1}),(0,T.tZ)(s.ZP,{item:!0,children:(0,T.tZ)(i.Z,{autoFocus:!0,size:"small",value:Q,onChange:e=>U(e.target.value),label:e("weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),(0,T.BX)(o.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:[(0,T.tZ)(r.Z,{count:ie,page:re+1,onChange:ue}),(0,T.tZ)(O,{numShowing:se.length,total:ce,t:e}),(0,T.tZ)(w.Z,{sx:{height:"100%"},sortKeys:j,value:ee,onChange:e=>n.displayWeapon.set({sortType:e}),ascending:ne,onChangeAsc:e=>n.displayWeapon.set({ascending:e})})]})]})}),(0,T.BX)(p.Suspense,{fallback:(0,T.tZ)(c.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:500}}),children:[(0,T.tZ)(u.Z,{fullWidth:!0,onClick:()=>D(!0),color:"info",startIcon:(0,T.tZ)(a.Z,{}),children:e("page_weapon:addWeapon")}),(0,T.tZ)(s.ZP,{container:!0,spacing:1,columns:z,children:se.map((e=>(0,T.tZ)(s.ZP,{item:!0,xs:1,children:(0,T.tZ)(E.Z,{weaponId:e,onDelete:F,onEdit:R,canEquip:!0})},e)))})]}),ie>1&&(0,T.tZ)(g.Z,{children:(0,T.tZ)(l.Z,{children:(0,T.BX)(s.ZP,{container:!0,alignItems:"flex-end",children:[(0,T.tZ)(s.ZP,{item:!0,flexGrow:1,children:(0,T.tZ)(r.Z,{count:ie,page:re+1,onChange:ue})}),(0,T.tZ)(s.ZP,{item:!0,children:(0,T.tZ)(O,{numShowing:se.length,total:ce,t:e})})]})})})]})}function O({numShowing:e,total:n,t}){return(0,T.tZ)(d.Z,{color:"text.secondary",children:(0,T.BX)(Z.cC,{t,i18nKey:"showingNum",count:e,value:n,children:["Showing ",(0,T.tZ)("b",{children:{count:e}})," out of ",{value:n}," Weapons"]})})}},94758:(e,n,t)=>{t.d(n,{Z:()=>l});var a=t(2784),o=t(25870);function l(e=""){const{database:n}=(0,a.useContext)(o.t),[t,l]=(0,a.useState)(n.weapons.get(e));return(0,a.useEffect)((()=>l(n.weapons.get(e))),[n,e]),(0,a.useEffect)((()=>e?n.weapons.follow(e,((e,n,t)=>"update"===n&&l(t))):void 0),[e,l,n]),t}},10618:(e,n,t)=>{t.d(n,{X:()=>o});var a=t(41015);function o(e){return(n,t)=>{const o=n.length;return o===e.length?[t]:1===o&&n[0]===t?[...e]:[...new Set((0,a.nh)(n,t))]}}},40775:(e,n,t)=>{t.d(n,{W:()=>o});var a=t(41015);function o(e,n){const t=function(e){return Object.fromEntries(e.map((e=>[e,{total:0,current:0}])))}(e);return n(t),o=t,(0,a.xh)(o,(({total:e,current:n})=>n===e?`${e}`:`${n}/${e}`));var o}}}]);
{"version":3,"sources":["Components/FieldDisplay.tsx","Components/CustomFormControl.tsx","Character/CharacterUtil.tsx","Conditional/ConditionalSelector.tsx","Components/ConditionalDisplay.tsx","Components/DocumentDisplay.tsx","Character/StatInput.tsx","Components/StatDisplay.tsx","Components/InfoComponent.tsx","Artifact/Component/SetEffectDisplay.tsx","Character/CharacterDisplay/DamageOptionsAndCalculation.tsx","Character/CharacterDisplay/StatDisplayComponent.tsx","Character/CharacterCard.tsx","Util/TimeUtil.ts","../node_modules/react-bootstrap/esm/ProgressBar.js","Build/BuildWorker.ts","Build/BuildDisplay.tsx"],"names":["FieldDisplay","field","index","className","useContext","buildContext","newBuild","equippedBuild","compareBuild","build","canShow","useMemo","fixedVal","fixed","fieldVal","value","Character","getTalentFieldValue","formula","retVal","fieldEquippedVal","parseInt","toFixed","diff","fieldText","fieldVariant","formulaTextOverlay","fieldFormulaText","placement","overlay","id","icon","faQuestionCircle","style","cursor","unit","Item","variant","CustomFormControl","onChange","disabled","float","placeholder","allowEmpty","max","min","useState","state","setState","sendChange","useCallback","undefined","parseFunc","parseFloat","useEffect","toString","aria-label","type","e","target","onBlur","onKeyDown","key","getFormulaTargetsDisplayHeading","characterSheet","weaponSheet","artifactSheets","eleKey","startsWith","subkey","split","getTalentOfKey","name","setKey","num","initialCharacter","level","ascension","hitMode","reactionMode","equippedArtifacts","objectFromKeyMap","allSlotKeys","equippedWeapon","conditionalValues","baseStatOverrides","buildSettings","initialBuildSettings","talent","auto","skill","burst","infusionAura","constellation","ConditionalSelector","conditional","conditionalValue","setConditional","stats","conditionalNum","conditionalStateKey","states","Object","values","text","evalIfFunc","maxStack","badge","Badge","Dropdown","Toggle","size","whiteSpace","Menu","onClick","entries","map","i","stateKey","condial","Fragment","Array","keys","v","stack","Button","faCheckSquare","faSquare","ConditionalDisplay","characterDispatch","fieldClassName","Conditional","resolve","conditionalStats","fields","conditionalFields","displayFields","statsToFields","condV","layeredAssignment","deletePropPath","objClearEmpties","Card","bg","Header","ListGroup","DocumentDisplay","sections","section","talentText","length","StatInput","prependEle","defaultValue","onValueChange","percent","restProps","Prepend","Text","Append","Boolean","pointerEvents","faUndo","DisplayStatDiff","label","val","oldVal","oldText","diffText","xs","StatDisplay","character","statKey","usePromise","isArray","Formula","get","invalid","getStatValueWithOverride","characterHP","characterDEF","characterATK","weaponATK","Stat","getStatUnit","fixedUnit","StatIcon","getStatName","labelVariant","hasOverride","InfoComponent","pageKey","modalTitle","children","dbStorage","showInfoModal","setshowInfoModal","getRandomElementFromArray","displayText","closeModal","infoShown","set","show","onHide","contentClassName","Title","faTimes","Body","fallback","animation","Footer","ns","key18","SetEffectDisplay","setNumKey","sheet","ArtifactSheet","setEffectText","setEffectDesc","setStats","setNumStats","setStatsFields","document","setEffectDocument","infusionVals","uncoloredEleIcons","pyro","cryo","InfusionAuraDropdown","isMelee","ReactionToggle","charEleKey","characterEle","includes","s","hydro","HitModeToggle","m","CalculationDisplay","sheets","displayStatKeys","getDisplayStatKeys","sectionKey","header","fieldIndex","FormulaCalculationField","fieldKeys","subFormulaKeys","getPrintableFormulaStatKeyList","GetDependencies","modifiers","reverse","as","eventKey","printStat","Collapse","subKey","expand","formulaField","fieldFixed","fieldUnit","fieldFormula","fieldFormulaDependency","fieldValue","ContextAwareToggle","callback","currentEventKey","AccordionContext","decoratedOnClick","useAccordionToggle","expanded","faWindowMinimize","faWindowMaximize","DamageOptionsAndCalculation","href","rel","xl","getStatNameRaw","getBaseStatValue","allElements","immunityStatKey","elementImmunity","StatDisplayComponent","statsDisplayKeys","cardbg","sectionValues","md","JSON","stringify","CharacterCard","characterKey","onEdit","onDelete","cardClassName","footer","database","DatabaseContext","databaseCharacter","updateDatabaseCharacter","followChar","getAll","CharacterSheet","weapon","_getWeapon","WeaponSheet","calculateBuild","tlvl","elementKey","weaponTypeKey","weaponName","weaponMainVal","getMainStatValue","weaponSubKey","getSubStatKey","weaponSubVal","getSubStatValue","weaponLevelName","getLevelString","weaponPassiveName","passiveName","faEdit","faTrashAlt","src","thumbImg","star","thumbnail","stars","colored","Assets","weaponTypes","refinement","setEffects","setToSlots","arr","artifactSetName","highestNum","Math","statVal","Link","to","pathname","faCalculator","faLink","msToUnits","ms","milliseconds","seconds","floor","minutes","hours","timeString","timeText","strPadLeft","timeStringMs","_excluded","_excluded2","_excluded3","getPercentage","now","percentage","round","renderProgressBar","_ref","ref","_classNames","srOnly","striped","animated","bsPrefix","props","_objectWithoutPropertiesLoose","React","createElement","_extends","role","classNames","width","ProgressBar","forwardRef","_ref2","isChild","useBootstrapPrefix","wrapperProps","child","cloneElement","displayName","defaultProps","Worker_fn","Worker","InfoDisplay","lazy","CharacterDisplayCard","warningBuildNumber","artifactsSlotsToSelectMainStats","BuildDisplay","propCharacterKey","location","setcharacterKey","modalBuild","setmodalBuild","showArtCondModal","setshowArtCondModal","showCharacterModal","setshowCharacterModal","generatingBuilds","setgeneratingBuilds","generationProgress","setgenerationProgress","generationDuration","setgenerationDuration","generationSkipped","setgenerationSkipped","useForceUpdate","charDirty","setCharDirty","artsDirty","setArtsDirty","isMounted","useRef","worker","initialStats","setCharacterData","setFilters","statFilters","mainStatKeys","optimizationTarget","mainStatAssumptionLevel","useExcludedArts","useEquippedArts","builds","buildDate","maxBuildsToShow","buildStats","arts","fromEntries","_getArt","art","slotKey","calculateBuildwithArtifact","filter","buildSettingsDispatch","action","mainStatKey","k","push","buildSettingsReducer","updateChar","ReactGA","pageview","selectCharacter","cKey","a","_getChar","createInitialStats","followAnyArt","current","terminate","totBuildNumber","artifactDatabase","_getArts","exclude","Artifact","splitArtifactsBySlot","forEach","calculateTotalBuildNumber","generateBuilds","artifactSetEffects","setEffectsObjs","splitArtifacts","deepClone","artArr","mainStatVal","mainStatValue","rarity","data","minFilters","onmessage","progress","timing","skipped","category","variable","b","artifacts","Date","postMessage","dropdownitemsForStar","setsWithMaxRarity","setobj","some","setsNumArr","artsAccountedOther","reduce","accu","cur","ind","every","nameWithIcon","characterName","characterDropDown","DropdownButton","title","Divider","CharacterSelection","onSelect","sortByText","getStatVariant","getStatNameWithPercent","talentKey","artsAccounted","artifactCondCount","count","crawlObject","artifact","Container","Provider","BuildModal","close","ArtConditionalModal","Row","Col","lg","HitModeCard","StatFilterCard","statKeys","basicKeys","setStatFilters","sFs","setNum","ButtonGroup","ItemText","setNKey","setNkey","editable","AssumeFullLevelToggle","setmainStatAssumptionLevel","numSel","slotMainStats","selected","OverlayTrigger","Tooltip","maxBuildsToShowList","drop","align","minWidth","overflow","textOverflow","TargetSelectorDropdownItem","BuildAlert","toLocaleString","ArtifactDisplayItem","talentField","Modal","Suspense","tabName","setCharacterKey","onClose","closeArtCondModal","artSetKeyList","setKeysByRarities","flatMap","slotIcons","rarities","Image","StatFilterItem","setFilter","isFloat","inputProps","minInputProps","InputGroup","sKey","faTrash","setHitmode","setReactionMode","setInfusionAura","remainingKeys","currentlyEquipped","sort","slotarr1","slotarr","artifactSlotIcon","totalBuildNumberString","totalUnskipped","generationProgressString","generationSkippedString","totalUnskippedString","generationSkippedText","progPercent","Alert","levels","0","4","8","12","16","20"],"mappings":"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","file":"static/js/12.d43d4028.chunk.js","sourcesContent":["import { faQuestionCircle } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport React, { useContext, useMemo } from 'react';\r\nimport { ListGroup, OverlayTrigger, Tooltip } from \"react-bootstrap\";\r\nimport { buildContext } from \"../Build/Build\";\r\nimport Character from \"../Character/Character\";\r\nimport { IFieldDisplay } from \"../Types/IFieldDisplay\";\r\n\r\nexport default function FieldDisplay({ field, index, className = \"p-2\" }: { field: IFieldDisplay, index: number, className?: string }) {\r\n  const { newBuild, equippedBuild, compareBuild } = useContext(buildContext)\r\n  const build = (newBuild ? newBuild : equippedBuild)\r\n  const canShow = useMemo(() => build ? field?.canShow?.(build) : false, [field, build])\r\n  const fixedVal = field?.fixed || 0\r\n  const fieldVal = useMemo(() => {\r\n    if (field.value) return Character.getTalentFieldValue(field, \"value\", build)\r\n    else if (field.formula) {\r\n      let retVal = Character.getTalentFieldValue(field, \"formula\", build)?.[0]?.(build)\r\n      //compareAgainstEquipped\r\n      if (compareBuild && equippedBuild && typeof retVal === \"number\") {\r\n        let fieldEquippedVal = field.value ? field.value : field.formula?.(equippedBuild)?.[0]?.(equippedBuild)\r\n        if (typeof fieldEquippedVal === \"function\")\r\n          fieldEquippedVal = parseInt(fieldEquippedVal?.(equippedBuild)?.toFixed?.(fixedVal))\r\n        let diff = retVal - fieldEquippedVal\r\n        retVal = <span>{fieldEquippedVal?.toFixed(fixedVal) ?? fieldEquippedVal}{diff ? <span className={diff > 0 ? \"text-success\" : \"text-danger\"}> ({diff > 0 ? \"+\" : \"\"}{diff?.toFixed?.(fixedVal) || diff})</span> : \"\"}</span>\r\n      }\r\n      return retVal\r\n    }\r\n  }, [compareBuild, fixedVal, equippedBuild, field, build])\r\n\r\n  const fieldText = useMemo(() => Character.getTalentFieldValue(field, \"text\", build), [field, build])\r\n  const fieldVariant = useMemo(() => Character.getTalentFieldValue(field, \"variant\", build), [field, build])\r\n\r\n  const formulaTextOverlay = useMemo(() => {\r\n    const fieldFormulaText = Character.getTalentFieldValue(field, \"formulaText\", build)\r\n    return fieldFormulaText ? <OverlayTrigger\r\n      placement=\"top\"\r\n      overlay={<Tooltip id=\"field-formula\">{fieldFormulaText}</Tooltip>}\r\n    >\r\n      <FontAwesomeIcon icon={faQuestionCircle} className=\"ml-2\" style={{ cursor: \"help\" }} />\r\n    </OverlayTrigger> : null\r\n  }, [field, build])\r\n\r\n  const unit = useMemo(() => Character.getTalentFieldValue(field, \"unit\", build), [field, build])\r\n\r\n  if (!canShow) return null\r\n  return <ListGroup.Item variant={index % 2 ? \"customdark\" : \"customdarker\"} className={className}>\r\n    <span><b>{fieldText}</b>{formulaTextOverlay}</span>\r\n    <span className={`float-right text-right text-${fieldVariant}`} >{fieldVal?.toFixed?.(fixedVal) ?? fieldVal}{unit}</span>\r\n  </ListGroup.Item>\r\n}\r\n","import { useCallback, useEffect, useState } from 'react'\r\nimport FormControl from 'react-bootstrap/FormControl'\r\ntype props = {\r\n  value: number | undefined,\r\n  onChange: (newValue: number | undefined) => void,\r\n  className?: string\r\n  disabled?: boolean\r\n  float?: boolean,\r\n  placeholder?: string,\r\n  allowEmpty?: boolean,\r\n  max?: string | number,\r\n  min?: string | number,\r\n}\r\nexport default function CustomFormControl({ value, onChange, className = \"\", disabled = false, float = false, placeholder, allowEmpty = false, max, min }: props) {\r\n  const [state, setState] = useState(\"\")\r\n  const sendChange = useCallback(\r\n    () => {\r\n      if (allowEmpty && state === \"\") return onChange(undefined)\r\n      if (state === \"\") return onChange(0)\r\n      const parseFunc = float ? parseFloat : parseInt\r\n      onChange(parseFunc(state))\r\n    },\r\n    [onChange, state, float, allowEmpty],\r\n  )\r\n  useEffect(() => setState(value?.toString() ?? \"\"), [value, setState]) // update value on value change\r\n\r\n  return <FormControl\r\n    value={state}\r\n    aria-label=\"custom-input\"\r\n    className={`hide-appearance ${className}`}\r\n    type=\"number\"\r\n    placeholder={placeholder}\r\n    onChange={(e: any) => setState(e.target.value)}\r\n    onBlur={sendChange}\r\n    disabled={disabled}\r\n    onKeyDown={(e: any) => e.key === \"Enter\" && sendChange()}\r\n    max={max}\r\n    min={min}\r\n  />\r\n}","import { Badge } from \"react-bootstrap\"\r\nimport { ArtifactSheet } from \"../Artifact/ArtifactSheet\"\r\nimport { initialBuildSettings } from \"../Build/BuildSetting\"\r\nimport { ICachedCharacter } from \"../Types/character\"\r\nimport { allSlotKeys, ArtifactSetKey, CharacterKey, ElementKey } from \"../Types/consts\"\r\nimport { objectFromKeyMap } from \"../Util/Util\"\r\nimport WeaponSheet from \"../Weapon/WeaponSheet\"\r\nimport CharacterSheet from \"./CharacterSheet\"\r\n\r\nexport function getFormulaTargetsDisplayHeading(key: string, { characterSheet, weaponSheet, artifactSheets }: { characterSheet: CharacterSheet, weaponSheet: WeaponSheet, artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet> }, eleKey: ElementKey = \"anemo\") {\r\n  if (key === \"basicKeys\") return \"Basic Stats\"\r\n  else if (key === \"genericAvgHit\") return \"Generic Optimization Values\"\r\n  else if (key === \"transReactions\") return \"Transformation Reaction\"\r\n  else if (key.startsWith(\"talentKey_\")) {\r\n    const subkey = key.split(\"talentKey_\")[1]\r\n    return (characterSheet?.getTalentOfKey(subkey, eleKey)?.name ?? subkey)\r\n  } else if (key.startsWith(\"weapon_\")) {\r\n    const subkey = key.split(\"weapon_\")[1]\r\n    return (weaponSheet?.name ?? subkey)\r\n  } else if (key.startsWith(\"artifact_\")) {\r\n    const [, setKey, num] = key.split('_')\r\n    return <span>{artifactSheets[setKey]?.name} <Badge variant=\"success\">{num}-Set</Badge></span>\r\n  }\r\n  return \"\"\r\n}\r\n\r\nexport function initialCharacter(key: CharacterKey): ICachedCharacter {\r\n  return {\r\n    key, // the game character this is based off\r\n    level: 1,\r\n    ascension: 0,\r\n    hitMode: \"avgHit\",\r\n    reactionMode: null,\r\n    equippedArtifacts: objectFromKeyMap(allSlotKeys, () => \"\"),\r\n    equippedWeapon: \"\",\r\n    conditionalValues: {},\r\n    baseStatOverrides: {}, // overriding the baseStat\r\n    buildSettings: initialBuildSettings(),\r\n    talent: {\r\n      auto: 1,\r\n      skill: 1,\r\n      burst: 1,\r\n    },\r\n    infusionAura: \"\",\r\n    constellation: 0,\r\n  }\r\n}","import { faCheckSquare, faSquare } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport React from 'react';\r\nimport Badge from 'react-bootstrap/Badge';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport { ICalculatedStats } from '../Types/stats';\r\nimport IConditional, { IConditionalValue } from '../Types/IConditional';\r\nimport { evalIfFunc } from '../Util/Util';\r\n\r\nexport default function ConditionalSelector({ conditional, conditionalValue, setConditional, name, disabled, stats }:\r\n  { conditional: IConditional, conditionalValue: IConditionalValue, setConditional: (newCond: IConditionalValue) => void, name: Displayable, disabled?: boolean, stats: ICalculatedStats }) {\r\n  const [conditionalNum = 0, conditionalStateKey] = conditionalValue\r\n  if (!conditional) return name as JSX.Element\r\n  if (\"states\" in conditional) {//complex conditional\r\n    const state = conditionalStateKey ? conditional.states[conditionalStateKey] : Object.values(conditional.states)[0]\r\n    const text = conditionalNum === 0 ? \"Not Active\" : <span>{state.name} {(evalIfFunc(state!.maxStack, stats) as number > 1 ? (`: ${conditionalNum} stack${conditionalNum > 1 ? \"s\" : \"\"}`) : \"\")}</span>\r\n    const badge = <Badge variant={conditionalNum === 0 ? \"secondary\" : \"success\"}>{text}</Badge>\r\n    return <Dropdown>\r\n      <Dropdown.Toggle size=\"sm\" disabled={disabled}>\r\n        <h6 className=\"mb-0 d-inline\" style={{ whiteSpace: \"normal\" }}>{name} {badge}</h6>\r\n      </Dropdown.Toggle>\r\n      <Dropdown.Menu>\r\n        <Dropdown.Item onClick={() => setConditional([0])}>\r\n          <span>Not Active</span>\r\n        </Dropdown.Item>\r\n        {Object.entries(conditional.states).map(([stateKey, condial]: any, i) =>\r\n          <React.Fragment key={i}>\r\n            {[...Array(condial.maxStack).keys()].map(v => v + 1).map((stack, i) =>\r\n              <Dropdown.Item key={stateKey + i} onClick={() => setConditional([stack, stateKey])}>\r\n                {condial.name}{condial.maxStack > 1 ? `: ${stack} stack${stack > 1 ? \"s\" : \"\"}` : \"\"}\r\n              </Dropdown.Item>)}\r\n          </React.Fragment>\r\n        )}\r\n      </Dropdown.Menu>\r\n    </Dropdown>\r\n  } else {\r\n    const maxStack = evalIfFunc(conditional!.maxStack, stats) as number\r\n    if (maxStack > 1) {\r\n      //stacking conditional\r\n      const badge = <Badge variant={conditionalNum === 0 ? \"secondary\" : \"success\"}>{conditionalNum > 0 ? `${conditionalNum} stack${conditionalNum > 1 ? \"s\" : \"\"}` : \"Not Active\"}</Badge>\r\n      return <Dropdown>\r\n        <Dropdown.Toggle size=\"sm\" disabled={disabled}>\r\n          <h6 className=\"mb-0 d-inline\" style={{ whiteSpace: \"normal\" }}>{name} {badge}</h6>\r\n        </Dropdown.Toggle>\r\n        <Dropdown.Menu>\r\n          <Dropdown.Item onClick={() => setConditional([0])}>\r\n            <span>Not Active</span>\r\n          </Dropdown.Item>\r\n          {[...Array(maxStack).keys()].map(v => v + 1).map(stack =>\r\n            <Dropdown.Item key={stack} onClick={() => setConditional([stack])}>\r\n              {`${stack} stack${stack > 1 ? \"s\" : \"\"}`}\r\n            </Dropdown.Item>)}\r\n        </Dropdown.Menu>\r\n      </Dropdown>\r\n    } else if (maxStack === 1) {//single boolean conditional\r\n      return <Button size=\"sm\" onClick={() => setConditional([conditionalNum ? 0 : 1])} disabled={disabled}>\r\n        <h6 className=\"mb-0\"><FontAwesomeIcon icon={conditionalNum ? faCheckSquare : faSquare} /> {name}</h6>\r\n      </Button>\r\n    }\r\n  }\r\n  return null\r\n}","import { useCallback, useContext, useMemo } from \"react\"\r\nimport { Card, ListGroup } from \"react-bootstrap\"\r\nimport { buildContext } from \"../Build/Build\"\r\nimport Conditional from \"../Conditional/Conditional\"\r\nimport ConditionalSelector from \"../Conditional/ConditionalSelector\"\r\nimport IConditional from \"../Types/IConditional\"\r\nimport statsToFields from \"../Util/FieldUtil\"\r\nimport { deletePropPath, layeredAssignment, objClearEmpties } from \"../Util/Util\"\r\nimport FieldDisplay from \"./FieldDisplay\"\r\ntype ConditionalDisplayProps = {\r\n  conditional: IConditional,\r\n  characterDispatch: (any) => void,//TODO: characterDispatch type\r\n  fieldClassName?: string\r\n}\r\n\r\nexport default function ConditionalDisplay({ conditional, characterDispatch, fieldClassName }: ConditionalDisplayProps) {\r\n  const { newBuild, equippedBuild } = useContext(buildContext)\r\n  const stats = newBuild ? newBuild : equippedBuild\r\n  const canShow = useMemo(() => Conditional.canShow(conditional, stats), [conditional, stats])\r\n  const { stats: conditionalStats = {}, fields: conditionalFields = [], conditionalValue } = useMemo(() => canShow && Conditional.resolve(conditional, stats, undefined), [canShow, conditional, stats])\r\n  const displayFields = useMemo(() => canShow && [...statsToFields(conditionalStats, stats), ...conditionalFields], [canShow, conditionalStats, stats, conditionalFields])\r\n  const setConditional = useCallback(condV => {\r\n    if (!stats) return\r\n    const [conditionalNum = 0] = condV\r\n    if (!conditionalNum) {\r\n      deletePropPath(stats.conditionalValues, conditional!.keys)\r\n      objClearEmpties(stats.conditionalValues)\r\n    } else if (conditional.keys)\r\n      layeredAssignment(stats.conditionalValues, conditional!.keys, condV)\r\n    characterDispatch({ conditionalValues: stats.conditionalValues })\r\n  }, [conditional, stats, characterDispatch])\r\n\r\n  if (!canShow || !stats) return null\r\n  return <Card bg=\"darkcontent\" text={\"lightfont\" as any} className=\"mb-2 w-100\">\r\n    <Card.Header className=\"p-2\">\r\n      <ConditionalSelector\r\n        conditional={conditional}\r\n        conditionalValue={conditionalValue}\r\n        setConditional={setConditional}\r\n        name={conditional.name}\r\n        stats={stats} />\r\n    </Card.Header>\r\n    <ListGroup className=\"text-white\" variant=\"flush\">\r\n      {displayFields.map((field, i) => <FieldDisplay key={i} index={i} field={field} className={fieldClassName} />)}\r\n    </ListGroup>\r\n  </Card>\r\n}","import { useContext } from \"react\"\r\nimport { ListGroup } from \"react-bootstrap\"\r\nimport { buildContext } from \"../Build/Build\"\r\nimport { DocumentSection } from \"../Types/character\"\r\nimport { evalIfFunc } from \"../Util/Util\"\r\nimport ConditionalDisplay from \"./ConditionalDisplay\"\r\nimport FieldDisplay from \"./FieldDisplay\"\r\n\r\ntype SkillDisplayCardProps = {\r\n  sections: DocumentSection[],\r\n  characterDispatch: (any) => void,\r\n}\r\nexport default function DocumentDisplay({ sections, characterDispatch }: SkillDisplayCardProps) {\r\n  const { newBuild, equippedBuild } = useContext(buildContext)\r\n  const build = newBuild ? newBuild : equippedBuild\r\n  if (!build) return null\r\n  return <div className=\"w-100\">{sections?.map((section, i) => {\r\n    if (!section.canShow!(build)) return null\r\n    const talentText = evalIfFunc(section.text, build)\r\n    const fields = section.fields ?? []\r\n    return <div className=\"my-2\" key={\"section\" + i}>\r\n      <div>\r\n        <div className=\"mb-2\">{talentText}</div>\r\n        {fields.length > 0 && <ListGroup className=\"text-white mb-2\">\r\n          {fields?.map?.((field, i) => <FieldDisplay key={i} index={i} field={field} />)}\r\n        </ListGroup>}\r\n      </div>\r\n      {!!section.conditional && <ConditionalDisplay conditional={section.conditional} characterDispatch={characterDispatch} />}\r\n    </div>\r\n  })}</div>\r\n}\r\n","import { faUndo } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport Button from \"react-bootstrap/Button\"\r\nimport InputGroup from \"react-bootstrap/InputGroup\"\r\nimport OverlayTrigger from \"react-bootstrap/OverlayTrigger\"\r\nimport Tooltip from \"react-bootstrap/Tooltip\"\r\nimport CustomFormControl from \"../Components/CustomFormControl\"\r\n\r\ntype StatInputInput = {\r\n  name: Displayable,\r\n  prependEle?: Displayable,\r\n  value: number,\r\n  placeholder: string,\r\n  defaultValue: number,\r\n  onValueChange: (newValue: number | undefined) => void,\r\n  percent?: boolean,\r\n  disabled?: boolean,\r\n  className?: any,\r\n}\r\n\r\nconst StatInput = ({ name, prependEle, value, placeholder, defaultValue, onValueChange, percent = false, disabled = false, ...restProps }: StatInputInput) =>\r\n  <InputGroup {...restProps}>\r\n    {prependEle ? <InputGroup.Prepend>{prependEle}</InputGroup.Prepend> : null}\r\n    <InputGroup.Prepend>\r\n      <InputGroup.Text>{name}</InputGroup.Text>\r\n    </InputGroup.Prepend>\r\n    <CustomFormControl\r\n      float={percent}\r\n      placeholder={placeholder}\r\n      value={value}\r\n      onChange={onValueChange}\r\n      disabled={disabled}\r\n    />\r\n    <InputGroup.Append>\r\n      {Boolean(percent) && <InputGroup.Text>%</InputGroup.Text>}\r\n      {defaultValue !== undefined && <OverlayTrigger placement=\"top\"\r\n        overlay={<Tooltip id=\"reset-tooltip\">Reset this override to the default value.</Tooltip>}>\r\n        <span className=\"d-inline-block\">\r\n          <Button onClick={() => onValueChange(defaultValue)} disabled={disabled || value === defaultValue} style={value === defaultValue ? { pointerEvents: 'none' } : {}}>\r\n            <FontAwesomeIcon icon={faUndo} />\r\n          </Button>\r\n        </span>\r\n      </OverlayTrigger>}\r\n    </InputGroup.Append>\r\n  </InputGroup>\r\nexport default StatInput","import { useMemo } from \"react\"\r\nimport { Col, Row } from \"react-bootstrap\"\r\nimport Character from \"../Character/Character\"\r\nimport CharacterSheet from \"../Character/CharacterSheet\"\r\nimport Formula from \"../Formula\"\r\nimport Stat from \"../Stat\"\r\nimport { ICachedCharacter } from \"../Types/character\"\r\nimport { IFieldDisplay } from \"../Types/IFieldDisplay\"\r\nimport { ICalculatedStats } from \"../Types/stats\"\r\nimport { usePromise } from \"../Util/ReactUtil\"\r\nimport WeaponSheet from \"../Weapon/WeaponSheet\"\r\nimport StatIcon from \"./StatIcon\"\r\n\r\nfunction DisplayStatDiff({ label = \"\", val, oldVal, fixed = 0, unit = \"\", variant = \"\" }) {\r\n  if (typeof oldVal === \"undefined\" && typeof val === \"number\") {//if only one value is filled, display that one.\r\n    oldVal = val\r\n    val = undefined\r\n  }\r\n  const diff = val !== undefined ? val - oldVal : 0;\r\n  let oldText: Displayable = \"\", diffText: Displayable = \"\"\r\n  if (oldVal || diff === 0) oldText = oldVal?.toFixed(fixed)\r\n  else if (oldVal === undefined) oldText = val?.toFixed(fixed)//if oldval isnt defined, just display val.\r\n  if (oldText) oldText = <span className={`text-${variant}`}>{oldText}{unit}</span>\r\n  if (diff !== 0) diffText = <span className={`text-${diff > 0 ? \"success\" : \"danger\"}`}>{diff > 0 ? \"+\" : \"\"}{diff?.toFixed(fixed)}{unit}</span>\r\n\r\n  return <Col xs=\"12\"><Row>\r\n    <Col><b>{label}</b></Col>\r\n    <Col xs=\"auto\">{oldText}{diff ? \" \" : \"\"}{diffText}</Col>\r\n  </Row></Col>\r\n}\r\ntype StatDisplayProps = {\r\n  characterSheet: CharacterSheet,\r\n  weaponSheet: WeaponSheet\r\n  character: ICachedCharacter,\r\n  equippedBuild?: ICalculatedStats,\r\n  newBuild?: ICalculatedStats,\r\n  statKey: string\r\n}\r\nexport default function StatDisplay({ characterSheet, weaponSheet, character, equippedBuild, newBuild, statKey }: StatDisplayProps) {\r\n  const formula = usePromise(Array.isArray(statKey) ? Formula.get(statKey) : undefined, [statKey])\r\n\r\n  const { val, oldVal, fixed, unit, variant, label } = useMemo(() => {\r\n    let val, oldVal, fixed, unit, variant, label: Displayable = \"\"\r\n    if (typeof statKey === \"string\") {//basic statKey\r\n      if (newBuild && equippedBuild) {//comparable\r\n        //newbuild -> val\r\n        //equippedbuild ->old\r\n        val = newBuild?.[statKey] ?? 0\r\n        oldVal = equippedBuild?.[statKey] ?? 0\r\n      } else {\r\n        const build = newBuild ? newBuild : equippedBuild\r\n        //build ->val\r\n        val = build?.[statKey] ?? 0\r\n        //statvaluewith override -> old\r\n        const invalid = \"invalid\" //can't use undeinfed as the defVal, since I want undefined for invalid numbers.\r\n        oldVal = Character.getStatValueWithOverride(character, characterSheet, weaponSheet, statKey) ?? invalid\r\n        oldVal === invalid && (oldVal = undefined)\r\n        if (build) {\r\n          if (statKey === \"finalHP\")\r\n            oldVal = build.characterHP\r\n          else if (statKey === \"finalDEF\")\r\n            oldVal = build.characterDEF\r\n          else if (statKey === \"finalATK\")\r\n            oldVal = build.characterATK + build.weaponATK\r\n        }\r\n      }\r\n      unit = Stat.getStatUnit(statKey)\r\n      fixed = Stat.fixedUnit(statKey)\r\n      label = <span>{StatIcon[statKey]} {Stat.getStatName(statKey)}</span>\r\n    } else if (formula) {//Formula\r\n      const build = newBuild ? newBuild : equippedBuild\r\n      const field = (formula as any).field as IFieldDisplay //assume it is attached in post-processing\r\n      const labelVariant = Character.getTalentFieldValue(field, \"variant\", build)\r\n      label = <span className={`text-${labelVariant}`}>{Character.getTalentFieldValue(field, \"text\", build)}</span>\r\n      fixed = Character.getTalentFieldValue(field, \"fixed\", build, 0 as any)\r\n      unit = Character.getTalentFieldValue(field, \"unit\", build,\"\")\r\n      val = Character.getTalentFieldValue(field, \"formula\", build)?.[0]?.(build)\r\n      if (newBuild && equippedBuild) {//comparable\r\n        oldVal = Character.getTalentFieldValue(field, \"formula\", equippedBuild)?.[0]?.(equippedBuild)\r\n      }\r\n    }\r\n    if (Character.hasOverride(character, statKey)) variant = \"warning\"\r\n    return { val, oldVal, fixed, unit, variant, label }\r\n  }, [character, characterSheet, weaponSheet, equippedBuild, newBuild, statKey, formula])\r\n\r\n  return <DisplayStatDiff {...{ val, oldVal, fixed, unit, variant, label: label as any }} />\r\n}","import { faQuestionCircle, faTimes } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { Suspense, useState } from \"react\"\r\nimport { Button, Card, Col, Modal, Row, Spinner } from \"react-bootstrap\"\r\nimport { dbStorage } from \"../Database/DBStorage\"\r\nimport { getRandomElementFromArray } from \"../Util/Util\"\r\nimport { TransWrapper } from \"./Translate\"\r\n\r\nexport default function InfoComponent({ pageKey = \"\", text = \"\", modalTitle = \"\", children }: { pageKey: string, text: Displayable | Displayable[], modalTitle: Displayable, children: JSX.Element }) {\r\n  const [showInfoModal, setshowInfoModal] = useState(dbStorage.get(\"infoShown\")?.[pageKey] ?? true)\r\n  const [displayText,] = useState(Array.isArray(text) ? getRandomElementFromArray(text) : text)\r\n  const closeModal = () => {\r\n    const infoShown = dbStorage.get(\"infoShown\") ?? {}\r\n    infoShown[pageKey] = false\r\n    dbStorage.set(\"infoShown\", infoShown)\r\n    setshowInfoModal(false)\r\n  }\r\n  return <>\r\n    <Modal show={showInfoModal} onHide={() => closeModal()} size=\"xl\" variant=\"success\" contentClassName=\"bg-transparent\">\r\n      <Card bg=\"darkcontent\" text={\"lightfont\" as any} >\r\n        <Card.Header>\r\n          <Row>\r\n            <Col>\r\n              <Card.Title>{modalTitle}</Card.Title>\r\n            </Col>\r\n            <Col xs=\"auto\">\r\n              <Button variant=\"danger\" onClick={() => closeModal()} >\r\n                <FontAwesomeIcon icon={faTimes} /></Button>\r\n            </Col>\r\n          </Row>\r\n        </Card.Header>\r\n        <Card.Body>\r\n          <Suspense fallback={<h3 className=\"text-center\">Loading... <Spinner animation=\"border\" variant=\"primary\" /></h3>}>\r\n            {children}\r\n          </Suspense>\r\n        </Card.Body>\r\n        <Card.Footer>\r\n          <Button variant=\"danger\" onClick={() => closeModal()}>\r\n            <span>Close</span>\r\n          </Button>\r\n        </Card.Footer>\r\n      </Card>\r\n    </Modal >\r\n    <Card bg=\"lightcontent\" text={\"lightfont\" as any} className=\"mb-2\">\r\n      <Card.Body className=\"pl-2 py-0 pr-0\">\r\n        <Row>\r\n          <Col><small>{displayText}</small></Col>\r\n          <Col xs=\"auto\">\r\n            <Button size=\"sm\" variant=\"info\" className=\"m-0 py-1\" onClick={() => setshowInfoModal(true)}><TransWrapper ns=\"ui\" key18=\"info\" /> <FontAwesomeIcon icon={faQuestionCircle} /></Button>\r\n          </Col>\r\n        </Row>\r\n      </Card.Body>\r\n    </Card>\r\n  </>\r\n}","import { Badge, Card, ListGroup } from \"react-bootstrap\"\r\nimport DocumentDisplay from \"../../Components/DocumentDisplay\"\r\nimport FieldDisplay from \"../../Components/FieldDisplay\"\r\nimport { ArtifactSetKey, SetNum } from \"../../Types/consts\"\r\nimport { ICalculatedStats } from \"../../Types/stats\"\r\nimport statsToFields from \"../../Util/FieldUtil\"\r\nimport { usePromise } from \"../../Util/ReactUtil\"\r\nimport { ArtifactSheet } from \"../ArtifactSheet\"\r\n\r\ntype Data = {\r\n  setKey: ArtifactSetKey,\r\n  setNumKey: SetNum,\r\n  newBuild?: ICalculatedStats,\r\n  equippedBuild?: ICalculatedStats\r\n  characterDispatch: (arg0: any) => void,\r\n}\r\n\r\nexport default function SetEffectDisplay({ setKey, setNumKey, equippedBuild, newBuild, characterDispatch }: Data) {\r\n  const sheet = usePromise(ArtifactSheet.get(setKey), [setKey])\r\n  if (!sheet) return null\r\n\r\n  const stats = newBuild ?? equippedBuild!\r\n  const setEffectText = sheet.setEffectDesc(setNumKey)\r\n  const setStats = sheet.setNumStats(setNumKey, stats)\r\n  const setStatsFields = statsToFields(setStats, stats)\r\n  const document = sheet.setEffectDocument(setNumKey)\r\n  return <>\r\n    <Card bg=\"darkcontent\" text={\"lightfont\" as any} className=\"mb-2 w-100\" >\r\n      <Card.Header className=\"p-2\">\r\n        <Badge variant=\"success\">{setNumKey}-Set</Badge> {setEffectText}\r\n      </Card.Header>\r\n      <ListGroup className=\"text-white\" variant=\"flush\">\r\n        {setStatsFields.map((field, i) => <FieldDisplay key={i} index={i} field={field} />)}\r\n      </ListGroup>\r\n    </Card>\r\n    {document ? <DocumentDisplay sections={document} characterDispatch={characterDispatch} /> : null}\r\n  </>\r\n}\r\n","import { faCheckSquare, faSquare, faWindowMaximize, faWindowMinimize } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { useContext, useMemo } from 'react';\r\nimport { Accordion, AccordionContext, Button, Card, Col, Dropdown, Row, ToggleButton, ToggleButtonGroup } from \"react-bootstrap\";\r\nimport { useAccordionToggle } from 'react-bootstrap/AccordionToggle';\r\nimport { ArtifactSheet } from \"../../Artifact/ArtifactSheet\";\r\nimport { buildContext } from \"../../Build/Build\";\r\nimport StatIcon, { uncoloredEleIcons } from \"../../Components/StatIcon\";\r\nimport Formula from \"../../Formula\";\r\nimport Stat, { FormulaDisplay } from \"../../Stat\";\r\nimport { GetDependencies } from \"../../StatDependency\";\r\nimport { ICachedCharacter } from \"../../Types/character\";\r\nimport { allElements, ArtifactSetKey } from \"../../Types/consts\";\r\nimport { IFieldDisplay } from \"../../Types/IFieldDisplay\";\r\nimport { ICalculatedStats } from \"../../Types/stats\";\r\nimport { usePromise } from \"../../Util/ReactUtil\";\r\nimport WeaponSheet from \"../../Weapon/WeaponSheet\";\r\nimport Character from \"../Character\";\r\nimport type { characterReducerAction } from \"../CharacterDisplayCard\";\r\nimport CharacterSheet from \"../CharacterSheet\";\r\nimport { getFormulaTargetsDisplayHeading } from \"../CharacterUtil\";\r\nimport StatInput from \"../StatInput\";\r\nconst infusionVals = {\r\n  \"\": <span>No External Infusion</span>,\r\n  \"pyro\": <span >{uncoloredEleIcons.pyro} Pyro Infusion</span>,\r\n  \"cryo\": <span >{uncoloredEleIcons.cryo} Cryo Infusion</span>,\r\n}\r\ntype InfusionAuraDropdownProps = {\r\n  characterSheet: CharacterSheet,\r\n  character: ICachedCharacter,\r\n  characterDispatch: (any: characterReducerAction) => void,\r\n  className?: string\r\n  disabled?: boolean\r\n}\r\nexport function InfusionAuraDropdown({ characterSheet, character: { infusionAura = \"\" }, characterDispatch, className, disabled = false }: InfusionAuraDropdownProps) {\r\n  if (!characterSheet.isMelee()) return null\r\n  return <Dropdown className={className}>\r\n    <Dropdown.Toggle variant={infusionAura || \"secondary\"} disabled={disabled}>{infusionVals[infusionAura]}</Dropdown.Toggle>\r\n    <Dropdown.Menu>\r\n      {Object.entries(infusionVals).map(([key, text]) => <Dropdown.Item key={key} className={`text-${key}`} onClick={() => characterDispatch({ infusionAura: key })}>{text}</Dropdown.Item>)}\r\n    </Dropdown.Menu>\r\n  </Dropdown>\r\n}\r\n\r\ntype ReactionToggleProps = {\r\n  character: ICachedCharacter,\r\n  build: ICalculatedStats,\r\n  characterDispatch: (any: characterReducerAction) => void,\r\n  className: string\r\n  disabled?: boolean\r\n}\r\nexport function ReactionToggle({ character: { reactionMode = null, infusionAura }, build, characterDispatch, className, disabled = false }: ReactionToggleProps) {\r\n  if (!build) return null\r\n  const charEleKey = build.characterEle\r\n  if (![\"pyro\", \"hydro\", \"cryo\"].includes(charEleKey) && ![\"pyro\", \"hydro\", \"cryo\"].includes(infusionAura)) return null\r\n  const v = s => s ? \"success\" : \"secondary\"\r\n  return <ToggleButtonGroup className={className} type=\"radio\" name=\"reactionMode\" value={reactionMode} onChange={val => characterDispatch({ reactionMode: val === \"none\" ? null : val })}>\r\n    <ToggleButton value={\"none\"} variant={v(!reactionMode)} disabled={disabled}>No Reactions</ToggleButton >\r\n    {(charEleKey === \"pyro\" || infusionAura === \"pyro\") && <ToggleButton value={\"pyro_vaporize\"} variant={v(reactionMode === \"pyro_vaporize\")} disabled={disabled}>\r\n      <span className=\"text-vaporize\">Vaporize(Pyro) {StatIcon.hydro}+{StatIcon.pyro}</span>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"pyro\" || infusionAura === \"pyro\") && <ToggleButton value={\"pyro_melt\"} variant={v(reactionMode === \"pyro_melt\")} disabled={disabled}>\r\n      <span className=\"text-melt\">Melt(Pyro) {StatIcon.cryo}+{StatIcon.pyro}</span>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"hydro\" || infusionAura === \"hydro\") && <ToggleButton value={\"hydro_vaporize\"} variant={v(reactionMode === \"hydro_vaporize\")} disabled={disabled}>\r\n      <span className=\"text-vaporize\">Vaporize(Hydro) {StatIcon.pyro}+{StatIcon.hydro}</span>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"cryo\" || infusionAura === \"cryo\") && <ToggleButton value={\"cryo_melt\"} variant={v(reactionMode === \"cryo_melt\")} disabled={disabled}>\r\n      <span className=\"text-melt\">Melt(Cryo) {StatIcon.pyro}+{StatIcon.cryo}</span>\r\n    </ToggleButton >}\r\n  </ToggleButtonGroup>\r\n}\r\nexport function HitModeToggle({ hitMode, characterDispatch, className, disabled = false }) {\r\n  const v = s => s ? \"success\" : \"secondary\"\r\n  return <ToggleButtonGroup type=\"radio\" value={hitMode} name=\"hitOptions\" onChange={m => characterDispatch({ hitMode: m })} className={className} >\r\n    <ToggleButton value=\"avgHit\" variant={v(hitMode === \"avgHit\")} disabled={disabled} >Avg. DMG</ToggleButton>\r\n    <ToggleButton value=\"hit\" variant={v(hitMode === \"hit\")} disabled={disabled} >Non Crit DMG</ToggleButton>\r\n    <ToggleButton value=\"critHit\" variant={v(hitMode === \"critHit\")} disabled={disabled} >Crit Hit DMG</ToggleButton>\r\n  </ToggleButtonGroup>\r\n}\r\n\r\nfunction CalculationDisplay({ sheets, build }: {\r\n  sheets: {\r\n    characterSheet: CharacterSheet\r\n    weaponSheet: WeaponSheet,\r\n    artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet>\r\n  },\r\n  build: ICalculatedStats\r\n}) {\r\n  const displayStatKeys = useMemo(() => build && Character.getDisplayStatKeys(build, sheets), [build, sheets])\r\n  if (!build) return null\r\n  return <div>\r\n    {Object.entries(displayStatKeys).map(([sectionKey, fields]: [string, any]) => {\r\n      const header = getFormulaTargetsDisplayHeading(sectionKey, sheets, build.characterEle)\r\n      return <Card bg=\"darkcontent\" text={\"lightfont\" as any} key={sectionKey} className=\"w-100 mb-2\">\r\n        <Card.Header>{header}</Card.Header>\r\n        <Card.Body className=\"p-2\">\r\n          <Accordion className=\"mb-n2\">\r\n            {fields.map((field, fieldIndex) => {\r\n              if (Array.isArray(field))\r\n                return <FormulaCalculationField key={fieldIndex} fieldKeys={field} build={build} fieldIndex={fieldIndex} />\r\n              else if (typeof field === \"string\") {//simple statKey field\r\n                const subFormulaKeys: any[] = Stat.getPrintableFormulaStatKeyList(GetDependencies(build, build?.modifiers, [field]), build?.modifiers).reverse()\r\n                return Boolean(subFormulaKeys.length) && <Card key={fieldIndex} bg=\"lightcontent\" text={\"lightfont\" as any} className=\"mb-2\">\r\n                  <Accordion.Toggle as={Card.Header} className=\"p-2 cursor-pointer\" variant=\"link\" eventKey={`field${fieldIndex}`}>\r\n                    {Stat.printStat(field, build)}\r\n                  </Accordion.Toggle>\r\n                  <Accordion.Collapse eventKey={`field${fieldIndex}`}>\r\n                    <Card.Body className=\"p-2\">\r\n                      <div className=\"mb-n2\">\r\n                        {subFormulaKeys.map(subKey =>\r\n                          <p className=\"mb-2\" key={subKey}>{Stat.printStat(subKey, build)} = <small><FormulaDisplay statKey={subKey} stats={build} modifiers={build.modifiers} expand={false} /></small></p>\r\n                        )}\r\n                      </div>\r\n                    </Card.Body>\r\n                  </Accordion.Collapse>\r\n                </Card>\r\n              }\r\n              return null\r\n            })}\r\n          </Accordion>\r\n        </Card.Body>\r\n      </Card>\r\n    })}\r\n  </div>\r\n}\r\nfunction FormulaCalculationField({ fieldKeys, build, fieldIndex }: { fieldKeys: string[], build: ICalculatedStats, fieldIndex: number, }) {\r\n  const formula = usePromise(Formula.get(fieldKeys), [fieldKeys])\r\n  if (!formula) return null\r\n  const formulaField = (formula as any).field as IFieldDisplay\r\n  const fieldText = Character.getTalentFieldValue(formulaField, \"text\", build)\r\n  const fieldVariant = Character.getTalentFieldValue(formulaField, \"variant\", build)\r\n  const fieldFormulaText = Character.getTalentFieldValue(formulaField, \"formulaText\", build)\r\n  const fieldFixed = Character.getTalentFieldValue(formulaField, \"fixed\", build) ?? 0\r\n  const fieldUnit = Character.getTalentFieldValue(formulaField, \"unit\", build) ?? \"\"\r\n  const [fieldFormula, fieldFormulaDependency] = Character.getTalentFieldValue(formulaField, \"formula\", build, [] as any)\r\n  if (!fieldFormula || !fieldFormulaDependency) return null\r\n  const fieldValue = fieldFormula?.(build)?.toFixed?.(fieldFixed)\r\n  const subFormulaKeys = Stat.getPrintableFormulaStatKeyList(GetDependencies(build, build?.modifiers, fieldFormulaDependency), build?.modifiers).reverse()\r\n  return <Card bg=\"lightcontent\" text={\"lightfont\" as any} className=\"mb-2\">\r\n    <Accordion.Toggle as={Card.Header} className=\"p-2 cursor-pointer\" variant=\"link\" eventKey={`field${fieldIndex}`}>\r\n      <b className={`text-${fieldVariant}`}>{fieldText}</b> <span className=\"text-info\">{fieldValue}{fieldUnit}</span>\r\n    </Accordion.Toggle>\r\n    <Accordion.Collapse eventKey={`field${fieldIndex}`}>\r\n      <Card.Body className=\"p-2\">\r\n        <div className=\"mb-n2\">\r\n          <p className=\"mb-2\"><b className={`text-${fieldVariant}`}>{fieldText}</b> <span className=\"text-info\">{fieldValue}</span> = <small>{fieldFormulaText}</small></p>\r\n          {subFormulaKeys.map(subKey =>\r\n            <p className=\"mb-2\" key={subKey}>{Stat.printStat(subKey, build)} = <small><FormulaDisplay statKey={subKey} stats={build} modifiers={build.modifiers} expand={false} /></small></p>\r\n          )}\r\n        </div>\r\n      </Card.Body>\r\n    </Accordion.Collapse>\r\n  </Card>\r\n}\r\n\r\nconst ContextAwareToggle = ({ eventKey, callback }) => {\r\n  const currentEventKey = useContext(AccordionContext);\r\n  const decoratedOnClick = useAccordionToggle(\r\n    eventKey,\r\n    () => callback && callback(eventKey),\r\n  );\r\n  const expanded = currentEventKey === eventKey;\r\n  return (\r\n    <Button onClick={decoratedOnClick} variant=\"info\">\r\n      <FontAwesomeIcon icon={expanded ? faWindowMinimize : faWindowMaximize} className={`fa-fw ${expanded ? \"fa-rotate-180\" : \"\"}`} />\r\n      <span> </span>{expanded ? \"Retract\" : \"Expand\"}\r\n    </Button>\r\n  );\r\n}\r\n\r\ntype DamageOptionsAndCalculationProps = {\r\n  sheets: {\r\n    characterSheet: CharacterSheet\r\n    weaponSheet: WeaponSheet,\r\n    artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet>\r\n  }\r\n  character: ICachedCharacter,\r\n  characterDispatch: (any: characterReducerAction) => void,\r\n  className: string\r\n}\r\nexport default function DamageOptionsAndCalculation({ sheets, sheets: { characterSheet, weaponSheet }, character, character: { hitMode }, characterDispatch, className }: DamageOptionsAndCalculationProps) {\r\n  const { newBuild, equippedBuild } = useContext(buildContext)\r\n  //choose which one to display stats for\r\n  const build = newBuild ? newBuild : equippedBuild!\r\n  return <div className={className}>\r\n    <Card bg=\"lightcontent\" text={\"lightfont\" as any} className=\"mb-2\">\r\n      <Card.Header>\r\n        <Row className=\"mb-n2\">\r\n          <Col xs=\"auto\"><InfusionAuraDropdown characterSheet={characterSheet} character={character} characterDispatch={characterDispatch} className=\"mb-2\" /></Col>\r\n          <Col xs=\"auto\"><HitModeToggle hitMode={hitMode} characterDispatch={characterDispatch} className=\"mb-2\" /></Col>\r\n          <Col xs=\"auto\"><ReactionToggle character={character} build={build} characterDispatch={characterDispatch} className=\"mb-2\" /></Col>\r\n        </Row>\r\n      </Card.Header>\r\n    </Card>\r\n    <Accordion >\r\n      <Card bg=\"lightcontent\" text={\"lightfont\" as any} >\r\n        <Card.Header>\r\n          <Row>\r\n            <Col>\r\n              <span className=\"d-block\">Damage Calculation Options & Formulas</span>\r\n              <small>Expand below to edit enemy details and view calculation details.</small>\r\n            </Col>\r\n            <Col xs=\"auto\">\r\n              <ContextAwareToggle callback={undefined} {...{ as: Button }} eventKey=\"details\" />\r\n            </Col>\r\n          </Row>\r\n        </Card.Header>\r\n        <Accordion.Collapse eventKey=\"details\">\r\n          <Card.Body className=\"p-2\">\r\n            <Card className=\"mb-2\" bg=\"darkcontent\" text={\"lightfont\" as any}>\r\n              <Card.Header>\r\n                <Row>\r\n                  <Col>Enemy Editor</Col>\r\n                  <Col xs=\"auto\">\r\n                    <Button variant=\"warning\" size=\"sm\">\r\n                      <a href=\"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances\" target=\"_blank\" rel=\"noreferrer\">To get the specific resistance values of enemies, please visit the wiki.</a>\r\n                    </Button >\r\n                  </Col>\r\n                </Row>\r\n              </Card.Header>\r\n              <Card.Body className=\"p-2\">\r\n                <Row >\r\n                  <Col xs={12} xl={6} className=\"mb-2\">\r\n                    <StatInput\r\n                      name={<b>Enemy Level</b>}\r\n                      value={Character.getStatValueWithOverride(character, characterSheet, weaponSheet, \"enemyLevel\")}\r\n                      placeholder={Stat.getStatNameRaw(\"enemyLevel\")}\r\n                      defaultValue={Character.getBaseStatValue(character, characterSheet, weaponSheet, \"enemyLevel\")}\r\n                      onValueChange={value => characterDispatch({ type: \"statOverride\", statKey: \"enemyLevel\", value })}\r\n                    />\r\n                  </Col>\r\n                  {[\"physical\", ...allElements].map(eleKey => {\r\n                    let statKey = `${eleKey}_enemyRes_`\r\n                    let immunityStatKey = `${eleKey}_enemyImmunity`\r\n                    let elementImmunity = Character.getStatValueWithOverride(character, characterSheet, weaponSheet, immunityStatKey)\r\n                    return <Col xs={12} xl={6} key={eleKey} className=\"mb-2\">\r\n                      <StatInput\r\n                        prependEle={<Button variant={eleKey} onClick={() => characterDispatch({ type: \"statOverride\", statKey: immunityStatKey, value: !elementImmunity })} className=\"text-darkcontent\">\r\n                          <FontAwesomeIcon icon={elementImmunity ? faCheckSquare : faSquare} className=\"fa-fw\" /> Immunity\r\n                        </Button>}\r\n                        name={<b>{Stat.getStatName(statKey)}</b>}\r\n                        value={Character.getStatValueWithOverride(character, characterSheet, weaponSheet, statKey)}\r\n                        placeholder={Stat.getStatNameRaw(statKey)}\r\n                        defaultValue={Character.getBaseStatValue(character, characterSheet, weaponSheet, statKey)}\r\n                        onValueChange={value => characterDispatch({ type: \"statOverride\", statKey, value })}\r\n                        disabled={elementImmunity}\r\n                        percent\r\n                      />\r\n                    </Col>\r\n                  })}\r\n                  <Col xs={12}><small>Note: for negative resistances due to resistance shred like Zhongli's shield (e.g. -10%), enter the RAW value (-10). GO will half the value for you in the calculations.</small></Col>\r\n                </Row>\r\n              </Card.Body>\r\n            </Card>\r\n            <CalculationDisplay sheets={sheets} build={build} />\r\n          </Card.Body>\r\n        </Accordion.Collapse>\r\n      </Card>\r\n    </Accordion>\r\n  </div>\r\n}\r\n","\r\n//take the new statsDisplayKeys, and display the stats.\r\n\r\nimport { Card, Col, Row } from \"react-bootstrap\"\r\nimport StatDisplay from \"../../Components/StatDisplay\"\r\nimport { ICachedCharacter } from \"../../Types/character\"\r\nimport CharacterSheet from \"../CharacterSheet\"\r\nimport { ICalculatedStats } from \"../../Types/stats\"\r\nimport WeaponSheet from \"../../Weapon/WeaponSheet\"\r\nimport { ArtifactSetKey } from \"../../Types/consts\"\r\nimport { ArtifactSheet } from \"../../Artifact/ArtifactSheet\"\r\nimport { getFormulaTargetsDisplayHeading } from \"../CharacterUtil\"\r\n\r\ntype StatDisplayComponentProps = {\r\n  sheets: {\r\n    characterSheet: CharacterSheet\r\n    weaponSheet: WeaponSheet,\r\n    artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet>\r\n  },\r\n  character: ICachedCharacter\r\n  statsDisplayKeys: any,\r\n  cardbg?: string\r\n  equippedBuild?: ICalculatedStats\r\n  newBuild?: ICalculatedStats\r\n}\r\n\r\nexport default function StatDisplayComponent({ sheets, sheets: { characterSheet, weaponSheet }, character, equippedBuild, newBuild, statsDisplayKeys, cardbg = \"darkcontent\" }: StatDisplayComponentProps) {\r\n  const build = newBuild ? newBuild : equippedBuild\r\n  return <Row className=\"mb-n2\">{Object.entries(statsDisplayKeys).map(([sectionKey, sectionValues]: any) => {\r\n    const header = getFormulaTargetsDisplayHeading(sectionKey, sheets, build?.characterEle)\r\n    return <Col key={sectionKey} className=\"mb-2\" xs={12} md={6} xl={4}>\r\n      <Card bg={cardbg} text={\"lightfont\" as any} className=\"h-100\">\r\n        <Card.Header>{header}</Card.Header>\r\n        <Card.Body>\r\n          <Row>{sectionValues.map(statKey => <StatDisplay key={JSON.stringify(statKey)} {...{ characterSheet, weaponSheet, character, equippedBuild, newBuild, statKey }} />)}</Row>\r\n        </Card.Body>\r\n      </Card>\r\n    </Col>\r\n  })}</Row>\r\n}","import { faCalculator, faEdit, faLink, faTrashAlt } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { useContext, useEffect, useMemo, useState } from 'react';\r\nimport { Badge, Image } from 'react-bootstrap';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Card from 'react-bootstrap/Card';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Row from 'react-bootstrap/Row';\r\nimport { Link } from 'react-router-dom';\r\nimport { ArtifactSheet } from '../Artifact/ArtifactSheet';\r\nimport Assets from '../Assets/Assets';\r\nimport { Stars } from '../Components/StarDisplay';\r\nimport StatIcon from '../Components/StatIcon';\r\nimport { DatabaseContext } from '../Database/Database';\r\nimport Stat from '../Stat';\r\nimport { ICachedCharacter } from '../Types/character';\r\nimport { CharacterKey } from '../Types/consts';\r\nimport { ICachedWeapon } from '../Types/weapon';\r\nimport { usePromise } from '../Util/ReactUtil';\r\nimport WeaponSheet from '../Weapon/WeaponSheet';\r\nimport Character from './Character';\r\nimport CharacterSheet from './CharacterSheet';\r\ntype CharacterCardProps = { characterKey: CharacterKey | \"\", onEdit?: (any) => void, onDelete?: (any) => void, cardClassName: string, header?: JSX.Element, bg?: string, footer?: boolean }\r\nexport default function CharacterCard({ characterKey, onEdit, onDelete, cardClassName = \"\", bg = \"\", header, footer = false }: CharacterCardProps) {\r\n  const database = useContext(DatabaseContext)\r\n  const [databaseCharacter, updateDatabaseCharacter] = useState(undefined as ICachedCharacter | undefined)\r\n  useEffect(() =>\r\n    characterKey ? database.followChar(characterKey, updateDatabaseCharacter) : undefined,\r\n    [characterKey, updateDatabaseCharacter, database])\r\n\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll(), [])\r\n  const character = databaseCharacter\r\n  const characterSheet = usePromise(CharacterSheet.get(characterKey), [characterKey])\r\n  const weapon = character?.equippedWeapon ? database._getWeapon(character.equippedWeapon) : undefined\r\n  const weaponSheet = usePromise(weapon ? WeaponSheet.get(weapon.key) : undefined, [weapon?.key])\r\n  const stats = useMemo(() => character && characterSheet && weaponSheet && artifactSheets && Character.calculateBuild(character, database, characterSheet, weaponSheet, artifactSheets), [character, characterSheet, weaponSheet, artifactSheets, database])\r\n  if (!character || !weapon || !characterSheet || !weaponSheet || !stats) return null;\r\n\r\n  const { constellation } = character\r\n  const { level, ascension } = weapon\r\n  const { tlvl } = stats\r\n  const name = characterSheet.name\r\n  const elementKey = stats.characterEle\r\n  const weaponTypeKey = characterSheet.weaponTypeKey\r\n  const weaponName = weaponSheet?.name\r\n  const weaponMainVal = weaponSheet.getMainStatValue(level, ascension).toFixed(Stat.fixedUnit(\"atk\"))\r\n  const weaponSubKey = weaponSheet.getSubStatKey()\r\n  const weaponSubVal = weaponSheet.getSubStatValue(level, ascension).toFixed(Stat.fixedUnit(weaponSubKey))\r\n  const weaponLevelName = WeaponSheet.getLevelString(weapon as ICachedWeapon)\r\n  const weaponPassiveName = weaponSheet?.passiveName\r\n  const statkeys = [\"finalHP\", \"finalATK\", \"finalDEF\", \"eleMas\", \"critRate_\", \"critDMG_\", \"enerRech_\",]\r\n\r\n  return (<Card className={cardClassName} bg={bg ? bg : \"darkcontent\"} text={\"lightfont\" as any}>\r\n    <Card.Header className=\"pr-2\">\r\n      <Row className=\"no-gutters\">\r\n        <Col >\r\n          {header ? header : <h5><b>{name}</b></h5>}\r\n        </Col>\r\n        <Col xs={\"auto\"}>\r\n          <span className=\"float-right align-top ml-1\">\r\n            {onEdit && <Button variant=\"primary\" size=\"sm\" className=\"mr-1\"\r\n              onClick={() => onEdit(characterKey)}>\r\n              <FontAwesomeIcon icon={faEdit} />\r\n            </Button>}\r\n            {onDelete && <Button variant=\"danger\" size=\"sm\"\r\n              onClick={() => onDelete(characterKey)}>\r\n              <FontAwesomeIcon icon={faTrashAlt} />\r\n            </Button>}\r\n          </span>\r\n        </Col>\r\n      </Row>\r\n    </Card.Header>\r\n    <Card.Body onClick={() => onEdit?.(characterKey)} className={onEdit ? \"cursor-pointer\" : \"\"} >\r\n      <Row>\r\n        <Col xs=\"auto\" className=\"pr-0\">\r\n          <Image src={characterSheet.thumbImg} className={`thumb-big grad-${characterSheet.star}star p-0`} thumbnail />\r\n        </Col>\r\n        <Col>\r\n          <h5 className=\"mb-0\">Lv. {Character.getLevelString(character)} {`C${constellation}`}</h5>\r\n          <h6 className=\"mb-0\">\r\n            <Badge variant=\"secondary\"><strong className=\"mx-1\">{tlvl.auto + 1}</strong></Badge>{` `}\r\n            <Badge variant=\"secondary\"><strong className=\"mx-1\">{tlvl.skill + 1}</strong></Badge>{` `}\r\n            <Badge variant=\"secondary\"><strong className=\"mx-1\">{tlvl.burst + 1}</strong></Badge>\r\n          </h6>\r\n          <h6 className=\"mb-0\"><Stars stars={characterSheet.star} colored /></h6>\r\n          <h3 className=\"mb-0\">{StatIcon[elementKey]} <Image src={Assets.weaponTypes?.[weaponTypeKey]} className=\"inline-icon\" /></h3>\r\n        </Col>\r\n      </Row>\r\n      <Row className=\"mb-2\">\r\n        <Col>\r\n          <h6 className=\"mb-0\">{weaponName}{weaponPassiveName && <Badge variant=\"info\" className=\"ml-1\">{weapon.refinement}</Badge>} {weaponLevelName}</h6>\r\n          <span>ATK: {weaponMainVal}  {weaponPassiveName && <span>{Stat.getStatName(weaponSubKey)}: {weaponSubVal}{Stat.getStatUnit(weaponSubKey)}</span>}</span>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col>\r\n          {artifactSheets && Object.entries(ArtifactSheet.setEffects(artifactSheets, stats.setToSlots)).map(([key, arr]) => {\r\n            let artifactSetName = artifactSheets?.[key].name ?? \"\"\r\n            let highestNum = Math.max(...arr)\r\n            return <h5 key={key}><Badge variant=\"secondary\">{artifactSetName} <Badge variant=\"success\">{highestNum}</Badge></Badge></h5>\r\n          })}\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        {statkeys.map(statKey => {\r\n          let unit = Stat.getStatUnit(statKey)\r\n          let statVal = stats[statKey]\r\n          return <Col xs={12} key={statKey}>\r\n            <h6 className=\"d-inline\">{StatIcon[statKey]} {Stat.getStatName(statKey)}</h6>\r\n            <span className={`float-right`}>\r\n              {statVal?.toFixed(Stat.fixedUnit(statKey)) + unit}\r\n            </span>\r\n          </Col>\r\n        })}\r\n      </Row>\r\n    </Card.Body>\r\n    {footer && <Card.Footer>\r\n      <Row>\r\n        <Col><Button as={Link} to={{\r\n          pathname: \"/build\",\r\n          characterKey\r\n        } as any}><FontAwesomeIcon icon={faCalculator} /> Generate Builds</Button>\r\n        </Col>\r\n        <Col>\r\n          <Button variant=\"info\" as={Link} to={{ pathname: \"/flex\", characterKey } as any}><FontAwesomeIcon icon={faLink} /> Share Character</Button>\r\n        </Col>\r\n      </Row>\r\n\r\n    </Card.Footer>}\r\n  </Card>)\r\n}","import { strPadLeft } from \"./Util\"\r\n\r\nexport function msToUnits(ms: number) {\r\n  let milliseconds = ms % 1000\r\n  let seconds = Math.floor((ms / 1000) % 60)\r\n  let minutes = Math.floor((ms / (1000 * 60)) % 60)\r\n  let hours = Math.floor((ms / (1000 * 60 * 60)))\r\n  return { hours, minutes, seconds, milliseconds }\r\n}\r\nexport function timeString(ms: number) {\r\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\r\n  let { hours, minutes, seconds } = msToUnits(ms)\r\n  let timeText = \"Minutes\"\r\n  if (hours) timeText = \"Hours\"\r\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)} ${timeText}`;\r\n}\r\nexport function timeStringMs(ms: number) {\r\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\r\n  let { hours, minutes, seconds, milliseconds } = msToUnits(ms)\r\n  let timeText = \"Minutes\"\r\n  if (hours) timeText = \"Hours\"\r\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)}.${strPadLeft(milliseconds, '0', 3)} ${timeText}`;\r\n}\r\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _excluded = [\"min\", \"now\", \"max\", \"label\", \"srOnly\", \"striped\", \"animated\", \"className\", \"style\", \"variant\", \"bsPrefix\"],\n    _excluded2 = [\"isChild\"],\n    _excluded3 = [\"min\", \"now\", \"max\", \"label\", \"srOnly\", \"striped\", \"animated\", \"bsPrefix\", \"variant\", \"className\", \"children\"];\nimport classNames from 'classnames';\nimport React, { cloneElement } from 'react';\nimport { useBootstrapPrefix } from './ThemeProvider';\nimport { map } from './ElementChildren';\nvar ROUND_PRECISION = 1000;\n/**\n * Validate that children, if any, are instances of `<ProgressBar>`.\n */\n\nfunction onlyProgressBar(props, propName, componentName) {\n  var children = props[propName];\n\n  if (!children) {\n    return null;\n  }\n\n  var error = null;\n  React.Children.forEach(children, function (child) {\n    if (error) {\n      return;\n    }\n    /**\n     * Compare types in a way that works with libraries that patch and proxy\n     * components like react-hot-loader.\n     *\n     * see https://github.com/gaearon/react-hot-loader#checking-element-types\n     */\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n\n\n    var element = /*#__PURE__*/React.createElement(ProgressBar, null);\n    if (child.type === element.type) return;\n    var childType = child.type;\n    var childIdentifier = /*#__PURE__*/React.isValidElement(child) ? childType.displayName || childType.name || childType : child;\n    error = new Error(\"Children of \" + componentName + \" can contain only ProgressBar \" + (\"components. Found \" + childIdentifier + \".\"));\n  });\n  return error;\n}\n\nvar defaultProps = {\n  min: 0,\n  max: 100,\n  animated: false,\n  isChild: false,\n  srOnly: false,\n  striped: false\n};\n\nfunction getPercentage(now, min, max) {\n  var percentage = (now - min) / (max - min) * 100;\n  return Math.round(percentage * ROUND_PRECISION) / ROUND_PRECISION;\n}\n\nfunction renderProgressBar(_ref, ref) {\n  var _classNames;\n\n  var min = _ref.min,\n      now = _ref.now,\n      max = _ref.max,\n      label = _ref.label,\n      srOnly = _ref.srOnly,\n      striped = _ref.striped,\n      animated = _ref.animated,\n      className = _ref.className,\n      style = _ref.style,\n      variant = _ref.variant,\n      bsPrefix = _ref.bsPrefix,\n      props = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: ref\n  }, props, {\n    role: \"progressbar\",\n    className: classNames(className, bsPrefix + \"-bar\", (_classNames = {}, _classNames[\"bg-\" + variant] = variant, _classNames[bsPrefix + \"-bar-animated\"] = animated, _classNames[bsPrefix + \"-bar-striped\"] = animated || striped, _classNames)),\n    style: _extends({\n      width: getPercentage(now, min, max) + \"%\"\n    }, style),\n    \"aria-valuenow\": now,\n    \"aria-valuemin\": min,\n    \"aria-valuemax\": max\n  }), srOnly ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"sr-only\"\n  }, label) : label);\n}\n\nvar ProgressBar = /*#__PURE__*/React.forwardRef(function (_ref2, ref) {\n  var isChild = _ref2.isChild,\n      props = _objectWithoutPropertiesLoose(_ref2, _excluded2);\n\n  props.bsPrefix = useBootstrapPrefix(props.bsPrefix, 'progress');\n\n  if (isChild) {\n    return renderProgressBar(props, ref);\n  }\n\n  var min = props.min,\n      now = props.now,\n      max = props.max,\n      label = props.label,\n      srOnly = props.srOnly,\n      striped = props.striped,\n      animated = props.animated,\n      bsPrefix = props.bsPrefix,\n      variant = props.variant,\n      className = props.className,\n      children = props.children,\n      wrapperProps = _objectWithoutPropertiesLoose(props, _excluded3);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: ref\n  }, wrapperProps, {\n    className: classNames(className, bsPrefix)\n  }), children ? map(children, function (child) {\n    return /*#__PURE__*/cloneElement(child, {\n      isChild: true\n    });\n  }) : renderProgressBar({\n    min: min,\n    now: now,\n    max: max,\n    label: label,\n    srOnly: srOnly,\n    striped: striped,\n    animated: animated,\n    bsPrefix: bsPrefix,\n    variant: variant\n  }, ref));\n});\nProgressBar.displayName = 'ProgressBar';\nProgressBar.defaultProps = defaultProps;\nexport default ProgressBar;","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/BuildWorker.61169781.worker.js\");\n}\n","import { faCheckSquare, faSquare, faTimes, faTrash, faUndo } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport React, { lazy, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Alert, Badge, Button, ButtonGroup, Card, Col, Container, Dropdown, DropdownButton, Image, InputGroup, ListGroup, Modal, OverlayTrigger, ProgressBar, Row, Tooltip } from 'react-bootstrap';\r\nimport ReactGA from 'react-ga';\r\n// eslint-disable-next-line\r\nimport Worker from \"worker-loader!./BuildWorker\";\r\nimport Artifact from '../Artifact/Artifact';\r\nimport { ArtifactSheet } from '../Artifact/ArtifactSheet';\r\nimport SetEffectDisplay from '../Artifact/Component/SetEffectDisplay';\r\nimport SlotNameWithIcon, { artifactSlotIcon } from '../Artifact/Component/SlotNameWIthIcon';\r\nimport Character from '../Character/Character';\r\nimport CharacterCard from '../Character/CharacterCard';\r\nimport { HitModeToggle, InfusionAuraDropdown, ReactionToggle } from '../Character/CharacterDisplay/DamageOptionsAndCalculation';\r\nimport StatDisplayComponent from '../Character/CharacterDisplay/StatDisplayComponent';\r\nimport CharacterSheet from '../Character/CharacterSheet';\r\nimport { getFormulaTargetsDisplayHeading } from '../Character/CharacterUtil';\r\nimport { CharacterSelectionDropdownList } from '../Character/CharacterSelection';\r\nimport CustomFormControl from '../Components/CustomFormControl';\r\nimport InfoComponent from '../Components/InfoComponent';\r\nimport { Stars } from '../Components/StarDisplay';\r\nimport StatIcon from '../Components/StatIcon';\r\nimport { DatabaseContext } from '../Database/Database';\r\nimport { dbStorage } from '../Database/DBStorage';\r\nimport Formula from '../Formula';\r\nimport Stat from '../Stat';\r\nimport { StatKey } from '../Types/artifact';\r\nimport { ArtifactsBySlot, Build, BuildSetting } from '../Types/Build';\r\nimport { ICachedCharacter } from '../Types/character';\r\nimport { allSlotKeys, ArtifactSetKey, CharacterKey, SetNum, SlotKey } from '../Types/consts';\r\nimport { IFieldDisplay } from '../Types/IFieldDisplay';\r\nimport { ICalculatedStats } from '../Types/stats';\r\nimport { useForceUpdate, usePromise } from '../Util/ReactUtil';\r\nimport { timeStringMs } from '../Util/TimeUtil';\r\nimport { crawlObject, deepClone, objectFromKeyMap } from '../Util/Util';\r\nimport WeaponSheet from '../Weapon/WeaponSheet';\r\nimport { buildContext, calculateTotalBuildNumber, maxBuildsToShowList } from './Build';\r\nimport { initialBuildSettings } from './BuildSetting';\r\nconst InfoDisplay = React.lazy(() => import('./InfoDisplay'));\r\n\r\n//lazy load the character display\r\nconst CharacterDisplayCard = lazy(() => import('../Character/CharacterDisplayCard'))\r\n\r\nconst warningBuildNumber = 10000000\r\n\r\nconst artifactsSlotsToSelectMainStats = [\"sands\", \"goblet\", \"circlet\"] as const\r\n\r\nfunction buildSettingsReducer(state: BuildSetting, action): BuildSetting {\r\n  switch (action.type) {\r\n    case 'mainStatKey': {\r\n      const { slotKey, mainStatKey } = action\r\n      const mainStatKeys = { ...state.mainStatKeys }//create a new object to update react dependencies\r\n\r\n      if (state.mainStatKeys[slotKey].includes(mainStatKey))\r\n        mainStatKeys[slotKey] = mainStatKeys[slotKey].filter(k => k !== mainStatKey)\r\n      else\r\n        mainStatKeys[slotKey].push(mainStatKey)\r\n      return { ...state, mainStatKeys }\r\n    }\r\n    case 'mainStatKeyReset': {\r\n      const { slotKey } = action\r\n      const mainStatKeys = { ...state.mainStatKeys }//create a new object to update react dependencies\r\n      mainStatKeys[slotKey] = []\r\n      return { ...state, mainStatKeys }\r\n    }\r\n    case `setFilter`: {\r\n      const { index, key, num = 0 } = action\r\n      state.setFilters[index] = { key, num }\r\n      return { ...state, setFilters: [...state.setFilters] }//do this because this is a dependency, so needs to be a \"new\" array\r\n    }\r\n    default:\r\n      break;\r\n  }\r\n  return { ...state, ...action }\r\n}\r\n\r\nexport default function BuildDisplay({ location: { characterKey: propCharacterKey } }) {\r\n  const database = useContext(DatabaseContext)\r\n  const [characterKey, setcharacterKey] = useState(() => {\r\n    const { characterKey = \"\" } = dbStorage.get(\"BuildsDisplay.state\") ?? {}\r\n    //NOTE that propCharacterKey can override the selected character.\r\n    return (propCharacterKey ?? characterKey) as CharacterKey | \"\"\r\n  })\r\n\r\n  const [modalBuild, setmodalBuild] = useState(-1) // the index of the newBuild that is being displayed in the character modal,\r\n  const [showArtCondModal, setshowArtCondModal] = useState(false)\r\n  const [showCharacterModal, setshowCharacterModal] = useState(false)\r\n\r\n  const [generatingBuilds, setgeneratingBuilds] = useState(false)\r\n  const [generationProgress, setgenerationProgress] = useState(0)\r\n  const [generationDuration, setgenerationDuration] = useState(0)//in ms\r\n  const [generationSkipped, setgenerationSkipped] = useState(0)\r\n\r\n  const [charDirty, setCharDirty] = useForceUpdate()\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll(), [])\r\n\r\n  const [artsDirty, setArtsDirty] = useForceUpdate()\r\n\r\n  const isMounted = useRef(false)\r\n\r\n  const worker = useRef(null as Worker | null)\r\n\r\n  type characterDataType = { character?: ICachedCharacter, characterSheet?: CharacterSheet, weaponSheet?: WeaponSheet, initialStats?: ICalculatedStats, statsDisplayKeys?: { basicKeys: any, [key: string]: any } }\r\n  const [{ character, characterSheet, weaponSheet, initialStats, statsDisplayKeys }, setCharacterData] = useState({} as characterDataType)\r\n  const buildSettings = useMemo(() => character?.buildSettings ?? initialBuildSettings(), [character])\r\n  const { setFilters, statFilters, mainStatKeys, optimizationTarget, mainStatAssumptionLevel, useExcludedArts, useEquippedArts, builds, buildDate, maxBuildsToShow } = buildSettings\r\n\r\n  if (initialStats)\r\n    initialStats.mainStatAssumptionLevel = mainStatAssumptionLevel\r\n\r\n  const buildStats = useMemo(() => {\r\n    if (!initialStats || !artifactSheets) return []\r\n    return builds.map(build => {\r\n      const arts = Object.fromEntries(build.map(id => database._getArt(id)).map(art => [art?.slotKey, art]))\r\n      return Character.calculateBuildwithArtifact(initialStats, arts, artifactSheets)\r\n    }).filter(build => build)\r\n  }, [builds, database, initialStats, artifactSheets])\r\n\r\n  const buildSettingsDispatch = useCallback((action) => {\r\n    if (!character) return\r\n    character.buildSettings = buildSettingsReducer(buildSettings, action)\r\n    database.updateChar(character)\r\n  }, [character, buildSettings, database])\r\n\r\n  useEffect(() => ReactGA.pageview('/build'), [])\r\n\r\n  //select a new character Key\r\n  const selectCharacter = useCallback((cKey = \"\") => {\r\n    if (characterKey === cKey) return\r\n    setcharacterKey(cKey)\r\n    setCharDirty()\r\n    setCharacterData({})\r\n  }, [setCharDirty, setcharacterKey, characterKey])\r\n\r\n  //load the character data as a whole\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (!characterKey || !artifactSheets) return\r\n      const character = database._getChar(characterKey)\r\n      if (!character) return selectCharacter(\"\")// character is prob deleted.\r\n      const characterSheet = await CharacterSheet.get(characterKey)\r\n      const weapon = database._getWeapon(character.equippedWeapon)\r\n      if (!weapon) return\r\n      const weaponSheet = await WeaponSheet.get(weapon.key)\r\n      if (!characterSheet || !weaponSheet) return\r\n      const initialStats = Character.createInitialStats(character, database, characterSheet, weaponSheet)\r\n      //NOTE: since initialStats are used, there are no inclusion of artifact formulas here.\r\n      const statsDisplayKeys = Character.getDisplayStatKeys(initialStats, { characterSheet, weaponSheet, artifactSheets })\r\n      setCharacterData({ character, characterSheet, weaponSheet, initialStats, statsDisplayKeys })\r\n    })()\r\n  }, [charDirty, characterKey, artifactSheets, database, selectCharacter])\r\n\r\n  //register changes in artifact database\r\n  useEffect(() =>\r\n    database.followAnyArt(setArtsDirty),\r\n    [setArtsDirty, database])\r\n\r\n  //register changes in character in db\r\n  useEffect(() =>\r\n    characterKey ? database.followChar(characterKey, setCharDirty) : undefined,\r\n    [characterKey, setCharDirty, database])\r\n\r\n  //terminate worker when component unmounts\r\n  useEffect(() => () => worker.current?.terminate(), [])\r\n\r\n  //save to BuildsDisplay.state on change\r\n  useEffect(() => {\r\n    if (isMounted.current) dbStorage.set(\"BuildsDisplay.state\", { characterKey })\r\n    else isMounted.current = true\r\n  }, [characterKey])\r\n\r\n  //validate optimizationTarget \r\n  useEffect(() => {\r\n    if (!statsDisplayKeys) return\r\n    if (!Array.isArray(optimizationTarget)) return\r\n    for (const sectionKey in statsDisplayKeys) {\r\n      const section = statsDisplayKeys[sectionKey]\r\n      for (const keys of section)\r\n        if (JSON.stringify(keys) === JSON.stringify(optimizationTarget)) return\r\n    }\r\n    buildSettingsDispatch({ optimizationTarget: initialBuildSettings().optimizationTarget })\r\n  }, [optimizationTarget, statsDisplayKeys, buildSettingsDispatch])\r\n\r\n  const { split, totBuildNumber } = useMemo(() => {\r\n    if (!characterKey) // Make sure we have all slotKeys\r\n      return { split: objectFromKeyMap(allSlotKeys, () => []) as ArtifactsBySlot, totBuildNumber: 0 }\r\n    const artifactDatabase = database._getArts().filter(art => {\r\n      //if its equipped on the selected character, bypass the check\r\n      if (art.location === characterKey) return true\r\n\r\n      if (art.exclude && !useExcludedArts) return false\r\n      if (art.location && !useEquippedArts) return false\r\n      return true\r\n    })\r\n    const split = Artifact.splitArtifactsBySlot(artifactDatabase);\r\n    //filter the split slots on the mainstats selected.\r\n    artifactsSlotsToSelectMainStats.forEach(slotKey =>\r\n      mainStatKeys[slotKey].length && (split[slotKey] = split[slotKey]?.filter((art) => mainStatKeys[slotKey].includes(art.mainStatKey))))\r\n    const totBuildNumber = calculateTotalBuildNumber(split, setFilters)\r\n    return artsDirty && { split, totBuildNumber }\r\n  }, [characterKey, useExcludedArts, useEquippedArts, mainStatKeys, setFilters, artsDirty, database])\r\n\r\n  const generateBuilds = useCallback(() => {\r\n    if (!initialStats || !artifactSheets) return\r\n    setgeneratingBuilds(true)\r\n    setgenerationDuration(0)\r\n    setgenerationProgress(0)\r\n    setgenerationSkipped(0)\r\n    //get the formula for this target\r\n\r\n    const artifactSetEffects = Artifact.setEffectsObjs(artifactSheets, initialStats)\r\n    const splitArtifacts = deepClone(split) as ArtifactsBySlot\r\n    //add mainStatVal to each artifact\r\n    Object.values(splitArtifacts).forEach(artArr => {\r\n      artArr!.forEach(art => {\r\n        art.mainStatVal = Artifact.mainStatValue(art.mainStatKey, art.rarity, Math.max(Math.min(mainStatAssumptionLevel, art.rarity * 4), art.level)) ?? 0;\r\n      })\r\n    })\r\n    //create an obj with app the artifact set effects to pass to buildworker.\r\n    const data = {\r\n      splitArtifacts, initialStats, artifactSetEffects,\r\n      setFilters, minFilters: statFilters, maxBuildsToShow, optimizationTarget\r\n    };\r\n    worker.current?.terminate()\r\n    worker.current = new Worker()\r\n    worker.current.onmessage = (e) => {\r\n      if (typeof e.data.progress === \"number\") {\r\n        const { progress, timing = 0, skipped = 0 } = e.data\r\n        setgenerationProgress(progress)\r\n        setgenerationDuration(timing)\r\n        setgenerationSkipped(skipped)\r\n        return\r\n      }\r\n      ReactGA.timing({\r\n        category: \"Build Generation\",\r\n        variable: \"timing\",\r\n        value: e.data.timing,\r\n        label: totBuildNumber.toString()\r\n      })\r\n      const builds = (e.data.builds as Build[]).map(b => Object.values(b.artifacts).map(a => a.id))\r\n      buildSettingsDispatch({ builds, buildDate: Date.now() })\r\n\r\n      setgeneratingBuilds(false)\r\n      worker.current?.terminate()\r\n      worker.current = null\r\n    };\r\n    worker.current.postMessage(data)\r\n  }, [artifactSheets, split, totBuildNumber, mainStatAssumptionLevel, initialStats, maxBuildsToShow, optimizationTarget, setFilters, statFilters, buildSettingsDispatch])\r\n\r\n\r\n  const dropdownitemsForStar = useCallback((star, index) => artifactSheets && ArtifactSheet.setsWithMaxRarity(artifactSheets, star).map(([setKey, setobj]) => {\r\n    if (setFilters.some(filter => filter.key === setKey)) return false;\r\n    const setsNumArr = Object.keys(artifactSheets?.[setKey]?.setEffects ?? {})\r\n    const artsAccountedOther = setFilters.reduce((accu, cur, ind) => (cur.key && ind !== index) ? accu + cur.num : accu, 0)\r\n    if (setsNumArr.every((num: any) => parseInt(num) + artsAccountedOther > 5)) return false;\r\n    return (<Dropdown.Item key={setKey} onClick={() => buildSettingsDispatch({ type: 'setFilter', index, key: setKey, num: parseInt(setsNumArr[0] as any) ?? 0 })} >\r\n      {setobj.nameWithIcon}\r\n    </Dropdown.Item>)\r\n  }), [setFilters, buildSettingsDispatch, artifactSheets])\r\n\r\n  const characterName = characterSheet?.name ?? \"Character Name\"\r\n  const characterDropDown = useMemo(() => <DropdownButton title={characterName} disabled={generatingBuilds}>\r\n    <Dropdown.Item onClick={() => selectCharacter(\"\")}>Unselect Character</Dropdown.Item>\r\n    <Dropdown.Divider />\r\n    <CharacterSelectionDropdownList onSelect={cKey => selectCharacter(cKey)} />\r\n  </DropdownButton>, [characterName, generatingBuilds, selectCharacter])\r\n\r\n  const formula = usePromise(Array.isArray(optimizationTarget) ? Formula.get(optimizationTarget) : undefined, [optimizationTarget])\r\n  const sortByText = useMemo(() => {\r\n    if (Array.isArray(optimizationTarget)) {\r\n      if (!formula) return null\r\n      let [type, , talentKey] = (formula as any).keys as string[]\r\n      const field = (formula as any).field as IFieldDisplay\r\n      const variant = Character.getTalentFieldValue(field, \"variant\", initialStats)\r\n      const text = Character.getTalentFieldValue(field, \"text\", initialStats)\r\n      if (type === \"character\") {\r\n        if (talentKey === \"normal\" || talentKey === \"charged\" || talentKey === \"plunging\") talentKey = \"auto\"\r\n        return <b>{characterSheet?.getTalentOfKey(talentKey, initialStats?.characterEle)?.name}: <span className={`text-${variant}`}>{text}</span></b>\r\n      } else if (type === \"weapon\") {\r\n        return <b>{weaponSheet?.name}: <span className={`text-${variant}`}>{text}</span></b>\r\n      }\r\n    } else return <b>Basic Stat: <span className={`text-${Stat.getStatVariant(optimizationTarget)}`}>{Stat.getStatNameWithPercent(optimizationTarget)}</span></b>\r\n    // return <Badge variant=\"danger\">INVALID</Badge>\r\n  }, [optimizationTarget, formula, initialStats, characterSheet, weaponSheet])\r\n\r\n\r\n  const artsAccounted = setFilters.reduce((accu, cur) => cur.key ? accu + cur.num : accu, 0)\r\n  const artifactCondCount = useMemo(() => {\r\n    let count = 0;\r\n    crawlObject(initialStats?.conditionalValues?.artifact, [], v => Array.isArray(v), () => count++)\r\n    return count\r\n  }, [initialStats?.conditionalValues])\r\n  //rudimentary dispatcher, definitely not the same API as the real characterDispatch.\r\n  const characterDispatch = useCallback(val => database.updateChar({ ...character, ...val }), [character, database])\r\n  return <Container className=\"mt-2\"> <buildContext.Provider value={{ equippedBuild: initialStats }}>\r\n\r\n    <InfoComponent\r\n      pageKey=\"buildPage\"\r\n      modalTitle=\"Character Management Page Guide\"\r\n      text={[\"For self-infused attacks, like Noelle's Sweeping Time, enable the skill in the talent page.\",\r\n        \"You can compare the difference between equipped artifacts and generated builds.\",\r\n        \"The more complex the formula, the longer the generation time.\",]}\r\n    ><InfoDisplay /></InfoComponent>\r\n    <BuildModal {...{\r\n      build: buildStats[modalBuild], showCharacterModal, characterKey, selectCharacter, close: () => {\r\n        setmodalBuild(-1)\r\n        setshowCharacterModal(false)\r\n      }\r\n    }} />\r\n    {!!initialStats && <ArtConditionalModal {...{ showArtCondModal, setshowArtCondModal, initialStats, characterDispatch, artifactCondCount }} />}\r\n    <Row className=\"mt-2 mb-2\">\r\n      <Col>\r\n        {/* Build Generator Editor */}\r\n        <Card bg=\"darkcontent\" text={\"lightfont\" as any}>\r\n          <Card.Header>Build Generator</Card.Header>\r\n          <Card.Body>\r\n            <Row >\r\n              <Col xs={12} lg={6}>\r\n                {/* character selection */}\r\n                {characterKey ?\r\n                  <CharacterCard header={characterDropDown} characterKey={characterKey} bg={\"lightcontent\"} cardClassName=\"mb-2\" onEdit={!generatingBuilds ? () => setshowCharacterModal(true) : undefined} /> :\r\n                  <Card bg=\"lightcontent\" text={\"lightfont\" as any} className=\"mb-2\">\r\n                    <Card.Header>\r\n                      {characterDropDown}\r\n                    </Card.Header>\r\n                  </Card>}\r\n                {/* Hit mode options */}\r\n                {characterSheet && character && initialStats && <HitModeCard build={initialStats} characterSheet={characterSheet} className=\"mb-2\" character={character} disabled={generatingBuilds} />}\r\n                {/*Minimum Final Stat Filter */}\r\n                {!!statsDisplayKeys && <StatFilterCard className=\"mb-2\" statFilters={statFilters} statKeys={statsDisplayKeys?.basicKeys as any} setStatFilters={sFs => buildSettingsDispatch({ statFilters: sFs })} disabled={generatingBuilds} />}\r\n              </Col>\r\n              <Col xs={12} lg={6}><Row>\r\n                <Col className=\"mb-2\" xs={12}>\r\n                  <Card bg=\"lightcontent\" text={\"lightfont\" as any}><Card.Body>\r\n                    <Button className=\"w-100\" onClick={() => setshowArtCondModal(true)} disabled={generatingBuilds}>\r\n                      <span>Default Artifact Set Effects {Boolean(artifactCondCount) && <Badge variant=\"success\">{artifactCondCount} Selected</Badge>}</span>\r\n                    </Button>\r\n                  </Card.Body></Card>\r\n                </Col>\r\n                {/* Artifact set picker */}\r\n                {setFilters.map(({ key: setKey, num: setNum }, index) => <Col className=\"mb-2\" key={index} xs={12}>\r\n                  <Card className=\"h-100\" bg=\"lightcontent\" text={\"lightfont\" as any}>\r\n                    <Card.Header>\r\n                      <ButtonGroup>\r\n                        {/* Artifact set */}\r\n                        <DropdownButton as={ButtonGroup} title={artifactSheets?.[setKey]?.nameWithIcon ?? \"Artifact Set Filter\"} disabled={generatingBuilds}>\r\n                          <Dropdown.Item onClick={() => buildSettingsDispatch({ type: 'setFilter', index, key: \"\" })}>Unselect Artifact</Dropdown.Item>\r\n                          <Dropdown.ItemText>Max Rarity 🟊🟊🟊🟊🟊</Dropdown.ItemText>\r\n                          {dropdownitemsForStar(5, index)}\r\n                          <Dropdown.Divider />\r\n                          <Dropdown.ItemText>Max Rarity 🟊🟊🟊🟊</Dropdown.ItemText>\r\n                          {dropdownitemsForStar(4, index)}\r\n                          <Dropdown.Divider />\r\n                          <Dropdown.ItemText>Max Rarity 🟊🟊🟊</Dropdown.ItemText>\r\n                          {dropdownitemsForStar(3, index)}\r\n                        </DropdownButton>\r\n                        {/* set number */}\r\n                        <DropdownButton as={ButtonGroup} title={`${setNum}-set`}\r\n                          disabled={generatingBuilds || !setKey || artsAccounted >= 5}\r\n                        >\r\n                          {!!initialStats && Object.keys(artifactSheets?.[setKey]?.setEffects ?? {}).map((num: any) => {\r\n                            let artsAccountedOther = setFilters.reduce((accu, cur) => (cur.key && cur.key !== setKey) ? accu + cur.num : accu, 0)\r\n                            return (parseInt(num) + artsAccountedOther <= 5) &&\r\n                              (<Dropdown.Item key={num} onClick={() => buildSettingsDispatch({ type: 'setFilter', index, key: setFilters[index].key, num: parseInt(num) })} >\r\n                                {`${num}-set`}\r\n                              </Dropdown.Item>)\r\n                          })}\r\n                        </DropdownButton>\r\n                      </ButtonGroup>\r\n                    </Card.Header>\r\n                    {setKey ? <Card.Body><Row className=\"mb-n2\">\r\n                      {!!initialStats && Object.keys(artifactSheets?.[setKey].setEffects ?? {}).map(setNKey => parseInt(setNKey) as SetNum).filter(setNkey => setNkey <= setNum).map(setNumKey =>\r\n                        <SetEffectDisplay newBuild={undefined} key={setKey + setNumKey} {...{ setKey, setNumKey, equippedBuild: initialStats, characterDispatch, editable: true }} />)}\r\n                    </Row></Card.Body> : null}\r\n                  </Card>\r\n                </Col>)}\r\n                <Col className=\"mb-2\" xs={12}>\r\n                  <Card bg=\"lightcontent\" text={\"lightfont\" as any}><Card.Body className=\"mb-n2\">\r\n                    <Button className=\"w-100 mb-2\" onClick={() => buildSettingsDispatch({ useEquippedArts: !useEquippedArts })} disabled={generatingBuilds}>\r\n                      <span><FontAwesomeIcon icon={useEquippedArts ? faCheckSquare : faSquare} /> Use Equipped Artifacts</span>\r\n                    </Button>\r\n                    <Button className=\"w-100 mb-2\" onClick={() => buildSettingsDispatch({ useExcludedArts: !useExcludedArts })} disabled={generatingBuilds}>\r\n                      <span><FontAwesomeIcon icon={useExcludedArts ? faCheckSquare : faSquare} /> Use Excluded Artifacts</span>\r\n                    </Button>\r\n                  </Card.Body></Card>\r\n                </Col>\r\n                {/* main stat selector */}\r\n                <Col className=\"mb-2\" xs={12}>\r\n                  <Card bg=\"lightcontent\" text={\"lightfont\" as any}>\r\n                    <Card.Header>\r\n                      <Row>\r\n                        <Col>Artifact Main Stat</Col>\r\n                        <Col xs=\"auto\"><AssumeFullLevelToggle mainStatAssumptionLevel={mainStatAssumptionLevel} setmainStatAssumptionLevel={v => buildSettingsDispatch({ mainStatAssumptionLevel: v })} disabled={generatingBuilds} /></Col>\r\n                      </Row>\r\n                    </Card.Header>\r\n                    <Card.Body className=\"mb-n2\">\r\n                      {artifactsSlotsToSelectMainStats.map(slotKey => {\r\n                        const numSel = mainStatKeys[slotKey].length\r\n                        return <Card bg=\"darkcontent\" text={\"lightfont\" as any} className=\"mb-2\" key={slotKey}>\r\n                          <Card.Header className=\"p-2\"><Row >\r\n                            <Col className=\"ml-2\"><SlotNameWithIcon slotKey={slotKey} /></Col>\r\n                            <Col xs=\"auto\">\r\n                              <Badge variant=\"info\">{numSel ? `${numSel} Selected` : `Any`}</Badge>\r\n                              <Button variant=\"danger\" size=\"sm\" className=\"py-0 px-1 ml-2\" disabled={!mainStatKeys[slotKey].length}\r\n                                onClick={() => buildSettingsDispatch({ type: \"mainStatKeyReset\", slotKey })}>\r\n                                <FontAwesomeIcon icon={faUndo} />\r\n                              </Button>\r\n                            </Col>\r\n                          </Row></Card.Header>\r\n                          <Card.Body className=\"p-0\"><Row className=\"no-gutters\">\r\n                            {Artifact.slotMainStats(slotKey).map((mainStatKey, i) => {\r\n                              const selected = mainStatKeys[slotKey].includes(mainStatKey)\r\n                              return <Col xs={i < 3 ? 4 : 6} key={mainStatKey}>\r\n                                <Button className=\"w-100 rounded-0\" size=\"sm\" variant={selected ? \"success\" : \"secondary\"} disabled={generatingBuilds}\r\n                                  onClick={() => buildSettingsDispatch({ type: \"mainStatKey\", slotKey, mainStatKey })}>\r\n                                  {StatIcon[mainStatKey]} {Stat.getStatNameWithPercent(mainStatKey, \"\", false)}\r\n                                </Button>\r\n                              </Col>\r\n                            })}\r\n                          </Row></Card.Body>\r\n                        </Card>\r\n                      })}\r\n                    </Card.Body>\r\n                  </Card>\r\n                </Col>\r\n              </Row></Col>\r\n            </Row>\r\n            <Row className=\"d-flex justify-content-between mb-2\">\r\n              <Col xs=\"auto\" >\r\n                <ButtonGroup>\r\n                  <Button\r\n                    className=\"h-100\"\r\n                    disabled={!characterKey || generatingBuilds}\r\n                    variant={(characterKey && totBuildNumber <= warningBuildNumber) ? \"success\" : \"warning\"}\r\n                    onClick={generateBuilds}\r\n                  ><span>Generate</span></Button>\r\n                  <Dropdown as={ButtonGroup}>\r\n                    <OverlayTrigger\r\n                      overlay={<Tooltip id=\"max-build-tooltip\">\r\n                        Decreasing the number of generated build will decrease build calculation time for large number of builds.\r\n                      </Tooltip>}\r\n                    >\r\n                      <Dropdown.Toggle disabled={generatingBuilds}><b>{maxBuildsToShow}</b> {maxBuildsToShow === 1 ? \"Build\" : \"Builds\"}</Dropdown.Toggle>\r\n                    </OverlayTrigger>\r\n                    <Dropdown.Menu>\r\n                      {maxBuildsToShowList.map(v => <Dropdown.Item key={v} onClick={() => buildSettingsDispatch({ maxBuildsToShow: v })}>{v} {v === 1 ? \"Build\" : \"Builds\"}</Dropdown.Item>)}\r\n                    </Dropdown.Menu>\r\n                  </Dropdown>\r\n                  <Button\r\n                    className=\"h-100\"\r\n                    disabled={!generatingBuilds}\r\n                    variant=\"danger\"\r\n                    onClick={() => {\r\n                      if (!worker.current) return;\r\n                      worker.current.terminate();\r\n                      worker.current = null\r\n                      setgeneratingBuilds(false)\r\n                      setgenerationDuration(0)\r\n                      setgenerationProgress(0)\r\n                      setgenerationSkipped(0)\r\n                    }}\r\n                  ><span>Cancel</span></Button>\r\n                </ButtonGroup>\r\n              </Col>\r\n              <Col xs=\"auto\">\r\n                {/* Dropdown to select sorting value */}\r\n                {<Dropdown as={ButtonGroup} drop=\"up\">\r\n                  <Dropdown.Toggle disabled={generatingBuilds} variant=\"light\" >\r\n                    <span>Optimization Target: {sortByText}</span>\r\n                  </Dropdown.Toggle>\r\n                  <Dropdown.Menu align=\"right\" style={{ minWidth: \"40rem\" }} >\r\n                    <Row>\r\n                      {!!statsDisplayKeys && Object.entries(statsDisplayKeys).map(([sectionKey, fields]: [string, any]) => {\r\n                        const header = (characterSheet && weaponSheet && artifactSheets) ? getFormulaTargetsDisplayHeading(sectionKey, { characterSheet, weaponSheet, artifactSheets }, initialStats?.characterEle) : sectionKey\r\n                        return <Col xs={12} md={6} key={sectionKey}>\r\n                          <Dropdown.Header style={{ overflow: \"hidden\", textOverflow: \"ellipsis\" }}><b>{header}</b></Dropdown.Header>\r\n                          {fields.map((target, i) => {\r\n                            if (Array.isArray(target))\r\n                              return <TargetSelectorDropdownItem key={i} {...{ target, buildSettingsDispatch, initialStats }} />\r\n                            else if (typeof target === \"string\")\r\n                              return <Dropdown.Item key={i} onClick={() => buildSettingsDispatch({ optimizationTarget: target })}>{Stat.getStatNameWithPercent(target)}</Dropdown.Item>\r\n                            return null\r\n                          })}\r\n                        </Col>\r\n                      })}\r\n                    </Row>\r\n                  </Dropdown.Menu>\r\n                </Dropdown>}\r\n              </Col>\r\n            </Row>\r\n            <Row className=\"\">\r\n              <Col>{!!characterKey && <BuildAlert {...{ totBuildNumber, generatingBuilds, generationSkipped, generationProgress, generationDuration, characterName, maxBuildsToShow }} />}</Col>\r\n            </Row>\r\n          </Card.Body>\r\n        </Card>\r\n      </Col>\r\n    </Row>\r\n    <Row className=\"mb-2\">\r\n      <Col>\r\n        <Card bg=\"darkcontent\" text={\"lightfont\" as any}>\r\n          <Card.Header>\r\n            <Row>\r\n              <Col>{buildStats ? <span>Showing <strong>{buildStats.length}</strong> Builds generated for {characterName}. {!!buildDate && <span>Build generated on: <strong>{(new Date(buildDate)).toLocaleString()}</strong></span>}</span>\r\n                : <span>Select a character to generate builds.</span>}</Col>\r\n            </Row>\r\n          </Card.Header>\r\n          {/* Build List */}\r\n          <ListGroup>\r\n            {buildStats?.map((build, index) =>\r\n              characterSheet && weaponSheet && artifactSheets && <ArtifactDisplayItem sheets={{ characterSheet, weaponSheet, artifactSheets }} build={build} characterKey={characterKey as CharacterKey} index={index} key={index} statsDisplayKeys={statsDisplayKeys} onClick={() => setmodalBuild(index)} />\r\n            )}\r\n          </ListGroup>\r\n        </Card>\r\n      </Col>\r\n    </Row>\r\n  </buildContext.Provider></Container >\r\n}\r\n\r\nfunction TargetSelectorDropdownItem({ target, buildSettingsDispatch, initialStats }) {\r\n  const formula = usePromise(Formula.get(target), [target])\r\n  if (!formula) return null\r\n  const talentField = (formula as any).field as IFieldDisplay\r\n  return <Dropdown.Item onClick={() => buildSettingsDispatch({ optimizationTarget: target })} style={{ overflow: \"hidden\", textOverflow: \"ellipsis\" }}>\r\n    <span className={`text-${Character.getTalentFieldValue(talentField, \"variant\", initialStats)}`}>{Character.getTalentFieldValue(talentField, \"text\", initialStats)}</span>\r\n  </Dropdown.Item>\r\n}\r\n\r\nfunction BuildModal({ build, showCharacterModal, characterKey, selectCharacter, close }) {\r\n  return <Modal show={Boolean(showCharacterModal || build)} onHide={close} size=\"xl\" contentClassName=\"bg-transparent\">\r\n    <React.Suspense fallback={<span>Loading...</span>}>\r\n      <CharacterDisplayCard\r\n        tabName={undefined}\r\n        characterKey={characterKey}\r\n        setCharacterKey={cKey => selectCharacter(cKey)}\r\n        newBuild={build}\r\n        onClose={close}\r\n        footer={<Button variant=\"danger\" onClick={close}>Close</Button>} />\r\n    </React.Suspense>\r\n  </Modal>\r\n}\r\n\r\nfunction ArtConditionalModal({ showArtCondModal, setshowArtCondModal, initialStats, characterDispatch, artifactCondCount }) {\r\n  const closeArtCondModal = useCallback(() => setshowArtCondModal(false), [setshowArtCondModal])\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll(), [])\r\n  if (!artifactSheets) return null\r\n  const artSetKeyList = Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets)).reverse().flatMap(([, sets]) => sets)\r\n  return <Modal show={showArtCondModal} onHide={closeArtCondModal} size=\"xl\" contentClassName=\"bg-transparent\">\r\n    <Card bg=\"darkcontent\" text={\"lightfont\" as any}>\r\n      <Card.Header>\r\n        <Row>\r\n          <Col>\r\n            <h5>Default Artifact Set Effects  {Boolean(artifactCondCount) && <Badge variant=\"success\">{artifactCondCount} Selected</Badge>}</h5>\r\n          </Col>\r\n          <Col xs=\"auto\" >\r\n            <Button onClick={() => {\r\n              if (initialStats.conditionalValues.artifact) initialStats.conditionalValues.artifact = {}\r\n              characterDispatch({ conditionalValues: initialStats.conditionalValues })\r\n            }}><span><FontAwesomeIcon icon={faUndo} /> Reset All</span></Button>\r\n          </Col>\r\n          <Col xs=\"auto\" >\r\n            <Button variant=\"danger\" onClick={closeArtCondModal}>\r\n              <FontAwesomeIcon icon={faTimes} /></Button>\r\n          </Col>\r\n        </Row>\r\n      </Card.Header>\r\n      <Card.Body>\r\n        <Row>\r\n          {artSetKeyList.map(setKey => {\r\n            const sheet = artifactSheets[setKey]\r\n            let icon = Object.values(sheet.slotIcons)[0]\r\n            const rarities = sheet.rarity\r\n            const rarity = rarities[0]\r\n            return <Col className=\"mb-2\" key={setKey} xs={12} lg={6} xl={4}>\r\n              <Card className=\"h-100\" bg=\"lightcontent\" text={\"lightfont\" as any}>\r\n                <Card.Header >\r\n                  <Row>\r\n                    <Col xs=\"auto\" className=\"ml-n3 my-n2\">\r\n                      <Image src={icon} className={`thumb-mid grad-${rarity}star m-1`} thumbnail />\r\n                    </Col>\r\n                    <Col >\r\n                      <h6><b>{artifactSheets?.[setKey].name ?? \"\"}</b></h6>\r\n                      <span>{rarities.map((ns, i) => <span key={ns}>{ns}<Stars stars={1} /> {i < (rarities.length - 1) ? \"/ \" : null}</span>)}</span>\r\n                    </Col>\r\n                  </Row>\r\n                </Card.Header>\r\n                <Card.Body><Row className=\"mb-n2\">\r\n                  {Boolean(setKey) && Object.keys(sheet.setEffects).map(key => parseInt(key) as SetNum).map(setNumKey =>\r\n                    <SetEffectDisplay newBuild={undefined} key={setKey + setNumKey} {...{ setKey, setNumKey, equippedBuild: initialStats, editable: true, characterDispatch, }} />)}\r\n                </Row></Card.Body>\r\n              </Card>\r\n            </Col>\r\n          })}\r\n        </Row>\r\n      </Card.Body>\r\n      <Card.Footer>\r\n        <Button variant=\"danger\" onClick={closeArtCondModal}>\r\n          <FontAwesomeIcon icon={faTimes} /> CLOSE</Button>\r\n      </Card.Footer>\r\n    </Card>\r\n  </Modal>\r\n}\r\n\r\nfunction StatFilterItem({ statKey, statKeys = [], min, close, setFilter, disabled }: {\r\n  statKey?, statKeys, min, close, setFilter, disabled\r\n}) {\r\n  const isFloat = Stat.getStatUnit(statKey) === \"%\"\r\n  const inputProps = {\r\n    disabled: !statKey,\r\n    allowEmpty: true,\r\n    float: isFloat,\r\n  }\r\n  const minInputProps = {\r\n    ...inputProps,\r\n    placeholder: \"MIN\",\r\n    value: min,\r\n    onChange: (s) => setFilter(statKey, s)\r\n  }\r\n  return <InputGroup className=\"mb-2\">\r\n    <DropdownButton\r\n      as={InputGroup.Prepend}\r\n      title={Stat.getStatNameWithPercent(statKey, \"New Stat\")}\r\n      id=\"input-group-dropdown-1\"\r\n      disabled={disabled}\r\n    >\r\n      {statKeys.map(sKey => <Dropdown.Item key={sKey} onClick={() => { close?.(); setFilter(sKey, min) }}>{Stat.getStatNameWithPercent(sKey)}</Dropdown.Item>)}\r\n    </DropdownButton>\r\n    <CustomFormControl {...minInputProps} />\r\n    {Boolean(close) && <InputGroup.Append>\r\n      <Button variant=\"danger\" onClick={close} disabled={disabled}><FontAwesomeIcon icon={faTrash} /></Button>\r\n    </InputGroup.Append>}\r\n  </InputGroup>\r\n}\r\n\r\nfunction HitModeCard({ characterSheet, character, build, className, disabled }: { characterSheet: CharacterSheet, character: ICachedCharacter, build: ICalculatedStats, className: string, disabled: boolean }) {\r\n  const database = useContext(DatabaseContext)\r\n  const setHitmode = useCallback(({ hitMode }) => database.updateChar({ ...character, hitMode }), [character, database])\r\n  const setReactionMode = useCallback(({ reactionMode }) => database.updateChar({ ...character, reactionMode }), [character, database])\r\n  const setInfusionAura = useCallback(({ infusionAura }) => database.updateChar({ ...character, infusionAura }), [character, database])\r\n  if (!character) return null\r\n  return <Card bg=\"lightcontent\" text={\"lightfont\" as any} className={className}>\r\n    <Card.Header>\r\n      <Row>\r\n        <Col>Hit Mode Options</Col>\r\n        <Col xs=\"auto\"><InfusionAuraDropdown characterSheet={characterSheet} character={character} characterDispatch={setInfusionAura} disabled={disabled} /></Col>\r\n      </Row>\r\n    </Card.Header>\r\n    <Card.Body className=\"mb-n2\">\r\n      <HitModeToggle hitMode={character.hitMode} characterDispatch={setHitmode} className=\"w-100 mb-2\" disabled={disabled} />\r\n      <ReactionToggle build={build} character={character} characterDispatch={setReactionMode} className=\"w-100 mb-2\" disabled={disabled} />\r\n    </Card.Body>\r\n  </Card >\r\n}\r\n\r\nfunction StatFilterCard({ statKeys = [], statFilters = {}, setStatFilters, className, disabled }: { statKeys: StatKey[], statFilters: Dict<StatKey, number>, setStatFilters: (object) => void, className: string, disabled?: boolean }) {\r\n  const remainingKeys = statKeys.filter(key => !(Object.keys(statFilters) as any).some(k => k === key))\r\n  const setFilter = (sKey, min) => setStatFilters({ ...statFilters, [sKey]: min })\r\n  return <Card bg=\"lightcontent\" text={\"lightfont\" as any} className={className}>\r\n    <Card.Header>Minimum Final Stat Filter</Card.Header>\r\n    <Card.Body>\r\n      <Row className=\"mb-n2\">\r\n        {Object.entries(statFilters).map(([statKey, min]) => {\r\n          return <Col xs={12} key={statKey} ><StatFilterItem statKey={statKey} statKeys={remainingKeys} setFilter={setFilter} disabled={disabled} min={min} close={() => {\r\n            delete statFilters[statKey]\r\n            setStatFilters({ ...statFilters })\r\n          }} /></Col>\r\n        })}\r\n        <Col xs={12}>\r\n          <StatFilterItem min={undefined} close={undefined} statKeys={remainingKeys} setFilter={setFilter} disabled={disabled} />\r\n        </Col>\r\n      </Row>\r\n    </Card.Body>\r\n  </Card>\r\n}\r\n\r\ntype ArtifactDisplayItemProps = {\r\n  sheets: {\r\n    characterSheet: CharacterSheet\r\n    weaponSheet: WeaponSheet,\r\n    artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet>\r\n  },\r\n  index: number,\r\n  characterKey: CharacterKey,\r\n  build: ICalculatedStats,\r\n  statsDisplayKeys: any,\r\n  onClick: () => void\r\n}\r\n//for displaying each artifact build\r\nfunction ArtifactDisplayItem({ sheets, sheets: { artifactSheets }, index, characterKey, build, statsDisplayKeys, onClick }: ArtifactDisplayItemProps) {\r\n  const database = useContext(DatabaseContext)\r\n  const character = database._getChar(characterKey)\r\n  if (!character) return null\r\n  const { equippedArtifacts } = character\r\n  const currentlyEquipped = allSlotKeys.every(slotKey => equippedArtifacts[slotKey] === build.equippedArtifacts?.[slotKey])\r\n  return (<div>\r\n    <ListGroup.Item\r\n      variant={index % 2 ? \"customdark\" : \"customdarker\"} className=\"text-white\" action\r\n      onClick={onClick}\r\n    >\r\n      <h5 className=\"mb-2\"><Row>\r\n        <Col xs=\"auto\">\r\n          <Badge variant=\"info\"><strong>{index + 1}{currentlyEquipped ? \" (Equipped)\" : \"\"}</strong></Badge>\r\n        </Col>\r\n        <Col xs=\"auto\">{(Object.entries(build.setToSlots) as [ArtifactSetKey, SlotKey[]][]).sort(([key1, slotarr1], [key2, slotarr2]) => slotarr2.length - slotarr1.length).map(([key, slotarr]) =>\r\n          <Badge key={key} variant={currentlyEquipped ? \"success\" : \"primary\"} className=\"mr-2\">\r\n            {slotarr.map(slotKey => artifactSlotIcon(slotKey))} {artifactSheets?.[key].name ?? \"\"}\r\n          </Badge>\r\n        )}</Col>\r\n      </Row></h5>\r\n      <StatDisplayComponent {...{ sheets, character, equippedBuild: build, statsDisplayKeys, cardbg: (index % 2 ? \"lightcontent\" : \"darkcontent\") }} />\r\n    </ListGroup.Item>\r\n  </div>)\r\n}\r\n\r\nfunction BuildAlert({ totBuildNumber, generatingBuilds, generationSkipped, generationProgress, generationDuration, characterName, maxBuildsToShow }) {\r\n  const totalBuildNumberString = totBuildNumber?.toLocaleString() ?? totBuildNumber\r\n  const totalUnskipped = totBuildNumber - generationSkipped\r\n  const generationProgressString = generationProgress?.toLocaleString() ?? generationProgress\r\n  const generationSkippedString = generationSkipped?.toLocaleString() ?? generationSkipped\r\n  const totalUnskippedString = totalUnskipped?.toLocaleString() ?? totalUnskipped\r\n  const generationSkippedText = Boolean(generationSkipped) && <span>(<b>{generationSkippedString}</b> skipped)</span>\r\n  if (generatingBuilds) {\r\n    let progPercent = generationProgress * 100 / (totalUnskipped)\r\n    return <Alert variant=\"success\">\r\n      <span>Generating and testing <b className=\"text-monospace\">{generationProgressString}/{totalUnskippedString}</b> build configurations against the criteria for <b>{characterName}</b>. {generationSkippedText}</span><br />\r\n      <h6>Time elapsed: <strong className=\"text-monospace\">{timeStringMs(generationDuration)}</strong></h6>\r\n      <ProgressBar now={progPercent} label={`${progPercent.toFixed(1)}%`} />\r\n    </Alert>\r\n  } else if (!generatingBuilds && generationProgress) {//done\r\n    return <Alert variant=\"success\">\r\n      <span>Generated and tested <b className=\"text-monospace\">{totalUnskippedString}</b> Build configurations against the criteria for <b>{characterName}</b>. {generationSkippedText}</span>\r\n      <h6>Total duration: <strong className=\"text-monospace\">{timeStringMs(generationDuration)}</strong></h6>\r\n      <ProgressBar now={100} variant=\"success\" label=\"100%\" />\r\n    </Alert>\r\n  } else {\r\n    return totBuildNumber === 0 ?\r\n      <Alert variant=\"warning\" className=\"mb-0\"><span>Current configuration will not generate any builds for <b>{characterName}</b>. Please change your Artifact configurations, or add/include more Artifacts.</span></Alert>\r\n      : (totBuildNumber > warningBuildNumber ?\r\n        <Alert variant=\"warning\" className=\"mb-0\"><span>Current configuration will generate <b>{totalBuildNumberString}</b> builds for <b>{characterName}</b>. This might take quite a while to generate...</span></Alert> :\r\n        <Alert variant=\"success\" className=\"mb-0\"><span>Current configuration {totBuildNumber <= maxBuildsToShow ? \"generated\" : \"will generate\"} <b>{totalBuildNumberString}</b> builds for <b>{characterName}</b>.</span></Alert>)\r\n  }\r\n}\r\n\r\nconst levels = {\r\n  0: <span>No level assumption</span>,\r\n  4: <span>Assume at least level 4</span>,\r\n  8: <span>Assume at least level 8</span>,\r\n  12: <span>Assume at least level 12</span>,\r\n  16: <span>Assume at least level 16</span>,\r\n  20: <span>Assume at least level 20</span>\r\n}\r\nfunction AssumeFullLevelToggle({ mainStatAssumptionLevel = 0, setmainStatAssumptionLevel, disabled }) {\r\n  return <OverlayTrigger overlay={<Tooltip id=\"assume-level-tooltip\">Change Main Stat value to be at least a specific level. Does not change substats.</Tooltip>} >\r\n    <Dropdown>\r\n      <Dropdown.Toggle variant={mainStatAssumptionLevel ? \"orange\" : \"primary\"} disabled={disabled}>{levels[mainStatAssumptionLevel]}</Dropdown.Toggle>\r\n      <Dropdown.Menu>\r\n        {Object.entries(levels).map(([key, text]) => <Dropdown.Item key={key} onClick={() => setmainStatAssumptionLevel(parseInt(key))}>{text}</Dropdown.Item>)}\r\n      </Dropdown.Menu>\r\n    </Dropdown>\r\n  </OverlayTrigger>\r\n}\r\n"],"sourceRoot":""}
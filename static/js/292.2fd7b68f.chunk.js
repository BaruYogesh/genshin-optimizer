"use strict";(self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[]).push([[292],{29292:function(e,t,n){n.r(t),n.d(t,{default:function(){return yt}});var r,i=n(30168),a=n(93433),s=n(29439),l=n(1413),o=n(87757),c=n.n(o),u=n(53174),d=n(54483),h=n(43245),f=n(68087),x=n(49670),v=n(54091),p=n(66934),Z=n(47047),m=n(9585),y=n(39504),j=n(61889),g=n(2199),b=n(68870),w=n(24518),S=n(20890),k=n(23786),K=n(57064),C=n(49900),P=n(13239),A=n(19658),E=n(72791),I=n(16129),R=n(22020),F=n(76899),U=n(45987),L=n(24351),M=n(33890),G=n(10157),O=n(80184),T=["rarity","onChange","filter"];function V(e){var t=e.rarity,n=e.onChange,a=e.filter,s=(0,U.Z)(e,T),o=(0,R.$)("artifact").t;return(0,O.jsx)(M.Z,(0,l.Z)((0,l.Z)({},s),{},{title:t?(0,O.jsx)(G.t,{stars:t}):o(r||(r=(0,i.Z)(["editor.rarity"]))),color:t?"success":"primary",children:[5,4,3].map((function(e){return(0,O.jsx)(k.Z,{disabled:!a(e),onClick:function(){return n(e)},children:(0,O.jsx)(G.t,{stars:e})},e)}))}))}var z,W=n(8375),D=n(94721),N=n(95614),B=["slotKey","onChange","hasUnselect"];function _(e){var t=e.slotKey,n=void 0===t?"":t,r=e.onChange,a=e.hasUnselect,s=void 0!==a&&a,o=(0,U.Z)(e,B),c=(0,R.$)(["artifact","ui"]).t;return(0,O.jsxs)(M.Z,(0,l.Z)((0,l.Z)({title:c(n?"artifact:slotName:".concat(n):"artifact:slot"),color:n?"success":"primary",startIcon:n?(0,N.Ir)(n):void 0},o),{},{children:[s&&(0,O.jsxs)(k.Z,{selected:""===n,disabled:""===n,onClick:function(){return r("")},children:[(0,O.jsx)(K.Z,{children:(0,O.jsx)(x.Z,{})}),(0,O.jsx)(C.Z,{children:c(z||(z=(0,i.Z)(["ui:unselect"])))})]}),s&&(0,O.jsx)(D.Z,{}),L.eV.map((function(e){return(0,O.jsxs)(k.Z,{selected:n===e,disabled:n===e,onClick:function(){return r(e)},children:[(0,O.jsx)(K.Z,{children:(0,N.Ir)(e)}),(0,O.jsx)(C.Z,{children:c("artifact:slotName:".concat(e))})]},e)}))]}))}var q=n(3992),$=n(71310),H=n(68198),X=n(27391),Y=["value","onChange","disabled","float"];function J(e){var t=e.value,n=e.onChange,r=e.disabled,i=void 0!==r&&r,a=e.float,o=void 0!==a&&a,c=(0,U.Z)(e,Y),u=(0,E.useState)(""),d=(0,s.Z)(u,2),h=d[0],f=d[1],x=(0,E.useCallback)((function(){if(""===h)return n(0);var e=o?parseFloat:parseInt;n(e(h))}),[n,h,o]);return(0,E.useEffect)((function(){var e;return f(null!==(e=null===t||void 0===t?void 0:t.toString())&&void 0!==e?e:"")}),[t,f]),(0,O.jsx)(X.Z,(0,l.Z)({value:h,"aria-label":"custom-input",type:"number",onChange:function(e){return f(e.target.value)},onBlur:x,disabled:i,onKeyDown:function(e){return"Enter"===e.key&&x()}},c))}var Q=n(55942),ee=n(9321),te=n(75545),ne=n(19272),re=n(31148),ie=n(56928),ae=n(45748),se=n(92830),le=n(79406),oe=n(68544),ce=n(42320),ue=n(50765),de=JSON.parse('{"5":{"def_":{"24.0":"24.1"},"critRate_":{"8.5":"8.6","19.5":"19.4","23.0":"22.9"}}}'),he=n(60393);var fe=n(72838),xe=n(96106),ve=n(46797);function pe(e){var t=e.efficiency,n=e.max,r=void 0!==n&&n,i=e.t,a=e.valid,s=r?"maxSubEff":"curSubEff";return(0,O.jsx)($.Z,{sx:{py:1,px:2},children:(0,O.jsxs)(j.ZP,{container:!0,spacing:1,children:[(0,O.jsx)(j.ZP,{item:!0,children:i("editor.".concat(s))}),(0,O.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,O.jsx)(xe.Z,{placement:"top",title:(0,O.jsxs)("span",{children:[(0,O.jsx)(S.Z,{variant:"h6",children:i("editor.".concat(s))}),(0,O.jsx)(S.Z,{children:(0,O.jsx)(F.c,{t:i,i18nKey:"editor.".concat(s,"Desc")})})]}),children:(0,O.jsx)("span",{children:(0,O.jsx)(b.Z,{component:d.G,icon:u.sph,sx:{cursor:"help"}})})})}),(0,O.jsx)(j.ZP,{item:!0,xs:"auto",children:(0,O.jsx)(ve.Z,{valid:a,max:900,value:a?t:"ERR"})})]})})}var Ze,me,ye,je,ge,be,we,Se=n(10600),ke=n(25617),Ke=n(92443);function Ce(e){var t,n=e.index,r=e.artifact,s=e.setSubstat,l=(0,R.$)("artifact").t,o=null!==r&&void 0!==r?r:{},c=o.mainStatKey,u=void 0===c?"":c,d=o.rarity,h=void 0===d?5:d,f=null!==(t=null===r||void 0===r?void 0:r.substats[n])&&void 0!==t?t:{},x=f.key,v=void 0===x?"":x,p=f.value,Z=void 0===p?0:p,m=f.rolls,y=void 0===m?[]:m,P=f.efficiency,A=void 0===P?0:P,E=y.reduce((function(e,t){return e+t}),0),I=le.ZP.unit(v),U=y.length,L="",G=[],T=0;if(r){var V=r.rarity,z=ne.Z.rollInfo(V),W=z.numUpgrades,D=z.high;T=W+D-3-U,G=v?ne.Z.getSubstatRollData(v,V):[]}var N=7-G.length;return!U&&v&&Z&&(L=L||l(Ze||(Ze=(0,i.Z)(["editor.substat.error.noCalc"])))),T<0&&(L=L||l("editor.substat.error.noOverRoll",{value:T+U})),(0,O.jsxs)($.Z,{children:[(0,O.jsx)(b.Z,{sx:{display:"flex"},children:(0,O.jsxs)(g.Z,{size:"small",sx:{width:"100%",display:"flex"},children:[(0,O.jsxs)(M.Z,{startIcon:v?te.Z[v]:void 0,title:v?le.ZP.getArtStr(v):l("editor.substat.substatFormat",{value:n+1}),disabled:!r,color:v?"success":"primary",sx:{whiteSpace:"nowrap"},children:[v&&(0,O.jsx)(k.Z,{onClick:function(){return s(n,{key:"",value:0})},children:l(me||(me=(0,i.Z)(["editor.substat.noSubstat"])))}),ue.L.filter((function(e){return u!==e})).map((function(e){return(0,O.jsxs)(k.Z,{selected:v===e,disabled:v===e,onClick:function(){return s(n,{key:e,value:0})},children:[(0,O.jsx)(K.Z,{children:te.Z[e]}),(0,O.jsx)(C.Z,{children:le.ZP.getArtStr(e)})]},e)}))]}),(0,O.jsx)(Se.CC,{sx:{flexBasis:30,flexGrow:1},children:(0,O.jsx)(Se.ZP,{float:"%"===I,placeholder:l(ye||(ye=(0,i.Z)(["editor.substat.selectSub"]))),value:v?Z:void 0,onChange:function(e){return s(n,{key:v,value:null!==e&&void 0!==e?e:0})},disabled:!v,error:!!L,sx:{px:1},inputProps:{sx:{textAlign:"right"}}})}),!!G.length&&(0,O.jsx)(Ke.Z,{children:l(je||(je=(0,i.Z)(["editor.substat.nextRolls"])))}),G.map((function(e,t){var r,i,a,l=(0,le.qs)(E+e,I);return l=null!==(r=null===(i=de[h])||void 0===i||null===(a=i[v])||void 0===a?void 0:a[l])&&void 0!==r?r:l,(0,O.jsx)(w.Z,{color:"roll".concat((0,he.uZ)(N+t,1,6)),disabled:Z&&!U||T<=0,onClick:function(){return s(n,{key:v,value:parseFloat(l)})},children:l},t)}))]})}),(0,O.jsx)(b.Z,{sx:{p:1},children:L?(0,O.jsx)(ke.Z,{color:"error",children:l(ge||(ge=(0,i.Z)(["ui:error"])))}):(0,O.jsxs)(j.ZP,{container:!0,children:[(0,O.jsx)(j.ZP,{item:!0,children:(0,O.jsx)(ke.Z,{color:0===U?"secondary":"roll".concat((0,he.uZ)(U,1,6)),children:U?l("editor.substat.RollCount",{count:U}):l(be||(be=(0,i.Z)(["editor.substat.noRoll"])))})}),(0,O.jsx)(j.ZP,{item:!0,flexGrow:1,children:!!y.length&&(0,a.Z)(y).sort().map((function(e,t){return(0,O.jsx)(S.Z,{component:"span",color:"roll".concat((0,he.uZ)(N+G.indexOf(e),1,6),".main"),sx:{ml:1},children:(0,le.qs)(e,I)},"".concat(t,".").concat(e))}))}),(0,O.jsx)(j.ZP,{item:!0,xs:"auto",flexShrink:1,children:(0,O.jsx)(S.Z,{children:(0,O.jsxs)(F.c,{t:l,i18nKey:"editor.substat.eff",color:"text.secondary",children:["Efficiency: ",(0,O.jsx)(ve.Z,{valid:!0,max:100*U,value:A||l(we||(we=(0,i.Z)(["editor.substat.noStat"])))})]})})})]})})]})}var Pe=n(57641),Ae=n(82554);function Ee(e){var t=e.modalShow,n=e.hide;return(0,O.jsx)(ee.Z,{open:t,onClose:n,children:(0,O.jsxs)(q.Z,{children:[(0,O.jsx)(y.Z,{sx:{py:1},children:(0,O.jsxs)(j.ZP,{container:!0,children:[(0,O.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,O.jsx)(S.Z,{variant:"subtitle1",children:"How do Upload Screenshots for parsing"})}),(0,O.jsx)(j.ZP,{item:!0,children:(0,O.jsx)(H.Z,{onClick:n})})]})}),(0,O.jsx)(D.Z,{}),(0,O.jsxs)(y.Z,{children:[(0,O.jsxs)(A.Z,{variant:"outlined",severity:"warning",children:["NOTE: Artifact Scanning currently only work for ",(0,O.jsx)("strong",{children:"ENGLISH"})," artifacts."]}),(0,O.jsxs)(j.ZP,{container:!0,spacing:1,mt:1,children:[(0,O.jsx)(j.ZP,{item:!0,xs:8,md:4,children:(0,O.jsx)(b.Z,{component:"img",alt:"snippet of the screen to take",src:Ae,width:"100%",height:"auto"})}),(0,O.jsxs)(j.ZP,{item:!0,xs:12,md:8,children:[(0,O.jsx)(S.Z,{gutterBottom:!0,children:"Using screenshots can dramatically decrease the amount of time you manually input in stats on the Genshin Optimizer."}),(0,O.jsx)(S.Z,{variant:"h5",children:"Where to snip the screenshot."}),(0,O.jsxs)(S.Z,{gutterBottom:!0,children:["In game, Open your bag, and navigate to the artifacts tab. Select the artifact you want to scan with Genshin Optimizer. ",(0,O.jsx)("b",{children:"Only artifact from this screen can be scanned."})]}),(0,O.jsx)(S.Z,{variant:"h6",children:"Single artifact"}),(0,O.jsxs)(S.Z,{gutterBottom:!0,children:["To take a screenshot, in Windows, the shortcut is ",(0,O.jsx)("strong",{children:"Shift + WindowsKey + S"}),". Once you selected the region, the image is automatically included in your clipboard."]}),(0,O.jsx)(S.Z,{variant:"h6",children:"Multiple artifacts"}),(0,O.jsxs)(S.Z,{gutterBottom:!0,children:["To take advantage of batch uploads, you can use a tool like ",(0,O.jsx)("a",{href:"https://picpick.app/",target:"_blank",rel:"noreferrer",children:"PicPick"})," to create a macro to easily to screenshot a region to screenshot multiple artifacts at once."]}),(0,O.jsx)(S.Z,{variant:"h5",children:"What to include in the screenshot."}),(0,O.jsx)(S.Z,{children:"As shown in the Image, starting from the top with the artifact name, all the way to the set name(the text in green). "})]}),(0,O.jsxs)(j.ZP,{item:!0,xs:12,md:7,children:[(0,O.jsx)(S.Z,{variant:"h5",children:"Adding Screenshot to Genshin Optimizer"}),(0,O.jsx)(S.Z,{children:"At this point, you should have the artifact snippet either saved to your harddrive, or in your clipboard."}),(0,O.jsx)(S.Z,{gutterBottom:!0,children:'You can click on the box next to "Browse" to browse the files in your harddrive for multiple screenshots.'}),(0,O.jsxs)(S.Z,{children:["For single screenshots from the snippets, just press ",(0,O.jsx)("strong",{children:"Ctrl + V"})," to paste from your clipboard."]}),(0,O.jsxs)(S.Z,{gutterBottom:!0,children:["You should be able to see a Preview of your artifact snippet, and after waiting a few seconds, the artifact set and the substats will be filled in in the ",(0,O.jsx)("b",{children:"Artifact Editor"}),"."]}),(0,O.jsx)(S.Z,{variant:"h5",children:"Finishing the Artifact"}),(0,O.jsxs)(S.Z,{children:["Unfortunately, computer vision is not 100%. There will always be cases where something is not scanned properly. You should always double check the scanned artifact values! Once the artifact has been filled, Click on ",(0,O.jsx)("strong",{children:"Add Artifact"})," to finish editing the artifact."]})]}),(0,O.jsx)(j.ZP,{item:!0,xs:8,md:5,children:(0,O.jsx)(b.Z,{component:"img",alt:"main screen after importing stats",src:Pe,width:"100%",height:"auto"})})]})]}),(0,O.jsx)(D.Z,{}),(0,O.jsx)(y.Z,{sx:{py:1},children:(0,O.jsx)(H.Z,{large:!0,onClick:n})})]})})}var Ie=n(37762),Re=n(15861),Fe=n(31362),Ue=n(91702),Le=n(15671),Me=n(43144),Ge=function(){function e(t,n){(0,Le.Z)(this,e),this.data={},this.init=void 0,this.deinit=void 0,this.init=t,this.deinit=n}return(0,Me.Z)(e,[{key:"borrow",value:function(){var e=(0,Re.Z)(c().mark((function e(t,n){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.data[t]||(this.data[t]={value:this.init(t),refCount:0}),(r=this.data[t]).refCount+=1,e.next=5,n(r.value);case 5:return i=e.sent,r.refCount-=1,r.refCount||(delete this.data[t],this.deinit(t,r.value)),e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),Oe={r:255,g:204,b:50},Te=new Ge(function(){var e=(0,Re.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,Fe.createScheduler)(),r=Array(2).fill(0).map(function(){var e=(0,Re.Z)(c().mark((function e(r){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,Fe.createWorker)({errorHandler:console.error}),e.next=3,i.load();case 3:return e.next=5,i.loadLanguage(t);case 5:return e.next=7,i.initialize(t);case 7:n.addWorker(i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.any(r);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e,t){t.then((function(e){return e.terminate()}))})),Ve=function(e,t){switch(t.type){case"upload":return{processed:e.processed,outstanding:[].concat((0,a.Z)(e.outstanding),(0,a.Z)(t.files))};case"processing":return{processed:e.processed,outstanding:(0,a.Z)(e.outstanding)};case"processed":return e.outstanding[0].file===t.file?{processed:[].concat((0,a.Z)(e.processed),[t.result]),outstanding:e.outstanding.slice(1)}:e;case"pop":return{processed:e.processed.slice(1),outstanding:e.outstanding};case"clear":return{processed:[],outstanding:[]}}};function ze(e){if(!e.result){var t=e.file,n=e.fileName;e.imageURL=et(t),e.result=e.imageURL.then(function(){var e=(0,Re.Z)(c().mark((function e(r){var i,a,l,o,u,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.y.getAll;case 2:return i=e.sent,e.next=5,rt(r);case 5:return a=e.sent,l=lt(i,a.rarities,ot(a.artifactSetTexts,i),dt(a.whiteTexts),xt(a.substatTexts),ht(a.whiteTexts),ft(a.whiteTexts)),o=(0,s.Z)(l,2),u=o[0],d=o[1],e.abrupt("return",{file:t,result:{fileName:n,imageURL:r,artifact:u,texts:d}});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}var We,De,Ne,Be,_e,qe,$e,He,Xe,Ye,Je,Qe,et=function(e){return new Promise((function(t){var n=new FileReader;n.onloadend=function(e){var n=e.target;return t(n.result)},n.readAsDataURL(e)}))},tt=function(e){return new Promise((function(t){var n=new Image;n.onload=function(e){var n=e.target;return t(function(e){var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height),n.getImageData(0,0,e.width,e.height)}(n))},n.src=e}))};function nt(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e,0,0),t}function rt(e){return it.apply(this,arguments)}function it(){return(it=(0,Re.Z)(c().mark((function e(t){var n,r,i,a,l,o,u,d,h,f,x;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tt(t);case 2:return n=e.sent,r=n.width,i=Math.floor(n.height/2),a={rectangle:{top:i,left:0,width:r,height:i}},l=[at(vt(n,[140,140,140],[255,255,255],{mode:"bw",region:"top"})),at(vt(n,[30,50,80],[160,160,160],{region:"bot"}),a),at(vt(n,[30,160,30],[200,255,200],{mode:"bw",region:"bot"}),a)],o=ct(n.data,n.width,n.height),e.next=9,Promise.all(l);case 9:return u=e.sent,d=(0,s.Z)(u,3),h=d[0],f=d[1],x=d[2],e.abrupt("return",{whiteTexts:h,substatTexts:f,artifactSetTexts:x,rarities:o});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function at(e){return st.apply(this,arguments)}function st(){return st=(0,Re.Z)(c().mark((function e(t){var n,r,i,a=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:void 0,r=nt(t),e.next=4,Te.borrow("eng",function(){var e=(0,Re.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return e.next=4,e.sent.addJob("recognize",r,n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:return i=e.sent,e.abrupt("return",i.data.lines.map((function(e){return e.text})));case 6:case"end":return e.stop()}}),e)}))),st.apply(this,arguments)}function lt(e,t,n,r,i,l,o){var c,u=(0,a.Z)(new Set([].concat((0,a.Z)(n),["EmblemOfSeveredFate"]))),d=-1,h=[{setKey:"EmblemOfSeveredFate",rarity:3,level:0,slotKey:"flower",mainStatKey:"hp",substats:[],location:"",lock:!1,exclude:!1}],f=(0,he.O)(L.En,(function(t){var r=0;n.size&&(r+=(0,a.Z)(n).reduce((function(n,r){return n+(e[r].rarity.includes(t)?1:0)}),0)/n.size);if(i.length){var s=i.reduce((function(e,n){return e+(ne.Z.getSubstatRolls(n.key,n.value,t).length?1:0)}),0);r+=s/i.length*2}return r})),x=(0,Ie.Z)(L.eV);try{for(x.s();!(c=x.n()).done;){var v,p=c.value,Z=(0,Ie.Z)(ne.Z.slotMainStats(p));try{var m=function(){for(var t=v.value,i=(r.has(p)?1:0)+(l.has(t)?1:0),a=o.filter((function(e){return"%"!==e.unit||"%"===le.ZP.unit(t)})).map((function(e){return e.mainStatValue})),c=function(){var r=(0,s.Z)(Z[x],2),l=r[0],o=r[1],c=parseInt(l),f=u.filter((function(t){return e[t].rarity.includes(c)})),v=i+o;if(v+2<d)return"continue";var m,y=(0,Ie.Z)(a);try{var j=function(){var e,r=m.value,i=ne.Z.mainStatValues(c,t),a=Math.max(0,i.findIndex((function(e){return e>=r}))),s=i[a],l=v+(s===r?1:0),o=(0,Ie.Z)(f);try{for(o.s();!(e=o.n()).done;){var u=e.value,x=l+(n.has(u)?1:0);x>=d&&(x>d&&(h=[]),d=x,h.push({setKey:u,rarity:c,level:a,slotKey:p,mainStatKey:t,substats:[],location:"",lock:!1,exclude:!1}))}}catch(Z){o.e(Z)}finally{o.f()}};for(y.s();!(m=y.n()).done;)j()}catch(k){y.e(k)}finally{y.f()}if(v>=d){var g,b=(0,Ie.Z)(f);try{for(b.s();!(g=b.n()).done;){var w=g.value,S=v+(n.has(w)?1:0);S>d&&(h=[]),d=S,h.push({setKey:w,rarity:c,level:0,slotKey:p,mainStatKey:t,substats:[],location:"",lock:!1,exclude:!1})}}catch(k){b.e(k)}finally{b.f()}}},x=0,Z=Object.entries(f);x<Z.length;x++)c()};for(Z.s();!(v=Z.n()).done;)m()}catch(R){Z.e(R)}finally{Z.f()}}}catch(R){x.e(R)}finally{x.f()}var y={},j={setKey:new Set,rarity:new Set,level:new Set,slotKey:new Set,mainStatKey:new Set,mainStatVal:new Set},g=h[0],b=ne.Z.mainStatValue(g.mainStatKey,g.rarity,g.level);g.substats=i.filter((function(e,t){return e.key!==g.mainStatKey&&i.slice(0,t).every((function(t){return t.key!==e.key}))}));for(var w=g.substats.length;w<4;w++)g.substats.push({key:"",value:0});for(var S=0,k=h;S<k.length;S++){var K=k[S];j.setKey.add(K.setKey),j.rarity.add(K.rarity),j.level.add(K.level),j.slotKey.add(K.slotKey),j.mainStatKey.add(K.mainStatKey)}function C(e,t,n){return(0,O.jsxs)(O.Fragment,{children:["Unknown ",t," : Set to ",(0,O.jsx)(Ue.Z,{color:"error",children:n(e)})]})}function P(e,t,n){return(0,O.jsxs)(O.Fragment,{children:["Detected ",t," ",(0,O.jsx)(Ue.Z,{color:"success",children:n(e)})]})}function A(e,t,n){return(0,O.jsxs)(O.Fragment,{children:["Inferred ",t," ",(0,O.jsx)(Ue.Z,{color:"warning",children:n(e)})]})}function E(e,t,n,r){var i=new Set((0,a.Z)(j[e]).filter((function(e){return t.has(e)})));i.size>1?y[e]=function(e,t,n,r){return(0,O.jsxs)(O.Fragment,{children:["Ambiguous ",n," ",(0,O.jsx)(Ue.Z,{color:"error",children:r(e)})," : May also be ",t.filter((function(t){return t!==e})).map((function(e,t){return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("b",{children:t>0?"/":""}),(0,O.jsx)(Ue.Z,{color:"warning",children:r(e)})]})}))]})}(g[e],(0,a.Z)(t),n,r):1===i.size?y[e]=P(g[e],n,r):j[e].size>1?y[e]=C(g[e],n,r):y[e]=A(g[e],n,r)}E("setKey",n,"Set",(function(t){return e[t].name})),E("rarity",t,"Rarity",(function(e){return(0,O.jsxs)(O.Fragment,{children:[e," ",1!==e?"Stars":"Star"]})})),E("slotKey",r,"Slot",(function(e){return(0,O.jsx)(O.Fragment,{children:ne.Z.slotName(e)})})),E("mainStatKey",l,"Main Stat",(function(e){return(0,O.jsx)(O.Fragment,{children:le.ZP.getStr(e)})})),y.substats=(0,O.jsx)(O.Fragment,{children:g.substats.filter((function(e){return""!==e.key})).map((function(e,t){return(0,O.jsx)("div",{children:P(e,"Sub Stat",(function(e){return(0,O.jsxs)(O.Fragment,{children:[le.ZP.getStr(e.key),"+",(0,le.qs)(e.value,le.ZP.unit(e.key)),le.ZP.unit(e.key)]})}))},t)}))});var I=function(e){return(0,O.jsxs)(O.Fragment,{children:[(0,le.qs)(e,le.ZP.unit(g.mainStatKey)),le.ZP.unit(g.mainStatKey)]})};return o.find((function(e){return e.mainStatValue===b}))?l.has(g.mainStatKey)?(y.level=P(g.level,"Level",(function(e){return"+"+e})),y.mainStatVal=P(b,"Main Stat value",I)):(y.level=A(g.level,"Level",(function(e){return"+"+e})),y.mainStatVal=A(b,"Main Stat value",I)):(y.level=C(g.level,"Level",(function(e){return"+"+e})),y.mainStatVal=C(b,"Main Stat value",I)),[g,y]}function ot(e,t){var n,r=new Set([]),i=(0,Ie.Z)(e);try{for(i.s();!(n=i.n()).done;){var a,s=n.value,l=(0,Ie.Z)(L.q2);try{for(l.s();!(a=l.n()).done;){var o=a.value;(0,he.UX)(s.replace(/\W/g,""),t[o].nameRaw.replace(/\W/g,""))<=2&&r.add(o)}}catch(c){l.e(c)}finally{l.f()}}}catch(c){i.e(c)}finally{i.f()}return r}function ct(e,t,n){for(var r=e,i=0,a=0,s=new Set([]),l=0;l<n;l++){for(var o=0,c=!1,u=0;u<t;u++){var d=4*(l*t+u);ut({r:r[d],g:r[d+1],b:r[d+2]},Oe)?c||(c=!0,o++):c=!1}i!==o?(i=o,a=1):i&&++a>=10&&s.add((0,he.uZ)(i,3,5))}return s}function ut(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=function(e,t){return Math.abs(e-t)<=n};return r(e.r,t.r)&&r(e.g,t.g)&&r(e.b,t.b)}function dt(e){var t,n=new Set,r=(0,Ie.Z)(e);try{for(r.s();!(t=r.n()).done;){var i,a=t.value,s=(0,Ie.Z)(L.eV);try{for(s.s();!(i=s.n()).done;){var l=i.value;(0,he.UX)(a.replace(/\W/g,""),ne.Z.slotName(l).replace(/\W/g,""))<=2&&n.add(l)}}catch(o){s.e(o)}finally{s.f()}}}catch(o){r.e(o)}finally{r.f()}return n}function ht(e){var t,n=new Set([]),r=(0,Ie.Z)(e);try{for(r.s();!(t=r.n()).done;){var i,a=t.value,s=(0,Ie.Z)(ue.r);try{for(s.s();!(i=s.n()).done;){var l,o,c,u=i.value;a.toLowerCase().includes(null!==(l=null===(o=le.ZP.getStr(u))||void 0===o?void 0:o.toLowerCase())&&void 0!==l?l:"")&&n.add(u),u.includes("_bonu")&&(0,he.UX)(a.replace(/\W/g,""),(null!==(c=le.ZP.getStr(u))&&void 0!==c?c:"").replace(/\W/g,""))<=1&&n.add(u)}}catch(d){s.e(d)}finally{s.f()}}}catch(d){r.e(d)}finally{r.f()}return n}function ft(e){var t,n=[],r=(0,Ie.Z)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=/(\d+[,|\\.]+\d)%/,s=a.exec(i);s&&n.push({mainStatValue:parseFloat(s[1].replace(/,/g,".").replace(/\.{2,}/g,".")),unit:"%"}),(s=(a=/(\d+[,|\\.]\d{3}|\d{2,3})/).exec(i))&&n.push({mainStatValue:parseInt(s[1].replace(/[,|\\.]+/g,""))})}}catch(l){r.e(l)}finally{r.f()}return n}function xt(e){var t,n=[],r=(0,Ie.Z)(e);try{var i=function(){var e=t.value;e=e.replace(/^[\W]+/,"").replace(/\n/,""),ue.L.forEach((function(t){var r=le.ZP.getStr(t),i=("%"===le.ZP.unit(t)?new RegExp(r+"\\s*\\+\\s*(\\d+[\\.|,]+\\d)%","im"):new RegExp(r+"\\s*\\+\\s*(\\d+,\\d+|\\d+)($|\\s)","im")).exec(e);i&&n.push({key:t,value:parseFloat(i[1].replace(/,/g,".").replace(/\.{2,}/g,"."))})}))};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n.slice(0,4)}function vt(e,t,n,r){for(var i=r.region,a=void 0===i?"all":i,s=r.mode,l=void 0===s?"color":s,o=Uint8ClampedArray.from(e.data),c="top"===a,u="bot"===a,d="all"===a,h="bw"===l,f="invert"===l,x=Math.floor(e.width*(e.height/2)*4),v=0;v<o.length;v+=4){var p=o[v],Z=o[v+1],m=o[v+2];(d||c&&v<x||u&&v>x)&&p>=t[0]&&p<=n[0]&&Z>=t[1]&&Z<=n[1]&&m>=t[2]&&m<=n[2]?h?o[v]=o[v+1]=o[v+2]=0:f&&(o[v]=255-p,o[v+1]=255-Z,o[v+2]=255-m):o[v]=o[v+1]=o[v+2]=255}return new ImageData(o,e.width,e.height)}var pt=new Set(ue.L);function Zt(e,t){switch(t.type){case"reset":return;case"substat":var n=t.index,r=t.substat,i=r.key?e.substats.findIndex((function(e){return e.key===r.key})):-1;if(-1===i||i===n)e.substats[n]=r;else{var a=[e.substats[i],e.substats[n]];e.substats[n]=a[0],e.substats[i]=a[1]}return(0,l.Z)({},e);case"overwrite":return t.artifact;case"update":return(0,l.Z)((0,l.Z)({},e),t.artifact)}}var mt=(0,p.ZP)("input")({display:"none"});function yt(e){var t,n=e.artifactIdToEdit,r=void 0===n?"":n,o=e.cancelEdit,c=e.allowUpload,p=void 0!==c&&c,U=e.allowEmpty,L=void 0!==U&&U,G=(0,R.$)("artifact").t,T=(0,ce.Z)(re.y.getAll,[]),z=(0,E.useContext)(ie.t).database,D=(0,E.useState)(!1),N=(0,s.Z)(D,2),B=N[0],X=N[1],Y=(0,oe.Z)(),ue=(0,s.Z)(Y,2),de=ue[0],xe=ue[1];(0,E.useEffect)((function(){return z.followAnyArt(xe)}),[z,xe]);var ve=(0,E.useReducer)(Zt,void 0),Ze=(0,s.Z)(ve,2),me=Ze[0],ye=Ze[1],je=(0,E.useMemo)((function(){return me&&(0,ae.R$)(me)}),[me]),ge=(0,E.useState)(!1),be=(0,s.Z)(ge,2),we=be[0],Se=be[1],ke=(0,E.useReducer)(Ve,{processed:[],outstanding:[]}),Ke=(0,s.Z)(ke,2),Pe=Ke[0],Ae=Pe.processed,Ie=Pe.outstanding,Re=Ke[1],Fe=Ae[0],Ue=Ie[0],Le=(0,ce.Z)(null===Ue||void 0===Ue?void 0:Ue.imageURL,[null===Ue||void 0===Ue?void 0:Ue.imageURL]),Me=(0,ce.Z)(null===Ue||void 0===Ue?void 0:Ue.result,[null===Ue||void 0===Ue?void 0:Ue.result]),Ge=Ae.length+Ie.length,Oe=null!==(t=null===Fe||void 0===Fe?void 0:Fe.imageURL)&&void 0!==t?t:Le,Te=null!==Fe&&void 0!==Fe?Fe:{},et=Te.artifact,tt=Te.texts;(0,E.useEffect)((function(){!je&&et&&ye({type:"overwrite",artifact:et})}),[je,et,ye]),(0,E.useEffect)((function(){var e=Math.min(16-Ae.length,3,Ie.length),t=e&&!Ie[0].result;Ie.slice(0,e).forEach(ze),t&&Re({type:"processing"})}),[Ae.length,Ie]),(0,E.useEffect)((function(){Me&&Re((0,l.Z)({type:"processed"},Me))}),[Me,Re]);var nt=(0,E.useCallback)((function(e){X(!0),Re({type:"upload",files:(0,a.Z)(e).map((function(e){return{file:e,fileName:e.name}}))})}),[Re,X]),rt=(0,E.useCallback)((function(){return Re({type:"clear"})}),[Re]);(0,E.useEffect)((function(){var e=function(e){return nt(e.clipboardData.files)};return p&&window.addEventListener("paste",e),function(){p&&window.removeEventListener("paste",e)}}),[nt,p]);var it=(0,E.useCallback)((function(e){nt(e.target.files),e.target.value=null}),[nt]),at=(0,E.useMemo)((function(){var e,t=de&&r&&z._getArt(r);if(t)return{old:t,oldType:"edit"};if(void 0===je)return{old:void 0,oldType:""};var n=de&&z.findDuplicates(je),i=n.duplicated,a=n.upgraded;return{old:null!==(e=i[0])&&void 0!==e?e:a[0],oldType:0!==i.length?"duplicate":"upgrade"}}),[je,r,z,de]),st=at.old,lt=at.oldType,ot=(0,E.useMemo)((function(){if(!je)return{artifact:void 0,errors:[]};var e=(0,se.BG)(je,r);return st&&(e.artifact.location=st.location,e.artifact.exclude=st.exclude),e}),[je,r,st]),ct=ot.artifact,ut=ot.errors;(0,E.useEffect)((function(){"new"===r&&(X(!0),ye({type:"reset"}));var e=r&&de&&z._getArt(r);e&&(X(!0),ye({type:"overwrite",artifact:(0,he.I8)(e)}))}),[r,z,de]);var dt=je?null===T||void 0===T?void 0:T[je.setKey]:void 0,ht=(0,E.useCallback)((function(){null===o||void 0===o||o(),Re({type:"pop"}),ye({type:"reset"})}),[o,ye]),ft=(0,E.useCallback)((function(e){var t,n,r=e.setKey?T[e.setKey]:dt;function i(e,t,n){return e&&t.includes(e)?e:null!==n&&void 0!==n?n:t[0]}e.setKey&&(e.rarity=i(null===je||void 0===je?void 0:je.rarity,r.rarity,Math.max.apply(Math,(0,a.Z)(r.rarity))),e.slotKey=i(null===je||void 0===je?void 0:je.slotKey,r.slots)),e.rarity&&(e.level=null!==(t=null===je||void 0===je?void 0:je.level)&&void 0!==t?t:0),e.level&&(e.level=(0,he.uZ)(e.level,0,4*(null!==(n=e.rarity)&&void 0!==n?n:je.rarity))),e.slotKey&&(e.mainStatKey=i(null===je||void 0===je?void 0:je.mainStatKey,ne.Z.slotMainStats(e.slotKey))),e.mainStatKey&&(e.substats=[0,1,2,3].map((function(t){return je&&je.substats[t].key!==e.mainStatKey?je.substats[t]:{key:"",value:0}}))),ye({type:"update",artifact:e})}),[je,T,dt,ye]),xt=(0,E.useCallback)((function(e,t){ye({type:"substat",index:e,substat:t})}),[ye]),vt=!ut.length,yt=null!==je&&void 0!==je?je:{},jt=yt.rarity,gt=void 0===jt?5:jt,bt=yt.level,wt=void 0===bt?0:bt,St=yt.slotKey,kt=void 0===St?"flower":St,Kt=ct?ne.Z.getArtifactEfficiency(ct,pt):{},Ct=Kt.currentEfficiency,Pt=void 0===Ct?0:Ct,At=Kt.maxEfficiency,Et=void 0===At?0:At,It=Ae.length||Ie.length,Rt=(0,E.useCallback)((function(e){It&&e.preventDefault(),X(!1),o()}),[It,X,o]);return(0,O.jsx)(ee.Z,{open:B,onClose:Rt,children:(0,O.jsx)(E.Suspense,{fallback:(0,O.jsx)(Z.Z,{variant:"rectangular",sx:{width:"100%",height:B?"100%":64}}),children:(0,O.jsxs)(q.Z,{children:[(0,O.jsx)(Ee,{modalShow:we,hide:function(){return Se(!1)}}),(0,O.jsx)(m.Z,{title:(0,O.jsx)(F.c,{t:G,i18nKey:"editor.title",children:"Artifact Editor"}),action:(0,O.jsx)(H.Z,{disabled:!!It,onClick:Rt})}),(0,O.jsxs)(y.Z,{sx:{pt:0},children:[(0,O.jsxs)(j.ZP,{container:!0,spacing:1,sx:{mb:1},children:[(0,O.jsxs)(j.ZP,{item:!0,xs:12,md:6,lg:6,sx:{"> div:nth-last-of-type(n+2)":{mb:1}},children:[(0,O.jsxs)(g.Z,{sx:{display:"flex",mb:1},children:[(0,O.jsx)(W.Z,{selectedSetKey:null===je||void 0===je?void 0:je.setKey,onChange:function(e){return ft({setKey:e})},sx:{flexGrow:1}}),(0,O.jsx)(V,{rarity:je?gt:void 0,onChange:function(e){return ft({rarity:e})},filter:function(e){var t,n;return!(null===dt||void 0===dt||null===(t=dt.rarity)||void 0===t||null===(n=t.includes)||void 0===n||!n.call(t,e))},disabled:!dt})]}),(0,O.jsxs)(b.Z,{component:"div",display:"flex",children:[(0,O.jsx)(J,{id:"filled-basic",label:"Level",variant:"filled",sx:{flexShrink:1,flexGrow:1,mr:1,my:0},margin:"dense",size:"small",value:wt,disabled:!dt,placeholder:"0~".concat(4*gt),onChange:function(e){return ft({level:e})}}),(0,O.jsxs)(g.Z,{children:[(0,O.jsx)(w.Z,{onClick:function(){return ft({level:wt-1})},disabled:!dt||0===wt,children:"-"}),gt?(0,a.Z)(Array(gt+1).keys()).map((function(e){return 4*e})).map((function(e){return(0,O.jsx)(w.Z,{onClick:function(){return ft({level:e})},disabled:!dt||wt===e,children:e},e)})):null,(0,O.jsx)(w.Z,{onClick:function(){return ft({level:wt+1})},disabled:!dt||wt===4*gt,children:"+"})]})]}),(0,O.jsxs)(b.Z,{component:"div",display:"flex",children:[(0,O.jsx)(_,{disabled:!dt,slotKey:kt,onChange:function(e){return ft({slotKey:e})}}),(0,O.jsx)($.Z,{sx:{p:1,ml:1,flexGrow:1},children:(0,O.jsx)(E.Suspense,{fallback:(0,O.jsx)(Z.Z,{width:"60%"}),children:(0,O.jsx)(S.Z,{color:"text.secondary",children:null!==dt&&void 0!==dt&&dt.getSlotName(je.slotKey)?(0,O.jsxs)("span",{children:[(0,O.jsx)(Q.Z,{src:dt.slotIcons[je.slotKey]})," ",null===dt||void 0===dt?void 0:dt.getSlotName(je.slotKey)]}):G(De||(De=(0,i.Z)(["editor.unknownPieceName"])))})})})]}),(0,O.jsxs)(b.Z,{component:"div",display:"flex",children:[(0,O.jsx)(M.Z,{startIcon:null!==je&&void 0!==je&&je.mainStatKey?te.Z[je.mainStatKey]:void 0,title:(0,O.jsx)("b",{children:je?le.ZP.getArtStr(je.mainStatKey):G(Ne||(Ne=(0,i.Z)(["mainStat"])))}),disabled:!dt,color:je?"success":"primary",children:ne.Z.slotMainStats(kt).map((function(e){return(0,O.jsxs)(k.Z,{selected:(null===je||void 0===je?void 0:je.mainStatKey)===e,disabled:(null===je||void 0===je?void 0:je.mainStatKey)===e,onClick:function(){return ft({mainStatKey:e})},children:[(0,O.jsx)(K.Z,{children:te.Z[e]}),(0,O.jsx)(C.Z,{children:le.ZP.getArtStr(e)})]},e)}))}),(0,O.jsx)($.Z,{sx:{p:1,ml:1,flexGrow:1},children:(0,O.jsx)(S.Z,{color:"text.secondary",children:je?"".concat((0,le.qs)(ne.Z.mainStatValue(je.mainStatKey,gt,wt),le.ZP.unit(je.mainStatKey))).concat(le.ZP.unit(je.mainStatKey)):G(Be||(Be=(0,i.Z)(["mainStat"])))})})]}),(0,O.jsx)(pe,{valid:vt,efficiency:Pt,t:G}),Pt!==Et&&(0,O.jsx)(pe,{max:!0,valid:vt,efficiency:Et,t:G}),p&&(0,O.jsx)($.Z,{children:(0,O.jsx)(y.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:(0,O.jsxs)(E.Suspense,{fallback:(0,O.jsx)(Z.Z,{width:"100%",height:"100"}),children:[(0,O.jsxs)(j.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,O.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,O.jsxs)("label",{htmlFor:"contained-button-file",children:[(0,O.jsx)(mt,{accept:"image/*",id:"contained-button-file",multiple:!0,type:"file",onChange:it}),(0,O.jsx)(w.Z,{component:"span",startIcon:(0,O.jsx)(h.Z,{}),children:"Upload Screenshot (or Ctrl-V)"})]})}),(0,O.jsx)(j.ZP,{item:!0,children:(0,O.jsx)(w.Z,{color:"info",sx:{px:2,minWidth:0},onClick:function(){Se(!0),I.ZP.modalview("/artifact/how-to-upload")},children:(0,O.jsx)(S.Z,{children:(0,O.jsx)(d.G,{icon:u.sph})})})})]}),Oe&&(0,O.jsx)(b.Z,{display:"flex",justifyContent:"center",children:(0,O.jsx)(b.Z,{component:"img",src:Oe,width:"100%",maxWidth:350,height:"auto",alt:"Screenshot to parse for artifact values"})}),Ge>0&&(0,O.jsx)(q.Z,{sx:{pl:2},children:(0,O.jsxs)(j.ZP,{container:!0,spacing:1,alignItems:"center",children:[!Fe&&Ue&&(0,O.jsx)(j.ZP,{item:!0,children:(0,O.jsx)(P.Z,{size:"1em"})}),(0,O.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,O.jsx)(S.Z,{children:(0,O.jsxs)("span",{children:["Screenshots in file-queue: ",(0,O.jsx)("b",{children:Ge})]})})}),(0,O.jsx)(j.ZP,{item:!0,children:(0,O.jsx)(w.Z,{size:"small",color:"error",onClick:rt,children:"Clear file-queue"})})]})})]})})})]}),(0,O.jsxs)(j.ZP,{item:!0,xs:12,md:6,lg:6,display:"flex",flexDirection:"column",gap:1,children:[[0,1,2,3].map((function(e){return(0,O.jsx)(Ce,{index:e,artifact:ct,setSubstat:xt},e)})),tt&&(0,O.jsx)($.Z,{children:(0,O.jsxs)(y.Z,{children:[(0,O.jsx)("div",{children:tt.slotKey}),(0,O.jsx)("div",{children:tt.mainStatKey}),(0,O.jsx)("div",{children:tt.mainStatVal}),(0,O.jsx)("div",{children:tt.rarity}),(0,O.jsx)("div",{children:tt.level}),(0,O.jsx)("div",{children:tt.substats}),(0,O.jsx)("div",{children:tt.setKey})]})})]})]}),st&&(0,O.jsxs)(j.ZP,{container:!0,sx:{justifyContent:"space-around",mb:1},spacing:1,children:[(0,O.jsx)(j.ZP,{item:!0,lg:4,md:6,children:(0,O.jsxs)($.Z,{children:[(0,O.jsx)(S.Z,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:G(_e||(_e=(0,i.Z)(["editor.preview"])))}),(0,O.jsx)(fe.Z,{artifactObj:ct})]})}),(0,O.jsx)(j.ZP,{item:!0,lg:4,md:6,children:(0,O.jsxs)($.Z,{children:[(0,O.jsx)(S.Z,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:G("edit"!==lt?"duplicate"===lt?qe||(qe=(0,i.Z)(["editor.dupArt"])):$e||($e=(0,i.Z)(["editor.upArt"])):He||(He=(0,i.Z)(["editor.beforeEdit"])))}),(0,O.jsx)(fe.Z,{artifactObj:st})]})})]}),!vt&&(0,O.jsx)(A.Z,{variant:"filled",severity:"error",sx:{mb:1},children:ut.map((function(e,t){return(0,O.jsx)("div",{children:e},t)}))}),(0,O.jsxs)(j.ZP,{container:!0,spacing:2,children:[(0,O.jsx)(j.ZP,{item:!0,children:"edit"===lt?(0,O.jsx)(w.Z,{startIcon:(0,O.jsx)(f.Z,{}),onClick:function(){z.updateArt(me,st.id),L?ht():X(!1)},disabled:!me||!vt,color:"primary",children:G(Xe||(Xe=(0,i.Z)(["editor.btnSave"])))}):(0,O.jsx)(w.Z,{startIcon:(0,O.jsx)(f.Z,{}),onClick:function(){z.createArt(je),L?ht():X(!1)},disabled:!je||!vt,color:"duplicate"===lt?"warning":"primary",children:G(Ye||(Ye=(0,i.Z)(["editor.btnAdd"])))})}),(0,O.jsx)(j.ZP,{item:!0,flexGrow:1,children:L&&(0,O.jsx)(w.Z,{startIcon:(0,O.jsx)(x.Z,{}),disabled:!je,onClick:function(){window.confirm(G(We||(We=(0,i.Z)(["editor.clearPrompt"]))))&&ht()},color:"error",children:G(Je||(Je=(0,i.Z)(["editor.btnClear"])))})}),(0,O.jsx)(j.ZP,{item:!0,children:!1}),st&&"edit"!==lt&&(0,O.jsx)(j.ZP,{item:!0,children:(0,O.jsx)(w.Z,{startIcon:(0,O.jsx)(v.Z,{}),onClick:function(){z.updateArt(me,st.id),L?ht():X(!1)},disabled:!me||!vt,color:"success",children:G(Qe||(Qe=(0,i.Z)(["editor.btnUpdate"])))})})]})]})]})})})}},57641:function(e,t,n){e.exports=n.p+"static/media/scan_art_main.66f01e51a69c518e4278.png"},82554:function(e,t,n){e.exports=n.p+"static/media/snippet.d223e79704fd95bcb783.png"}}]);
//# sourceMappingURL=292.2fd7b68f.chunk.js.map
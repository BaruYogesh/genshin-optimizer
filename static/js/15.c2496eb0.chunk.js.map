{"version":3,"sources":["Components/EquipmentDropdown.tsx","Character/CharacterUtil.tsx","Weapon/WeaponCard.tsx","Weapon/WeaponSelection.tsx","../node_modules/react-bootstrap/esm/ToastContext.js","../node_modules/react-bootstrap/esm/ToastHeader.js","../node_modules/react-bootstrap/esm/ToastBody.js","../node_modules/react-bootstrap/esm/Toast.js","FlexPage/CodingUtil.ts","FlexPage/Schemas.ts","FlexPage/FlexUtil.ts","FlexPage/FlexDisplay.tsx"],"names":["EquipmentDropdown","location","onEquip","weaponTypeKey","disableUnequip","editable","t","useTranslation","characterSheet","usePromise","CharacterSheet","get","locationName","name","nameWIthIcon","icon","faBriefcase","Toggle","className","Menu","Item","onClick","Divider","onSelect","getFormulaTargetsDisplayHeading","key","weaponSheet","artifactSheets","eleKey","startsWith","subkey","split","getTalentOfKey","setKey","num","variant","initialCharacter","level","ascension","hitMode","reactionMode","equippedArtifacts","Object","fromEntries","allSlotKeys","map","sKey","equippedWeapon","conditionalValues","baseStatOverrides","buildSettings","initialBuildSettings","talent","auto","skill","burst","infusionAura","constellation","WeaponCard","weaponId","onEdit","onDelete","cardClassName","bg","footer","database","useContext","DatabaseContext","useState","undefined","databaseWeapon","updateDatabaseWeapon","useEffect","followWeapon","weapon","WeaponSheet","refine","id","weaponType","weaponMainVal","getMainStatValue","toFixed","Stat","fixedUnit","weaponSubKey","getSubStatKey","weaponSubVal","getSubStatValue","weaponLevelName","getLevelString","statMap","passiveName","push","text","Header","src","Assets","weaponTypes","Body","xs","img","rarity","thumbnail","stars","colored","statKey","statVal","unit","getStatUnit","StatIcon","getStatName","process","Footer","charKey","setWeaponLocation","size","faEdit","disabled","faTrashAlt","filterReducer","oldFilter","newFilter","WeaponSelectionModal","show","onHide","filter","weaponSheets","getAll","useReducer","weaponFilter","weaponFilterDispatch","weaponIdList","Set","allWeaponKeys","wKey","sort","a","b","contentClassName","allWeaponTypeKeys","faTimes","weaponKey","lg","md","WeaponSelectionButton","setshow","as","ButtonGroup","ToastContext","React","createContext","onClose","_excluded","ToastHeader","forwardRef","_ref","ref","bsPrefix","closeLabel","closeButton","children","props","_objectWithoutPropertiesLoose","useBootstrapPrefix","context","handleClick","useEventCallback","e","createElement","_extends","classNames","CloseButton","label","displayName","defaultProps","createWithBsPrefix","Toast","_ref$transition","transition","Transition","Fade","_ref$show","_ref$animation","animation","_ref$delay","delay","_ref$autohide","autohide","delayRef","useRef","onCloseRef","current","autohideTimeout","useTimeout","autohideToast","autohideFunc","useCallback","set","toastContext","useMemo","hasAnimation","toast","role","Provider","value","in","unmountOnExit","assign","ToastBody","decode","string","schema","stream","BlockStream","result","decodeItem","end","encodeItem","data","pathItem","encode","type","uint","uintToString","length","encodeLength","encodeUInt","match","Error","encodeString","schemas","defaultSchema","item","i","join","encodeArray","entries","default","encodeObject","keySchema","keys","valueSchema","items","includes","encodeSparse","error","path","decodeLength","stringToUInt","take","decodeUInt","decodeString","Array","unused","decodeArray","decodeObject","decodeSparse","number","remainder","Math","floor","String","fromCharCode","padEnd","multiplier","code","charCodeAt","offset","this","count","slice","stats","float","toString","replace","parseFloat","array","other","object","sparse","optional","list","defaultValue","indexOf","index","fixed","stat","artifactSet","allArtifactSets","slot","characterKey","allCharacterKeys","allHitModes","allReactionModes","element","allElements","substat","factor","endsWith","crawlObject","c","isArray","pathvalues","artifact","character","last","pop","next","artifactV2","numStars","mainStatKey","slotKey","substats","art","lock","weaponV2","levelKey","refineIndex","overrideMainVal","overrideSubVal","lvla","parseInt","ascensionMaxLevel","findIndex","maxLevel","addAsc","characterV2","overrideLevel","talentLevelKeys","reserved","isAscended","levelString","characterLevel","weaponLevel","elementKey","flexV2","artifacts","artifactV3","raritySlotKey","weaponV3","ascensionRefine","levelDiff","characterV3","ascensionConstellation","flexV3","characters","weapons","createFlexObj","_getChar","_getWeapon","values","_getArt","parseFlexObj","parameters","s","v","decoded","newCharacterKey","toLowerCase","storage","SandboxStorage","setString","forEach","ArtCharDatabase","parseFlexObjV2","d","parseFlexObjV3","FlexDisplay","useLocation","searchStr","search","flexResult","substring","to","Database","Display","flexObj","window","scrollTo","settoast","url","href","Container","style","position","top","right","Card","InputGroup","Prepend","Button","navigator","clipboard","writeText","then","catch","console","faLink","Form","Control","readOnly","target","select","CharacterDisplayCard"],"mappings":"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","file":"static/js/15.c2496eb0.chunk.js","sourcesContent":["import { faBriefcase } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { Dropdown } from \"react-bootstrap\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport CharacterSheet from \"../Character/CharacterSheet\";\r\nimport { CharacterKey, WeaponTypeKey } from \"../Types/consts\";\r\nimport { usePromise } from \"../Util/ReactUtil\";\r\nimport { CharacterSelectionDropdownList } from \"../Character/CharacterSelection\";\r\n\r\nexport default function EquipmentDropdown({ location, onEquip, weaponTypeKey, disableUnequip = false, editable = false }: { location: CharacterKey | \"\", onEquip: (charKey: CharacterKey) => void, weaponTypeKey?: WeaponTypeKey, disableUnequip?: boolean, editable?: boolean }) {\r\n  const { t } = useTranslation([\"artifact\"]);\r\n  const characterSheet = usePromise(CharacterSheet.get(location), [location])\r\n  const locationName = characterSheet?.name ? characterSheet.nameWIthIcon : <span><FontAwesomeIcon icon={faBriefcase} /> {t`filterLocation.inventory`}</span>\r\n\r\n  return editable ? <Dropdown>\r\n    <Dropdown.Toggle className=\"text-left\">{locationName}</Dropdown.Toggle>\r\n    <Dropdown.Menu>\r\n      {!disableUnequip && <><Dropdown.Item onClick={() => { /* TODO */ }}><FontAwesomeIcon icon={faBriefcase} /> Inventory</Dropdown.Item>\r\n        <Dropdown.Divider /></>}\r\n      <CharacterSelectionDropdownList onSelect={onEquip} weaponTypeKey={weaponTypeKey} />\r\n    </Dropdown.Menu>\r\n  </Dropdown> : locationName\r\n}","import { Badge } from \"react-bootstrap\"\r\nimport { ArtifactSheet } from \"../Artifact/ArtifactSheet\"\r\nimport { initialBuildSettings } from \"../Build/BuildSetting\"\r\nimport { ICachedCharacter } from \"../Types/character\"\r\nimport { allSlotKeys, ArtifactSetKey, CharacterKey, ElementKey } from \"../Types/consts\"\r\nimport WeaponSheet from \"../Weapon/WeaponSheet\"\r\nimport CharacterSheet from \"./CharacterSheet\"\r\n\r\nexport function getFormulaTargetsDisplayHeading(key: string, { characterSheet, weaponSheet, artifactSheets }: { characterSheet: CharacterSheet, weaponSheet: WeaponSheet, artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet> }, eleKey: ElementKey = \"anemo\") {\r\n  if (key === \"basicKeys\") return \"Basic Stats\"\r\n  else if (key === \"genericAvgHit\") return \"Generic Optimization Values\"\r\n  else if (key === \"transReactions\") return \"Transformation Reaction\"\r\n  else if (key.startsWith(\"talentKey_\")) {\r\n    const subkey = key.split(\"talentKey_\")[1]\r\n    return (characterSheet?.getTalentOfKey(subkey, eleKey)?.name ?? subkey)\r\n  } else if (key.startsWith(\"weapon_\")) {\r\n    const subkey = key.split(\"weapon_\")[1]\r\n    return (weaponSheet?.name ?? subkey)\r\n  } else if (key.startsWith(\"artifact_\")) {\r\n    const [, setKey, num] = key.split('_')\r\n    return <span>{artifactSheets[setKey]?.name} <Badge variant=\"success\">{num}-Set</Badge></span>\r\n  }\r\n  return \"\"\r\n}\r\n\r\nexport function initialCharacter(key: CharacterKey): ICachedCharacter {\r\n  return {\r\n    key, // the game character this is based off\r\n    level: 1,\r\n    ascension: 0,\r\n    hitMode: \"avgHit\",\r\n    reactionMode: null,\r\n    equippedArtifacts: Object.fromEntries(allSlotKeys.map(sKey => [sKey, \"\"])) as any,\r\n    equippedWeapon: \"\",\r\n    conditionalValues: {},\r\n    baseStatOverrides: {}, // overriding the baseStat\r\n    buildSettings: initialBuildSettings(),\r\n    talent: {\r\n      auto: 1,\r\n      skill: 1,\r\n      burst: 1,\r\n    },\r\n    infusionAura: \"\",\r\n    constellation: 0,\r\n  }\r\n}","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { useContext, useEffect, useState } from \"react\"\r\nimport { Button, Card, Col, Image, Row } from \"react-bootstrap\"\r\nimport Assets from \"../Assets/Assets\"\r\nimport EquipmentDropdown from \"../Components/EquipmentDropdown\"\r\nimport { Stars } from \"../Components/StarDisplay\"\r\nimport StatIcon from \"../Components/StatIcon\"\r\nimport { DatabaseContext } from \"../Database/Database\"\r\nimport Stat from \"../Stat\"\r\nimport { CharacterKey } from \"../Types/consts\"\r\nimport { ICachedWeapon } from \"../Types/weapon\"\r\nimport { usePromise } from \"../Util/ReactUtil\"\r\nimport WeaponSheet from \"./WeaponSheet\"\r\n\r\ntype CharacterCardProps = { weaponId: string, onEdit?: (weaponId: string) => void, onClick?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, cardClassName: string, bg?: string, footer?: boolean, editable?: boolean }\r\nexport default function WeaponCard({ weaponId, onEdit, onDelete, onClick, cardClassName = \"\", bg = \"\", footer = false, editable = false }: CharacterCardProps) {\r\n  const database = useContext(DatabaseContext)\r\n  const [databaseWeapon, updateDatabaseWeapon] = useState(undefined as ICachedWeapon | undefined)\r\n  useEffect(() =>\r\n    weaponId ? database.followWeapon(weaponId, updateDatabaseWeapon) : undefined,\r\n    [weaponId, updateDatabaseWeapon, database])\r\n\r\n  const weapon = databaseWeapon\r\n  const weaponSheet = usePromise(weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\r\n\r\n  if (!weapon || !weaponSheet) return null;\r\n  const { level, ascension, refine, id } = weapon\r\n  const equipOnChar = (charKey: CharacterKey) => database.setWeaponLocation(weaponId, charKey)\r\n\r\n  const weaponTypeKey = weaponSheet.weaponType\r\n  const weaponMainVal = weaponSheet.getMainStatValue(level, ascension).toFixed(Stat.fixedUnit(\"atk\"))\r\n  const weaponSubKey = weaponSheet.getSubStatKey()\r\n  const weaponSubVal = weaponSheet.getSubStatValue(level, ascension).toFixed(Stat.fixedUnit(weaponSubKey))\r\n  const weaponLevelName = WeaponSheet.getLevelString(weapon)\r\n  const weaponPassiveName = weaponSheet?.passiveName\r\n  const statMap = [[\"weaponATK\", weaponMainVal]]\r\n  weaponPassiveName && statMap.push([weaponSubKey, weaponSubVal])\r\n\r\n  return (<Card className={cardClassName} bg={bg ? bg : \"darkcontent\"} text={\"lightfont\" as any}>\r\n    <Card.Header>\r\n      <Image src={Assets.weaponTypes?.[weaponTypeKey]} className=\"inline-icon\" /> <h5 className=\"d-inline\">{weaponSheet.name}</h5>\r\n    </Card.Header>\r\n    <Card.Body onClick={() => onClick?.(weaponId)} className={onClick ? \"cursor-pointer\" : \"\"} >\r\n      <Row>\r\n        <Col xs=\"auto\" className=\"pr-0\">\r\n          <Image src={weaponSheet.img} className={`thumb-big grad-${weaponSheet.rarity}star p-0`} thumbnail />\r\n        </Col>\r\n        <Col>\r\n          <h5 className=\"mb-0\">Level {weaponLevelName} </h5>\r\n          <h5 >Refinement {refine}</h5>\r\n          <h6 className=\"mb-0\"><Stars stars={weaponSheet.rarity} colored /></h6>\r\n          {/* <h3 className=\"mb-0\"></h3> */}\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        {statMap.map(([statKey, statVal]) => {\r\n          let unit = Stat.getStatUnit(statKey)\r\n          return <Col xs={12} key={statKey}>\r\n            <h6 className=\"d-inline\">{StatIcon[statKey]} {Stat.getStatName(statKey)}</h6>\r\n            <span className={`float-right`}>\r\n              {statVal + unit}\r\n            </span>\r\n          </Col>\r\n        })}\r\n      </Row>\r\n      {process.env.NODE_ENV === \"development\" && <span className=\"text-warning\">{id || `\"\"`} </span>}\r\n    </Card.Body>\r\n    {footer && <Card.Footer>\r\n      <Row>\r\n        <Col >\r\n          <EquipmentDropdown location={weapon?.location} onEquip={equipOnChar} weaponTypeKey={weaponTypeKey} disableUnequip={!!weapon.location} editable={editable} />\r\n        </Col>\r\n        <Col xs={\"auto\"}>\r\n          <span className=\"float-right align-top ml-1\">\r\n            {onEdit && <Button variant=\"primary\" size=\"sm\" className=\"mr-1\"\r\n              onClick={() => onEdit(weaponId)}>\r\n              <FontAwesomeIcon icon={faEdit} />\r\n            </Button>}\r\n            {onDelete && <Button variant=\"danger\" size=\"sm\"\r\n              disabled={!!weapon.location}\r\n              onClick={() => onDelete(weaponId)}>\r\n              <FontAwesomeIcon icon={faTrashAlt} />\r\n            </Button>}\r\n          </span>\r\n        </Col>\r\n      </Row>\r\n\r\n    </Card.Footer>}\r\n  </Card>)\r\n}","import { faTimes } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { useReducer, useState } from \"react\"\r\nimport { Button, ButtonGroup, Card, Col, Image, Modal, Row } from \"react-bootstrap\"\r\nimport Assets from \"../Assets/Assets\"\r\nimport { Stars } from \"../Components/StarDisplay\"\r\nimport { allWeaponKeys, allWeaponTypeKeys, WeaponKey } from \"../Types/consts\"\r\nimport { usePromise } from \"../Util/ReactUtil\"\r\nimport WeaponSheet from \"./WeaponSheet\"\r\ntype WeaponSelectionModalProps = {\r\n  show: boolean,\r\n  onHide: () => void,\r\n  onSelect: (wKey: WeaponKey) => void,\r\n  filter?: (sheet: WeaponSheet) => boolean\r\n}\r\n\r\nfunction filterReducer(oldFilter, newFilter) {\r\n  if (newFilter === oldFilter)\r\n    return \"\"\r\n  return newFilter\r\n}\r\n\r\nexport function WeaponSelectionModal({ show, onHide, onSelect, filter = () => true }: WeaponSelectionModalProps) {\r\n  const weaponSheets = usePromise(WeaponSheet.getAll(), [])\r\n  const [weaponFilter, weaponFilterDispatch] = useReducer(filterReducer, \"\")\r\n\r\n  const weaponIdList = !weaponSheets ? [] : [...new Set(allWeaponKeys)].filter(wKey => filter(weaponSheets[wKey]))\r\n    .filter(wKey => {\r\n      if (weaponFilter && weaponFilter !== weaponSheets?.[wKey]?.weaponType) return false\r\n      return true\r\n    })\r\n    .sort((a, b) => (weaponSheets?.[b]?.rarity ?? 0) - (weaponSheets?.[a]?.rarity ?? 0))\r\n\r\n  if (!weaponSheets) return null\r\n  return <Modal show={show} size=\"xl\" contentClassName=\"bg-transparent\" onHide={onHide}>\r\n    <Card bg=\"lightcontent\" text={\"lightfont\" as any}>\r\n      <Card.Header>\r\n        <Row>\r\n          <Col>\r\n            <ButtonGroup >\r\n              {allWeaponTypeKeys.map(weaponType =>\r\n                <Button key={weaponType} variant={(!weaponFilter || weaponFilter === weaponType) ? \"success\" : \"secondary\"} className=\"py-1 px-2\" onClick={() => weaponFilterDispatch(weaponType)}>\r\n                  <h3 className=\"mb-0\"><Image src={Assets.weaponTypes?.[weaponType]} className=\"inline-icon\" /></h3></Button>)}\r\n            </ButtonGroup>\r\n          </Col>\r\n          <Col xs=\"auto\">\r\n            <Button onClick={onHide} variant=\"danger\"><FontAwesomeIcon icon={faTimes} /></Button>\r\n          </Col>\r\n        </Row>\r\n      </Card.Header>\r\n      <Card.Body>\r\n        <Row>\r\n          {weaponIdList.map(weaponKey => {\r\n            const weaponSheet = weaponSheets[weaponKey]\r\n            return <Col key={weaponKey} lg={3} md={4} className=\"mb-2\">\r\n              <Button className=\"w-100 h-100 align-top\" variant=\"darkcontent\" onClick={() => { onHide(); onSelect(weaponKey) }}>\r\n                <Row className=\"h-100\">\r\n                  <Col xs=\"auto\" className=\"pr-0\">\r\n                    <Image src={weaponSheet.img} className={`thumb-big grad-${weaponSheet.rarity}star p-0`} thumbnail />\r\n                  </Col>\r\n                  <Col>\r\n                    <h5 className=\"mb-0\"><Image src={Assets.weaponTypes?.[weaponSheet.weaponType]} className=\"inline-icon\" /> {weaponSheet.name}</h5>\r\n                    <h6 className=\"mb-0\"><Stars stars={weaponSheet.rarity} colored /></h6>\r\n                  </Col>\r\n                </Row>\r\n              </Button>\r\n            </Col>\r\n          })}\r\n        </Row>\r\n      </Card.Body>\r\n    </Card>\r\n  </Modal>\r\n}\r\n\r\nexport function WeaponSelectionButton({ weaponSheet, onSelect, filter }: { weaponSheet?: WeaponSheet, onSelect: (wKey: WeaponKey) => void, filter?: (sheet: WeaponSheet) => boolean }) {\r\n  const [show, setshow] = useState(false)\r\n  return <>\r\n    <Button as={ButtonGroup} onClick={() => setshow(true)} className=\"text-nowrap\">{weaponSheet?.name ?? \"Select a Weapon\"}</Button>\r\n    <WeaponSelectionModal show={show} onHide={() => setshow(false)} onSelect={onSelect} filter={filter} />\r\n  </>\r\n}","import React from 'react'; // TODO: check\n\nvar ToastContext = /*#__PURE__*/React.createContext({\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClose: function onClose() {}\n});\nexport default ToastContext;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _excluded = [\"bsPrefix\", \"closeLabel\", \"closeButton\", \"className\", \"children\"];\nimport classNames from 'classnames';\nimport React, { useContext } from 'react';\nimport useEventCallback from '@restart/hooks/useEventCallback';\nimport { useBootstrapPrefix } from './ThemeProvider';\nimport CloseButton from './CloseButton';\nimport ToastContext from './ToastContext';\nvar defaultProps = {\n  closeLabel: 'Close',\n  closeButton: true\n};\nvar ToastHeader = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var bsPrefix = _ref.bsPrefix,\n      closeLabel = _ref.closeLabel,\n      closeButton = _ref.closeButton,\n      className = _ref.className,\n      children = _ref.children,\n      props = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  bsPrefix = useBootstrapPrefix(bsPrefix, 'toast-header');\n  var context = useContext(ToastContext);\n  var handleClick = useEventCallback(function (e) {\n    if (context && context.onClose) {\n      context.onClose(e);\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: ref\n  }, props, {\n    className: classNames(bsPrefix, className)\n  }), children, closeButton && /*#__PURE__*/React.createElement(CloseButton, {\n    label: closeLabel,\n    onClick: handleClick,\n    className: \"ml-2 mb-1\",\n    \"data-dismiss\": \"toast\"\n  }));\n});\nToastHeader.displayName = 'ToastHeader';\nToastHeader.defaultProps = defaultProps;\nexport default ToastHeader;","import createWithBsPrefix from './createWithBsPrefix';\nexport default createWithBsPrefix('toast-body');","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _excluded = [\"bsPrefix\", \"className\", \"children\", \"transition\", \"show\", \"animation\", \"delay\", \"autohide\", \"onClose\"];\nimport React, { useEffect, useMemo, useRef, useCallback } from 'react';\nimport classNames from 'classnames';\nimport useTimeout from '@restart/hooks/useTimeout';\nimport Fade from './Fade';\nimport ToastHeader from './ToastHeader';\nimport ToastBody from './ToastBody';\nimport { useBootstrapPrefix } from './ThemeProvider';\nimport ToastContext from './ToastContext';\nvar Toast = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var bsPrefix = _ref.bsPrefix,\n      className = _ref.className,\n      children = _ref.children,\n      _ref$transition = _ref.transition,\n      Transition = _ref$transition === void 0 ? Fade : _ref$transition,\n      _ref$show = _ref.show,\n      show = _ref$show === void 0 ? true : _ref$show,\n      _ref$animation = _ref.animation,\n      animation = _ref$animation === void 0 ? true : _ref$animation,\n      _ref$delay = _ref.delay,\n      delay = _ref$delay === void 0 ? 3000 : _ref$delay,\n      _ref$autohide = _ref.autohide,\n      autohide = _ref$autohide === void 0 ? false : _ref$autohide,\n      onClose = _ref.onClose,\n      props = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  bsPrefix = useBootstrapPrefix(bsPrefix, 'toast'); // We use refs for these, because we don't want to restart the autohide\n  // timer in case these values change.\n\n  var delayRef = useRef(delay);\n  var onCloseRef = useRef(onClose);\n  useEffect(function () {\n    delayRef.current = delay;\n    onCloseRef.current = onClose;\n  }, [delay, onClose]);\n  var autohideTimeout = useTimeout();\n  var autohideToast = !!(autohide && show);\n  var autohideFunc = useCallback(function () {\n    if (autohideToast) {\n      onCloseRef.current == null ? void 0 : onCloseRef.current();\n    }\n  }, [autohideToast]);\n  useEffect(function () {\n    // Only reset timer if show or autohide changes.\n    autohideTimeout.set(autohideFunc, delayRef.current);\n  }, [autohideTimeout, autohideFunc]);\n  var toastContext = useMemo(function () {\n    return {\n      onClose: onClose\n    };\n  }, [onClose]);\n  var hasAnimation = !!(Transition && animation);\n  var toast = /*#__PURE__*/React.createElement(\"div\", _extends({}, props, {\n    ref: ref,\n    className: classNames(bsPrefix, className, !hasAnimation && (show ? 'show' : 'hide')),\n    role: \"alert\",\n    \"aria-live\": \"assertive\",\n    \"aria-atomic\": \"true\"\n  }), children);\n  return /*#__PURE__*/React.createElement(ToastContext.Provider, {\n    value: toastContext\n  }, hasAnimation && Transition ? /*#__PURE__*/React.createElement(Transition, {\n    in: show,\n    unmountOnExit: true\n  }, toast) : toast);\n});\nToast.displayName = 'Toast';\nexport default Object.assign(Toast, {\n  Body: ToastBody,\n  Header: ToastHeader\n});","// @ts-nocheck\r\n// The *type* of these data are in schema and so are unknown at compile time.\r\n// Type annotation here will only amount to adding `any` everywhere\r\n\r\n/// Schema keys\r\n/// Common {\r\n///   encode?: A function that transform encoding object into the specified format\r\n///   decode?: A function that transform object in the specified format into the decoded object\r\n/// }\r\n///\r\n/// UInt: { type: \"uint\",\r\n///   length?: number of bytes, uses variable-length format if not set,\r\n/// }\r\n/// String: { type: \"string\" }\r\n/// Array: { type: \"array\",\r\n///   schemas?: Array of schemas, in the same order as the item,\r\n///   defaultSchema?: Default schema for when `schemas[i]` is `null`,\r\n/// }\r\n/// Object: { type: \"object\",\r\n///   schemas: A key-schema dictionary. All keys are encoded\r\n///   default: default value if the object[key] doesn't exist\r\n/// }\r\n/// Sparse: { type: \"sparse\",\r\n///   keys?: A list of permitted keys, `null` if all keys are permitted,\r\n///   keySchema: Common schema for keys,\r\n///   valueSchema: Common schema for values,\r\n/// }\r\n\r\nexport function encode(data, schema) {\r\n  return encodeItem(data, schema, null)\r\n}\r\nexport function decode(string, schema) {\r\n  const stream = new BlockStream(string)\r\n  const result = decodeItem(stream, schema, null)\r\n  stream.end()\r\n  return result\r\n}\r\n\r\nfunction encodeItem(data, schema, pathItem) {\r\n  try {\r\n    if (schema.encode)\r\n      data = schema.encode(data)\r\n    switch (schema.type) {\r\n      case \"uint\": return encodeUInt(data, schema)\r\n      case \"string\": return encodeString(data, schema)\r\n      case \"array\": return encodeArray(data, schema)\r\n      case \"object\": return encodeObject(data, schema)\r\n      case \"sparse\": return encodeSparse(data, schema)\r\n      default: throw new Error(`Unsupported schema type ${schema.type} on array`)\r\n    }\r\n  } catch (error) {\r\n    error.path = error.path ?? []\r\n    error.path.push(pathItem)\r\n    throw error\r\n  }\r\n}\r\nfunction decodeItem(stream, schema, pathItem) {\r\n  try {\r\n    let result\r\n    switch (schema.type) {\r\n      case \"uint\": result = decodeUInt(stream, schema); break\r\n      case \"string\": result = decodeString(stream, schema); break\r\n      case \"array\": result = decodeArray(stream, schema); break\r\n      case \"object\": result = decodeObject(stream, schema); break\r\n      case \"sparse\": result = decodeSparse(stream, schema); break\r\n      default: throw new Error(`Unsupported schema type ${schema.type} on array`)\r\n    }\r\n    if (schema.decode)\r\n      return schema.decode(result)\r\n    return result\r\n  } catch (error) {\r\n    error.path = error.path ?? []\r\n    error.path.push(pathItem)\r\n    throw error\r\n  }\r\n}\r\n\r\nfunction encodeSparse(data, schema) {\r\n  const { keySchema, keys, valueSchema } = schema\r\n  const items = Object.entries(data).filter(([key]) => keys?.includes(key) ?? true)\r\n\r\n  return encodeLength(items.length) + items.map(([key, value]) =>\r\n    encodeItem(key, keySchema, key) + encodeItem(value, valueSchema, key)\r\n  ).join('')\r\n}\r\nfunction decodeSparse(stream, schema) {\r\n  const { keys, keySchema, valueSchema } = schema\r\n  const length = decodeLength(stream)\r\n\r\n  return Object.fromEntries([...new Array(length)].map(() => {\r\n    const key = decodeItem(stream, keySchema, null)\r\n    const value = decodeItem(stream, valueSchema, key)\r\n    return [key, value]\r\n  }).filter(([key]) => keys?.includes(key) ?? true))\r\n}\r\n\r\nfunction encodeObject(data, schema: { schemas: any[], default: any }) {\r\n  const { schemas = [] } = schema\r\n  return Object.entries(schemas).map(([key, schema]) =>\r\n    encodeItem(key in data ? data[key] : schema.default, schema, key)\r\n  ).join('')\r\n}\r\nfunction decodeObject(stream, schema) {\r\n  const { schemas = [] } = schema\r\n  return Object.fromEntries(Object.entries(schemas).map(([key, schema]) =>\r\n    [key, decodeItem(stream, schema, key)]\r\n  ))\r\n}\r\n\r\nfunction encodeArray(data, schema) {\r\n  const { schemas = [], defaultSchema } = schema\r\n  return encodeLength(data.length) + data.map((item, i) =>\r\n    encodeItem(item, schemas[i] ?? defaultSchema, i)\r\n  ).join('')\r\n}\r\nfunction decodeArray(stream, schema) {\r\n  const { schemas = [], defaultSchema } = schema, length = decodeLength(stream)\r\n  return [...new Array(length)].map((unused, i) =>\r\n    decodeItem(stream, schemas[i] ?? defaultSchema, i))\r\n}\r\n\r\nfunction encodeString(string, schema) {\r\n  if (!string.match(/^[a-z0-9\\-_]*$/i))\r\n    throw new Error(`Cannot encode string ${string}: not alphanumeric or -_`)\r\n  return encodeLength(string.length) + string\r\n}\r\nfunction decodeString(stream, schema) {\r\n  const string = stream.take(decodeLength(stream))\r\n  if (!string.match(/^[a-z0-9\\-_]*$/i))\r\n    throw new Error(`Cannot decode string ${string}: not alphanumeric or -_`)\r\n  return string\r\n}\r\n\r\nfunction encodeUInt(uint, schema) {\r\n  const string = uintToString(uint, schema.length)\r\n  return schema.length ? string : (encodeLength(string.length) + string)\r\n}\r\nfunction decodeUInt(stream, schema) {\r\n  let length = schema.length || decodeLength(stream)\r\n  return stringToUInt(stream.take(length))\r\n}\r\n\r\n// Keep the length low. We might want to reserve high bits for later extension.\r\nfunction encodeLength(length) {\r\n  if (length >= 32)\r\n    throw new Error(`Length (${length}) too large`)\r\n  return uintToString(length, 1)\r\n}\r\nfunction decodeLength(stream) {\r\n  let length = stringToUInt(stream.take(1))\r\n  if (length >= 32)\r\n    throw new Error(`Length (${length}) too large`)\r\n  return length\r\n}\r\n\r\nexport function uintToString(number, length = 0) {\r\n  if (number < 0) throw new Error(`Cannot encode negative number ${number}`)\r\n\r\n  var string = \"\"\r\n  while (number > 0) {\r\n    const remainder = number % 64\r\n    number = Math.floor(number / 64)\r\n    if (remainder < 10) // 0-9\r\n      string += String.fromCharCode(remainder + 48 - 0)\r\n    else if (remainder < 36) // a-z\r\n      string += String.fromCharCode(remainder + 97 - 10)\r\n    else if (remainder < 62) // A-Z\r\n      string += String.fromCharCode(remainder + 65 - 36)\r\n    else if (remainder === 62) // -\r\n      string += \"-\"\r\n    else if (remainder === 63) // _\r\n      string += \"_\"\r\n  }\r\n\r\n  if (!length)\r\n    return string\r\n\r\n  if (string.length > length)\r\n    throw new Error(`Cannot encode uint ${number}: value too large`)\r\n  return string.padEnd(length, \"0\")\r\n}\r\nexport function stringToUInt(string) {\r\n  let result = 0, multiplier = 1\r\n\r\n  for (let i = 0; i < string.length; i++) {\r\n    let code = string.charCodeAt(i)\r\n\r\n    if (48 <= code && code < 58) // 0-9\r\n      result += multiplier * (code - 48 + 0)\r\n    else if (97 <= code && code < 123) // a-z\r\n      result += multiplier * (code - 97 + 10)\r\n    else if (65 <= code && code < 91) // A-Z\r\n      result += multiplier * (code - 65 + 36)\r\n    else if (string[i] === '-')\r\n      result += multiplier * 62\r\n    else if (string[i] === '_')\r\n      result += multiplier * 63\r\n    else throw new Error(`Cannot parse UInt from \"${string}\", which contains \"${String.fromCharCode(code)}\"`)\r\n\r\n    multiplier *= 64\r\n  }\r\n\r\n  return result\r\n}\r\n\r\nclass BlockStream {\r\n  string: string\r\n  offset: number\r\n  constructor(string) {\r\n    this.string = string\r\n    this.offset = 0\r\n  }\r\n  take(count) {\r\n    if (this.offset + count > this.string.length)\r\n      throw new Error(`Cannot take ${count} items from ${this.string.slice(this.offset)}`)\r\n\r\n    const result = this.string.slice(this.offset, this.offset + count)\r\n    this.offset += count\r\n    return result\r\n  }\r\n  end() {\r\n    if (this.string.length !== this.offset)\r\n      throw new Error(`Unused string ${this.string.slice(this.offset)}`)\r\n  }\r\n}\r\n","import { ascensionMaxLevel } from \"../Data/CharacterData\"\r\nimport { allSlotKeys, allElements, allArtifactSets, allHitModes, allReactionModes, allCharacterKeys, CharacterKey } from \"../Types/consts\"\r\nimport { crawlObject } from \"../Util/Util\"\r\nimport { uintToString, stringToUInt } from \"./CodingUtil\"\r\n\r\n// DO NOT REMOVE ITEMS FROM THESE LISTS\r\n//        ONLY APPEND NEW ENTRIES\r\n// The index of items in this list is used to\r\n// compress the exported data. Removing an item\r\n// from this list will shift subsequent entries.\r\nconst stats = [\r\n  \"\", \"hp\", \"hp_\", \"atk\", \"atk_\", \"def\", \"def_\", \"eleMas\", \"enerRech_\", \"critRate_\", \"critDMG_\", \"heal_\",\r\n  \"physical_dmg_\", \"anemo_dmg_\", \"cryo_dmg_\", \"dendro_dmg_\", \"electro_dmg_\", \"geo_dmg_\", \"hydro_dmg_\", \"pyro_dmg_\",\r\n] as const\r\n\r\n// Common schemas\r\n\r\nconst uint = (length) => ({ type: \"uint\", length })\r\nconst float = {\r\n  type: \"string\",\r\n  encode: (value) => value.toString().replace(/\\./g, '_'),\r\n  decode: (string) => parseFloat(string.replace(/_/g, '.')),\r\n}\r\nconst string = { type: \"string\" }\r\nconst array = (defaultSchema, other = {}) => ({ type: \"array\", defaultSchema, ...other })\r\nconst object = (schemas, other = {}) => ({ type: \"object\", schemas, ...other })\r\nconst sparse = (keySchema, valueSchema, keys = null) => ({ type: \"sparse\", keys, keySchema, valueSchema })\r\n\r\n// Util schema\r\n\r\nconst optional = (list, defaultValue: any = undefined, length = 1) => ({\r\n  type: \"uint\", length,\r\n  encode: item => list.indexOf(item) + 1,\r\n  decode: index => list[index - 1] ?? defaultValue,\r\n})\r\nconst fixed = (list, length = 1) => ({\r\n  type: \"uint\", length,\r\n  encode: (item) => list.indexOf(item),\r\n  decode: (index) => list[index],\r\n})\r\nconst stat = fixed(stats)\r\nconst artifactSet = fixed(allArtifactSets)\r\nconst slot = fixed(allSlotKeys)\r\nconst characterKey = fixed(allCharacterKeys)\r\nconst hitMode = fixed(allHitModes)\r\nconst reactionMode = fixed([null, ...allReactionModes])\r\nconst element = optional(allElements, '')\r\n\r\n// Complex schema\r\n\r\nconst substat = object({\r\n  key: stat,\r\n  value: uint(2),\r\n}, {\r\n  encode: ({ key, value }) => {\r\n    let factor = key.endsWith(\"_\") ? 10 : 1 // one decimal place for percentage\r\n    return { key, value: value * factor }\r\n  },\r\n  decode: ({ key, value }) => {\r\n    let factor = key.endsWith(\"_\") ? 10 : 1 // one decomal place for percentage\r\n    return { key, value: value / factor }\r\n  }\r\n})\r\nconst conditionalValues = array(object({\r\n  path: array(string), value: array(string)\r\n}), {\r\n  encode: (conditionalValues) => {\r\n    let result: { path, value }[] = []\r\n    crawlObject(conditionalValues, [], c => Array.isArray(c), (value, path) => {\r\n      result.push({ path, value: value.map(item => item.toString()) })\r\n    })\r\n    result.filter(({ path }) => {\r\n      switch (path[0]) {\r\n        case \"character\":\r\n          path[0] = \"c\"\r\n          path[1] = uintToString(allCharacterKeys.indexOf(path[1]))\r\n          break\r\n        case \"weapon\":\r\n          path[0] = \"w\"\r\n          break\r\n        case \"artifact\":\r\n          path[0] = \"a\"\r\n          path[1] = uintToString(allArtifactSets.indexOf(path[1]))\r\n          break\r\n        default: return false\r\n      }\r\n      return true\r\n    })\r\n    return result\r\n  },\r\n  decode: (pathvalues) => {\r\n    const conditionalValues = { weapon: {}, artifact: {}, character: {} }\r\n    for (const { path, value } of pathvalues) {\r\n      switch (path[0]) {\r\n        case \"c\":\r\n          path[0] = \"character\"\r\n          path[1] = allCharacterKeys[stringToUInt(path[1])]\r\n          break\r\n        case \"w\":\r\n          path[0] = \"weapon\"\r\n          break\r\n        case \"a\":\r\n          path[0] = \"artifact\"\r\n          path[1] = allArtifactSets[stringToUInt(path[1])]\r\n          break\r\n        default:\r\n          continue\r\n      }\r\n      const last = path.pop()\r\n      let current = conditionalValues\r\n      for (const key of path) {\r\n        const next = current[key] ?? {}\r\n        current[key] = next\r\n        current = next\r\n      }\r\n      value[0] = parseFloat(value[0])\r\n      current[last] = value\r\n    }\r\n    return conditionalValues\r\n  }\r\n})\r\n\r\n// V2\r\n\r\nconst artifactV2 = object({\r\n  setKey: artifactSet,\r\n  numStars: uint(1),\r\n  level: uint(2),\r\n  mainStatKey: stat,\r\n  slotKey: slot,\r\n  substats: array(substat)\r\n}, {\r\n  decode: art => {\r\n    art.id = \"\"\r\n    art.lock = false\r\n    return art\r\n  }\r\n})\r\nconst weaponV2 = object({\r\n  key: string,\r\n  levelKey: string,\r\n  refineIndex: uint(1),\r\n  overrideMainVal: float,\r\n  overrideSubVal: float,\r\n}, {\r\n  decode: object => {\r\n    const levelKey = object.levelKey\r\n    delete object.levelKey\r\n    delete object.overrideMainVal\r\n    delete object.overrideSubVal\r\n    const [, lvla] = levelKey.split(\"L\")\r\n    const level = parseInt(lvla)\r\n    const ascension = ascensionMaxLevel.findIndex(maxLevel => level <= maxLevel)\r\n    const addAsc = lvla.includes(\"A\")\r\n    if (level < 0 || level > 90 || ascension < 0) {\r\n      object.level = 1\r\n      object.ascension = 0\r\n    } else {\r\n      object.level = level\r\n      object.ascension = ascension + (addAsc ? 1 : 0)\r\n    }\r\n    return object\r\n  }\r\n})\r\nconst characterV2 = object({\r\n  characterKey,\r\n  hitMode,\r\n  reactionMode,\r\n  constellation: uint(1),\r\n  overrideLevel: uint(2),\r\n  levelKey: string,\r\n  infusionAura: element,\r\n  talentLevelKeys: object({ auto: uint(1), skill: uint(1), burst: uint(1) }),\r\n  baseStatOverrides: sparse(string, float),\r\n  weapon: weaponV2,\r\n  conditionalValues,\r\n  reserved: array(uint(1)),\r\n}, {\r\n  decode: (value) => {\r\n    const isAscended = value.levelKey.slice(-1) === \"A\"\r\n    const levelString = isAscended ? value.levelKey.slice(1, -1) : value.levelKey.slice(1)\r\n    value.level = parseInt(levelString)\r\n    switch (value.level) {\r\n      case 1: value.ascension = 0; break\r\n      case 20: value.ascension = 0; break\r\n      case 40: value.ascension = 1; break\r\n      case 50: value.ascension = 2; break\r\n      case 60: value.ascension = 3; break\r\n      case 70: value.ascension = 4; break\r\n      case 80: value.ascension = 5; break\r\n      case 90: value.ascension = 6; break\r\n    }\r\n    if (isAscended) {\r\n      value.ascension += 1\r\n    }\r\n    if (value.baseStatOverrides.characterLevel) {\r\n      value.level = value.baseStatOverrides.characterLevel\r\n      delete value.baseStatOverrides.characterLevel\r\n    }\r\n    if (value.baseStatOverrides.weaponLevel) {\r\n      value.weapon.level = value.baseStatOverrides.weaponLevel\r\n      delete value.baseStatOverrides.weaponLevel\r\n    }\r\n    if (value.overrideLevel) {\r\n      value.level = value.overrideLevel\r\n    }\r\n    delete value.overrideLevel\r\n    delete value.levelKey\r\n\r\n    if (value.characterKey === \"Traveler\") {\r\n      value.elementKey = allElements[value.reserved[0] - 1] ?? \"anemo\"\r\n    }\r\n    delete value.reserved\r\n    return value\r\n  },\r\n})\r\n\r\nconst flexV2 = object({\r\n  artifacts: array(artifactV2),\r\n  character: characterV2,\r\n})\r\n\r\n// V3\r\n\r\nconst artifactV3 = object({\r\n  setKey: artifactSet,\r\n  // numStars\r\n  level: uint(2),\r\n  // slotKey\r\n  mainStatKey: stat,\r\n  substats: array(substat),\r\n  location: optional(allCharacterKeys),\r\n\r\n  // Mixed\r\n  raritySlotKey: uint(1),\r\n}, {\r\n  encode: value => {\r\n    value.raritySlotKey = allSlotKeys.indexOf(value.slotKey) * 8 + value.rarity\r\n    return value\r\n  },\r\n  decode: value => {\r\n    value.rarity = value.raritySlotKey % 8\r\n    value.slotKey = allSlotKeys[(value.raritySlotKey - value.rarity) / 8]\r\n    return value\r\n  }\r\n})\r\nconst weaponV3 = object({\r\n  key: string,\r\n  // level, ascension, refine\r\n  location: optional(allCharacterKeys),\r\n\r\n  // Mixed\r\n  ascensionRefine: uint(1),\r\n  levelDiff: uint(1),\r\n}, {\r\n  encode: object => {\r\n    object.ascensionRefine = object.ascension * 8 + object.refine\r\n    object.levelDiff = ascensionMaxLevel[object.ascension] - object.level\r\n    return object\r\n  },\r\n  decode: object => {\r\n    object.refine = object.ascensionRefine % 8\r\n    object.ascension = (object.ascensionRefine - object.refine) / 8\r\n    object.level = ascensionMaxLevel[object.ascension] - object.levelDiff\r\n    return object\r\n  }\r\n})\r\nconst characterV3 = object({\r\n  key: characterKey,\r\n  // level, ascension\r\n  hitMode,\r\n  // elementKey\r\n  reactionMode,\r\n  conditionalValues,\r\n  baseStatOverrides: sparse(string, float),\r\n  talent: object({ auto: uint(1), skill: uint(1), burst: uint(1) }),\r\n  infusionAura: element,\r\n  // constellation\r\n\r\n  // Mixed\r\n  levelDiff: uint(1),\r\n  ascensionConstellation: uint(1),\r\n  reserved: array(uint(1)),\r\n}, {\r\n  encode: (value) => {\r\n    value.levelDiff = ascensionMaxLevel[value.ascension] - value.level\r\n    value.ascensionConstellation = value.ascension * 8 + value.constellation\r\n\r\n    if ((value.characterKey as CharacterKey) !== \"Traveler\") value.reserved = []\r\n    else value.reserved = [allElements.indexOf(value.elementKey)]\r\n\r\n    return value\r\n  },\r\n  decode: (value) => {\r\n    value.constellation = value.ascensionConstellation % 8\r\n    value.ascension = (value.ascensionConstellation - value.constellation) / 8\r\n    value.level = ascensionMaxLevel[value.ascension] - value.levelDiff\r\n\r\n    if ((value.characterKey as CharacterKey) === \"Traveler\")\r\n      value.elementKey = allElements[value.reserved[0]] ?? \"anemo\"\r\n    return value\r\n  },\r\n})\r\n\r\nconst flexV3 = object({\r\n  characters: array(characterV3),\r\n  artifacts: array(artifactV3),\r\n  weapons: array(weaponV3),\r\n})\r\n\r\nexport const schemas = {\r\n  flexV2, flexV3\r\n}\r\n// For testing purpose only, no need to maintain strict ordering\r\nexport const constants = {\r\n  reactionModes: [null, ...allReactionModes], stats\r\n}\r\n","import { ArtCharDatabase } from \"../Database/Database\";\r\nimport { SandboxStorage } from \"../Database/DBStorage\";\r\nimport { IArtifact } from \"../Types/artifact\";\r\nimport { CharacterKey } from \"../Types/consts\";\r\nimport { decode, encode } from \"./CodingUtil\";\r\nimport { schemas } from \"./Schemas\";\r\n\r\nexport function createFlexObj(characterKey: CharacterKey, database: ArtCharDatabase): string | null {\r\n  const character = database._getChar(characterKey)\r\n  if (!character) return null;\r\n\r\n  const weapon = database._getWeapon(character.equippedWeapon)!\r\n  const artifacts = Object.values(character.equippedArtifacts)\r\n    .filter(art => art)\r\n    .map(id => database._getArt(id)!)\r\n\r\n  try {\r\n    return \"v=3&d=\" + encode({ characters: [character], weapons: [weapon], artifacts }, schemas.flexV3)\r\n  } catch (error) {\r\n    if (process.env.NODE_ENV === \"development\")\r\n      console.error(`Fail to encode data on path ${(error as any).path?.reverse() ?? []}: ${error}`)\r\n    return null\r\n  }\r\n}\r\n\r\nexport function parseFlexObj(string: string): [ArtCharDatabase, CharacterKey, number] | undefined {\r\n  const parameters = Object.fromEntries(string.split('&').map(s => s.split('=')))\r\n\r\n  try {\r\n    switch (parseInt(parameters.v)) {\r\n      case 2: return [...parseFlexObjV2(parameters.d), 2]\r\n      case 3: return [...parseFlexObjV3(parameters.d), 3]\r\n      default: return\r\n    }\r\n  } catch (error) {\r\n    if (process.env.NODE_ENV === \"development\")\r\n      console.error(`Fail to encode data on path ${(error as any).path?.reverse() ?? []}: ${error}`)\r\n    return\r\n  }\r\n}\r\n\r\nfunction parseFlexObjV2(string: string): [ArtCharDatabase, CharacterKey] {\r\n  const schema = schemas.flexV2\r\n  const decoded = decode(string, schema) as { character: any, artifacts: IArtifact[] }\r\n  const { character, artifacts } = decoded, newCharacterKey = character.characterKey, characterKey = newCharacterKey.toLowerCase() as CharacterKey\r\n  character.characterKey = characterKey\r\n\r\n  const storage = new SandboxStorage()\r\n  // DON'T CHANGE THIS.\r\n  // Flex v2 (decoding) scheme won't be updated even when newer\r\n  // db versions come along. So the object created from the url\r\n  // will remain a valid dbv7. The actual migration happens\r\n  // together with the validation down below.\r\n  storage.setString(\"db_ver\", \"7\")\r\n\r\n  storage.set(`char_${characterKey}`, character)\r\n  artifacts.forEach((artifact, i) => {\r\n    artifact.location = characterKey\r\n    storage.set(`artifact_${i + 1}`, artifact)\r\n  })\r\n\r\n  const database = new ArtCharDatabase(storage) // Validate storage\r\n\r\n  if (!database._getChar(newCharacterKey))\r\n    throw new Error(`Invalid flex object`)\r\n  return [database, newCharacterKey]\r\n}\r\n\r\nfunction parseFlexObjV3(string: string): [ArtCharDatabase, CharacterKey] {\r\n  const schema = schemas.flexV3\r\n  const { characters, artifacts, weapons } = decode(string, schema) as { characters: { key: CharacterKey }[], artifacts: any[], weapons: any[] }\r\n  const charKey = characters[0].key\r\n\r\n  const storage = new SandboxStorage()\r\n  // DON'T CHANGE THIS.\r\n  // Flex v3 (decoding) scheme won't be updated even when newer\r\n  // db versions come along. So the object created from the url\r\n  // will remain a valid dbv8. The actual migration happens\r\n  // together with the validation down below.\r\n  storage.setString(\"db_ver\", \"8\")\r\n\r\n  characters.forEach(character => storage.set(`char_${character.key}`, character))\r\n  artifacts.forEach((artifact, i) => storage.set(`artifact_${i}`, artifact))\r\n  weapons.forEach((weapon, i) => storage.set(`weapon_${i}`, weapon))\r\n\r\n  const database = new ArtCharDatabase(storage) // Validate storage\r\n\r\n  if (!database._getChar(charKey as any))\r\n    throw new Error(`Invalid flex object`)\r\n  return [database, charKey]\r\n}\r\n","import { Alert, Button, Card, Container, Form, InputGroup, Toast } from \"react-bootstrap\";\r\nimport { Redirect, useLocation } from \"react-router-dom\";\r\nimport CharacterDisplayCard from \"../Character/CharacterDisplayCard\";\r\nimport '../StatDependency'\r\nimport { createFlexObj, parseFlexObj } from \"./FlexUtil\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faLink } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { useContext, useState } from \"react\";\r\nimport { DatabaseContext } from \"../Database/Database\";\r\n\r\nexport default function FlexDisplay() {\r\n  const location = useLocation()\r\n  const database = useContext(DatabaseContext)\r\n  const searchStr = location.search\r\n  if (searchStr) {\r\n    const flexResult = parseFlexObj(searchStr.substring(1))\r\n    if (!flexResult) return <Redirect to={`/`} />\r\n    const [database, charKey, version] = flexResult\r\n    if (version !== 3)\r\n      return <Redirect to={`/flex?${createFlexObj(charKey, database)}`} />\r\n    return <DatabaseContext.Provider value={database}><Display characterKey={charKey} /></DatabaseContext.Provider>\r\n  } else {\r\n    const characterKey = (location as any).characterKey\r\n    if (!characterKey) return <Redirect to={`/`} />\r\n    const flexObj = createFlexObj(characterKey, database)\r\n    if (!flexObj) return <Redirect to={`/`} />\r\n    window.scrollTo(0, 0)//sometimes the window isnt scrolled to the top on redirect.\r\n    return <Redirect to={`/flex?${flexObj}`} />\r\n  }\r\n}\r\nfunction Display({ characterKey }) {\r\n  const [toast, settoast] = useState(false)\r\n  const url = window.location.href\r\n  const copyToClipboard = () => {\r\n    navigator.clipboard.writeText(url).then(() => settoast(true)).catch(console.error)\r\n  }\r\n  const isUpToDate = false\r\n  return <Container className=\"my-2\">\r\n    <Toast onClose={() => settoast(false)} show={toast} delay={3000} autohide style={{\r\n      position: 'absolute',\r\n      top: 50,\r\n      right: 50,\r\n    }}>\r\n      <Toast.Header><b className=\"mr-auto\">Genshin Optimizer</b></Toast.Header>\r\n      <Toast.Body>URL copied to clipboard.</Toast.Body>\r\n    </Toast>\r\n    <Card bg=\"darkcontent\" text={\"lightfont\" as any} className=\"mb-2\">\r\n      <Card.Body className=\"p-2\">\r\n        <InputGroup className=\"mb-0\">\r\n          <InputGroup.Prepend>\r\n            <Button onClick={copyToClipboard}>\r\n              <span><FontAwesomeIcon icon={faLink} /> Copy URL to clipboard</span>\r\n            </Button>\r\n          </InputGroup.Prepend>\r\n          <Form.Control readOnly value={window.location.href} onClick={e => e.target.select()} />\r\n        </InputGroup>\r\n        {isUpToDate && <Alert variant=\"warning\" className=\"py-2 mt-2 mb-0\">This URL is generated on an older database version of Genshin Optimizer. The character data below might not be displayed as intended.</Alert>}\r\n      </Card.Body>\r\n    </Card>\r\n    <CharacterDisplayCard characterKey={characterKey} editable={true} />\r\n  </Container>\r\n}"],"sourceRoot":""}
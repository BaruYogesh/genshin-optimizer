{"version":3,"file":"static/js/418.21a7d57b.chunk.js","mappings":"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","sources":["Components/Artifact/ArtifactLevelSlider.tsx","Components/Artifact/ArtifactSetDropdown.tsx","Components/InfoComponent.tsx","Components/StatFilterCard.tsx","GlobalSettings.tsx","PageBuild/BackgroundWorker.ts","PageBuild/ChartCard.tsx","PageBuild/common.ts","Components/Artifact/ArtifactCardNano.tsx","Components/Weapon/WeaponCardNano.tsx","PageBuild/Components/ArtifactBuildDisplayItem.tsx","PageBuild/Components/ArtifactConditionalCard.tsx","PageBuild/Components/ArtifactSetPicker.tsx","PageBuild/Components/BonusStatsCard.tsx","PageBuild/Components/BuildAlert.tsx","PageBuild/Components/EnemyEditorCard.tsx","PageBuild/Components/HitModeCard.tsx","PageBuild/Components/MainStatSelectionCard.tsx","PageBuild/Components/OptimizationTargetSelector.tsx","PageBuild/Components/TeamBuffCard.tsx","PageBuild/foreground.ts","PageBuild/BuildDisplay.tsx","ReactHooks/useCharacter.tsx","ReactHooks/useDBState.tsx","Util/TimeUtil.ts"],"sourcesContent":["import { Card, Slider } from \"@mui/material\"\r\nimport { useCallback, useEffect, useState } from \"react\"\r\nimport { clamp } from \"../../Util/Util\"\r\nimport CustomNumberInput from \"../CustomNumberInput\"\r\n\r\nexport default function ArtifactLevelSlider({ levelLow, levelHigh, setLow, setHigh, setBoth, dark = false, disabled = false }: {\r\n  levelLow: number,\r\n  levelHigh: number,\r\n  setLow: (low: number) => void,\r\n  setHigh: (high: number) => void,\r\n  setBoth: (low: number, high: number) => void,\r\n  dark?: boolean,\r\n  disabled?: boolean,\r\n}) {\r\n  const [sliderLow, setsliderLow] = useState(levelLow)\r\n  const [sliderHigh, setsliderHigh] = useState(levelHigh)\r\n  const setSlider = useCallback(\r\n    (e, [l, h]) => {\r\n      setsliderLow(l)\r\n      setsliderHigh(h)\r\n    },\r\n    [setsliderLow, setsliderHigh])\r\n  useEffect(() => setsliderLow(levelLow), [setsliderLow, levelLow])\r\n\r\n  useEffect(() => setsliderHigh(levelHigh), [setsliderHigh, levelHigh])\r\n  return <Card sx={{ width: \"100%\", display: \"flex\", alignItems: \"center\", bgcolor: dark ? \"contentDark.main\" : \"contentLight.main\" }}>\r\n    <CustomNumberInput\r\n      value={sliderLow}\r\n      onChange={val => setLow(clamp(val, 0, levelHigh))}\r\n      sx={{ pl: 2, width: 100, }}\r\n      inputProps={{ sx: { textAlign: \"center\" } }}\r\n      startAdornment={\"Level: \"}\r\n      disabled={disabled}\r\n    />\r\n    <Slider sx={{ width: 100, flexGrow: 1, mx: 2 }}\r\n      getAriaLabel={() => 'Arifact Level Range'}\r\n      value={[sliderLow, sliderHigh]}\r\n      onChange={setSlider}\r\n      onChangeCommitted={(e, value) => setBoth(value[0], value[1])}\r\n      valueLabelDisplay=\"auto\"\r\n      min={0} max={20} step={1} marks\r\n      disabled={disabled}\r\n    />\r\n    <CustomNumberInput\r\n      value={sliderHigh}\r\n      onChange={val => setHigh(clamp(val, levelLow, 20))}\r\n      sx={{ px: 1, width: 50, }}\r\n      inputProps={{ sx: { textAlign: \"center\" } }}\r\n      disabled={disabled}\r\n    />\r\n  </Card>\r\n}\r\n","import { Replay } from \"@mui/icons-material\";\r\nimport { ButtonProps, Divider, ListItemIcon, ListItemText, MenuItem, Typography } from \"@mui/material\";\r\nimport React, { useMemo } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport { ArtifactRarity, ArtifactSetKey, Rarity } from \"../../Types/consts\";\r\nimport DropdownButton from \"../DropdownMenu/DropdownButton\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport { Stars } from \"../StarDisplay\";\r\n\r\ntype props = Omit<ButtonProps, \"onChange\"> & {\r\n  selectedSetKey?: ArtifactSetKey | \"\"\r\n  onChange: (setKey: ArtifactSetKey | \"\") => void\r\n  hasUnselect?: boolean\r\n  artifactSetsByRarity?: { [rarity in ArtifactRarity]: ArtifactSetKey[] }\r\n}\r\nexport default function ArtifactSetDropdown({ selectedSetKey = \"\", onChange, artifactSetsByRarity, hasUnselect = false, ...props }: props) {\r\n  const { t } = useTranslation(\"artifact\")\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const sheet = artifactSheets?.[selectedSetKey]\r\n  const displaySets = useMemo(() => {\r\n    if (artifactSetsByRarity) return artifactSetsByRarity\r\n    if (!artifactSheets) return {}\r\n    return ArtifactSheet.setKeysByRarities(artifactSheets)\r\n  }, [artifactSheets, artifactSetsByRarity])\r\n  return <DropdownButton\r\n    {...props}\r\n    title={sheet?.name ?? t`editor.set.artifactSet`}\r\n    startIcon={sheet?.defIconSrc && <ImgIcon src={sheet?.defIconSrc} />}\r\n    color={sheet ? \"success\" : \"primary\"}\r\n  >\r\n    {hasUnselect && <MenuItem onClick={() => onChange(\"\")} selected={selectedSetKey === \"\"} disabled={selectedSetKey === \"\"}>\r\n      <ListItemIcon>\r\n        <Replay />\r\n      </ListItemIcon>\r\n      <ListItemText>\r\n        <Trans t={t} i18nKey=\"ui:unselect\" >Unselect</Trans>\r\n      </ListItemText>\r\n    </MenuItem >}\r\n    {!!Object.keys(displaySets).length && Object.entries(displaySets).reverse().flatMap(([star, sets], i) => [\r\n      ...(((i > 0) || hasUnselect) && sets.length ? [<Divider key={`${star}divi`} />] : []),\r\n      ...(sets.length ? [<MenuItem key={`${star}header`} >\r\n        <Typography>\r\n          <Trans t={t} i18nKey=\"editor.set.maxRarity\">Max Rarity <Stars stars={parseInt(star) as Rarity} /></Trans>\r\n        </Typography>\r\n      </MenuItem>] : []),\r\n      ...sets.map(setKey => <MenuItem key={setKey} onClick={() => onChange(setKey)} selected={selectedSetKey === setKey} disabled={selectedSetKey === setKey}>\r\n        <ListItemIcon>\r\n          <ImgIcon src={artifactSheets?.[setKey]?.defIconSrc} sx={{ fontSize: \"1.5em\" }} />\r\n        </ListItemIcon>\r\n        <ListItemText>\r\n          {artifactSheets?.[setKey]?.name}\r\n        </ListItemText>\r\n      </MenuItem >)\r\n    ])}\r\n  </DropdownButton>\r\n}\r\n","import { faQuestionCircle } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { Button, CardContent, Divider, Grid, Skeleton, Typography } from \"@mui/material\"\r\nimport { Suspense, useCallback, useState } from \"react\"\r\nimport useDBState from \"../ReactHooks/useDBState\"\r\nimport { getRandomElementFromArray } from \"../Util/Util\"\r\nimport CardDark from \"./Card/CardDark\"\r\nimport CloseButton from \"./CloseButton\"\r\nimport ModalWrapper from \"./ModalWrapper\"\r\nimport { Translate } from \"./Translate\"\r\nexport function initialInfoShownState() {\r\n  return {\r\n    artifactPage: true,\r\n    buildPage: true,\r\n    characterPage: true,\r\n  }\r\n}\r\ntype StateInfoShown = ReturnType<typeof initialInfoShownState>\r\ntype InfoShownPageKey = keyof StateInfoShown\r\n\r\nexport default function InfoComponent({ pageKey, text = \"\", modalTitle = \"\", children }: { pageKey: InfoShownPageKey, text: Displayable | Displayable[], modalTitle: Displayable, children: JSX.Element }) {\r\n  const [stateInfoShown, setStateInfoShown] = useDBState(\"InfoShown\", initialInfoShownState)\r\n  const showInfoModal = stateInfoShown[pageKey]\r\n  const setshowInfoModal = useCallback((value: boolean) => setStateInfoShown({ [pageKey]: value }), [setStateInfoShown, pageKey])\r\n\r\n  const [displayText,] = useState(Array.isArray(text) ? getRandomElementFromArray(text) : text)\r\n  const closeModal = () => setshowInfoModal(false)\r\n\r\n  return <CardDark >\r\n    <Grid container>\r\n      <Grid item flexGrow={1}>\r\n        <Typography variant=\"caption\" pl={1} >\r\n          {displayText}\r\n        </Typography>\r\n      </Grid>\r\n      <Grid item xs=\"auto\">\r\n        <Button size=\"small\" color=\"info\" variant=\"contained\" onClick={() => setshowInfoModal(true)} startIcon={<FontAwesomeIcon icon={faQuestionCircle} />}>\r\n          <Translate ns=\"ui\" key18=\"info\" />\r\n        </Button>\r\n      </Grid>\r\n    </Grid>\r\n    <ModalWrapper containerProps={{ maxWidth: \"xl\" }} open={showInfoModal} onClose={() => closeModal()} >\r\n      <CardDark >\r\n        <CardContent sx={{ py: 1 }}>\r\n          <Grid container>\r\n            <Grid item flexGrow={1}>\r\n              <Typography variant=\"h6\">{modalTitle}</Typography>\r\n            </Grid>\r\n            <Grid item>\r\n              <CloseButton onClick={closeModal} />\r\n            </Grid>\r\n          </Grid>\r\n        </CardContent>\r\n        <Divider />\r\n        <CardContent>\r\n          <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={500} />}>\r\n            {children}\r\n          </Suspense>\r\n        </CardContent>\r\n        <Divider />\r\n        <CardContent sx={{ py: 1 }}>\r\n          <CloseButton large onClick={closeModal} />\r\n        </CardContent>\r\n      </CardDark>\r\n    </ModalWrapper >\r\n  </CardDark>\r\n}\r\n","import { faTrashAlt } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { Button, ButtonGroup, CardContent, Divider, Grid, MenuItem, Typography } from '@mui/material';\r\nimport React, { useCallback, useContext } from 'react';\r\nimport CardLight from './Card/CardLight';\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from './CustomNumberInput';\r\nimport DropdownButton from './DropdownMenu/DropdownButton';\r\nimport { DataContext } from '../DataContext';\r\nimport { uiInput as input } from '../Formula';\r\nimport KeyMap, { StatKey } from '../KeyMap';\r\nimport { ElementKey } from '../Types/consts';\r\nexport default function StatFilterCard({ statFilters = {}, setStatFilters, disabled = false }:\r\n  { statFilters: Dict<StatKey, number>, setStatFilters: (object: Dict<StatKey, number>) => void, disabled?: boolean }) {\r\n  const { data } = useContext(DataContext)\r\n  const statKeys: StatKey[] = [\"atk\", \"hp\", \"def\", \"eleMas\", \"critRate_\", \"critDMG_\", \"heal_\", \"enerRech_\"]\r\n  if (data.get(input.weaponType).value !== \"catalyst\") statKeys.push(\"physical_dmg_\")\r\n  const charEle = data.get(input.charEle).value as ElementKey\r\n  statKeys.push(`${charEle}_dmg_`)\r\n\r\n  const remainingKeys = statKeys.filter(key => !(Object.keys(statFilters) as any).some(k => k === key))\r\n  const setFilter = useCallback((sKey, min) => setStatFilters({ ...statFilters, [sKey]: min }), [statFilters, setStatFilters],)\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Typography>Minimum Final Stat Filter</Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      <Grid container spacing={1}>\r\n        {Object.entries(statFilters).map(([statKey, min]) => {\r\n          return <Grid item xs={12} key={statKey} ><StatFilterItem statKey={statKey} statKeys={remainingKeys} setFilter={setFilter} disabled={disabled} value={min} close={() => {\r\n            delete statFilters[statKey]\r\n            setStatFilters({ ...statFilters })\r\n          }} /></Grid>\r\n        })}\r\n        <Grid item xs={12}>\r\n          <StatFilterItem value={undefined} close={undefined} statKeys={remainingKeys} setFilter={setFilter} disabled={disabled} />\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n\r\nexport function StatFilterItem({ statKey, statKeys = [], value = 0, close, setFilter, disabled = false }: {\r\n  statKey?: string, statKeys: string[], value?: number, close?: () => void, setFilter: (statKey: string, value?: number) => void, disabled?: boolean\r\n}) {\r\n  const isFloat = KeyMap.unit(statKey) === \"%\"\r\n  const onChange = useCallback(s => statKey && setFilter(statKey, s), [setFilter, statKey])\r\n  return <ButtonGroup sx={{ width: \"100%\" }}>\r\n    <DropdownButton\r\n      title={statKey ? KeyMap.get(statKey) : \"New Stat\"}\r\n      disabled={disabled}\r\n    >\r\n      {statKeys.map(sKey => <MenuItem key={sKey} onClick={() => { close?.(); setFilter(sKey, value) }}>{KeyMap.get(sKey)}</MenuItem>)}\r\n    </DropdownButton>\r\n    <CustomNumberInputButtonGroupWrapper sx={{ flexBasis: 30, flexGrow: 1 }}>\r\n      <CustomNumberInput\r\n        disabled={!statKey}\r\n        float={isFloat}\r\n        value={value}\r\n        placeholder=\"Min Value\"\r\n        onChange={onChange}\r\n        sx={{ px: 2 }}\r\n      />\r\n    </CustomNumberInputButtonGroupWrapper>\r\n    {!!close && <Button color=\"error\" onClick={close} disabled={disabled}><FontAwesomeIcon icon={faTrashAlt} /></Button>}\r\n  </ButtonGroup>\r\n}\r\n","\r\nexport function initGlobalSettings() {\r\n  return { tcMode: false }\r\n}\r\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/BackgroundWorker.f9b19197.worker.js\");\n}\n","import { CheckBox, CheckBoxOutlineBlank, Download, Info } from '@mui/icons-material';\r\nimport { Button, CardContent, Collapse, Divider, Grid, MenuItem, styled, Tooltip, Typography } from '@mui/material';\r\nimport { useContext, useMemo, useState } from 'react';\r\nimport { CartesianGrid, ComposedChart, Legend, Line, ResponsiveContainer, Scatter, XAxis, YAxis, ZAxis } from 'recharts';\r\nimport CardDark from '../Components/Card/CardDark';\r\nimport CardLight from '../Components/Card/CardLight';\r\nimport DropdownButton from '../Components/DropdownMenu/DropdownButton';\r\nimport { DataContext } from '../DataContext';\r\nimport { uiInput as input } from '../Formula';\r\nimport { NumNode } from '../Formula/type';\r\nimport KeyMap from '../KeyMap';\r\nimport { MainStatKey, SubstatKey } from '../Types/artifact';\r\nimport { ChartData } from './background';\r\ntype ChartCardProps = {\r\n  chartData?: ChartData\r\n  plotBase: MainStatKey | SubstatKey | \"\",\r\n  setPlotBase: (key: MainStatKey | SubstatKey | \"\") => void\r\n  disabled?: boolean\r\n}\r\ntype Point = { x: number, y: number, min?: number }\r\nexport default function ChartCard({ chartData, plotBase, setPlotBase, disabled = false }: ChartCardProps) {\r\n  const [showDownload, setshowDownload] = useState(false)\r\n  const [showMin, setshowMin] = useState(true)\r\n  const { data } = useContext(DataContext)\r\n  const statKeys = [\"atk\", \"hp\", \"def\", \"eleMas\", \"critRate_\", \"critDMG_\", \"heal_\", \"enerRech_\"]\r\n  if (data.get(input.weaponType).value !== \"catalyst\") statKeys.push(\"physical_dmg_\")\r\n  statKeys.push(`${data.get(input.charEle).value}_dmg_`)\r\n\r\n  const { displayData, downloadData } = useMemo(() => {\r\n    if (!chartData) return { displayData: null, downloadData: null }\r\n    const points = chartData.data.map(({ value: y, plot: x }) => ({ x, y })) as Point[]\r\n    const increasingX: Point[] = points.sort((a, b) => a.x - b.x)\r\n    const minimumData: Point[] = []\r\n    for (const point of increasingX) {\r\n      let last: Point | undefined\r\n      while ((last = minimumData.pop())) {\r\n        if (last.y > point.y) {\r\n          minimumData.push(last)\r\n          break\r\n        }\r\n      }\r\n      minimumData.push(point)\r\n    }\r\n\r\n    // Note:\r\n    // We can also just use `minimumData` if the plotter supports multiple data sources.\r\n    // It could be faster too since there're no empty entries in `minimumData`.\r\n    if (minimumData[0]?.x !== increasingX[0]?.x)\r\n      increasingX[0].min = minimumData[0].y\r\n    minimumData.forEach(x => { x.min = x.y })\r\n\r\n    const downloadData = {\r\n      minimum: minimumData.map(({ x, y }) => [x, y]),\r\n      allData: increasingX.map(({ x, y }) => [x, y]),\r\n    }\r\n    return { displayData: increasingX, downloadData }\r\n  }, [chartData])\r\n\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container spacing={1} alignItems=\"center\">\r\n        <Grid item>\r\n          <Typography variant=\"h6\" >Optimization Target vs</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <DropdownButton title={plotBase ? KeyMap.get(plotBase) : \"Not Selected\"}\r\n            color={plotBase ? \"success\" : \"primary\"}\r\n            disabled={disabled}\r\n          >\r\n            <MenuItem onClick={() => { setPlotBase(\"\") }}>Unselect</MenuItem>\r\n            <Divider />\r\n            {statKeys.map(sKey => <MenuItem key={sKey} onClick={() => { setPlotBase(sKey as any) }}>{KeyMap.get(sKey)}</MenuItem>)}\r\n          </DropdownButton>\r\n        </Grid>\r\n        <Grid item flexGrow={1}>\r\n          <Tooltip placement=\"top\" title=\"Using data from the builder, this will generate a graph to visualize Optimization Target vs. a selected stat. The graph will show the maximum Optimization Target value per 0.01 of the selected stat.\">\r\n            <Info />\r\n          </Tooltip>\r\n        </Grid>\r\n        {!!downloadData && <Grid item>\r\n          <Button startIcon={showMin ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n            color={showMin ? \"success\" : \"secondary\"}\r\n            onClick={() => setshowMin(!showMin)}>Show Min Stat Threshold</Button>\r\n        </Grid>}\r\n        {!!downloadData && <Grid item>\r\n          <Button color=\"info\" startIcon={<Download />} onClick={() => setshowDownload(!showDownload)}>Download Data</Button>\r\n        </Grid>}\r\n      </Grid>\r\n    </CardContent>\r\n    {!!displayData && <Divider />}\r\n    {chartData && !!displayData && <CardContent>\r\n      <Collapse in={!!downloadData && showDownload}>\r\n        <CardDark sx={{ mb: 2 }}>\r\n          <CardContent>\r\n            <Typography>Min Data</Typography>\r\n            <DataDisplay data={downloadData?.minimum} />\r\n            <Typography>All Data</Typography>\r\n            <DataDisplay data={downloadData?.allData} />\r\n          </CardContent>\r\n        </CardDark>\r\n      </Collapse>\r\n      <Chart displayData={displayData} plotNode={chartData.plotNode} valueNode={chartData.valueNode} showMin={showMin} />\r\n    </CardContent>}\r\n  </CardLight >\r\n}\r\nconst TextArea = styled(\"textarea\")({\r\n  width: \"100%\",\r\n  fontFamily: \"monospace\",\r\n  resize: \"vertical\",\r\n  minHeight: \"5em\"\r\n})\r\nfunction DataDisplay({ data, }: { data?: object }) {\r\n  return <TextArea readOnly value={JSON.stringify(data)} onClick={e => {\r\n    const target = e.target as HTMLTextAreaElement;\r\n    target.selectionStart = 0;\r\n    target.selectionEnd = target.value.length;\r\n  }} />\r\n}\r\nfunction Chart({ displayData, plotNode, valueNode, showMin }: {\r\n  displayData: Point[],\r\n  plotNode: NumNode,\r\n  valueNode: NumNode,\r\n  showMin: boolean\r\n}) {\r\n  const plotBaseUnit = KeyMap.unit(plotNode.info?.key)\r\n  const valueUnit = KeyMap.unit(valueNode.info?.key)\r\n  return <ResponsiveContainer width=\"100%\" height={600}>\r\n    <ComposedChart data={displayData}>\r\n      <CartesianGrid strokeDasharray=\"3 3\" />\r\n      <XAxis dataKey=\"x\" scale=\"linear\" unit={plotBaseUnit} domain={[\"auto\", \"auto\"]} tick={{ fill: 'white' }} type=\"number\" tickFormatter={n => n > 10000 ? n.toFixed() : n.toFixed(1)} />\r\n      <YAxis name=\"DMG\" domain={[\"auto\", \"auto\"]} unit={valueUnit} allowDecimals={false} tick={{ fill: 'white' }} type=\"number\" />\r\n      <ZAxis dataKey=\"y\" range={[3, 25]} />\r\n      <Legend />\r\n      <Scatter name=\"Optimization Target\" dataKey=\"y\" fill=\"#8884d8\" line lineType=\"fitting\" isAnimationActive={false} />\r\n      {showMin && <Line name=\"Minimum Stat Requirement Threshold\" dataKey=\"min\" stroke=\"#ff7300\" type=\"stepBefore\" connectNulls strokeWidth={2} isAnimationActive={false} />}\r\n    </ComposedChart>\r\n  </ResponsiveContainer>\r\n}\r\n","import { forEachNodes, mapFormulas } from \"../Formula/internal\";\r\nimport { allOperations, constantFold } from \"../Formula/optimization\";\r\nimport { ConstantNode, NumNode } from \"../Formula/type\";\r\nimport { constant, customRead, max, min } from \"../Formula/utils\";\r\nimport { allSlotKeys, ArtifactSetKey } from \"../Types/consts\";\r\nimport { assertUnreachable, objectKeyMap, objectMap } from \"../Util/Util\";\r\nimport type { ArtifactBuildData, ArtifactsBySlot, Build, DynStat, PlotData, RequestFilter } from \"./background\";\r\n\r\ntype DynMinMax = { [key in string]: MinMax }\r\ntype MinMax = { min: number, max: number }\r\n\r\ntype MicropassOperation = \"reaffine\" | \"pruneArtRange\" | \"pruneNodeRange\" | \"pruneOrder\"\r\nexport function pruneAll(nodes: NumNode[], minimum: number[], arts: ArtifactsBySlot, numTop: number, keepArtifacts: Set<ArtifactSetKey>, forced: Dict<MicropassOperation, boolean>): { nodes: NumNode[], arts: ArtifactsBySlot } {\r\n  let should = forced\r\n  /** If `key` makes progress, all operations in `value` should be performed */\r\n  const deps: StrictDict<MicropassOperation, Dict<MicropassOperation, true>> = {\r\n    pruneOrder: { pruneNodeRange: true },\r\n    pruneArtRange: { pruneNodeRange: true },\r\n    pruneNodeRange: { reaffine: true },\r\n    reaffine: { pruneOrder: true, pruneArtRange: true, pruneNodeRange: true }\r\n  }\r\n  let count = 0\r\n  while (Object.values(should).some(x => x) && count++ < 20) {\r\n    if (should.pruneOrder) {\r\n      delete should.pruneOrder\r\n      const newArts = pruneOrder(arts, numTop, keepArtifacts)\r\n      if (arts !== newArts) {\r\n        arts = newArts\r\n        should = { ...should, ...deps.pruneOrder }\r\n      }\r\n    }\r\n    if (should.pruneArtRange) {\r\n      delete should.pruneArtRange\r\n      const newArts = pruneArtRange(nodes, arts, minimum)\r\n      if (arts !== newArts) {\r\n        arts = newArts\r\n        should = { ...should, ...deps.pruneArtRange }\r\n      }\r\n    }\r\n    if (should.pruneNodeRange) {\r\n      delete should.pruneNodeRange\r\n      const newNodes = pruneNodeRange(nodes, arts)\r\n      if (nodes !== newNodes) {\r\n        nodes = newNodes\r\n        should = { ...should, ...deps.pruneNodeRange }\r\n      }\r\n    }\r\n    if (should.reaffine) {\r\n      delete should.reaffine\r\n      const { nodes: newNodes, arts: newArts } = reaffine(nodes, arts)\r\n      if (nodes !== newNodes || arts !== newArts) {\r\n        nodes = newNodes\r\n        arts = newArts\r\n        should = { ...should, ...deps.reaffine }\r\n      }\r\n    }\r\n  }\r\n  return { nodes, arts }\r\n}\r\n\r\nfunction reaffine(nodes: NumNode[], arts: ArtifactsBySlot, forceRename: boolean = false): { nodes: NumNode[], arts: ArtifactsBySlot } {\r\n  const affineNodes = new Set<NumNode>(), topLevelAffine = new Set<NumNode>()\r\n\r\n  function visit(node: NumNode, isAffine: boolean) {\r\n    if (isAffine) affineNodes.add(node)\r\n    else node.operands.forEach(_op => {\r\n      const op = _op as NumNode\r\n      affineNodes.has(op) && topLevelAffine.add(op)\r\n    })\r\n  }\r\n\r\n  const dynKeys = new Set<string>()\r\n\r\n  forEachNodes(nodes, _ => { }, f => {\r\n    const operation = f.operation\r\n    switch (operation) {\r\n      case \"read\":\r\n        if (f.type !== \"number\" || f.path[0] !== \"dyn\" || f.accu !== \"add\")\r\n          throw new Error(`Found unsupported ${operation} node at path ${f.path} when computing affine nodes`)\r\n        dynKeys.add(f.path[1])\r\n        visit(f, true)\r\n        break\r\n      case \"add\": visit(f, f.operands.every(op => affineNodes.has(op))); break\r\n      case \"mul\": {\r\n        const nonConst = f.operands.filter(op => op.operation !== \"const\")\r\n        visit(f, nonConst.length === 0 || (nonConst.length === 1 && affineNodes.has(nonConst[0])))\r\n        break\r\n      }\r\n      case \"const\":\r\n        if (typeof f.value === \"string\" || f.value === undefined)\r\n          throw new Error(`Found constant ${f.value} while compacting`)\r\n        visit(f as NumNode, true); break\r\n      case \"res\": case \"threshold\": case \"sum_frac\":\r\n      case \"max\": case \"min\": visit(f, false); break\r\n      case \"data\": case \"subscript\": case \"lookup\": case \"match\": case \"prio\": case \"small\":\r\n        throw new Error(`Found unsupported ${operation} node when computing affine nodes`)\r\n      default: assertUnreachable(operation)\r\n    }\r\n  })\r\n\r\n  if ([...topLevelAffine].every(({ operation }) => operation === \"read\" || operation === \"const\") &&\r\n    Object.keys(arts.base).length === dynKeys.size)\r\n    return { nodes, arts }\r\n\r\n  let current = -1\r\n  function nextDynKey(): string {\r\n    while (dynKeys.has(`${++current}`));\r\n    return `${current}`\r\n  }\r\n\r\n  nodes.forEach(node => affineNodes.has(node) && topLevelAffine.add(node))\r\n  const affine = [...topLevelAffine].filter(f => f.operation !== \"const\")\r\n  const affineMap = new Map(affine.map(node => [node,\r\n    !forceRename && node.operation === \"read\" && node.path[0] === \"dyn\"\r\n      ? node\r\n      : { ...customRead([\"dyn\", `${nextDynKey()}`]), accu: \"add\" as const }]))\r\n  nodes = mapFormulas(nodes, f => affineMap.get(f as NumNode) ?? f, f => f)\r\n\r\n  function reaffineArt(stat: DynStat): DynStat {\r\n    const values = constantFold([...affineMap.keys()], {\r\n      dyn: objectMap(stat, (value) => constant(value))\r\n    } as any, _ => true)\r\n    return Object.fromEntries([...affineMap.values()].map((v, i) => [v.path[1], (values[i] as ConstantNode<number>).value]))\r\n  }\r\n  const result = {\r\n    nodes, arts: {\r\n      base: reaffineArt(arts.base),\r\n      values: objectKeyMap(allSlotKeys, slot =>\r\n        arts.values[slot].map(({ id, set, values }) => ({ id, set, values: reaffineArt(values) })))\r\n    }\r\n  }\r\n  const offsets = Object.entries(reaffineArt({}))\r\n  for (const arts of Object.values(result.arts.values))\r\n    for (const { values } of arts)\r\n      for (const [key, baseValue] of offsets)\r\n        values[key] -= baseValue\r\n  return result\r\n}\r\n/** Remove artifacts that cannot be in top `numTop` builds */\r\nexport function pruneOrder(arts: ArtifactsBySlot, numTop: number, keepArtifacts: Set<ArtifactSetKey>): ArtifactsBySlot {\r\n  let progress = false\r\n  const values = objectKeyMap(allSlotKeys, slot => {\r\n    const list = arts.values[slot]\r\n    const newList = list.filter(art => {\r\n      let count = 0\r\n      return list.every(other => {\r\n        const greaterEqual = Object.entries(other.values).every(([k, o]) => o >= art.values[k])\r\n        const greater = Object.entries(other.values).some(([k, o]) => o > art.values[k])\r\n        if (greaterEqual && (greater || other.id > art.id) &&\r\n          (!keepArtifacts.has(art.set) || keepArtifacts.has(other.set)))\r\n          count++\r\n        return count < numTop\r\n      })\r\n    })\r\n    if (newList.length !== list.length) progress = true\r\n    return newList\r\n  })\r\n  return progress ? { base: arts.base, values } : arts\r\n}\r\n/** Remove artifacts that cannot reach `minimum` in any build */\r\nfunction pruneArtRange(nodes: NumNode[], arts: ArtifactsBySlot, minimum: number[]): ArtifactsBySlot {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  const wrap = { arts }\r\n  while (true) {\r\n    const artRanges = objectKeyMap(allSlotKeys, slot => computeArtRange(wrap.arts.values[slot]))\r\n    const otherArtRanges = objectKeyMap(allSlotKeys, key =>\r\n      addArtRange(Object.entries(artRanges).map(a => a[0] === key ? baseRange : a[1]).filter(x => x)))\r\n\r\n    let progress = false\r\n    const values = objectKeyMap(allSlotKeys, slot => {\r\n      const result = wrap.arts.values[slot].filter(art => {\r\n        const read = addArtRange([computeArtRange([art]), otherArtRanges[slot]])\r\n        const newRange = computeNodeRange(nodes, read)\r\n        return nodes.every((node, i) => newRange.get(node)!.max >= (minimum[i] ?? -Infinity))\r\n      })\r\n      if (result.length !== wrap.arts.values[slot].length)\r\n        progress = true\r\n      return result\r\n    })\r\n    if (!progress) break\r\n    wrap.arts = { base: wrap.arts.base, values }\r\n  }\r\n  return wrap.arts\r\n}\r\nfunction pruneNodeRange(nodes: NumNode[], arts: ArtifactsBySlot): NumNode[] {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  const reads = addArtRange([baseRange, ...Object.values(arts.values).map(values => computeArtRange(values))])\r\n  const nodeRange = computeNodeRange(nodes, reads)\r\n\r\n  return mapFormulas(nodes, f => {\r\n    const { operation } = f\r\n    const operandRanges = f.operands.map(x => nodeRange.get(x)!)\r\n    switch (operation) {\r\n      case \"threshold\": {\r\n        const [value, threshold, pass, fail] = operandRanges\r\n        if (value.min >= threshold.max) return f.operands[2]\r\n        else if (value.max < threshold.min) return constant(0)\r\n        if (pass.max === pass.min &&\r\n          fail.max === fail.min &&\r\n          pass.min === fail.min && isFinite(pass.min))\r\n          return constant(pass.max)\r\n        break\r\n      }\r\n      case \"min\": {\r\n        const newOperands = f.operands.filter((_, i) => {\r\n          const op1 = operandRanges[i]\r\n          return operandRanges.every((op2, j) => op1.min <= op2.max)\r\n        })\r\n        if (newOperands.length < operandRanges.length) return min(...newOperands)\r\n        break\r\n      }\r\n      case \"max\": {\r\n        const newOperands = f.operands.filter((_, i) => {\r\n          const op1 = operandRanges[i]\r\n          return operandRanges.every(op2 => op1.max >= op2.min)\r\n        })\r\n        if (newOperands.length < operandRanges.length) return max(...newOperands)\r\n        break\r\n      }\r\n    }\r\n    return f\r\n  }, f => f)\r\n}\r\nfunction addArtRange(ranges: DynMinMax[]): DynMinMax {\r\n  const result: DynMinMax = {}\r\n  ranges.forEach(range => {\r\n    Object.entries(range).forEach(([key, value]) => {\r\n      if (result[key]) {\r\n        result[key].min += value.min\r\n        result[key].max += value.max\r\n      } else result[key] = { ...value }\r\n    })\r\n  })\r\n  return result\r\n}\r\nfunction computeArtRange(arts: ArtifactBuildData[]): DynMinMax {\r\n  const result: DynMinMax = {}\r\n  if (arts.length) {\r\n    Object.keys(arts[0].values)\r\n      .filter(key => arts.every(art => art.values[key]))\r\n      .forEach(key => result[key] = { min: arts[0].values[key], max: arts[0].values[key] })\r\n    arts.forEach(({ values }) => {\r\n      for (const [key, value] of Object.entries(values)) {\r\n        if (!result[key]) result[key] = { min: 0, max: value }\r\n        else {\r\n          if (result[key].max < value) result[key].max = value\r\n          if (result[key].min > value) result[key].min = value\r\n        }\r\n      }\r\n    })\r\n  }\r\n  return result\r\n}\r\nfunction computeNodeRange(nodes: NumNode[], reads: DynMinMax): Map<NumNode, MinMax> {\r\n  const range = new Map<NumNode, MinMax>()\r\n\r\n  forEachNodes(nodes, _ => { }, _f => {\r\n    const f = _f as NumNode\r\n    const { operation } = f\r\n    const operands = f.operands.map(op => range.get(op)!)\r\n    let current: MinMax\r\n    switch (operation) {\r\n      case \"read\":\r\n        if (f.path[0] !== \"dyn\")\r\n          throw new Error(`Found non-dyn path ${f.path} while computing range`)\r\n        current = reads[f.path[1]] ?? { min: 0, max: 0 }\r\n        break\r\n      case \"const\": current = computeMinMax([f.value]); break\r\n      case \"subscript\": current = computeMinMax(f.list); break\r\n      case \"add\": case \"min\": case \"max\":\r\n        current = {\r\n          min: allOperations[operation](operands.map(x => x.min)),\r\n          max: allOperations[operation](operands.map(x => x.max)),\r\n        }; break\r\n      case \"res\": current = {\r\n        min: allOperations[operation]([operands[0].max]),\r\n        max: allOperations[operation]([operands[0].min]),\r\n      }; break\r\n      case \"mul\": current = operands.reduce((accu, current) => computeMinMax([\r\n        accu.min * current.min, accu.min * current.max,\r\n        accu.max * current.min, accu.max * current.max,\r\n      ])); break\r\n      case \"threshold\":\r\n        if (operands[0].min >= operands[1].max) current = operands[2]\r\n        else if (operands[0].max < operands[1].min) current = computeMinMax([0])\r\n        else current = computeMinMax([0], [operands[2]])\r\n        break\r\n      case \"sum_frac\": {\r\n        const [x, c] = operands, sum = { min: x.min + c.min, max: x.max + c.max }\r\n        if (sum.min <= 0 && sum.max >= 0)\r\n          current = (x.min <= 0 && x.max >= 0) ? { min: NaN, max: NaN } : { min: -Infinity, max: Infinity }\r\n        else\r\n          // TODO: Check this\r\n          current = computeMinMax([\r\n            x.min / sum.min, x.min / sum.max,\r\n            x.max / sum.min, x.max / sum.max\r\n          ])\r\n        break\r\n      }\r\n      case \"data\": case \"lookup\": case \"match\":\r\n        throw new Error(`Unsupported ${operation} node`)\r\n      default: assertUnreachable(operation)\r\n    }\r\n    range.set(f, current)\r\n  })\r\n  return range\r\n}\r\nfunction computeMinMax(values: readonly number[], minMaxes: readonly MinMax[] = []): MinMax {\r\n  const max = Math.max(...values, ...minMaxes.map(x => x.max))\r\n  const min = Math.min(...values, ...minMaxes.map(x => x.min))\r\n  return { min, max }\r\n}\r\n\r\nexport function filterArts(arts: ArtifactsBySlot, filters: RequestFilter): ArtifactsBySlot {\r\n  return {\r\n    base: arts.base,\r\n    values: objectKeyMap(allSlotKeys, slot => {\r\n      const filter = filters[slot]\r\n      switch (filter.kind) {\r\n        case \"id\": return arts.values[slot].filter(art => filter.ids.has(art.id))\r\n        case \"exclude\": return arts.values[slot].filter(art => !filter.sets.has(art.set))\r\n        case \"required\": return arts.values[slot].filter(art => filter.sets.has(art.set))\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport function mergeBuilds(builds: Build[][], maxNum: number): Build[] {\r\n  return builds.flatMap(x => x).sort((a, b) => b.value - a.value).slice(0, maxNum)\r\n}\r\nexport function mergePlot(plots: PlotData[]): PlotData {\r\n  let scale = 0.01, reductionScaling = 2, maxCount = 1500\r\n  let keys = new Set(plots.flatMap(x => Object.values(x).map(v => Math.round(v.plot! / scale))))\r\n  while (keys.size > maxCount) {\r\n    scale *= reductionScaling\r\n    keys = new Set([...keys].map(key => Math.round(key / reductionScaling)))\r\n  }\r\n  const result: PlotData = {}\r\n  for (const plot of plots)\r\n    for (const build of Object.values(plot)) {\r\n      const x = Math.round(build.plot! / scale) * scale\r\n      if (!result[x] || result[x]!.value < build.value)\r\n        result[x] = build\r\n    }\r\n  return result\r\n}\r\n\r\nexport function countBuilds(arts: ArtifactsBySlot): number {\r\n  return allSlotKeys.reduce((_count, slot) => _count * arts.values[slot].length, 1)\r\n}\r\n","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { Box, CardActionArea, CardMedia, Chip, Grid, Typography } from \"@mui/material\";\r\nimport { useCallback } from \"react\";\r\nimport Artifact from \"../../Data/Artifacts/Artifact\";\r\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\";\r\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\r\nimport KeyMap, { cacheValueString } from \"../../KeyMap\";\r\nimport useArtifact from \"../../ReactHooks/useArtifact\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport { ICachedSubstat } from \"../../Types/artifact\";\r\nimport { clamp } from \"../../Util/Util\";\r\nimport BootstrapTooltip from \"../BootstrapTooltip\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport ColorText from \"../ColoredText\";\r\nimport ConditionalWrapper from \"../ConditionalWrapper\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport StatIcon from \"../StatIcon\";\r\n\r\ntype Data = {\r\n  artifactId?: string,\r\n  mainStatAssumptionLevel?: number,\r\n  onClick?: () => void,\r\n}\r\n\r\nexport default function ArtifactCardNano({ artifactId, mainStatAssumptionLevel = 0, onClick }: Data) {\r\n  const art = useArtifact(artifactId)\r\n  const sheet = usePromise(ArtifactSheet.get(art?.setKey), [art])\r\n  const actionWrapperFunc = useCallback(\r\n    children => <CardActionArea onClick={onClick}>{children}</CardActionArea>,\r\n    [onClick],\r\n  )\r\n  if (!art) return null\r\n\r\n\r\n  const { slotKey, rarity, level, mainStatKey, substats, location } = art\r\n  const mainStatLevel = Math.max(Math.min(mainStatAssumptionLevel, rarity * 4), level)\r\n  const mainStatUnit = KeyMap.unit(mainStatKey)\r\n  const levelVariant = \"roll\" + (Math.floor(Math.max(level, 0) / 4) + 1)\r\n  return <CardDark><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc} >\r\n    <Grid container sx={{ flexWrap: \"nowrap\" }} className={`grad-${rarity}star`} >\r\n      <Grid item maxWidth=\"40%\" sx={{ mt: -1, mb: -2 }} >\r\n        <CardMedia\r\n          component=\"img\"\r\n          image={sheet?.slotIcons[slotKey] ?? \"\"}\r\n          width=\"100%\"\r\n          height=\"auto\"\r\n        />\r\n      </Grid>\r\n      <Grid item sx={{ textAlign: \"right\", flexGrow: 1, pr: 1, pt: 1 }}>\r\n        <Box display=\"flex\" justifyContent=\"flex-end\" gap={1}>\r\n          <Chip size=\"small\" label={<strong>{` +${level}`}</strong>} color={levelVariant as any} />\r\n          <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\r\n            overflow: \"visible\", \".MuiChip-label\": {\r\n              overflow: \"visible\"\r\n            }\r\n          }} />\r\n        </Box>\r\n\r\n        <Typography variant=\"h6\" sx={{ display: \"flex\", gap: 1, justifyContent: \"flex-end\" }}>\r\n          <ColorText color={KeyMap.getVariant(mainStatKey)}>{StatIcon[mainStatKey]}</ColorText>\r\n          <ColorText color={mainStatLevel !== level ? \"warning\" : undefined}>{cacheValueString(Artifact.mainStatValue(mainStatKey, rarity, mainStatLevel) ?? 0, KeyMap.unit(mainStatKey))}{mainStatUnit}</ColorText>\r\n        </Typography>\r\n      </Grid>\r\n    </Grid>\r\n    <Grid container sx={{ p: 1, pl: 2 }}>\r\n      {substats.map((stat: ICachedSubstat, i: number) => <Grid item key={i + stat.key} xs={6}>\r\n        <SubstatDisplay key={stat.key} stat={stat} />\r\n      </Grid>)}\r\n    </Grid>\r\n  </ConditionalWrapper></CardDark >\r\n}\r\nfunction SubstatDisplay({ stat }: { stat: ICachedSubstat }) {\r\n  if (!stat.value) return null\r\n  const numRolls = stat.rolls?.length ?? 0\r\n  const rollColor = `roll${clamp(numRolls, 1, 6)}`\r\n  const unit = KeyMap.unit(stat.key)\r\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\r\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} color={(numRolls ? `${rollColor}.main` : \"error.main\") as any} component=\"span\">\r\n      <BootstrapTooltip placement=\"top\" title={<Typography>{stat.key && KeyMap.getArtStr(stat.key)}</Typography>}>\r\n        <span>{StatIcon[stat.key]}</span>\r\n      </BootstrapTooltip>\r\n      <span>{`${cacheValueString(stat.value, KeyMap.unit(stat.key))}${unit}`}</span>\r\n    </Typography>\r\n  </Box>)\r\n}\r\nfunction LocationIcon({ location }) {\r\n  const characterSheet = usePromise(CharacterSheet.get(location ?? \"\"), [location])\r\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\r\n}\r\n","import { Box, CardMedia, Chip, Grid, Typography } from \"@mui/material\";\r\nimport { useMemo } from \"react\";\r\nimport WeaponSheet from \"../../Data/Weapons/WeaponSheet\";\r\nimport { input } from \"../../Formula\";\r\nimport { computeUIData, dataObjForWeapon } from \"../../Formula/api\";\r\nimport { NodeDisplay } from '../../Formula/uiData';\r\nimport { valueString } from \"../../KeyMap\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport useWeapon from \"../../ReactHooks/useWeapon\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport StatIcon from \"../StatIcon\";\r\n\r\ntype Data = {\r\n  weaponId?: string,\r\n}\r\n\r\nexport default function WeaponCardNano({ weaponId }: Data) {\r\n  const weapon = useWeapon(weaponId)\r\n  const weaponSheet = usePromise(weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\r\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\r\n  if (!weapon || !weaponSheet || !UIData) return null;\r\n  return <CardDark sx={{ height: \"100%\" }}>\r\n    <Grid container sx={{ flexWrap: \"nowrap\" }} className={`grad-${weaponSheet.rarity}star`} >\r\n      <Grid item maxWidth=\"40%\" sx={{}} >\r\n        <CardMedia\r\n          component=\"img\"\r\n          image={weaponSheet.img}\r\n          width=\"100%\"\r\n          height=\"auto\"\r\n        />\r\n      </Grid>\r\n      <Grid item sx={{ textAlign: \"right\", flexGrow: 1, pr: 1, pt: 1, display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <Chip size=\"small\" label={<strong>Lv. {WeaponSheet.getLevelString(weapon)}</strong>} color=\"primary\" />\r\n        {weaponSheet.hasRefinement && <Chip size=\"small\" color=\"info\" label={<strong>R{weapon.refinement}</strong>} />}\r\n      </Grid>\r\n    </Grid>\r\n    <Grid container sx={{ p: 1, pl: 2 }}>\r\n      <Grid item xs={6}>\r\n        <WeaponStat node={UIData.get(input.weapon.main)} />\r\n      </Grid>\r\n      <Grid item xs={6}>\r\n        <WeaponStat node={UIData.get(input.weapon.sub)} />\r\n      </Grid>\r\n    </Grid>\r\n  </CardDark >\r\n}\r\nfunction WeaponStat({ node }: { node: NodeDisplay }) {\r\n  if (!node.info.key) return null\r\n  const val = valueString(node.value, node.unit, !node.unit ? 0 : undefined)\r\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\r\n    <Typography sx={{ flexGrow: 1 }} component=\"span\">{StatIcon[node.info.key]} {val}</Typography>\r\n  </Box>)\r\n}\r\n","import { ChevronRight } from '@mui/icons-material';\r\nimport { Button, CardContent, Grid, Skeleton, Typography } from '@mui/material';\r\nimport { Box } from '@mui/system';\r\nimport React, { lazy, Suspense, useCallback, useContext, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport ArtifactCardNano from '../../Components/Artifact/ArtifactCardNano';\r\nimport { artifactSlotIcon } from '../../Components/Artifact/SlotNameWIthIcon';\r\nimport CardDark from '../../Components/Card/CardDark';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport StatDisplayComponent from '../../Components/Character/StatDisplayComponent';\r\nimport CloseButton from '../../Components/CloseButton';\r\nimport ModalWrapper from '../../Components/ModalWrapper';\r\nimport SqBadge from '../../Components/SqBadge';\r\nimport WeaponCardNano from '../../Components/Weapon/WeaponCardNano';\r\nimport { ArtifactSheet } from '../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../Database/Database';\r\nimport { DataContext } from '../../DataContext';\r\nimport { uiInput as input } from '../../Formula';\r\nimport ArtifactCard from '../../PageArtifact/ArtifactCard';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from '../../Types/consts';\r\nimport { ArtifactDisplayLocationState } from '../../Types/LocationState';\r\n\r\n//lazy load the character display\r\nconst CharacterDisplayCard = lazy(() => import('../../PageCharacter/CharacterDisplayCard'))\r\n\r\ntype NewOld = {\r\n  newId: string,\r\n  oldId?: string\r\n}\r\n\r\ntype ArtifactBuildDisplayItemProps = {\r\n  index: number,\r\n  compareBuild: boolean,\r\n  disabled?: boolean,\r\n}\r\n//for displaying each artifact build\r\nexport default function ArtifactBuildDisplayItem({ index, compareBuild, disabled }: ArtifactBuildDisplayItemProps) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const dataContext = useContext(DataContext)\r\n  const [showModal, setshowModal] = useState(false)\r\n  const closeModal = useCallback(() => setshowModal(false), [setshowModal],)\r\n  const openModal = useCallback(() => setshowModal(true), [setshowModal],)\r\n\r\n  const { character, data, oldData, teamData, mainStatAssumptionLevel } = dataContext\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const [newOld, setNewOld] = useState(undefined as NewOld | undefined)\r\n  const close = useCallback(() => setNewOld(undefined), [setNewOld],)\r\n\r\n  const equipArts = useCallback(() => {\r\n    if (!window.confirm(\"Do you want to equip this artifact build to this character?\")) return\r\n    const newBuild = Object.fromEntries(allSlotKeys.map(s => [s, data.get(input.art[s].id).value])) as Record<SlotKey, string>\r\n    database.equipArtifacts(character.key, newBuild)\r\n  }, [character, data, database])\r\n  if (!character || !artifactSheets || !oldData) return null\r\n  const currentlyEquipped = allSlotKeys.every(slotKey => data.get(input.art[slotKey].id).value === oldData.get(input.art[slotKey].id).value)\r\n  const statProviderContext = { ...dataContext }\r\n  if (!compareBuild) statProviderContext.oldData = undefined\r\n  const setToSlots: Partial<Record<ArtifactSetKey, SlotKey[]>> = {}\r\n  allSlotKeys.forEach(slotKey => {\r\n    const set = data.get(input.art[slotKey].set).value as ArtifactSetKey | undefined\r\n    if (!set) return\r\n    if (setToSlots[set]) setToSlots[set]!.push(slotKey)\r\n    else setToSlots[set] = [slotKey]\r\n  })\r\n\r\n  return <CardLight>\r\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n      <ModalWrapper open={showModal} onClose={closeModal} containerProps={{ maxWidth: \"xl\" }}>\r\n        <CharacterDisplayCard\r\n          characterKey={character.key}\r\n          newteamData={teamData}\r\n          onClose={closeModal}\r\n          footer={<CloseButton large onClick={closeModal} />} />\r\n      </ModalWrapper>\r\n      {newOld && <CompareArtifactModal newOld={newOld} onClose={close} />}\r\n      <CardContent>\r\n        <Box display=\"flex\" gap={1} sx={{ pb: 1 }}>\r\n          <Typography variant=\"h6\"><SqBadge color=\"info\"><strong>#{index + 1}{currentlyEquipped ? \" (Equipped)\" : \"\"}</strong></SqBadge></Typography>\r\n          {(Object.entries(setToSlots) as [ArtifactSetKey, SlotKey[]][]).sort(([k1, slotarr1], [k2, slotarr2]) => slotarr2.length - slotarr1.length).map(([key, slotarr]) =>\r\n            <Box key={key}><Typography variant=\"h6\"><SqBadge color={currentlyEquipped ? \"success\" : \"primary\"} >\r\n              {slotarr.map(slotKey => artifactSlotIcon(slotKey))} {artifactSheets?.[key].name ?? \"\"}\r\n            </SqBadge></Typography></Box>\r\n          )}\r\n          <Box sx={{ flexGrow: 1, display: \"flex\", justifyContent: \"flex-end\" }}>\r\n          </Box>\r\n          <Button size='small' color=\"info\" onClick={openModal} disabled={disabled || currentlyEquipped}>Build Details</Button>\r\n          <Button size='small' color=\"success\" onClick={equipArts} disabled={disabled || currentlyEquipped}>Equip Artifacts</Button>\r\n        </Box>\r\n        <Grid container spacing={1} sx={{ pb: 1 }}>\r\n          {allSlotKeys.map(slotKey =>\r\n            <Grid item xs={6} sm={4} md={3} lg={2} key={slotKey} >\r\n              <ArtifactCardNano artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel} onClick={() => {\r\n                const oldId = character.equippedArtifacts[slotKey]\r\n                const newId = data.get(input.art[slotKey].id).value!\r\n                setNewOld({ oldId: oldId !== newId ? oldId : undefined, newId })\r\n              }} />\r\n            </Grid>)}\r\n          <Grid item xs={6} sm={4} md={3} lg={2}>\r\n            <WeaponCardNano weaponId={character.equippedWeapon} />\r\n          </Grid>\r\n        </Grid>\r\n        <DataContext.Provider value={statProviderContext}>\r\n          <StatDisplayComponent />\r\n        </DataContext.Provider>\r\n      </CardContent>\r\n    </Suspense>\r\n  </CardLight>\r\n}\r\n\r\nfunction CompareArtifactModal({ newOld: { newId, oldId }, onClose }: { newOld: NewOld, onClose: () => void }) {\r\n  console.log(\"newOld\", newId, oldId)\r\n  const history = useHistory()\r\n  const edit = useCallback(\r\n    artid => history.push({\r\n      pathname: \"/artifact\",\r\n      state: {\r\n        artToEditId: artid\r\n      } as ArtifactDisplayLocationState\r\n    } as any), [history])\r\n  return <ModalWrapper open={!!newId} onClose={onClose} containerProps={{ maxWidth: oldId ? \"md\" : \"xs\" }}>\r\n    <CardDark>\r\n      <CardContent sx={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", gap: 2 }}>\r\n        {oldId && <ArtifactCard artifactId={oldId} onEdit={edit} />}\r\n        {oldId && <CardLight sx={{ display: \"flex\" }}><ChevronRight sx={{ fontSize: 40 }} /></CardLight>}\r\n        <ArtifactCard artifactId={newId} onEdit={edit} />\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { Replay } from '@mui/icons-material';\r\nimport { Box, Button, CardContent, Divider, Grid, Typography } from '@mui/material';\r\nimport React, { useCallback, useContext, useMemo, useState } from 'react';\r\nimport SetEffectDisplay from '../../Components/Artifact/SetEffectDisplay';\r\nimport CardDark from '../../Components/Card/CardDark';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport CloseButton from '../../Components/CloseButton';\r\nimport ModalWrapper from '../../Components/ModalWrapper';\r\nimport SqBadge from '../../Components/SqBadge';\r\nimport { Stars } from '../../Components/StarDisplay';\r\nimport { ArtifactSheet } from '../../Data/Artifacts/ArtifactSheet';\r\nimport { DataContext } from '../../DataContext';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport { allArtifactSets, SetNum } from '../../Types/consts';\r\n\r\nexport default function ArtifactConditionalCard({ disabled }: { disabled?: boolean }) {\r\n  const { character } = useContext(DataContext)\r\n  const [open, setOpen] = useState(false)\r\n  const onOpen = useCallback(() => setOpen(true), [setOpen])\r\n  const onClose = useCallback(() => setOpen(false), [setOpen])\r\n  const artifactCondCount = useMemo(() =>\r\n    (Object.keys(character.conditional) as any).filter(k =>\r\n      allArtifactSets.includes(k) && Object.keys(character.conditional[k]).length !== 0).length\r\n    , [character])\r\n  return <CardLight><CardContent>\r\n    <Button fullWidth onClick={onOpen} disabled={disabled}>\r\n      <span>Default Artifact Set Effects Conditionals {!!artifactCondCount && <SqBadge color=\"success\">{artifactCondCount} Selected</SqBadge>}</span>\r\n    </Button>\r\n    <ArtConditionalModal open={open} onClose={onClose} artifactCondCount={artifactCondCount} />\r\n  </CardContent></CardLight>\r\n}\r\n\r\nfunction ArtConditionalModal({ open, onClose, artifactCondCount }: {\r\n  open: boolean, onClose: () => void, artifactCondCount: number\r\n}) {\r\n  const { character, characterDispatch } = useContext(DataContext)\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const resetArtConds = useCallback(() => {\r\n    const conditional = Object.fromEntries(Object.entries(character.conditional).filter(([k, v]) => !allArtifactSets.includes(k as any)))\r\n    characterDispatch({ conditional })\r\n  }, [character, characterDispatch]);\r\n\r\n  if (!artifactSheets) return null\r\n  const artSetKeyList = Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets)).reverse().flatMap(([, sets]) => sets)\r\n  return <ModalWrapper open={open} onClose={onClose} ><CardDark>\r\n    <CardContent>\r\n      <Grid container spacing={1}>\r\n        <Grid item flexGrow={1}>\r\n          <Typography variant=\"h6\">Default Artifact Set Effects {!!artifactCondCount && <SqBadge color=\"success\">{artifactCondCount} Selected</SqBadge>}</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <Button onClick={resetArtConds} startIcon={<Replay />}>Reset All</Button>\r\n        </Grid>\r\n        <Grid item>\r\n          <CloseButton onClick={onClose} />\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      <CardLight sx={{ mb: 1 }}>\r\n        <CardContent>\r\n          <Typography>Some artifacts provide conditional stats. This windows allows you to select those stats, so they can take effect during build calculation, when artifact sets are not specified.</Typography>\r\n        </CardContent>\r\n      </CardLight>\r\n      <Grid container spacing={1}>\r\n        {artSetKeyList.map(setKey => {\r\n          const sheet = artifactSheets[setKey]\r\n          // Don't display if no conditional in artifact\r\n          if (!Object.values(sheet.setEffects).some(entry => entry.document && entry.document.some(d => d.conditional))) return null\r\n          return <Grid item key={setKey} xs={6} lg={4}>\r\n            <CardLight sx={{ height: \"100%\" }}>\r\n              <Box className={`grad-${sheet.rarity[0]}star`} width=\"100%\" sx={{ display: \"flex\" }} >\r\n                <Box component=\"img\" src={sheet.defIconSrc} sx={{ height: 100, width: \"auto\" }} />\r\n                <Box sx={{ flexGrow: 1, px: 1, display: \"flex\", flexDirection: \"column\", justifyContent: \"center\" }}>\r\n                  <Typography variant=\"h6\">{artifactSheets?.[setKey].name ?? \"\"}</Typography>\r\n                  <Typography variant=\"subtitle1\">{sheet.rarity.map((ns, i) => <span key={ns}>{ns}<Stars stars={1} /> {i < (sheet.rarity.length - 1) ? \"/ \" : null}</span>)}</Typography>\r\n                </Box>\r\n              </Box>\r\n              <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\r\n                {Object.keys(sheet.setEffects).map(setNumKey => <SetEffectDisplay key={setNumKey} setKey={setKey} setNumKey={parseInt(setNumKey) as SetNum} />)}\r\n              </CardContent>\r\n            </CardLight>\r\n          </Grid>\r\n        })}\r\n      </Grid>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent sx={{ py: 1 }}>\r\n      <CloseButton large onClick={onClose} />\r\n    </CardContent>\r\n  </CardDark></ModalWrapper>\r\n}\r\n","import { ButtonGroup, CardContent, Divider, MenuItem } from '@mui/material';\r\nimport React, { useMemo } from 'react';\r\nimport { ArtifactSheet } from '../../Data/Artifacts/ArtifactSheet';\r\nimport SetEffectDisplay from '../../Components/Artifact/SetEffectDisplay';\r\nimport ArtifactSetDropdown from '../../Components/Artifact/ArtifactSetDropdown';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport DropdownButton from '../../Components/DropdownMenu/DropdownButton';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport { BuildSetting } from '../../Types/Build';\r\nimport { ArtifactRarity, ArtifactSetKey, SetNum } from '../../Types/consts';\r\n\r\ntype PickerProps = {\r\n  index: number\r\n  setFilters: BuildSetting[\"setFilters\"],\r\n  disabled?: boolean,\r\n  onChange: (index: number, key: ArtifactSetKey | \"\", num: number) => void,\r\n}\r\n\r\nexport default function ArtifactSetPicker({ index, setFilters, onChange, disabled = false }: PickerProps) {\r\n  const { key: setKey, num: setNum } = setFilters[index]\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const artifactSetsByRarity = useMemo(() => {\r\n    if (!artifactSheets) return undefined\r\n    const artifactSetsByRarity = Object.fromEntries(Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets)).map(([rarity, sets]) => [rarity, sets.filter(setKey => {\r\n      if (setFilters.some(filter => filter.key === setKey)) return false;\r\n      const setsNumArr = Object.keys(artifactSheets?.[setKey]?.setEffects ?? {})\r\n      const artsAccountedOther = setFilters.reduce((accu, cur, ind) => (cur.key && ind !== index) ? accu + cur.num : accu, 0)\r\n      if (setsNumArr.every((num: any) => parseInt(num) + artsAccountedOther > 5)) return false;\r\n      return true\r\n    })])) as Dict<ArtifactRarity, ArtifactSetKey[]>\r\n    return artifactSetsByRarity\r\n  }, [artifactSheets, setFilters, index])\r\n\r\n  const artsAccounted = setFilters.reduce((accu, cur) => cur.key ? accu + cur.num : accu, 0)\r\n\r\n  return <CardLight>\r\n    <CardContent>\r\n      <ButtonGroup>\r\n        {/* Artifact set */}\r\n        {artifactSheets && <ArtifactSetDropdown hasUnselect selectedSetKey={setKey} artifactSetsByRarity={artifactSetsByRarity as any} disabled={disabled}\r\n          onChange={setKey => onChange(index, setKey as ArtifactSetKey, parseInt(Object.keys(artifactSheets[setKey]?.setEffects ?? {})[0] as string) ?? 0)} />}\r\n        {/* set number */}\r\n        <DropdownButton title={`${setNum}-set`}\r\n          disabled={disabled || !setKey || artsAccounted >= 5}\r\n        >\r\n          {Object.keys(artifactSheets?.[setKey]?.setEffects ?? {}).map((num: any) => {\r\n            let artsAccountedOther = setFilters.reduce((accu, cur) => (cur.key && cur.key !== setKey) ? accu + cur.num : accu, 0)\r\n            return (parseInt(num) + artsAccountedOther <= 5) &&\r\n              (<MenuItem key={num} onClick={() => onChange(index, setFilters[index].key, parseInt(num) ?? 0)} >\r\n                {`${num}-set`}\r\n              </MenuItem>)\r\n          })}\r\n        </DropdownButton>\r\n      </ButtonGroup>\r\n    </CardContent>\r\n    {!!setKey && <Divider />}\r\n    {!!setKey && <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\r\n      {Object.keys(artifactSheets?.[setKey].setEffects ?? {}).map(setNKey => parseInt(setNKey as string) as SetNum).filter(setNkey => setNkey <= setNum).map(setNumKey =>\r\n        <SetEffectDisplay key={setKey + setNumKey} setKey={setKey} setNumKey={setNumKey} />)}\r\n    </CardContent>}\r\n  </CardLight>\r\n}\r\n","import { CardContent, Divider, ListItem, Typography } from '@mui/material';\r\nimport { useContext } from 'react';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport { FieldDisplayList, NodeFieldDisplay } from '../../Components/FieldDisplay';\r\nimport { DataContext } from '../../DataContext';\r\nimport { uiInput as input } from '../../Formula';\r\nimport { NumNode } from '../../Formula/type';\r\nexport default function BonusStatsCard() {\r\n  const { data, character } = useContext(DataContext)\r\n  const bonusStatsKeys = Object.keys(character?.bonusStats)\r\n  if (!bonusStatsKeys.length) return null\r\n  const nodes = bonusStatsKeys.map(k => data.get(input.customBonus[k] as NumNode))\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Typography>Bonus Stats</Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent><FieldDisplayList sx={{ my: 0 }} >\r\n      {nodes.map(n => <ListItem key={n.info.key}><NodeFieldDisplay node={n} /></ListItem>)}\r\n    </FieldDisplayList></CardContent>\r\n  </CardLight>\r\n}\r\n","import { Alert, Grid, LinearProgress, styled, Typography } from '@mui/material';\r\nimport React, { ReactNode } from 'react';\r\nimport { timeStringMs } from '../../Util/TimeUtil';\r\n\r\nexport const warningBuildNumber = 10000000\r\n\r\nconst Monospace = styled(\"strong\")({\r\n  fontFamily: \"monospace\"\r\n})\r\n\r\nconst BorderLinearProgress = styled(LinearProgress)(({ theme }) => ({\r\n  height: 10,\r\n  borderRadius: 5,\r\n}));\r\nexport default function BuildAlert({ totBuildNumber, generatingBuilds, generationSkipped, generationProgress, generationDuration, characterName, maxBuildsToShow }) {\r\n  const totalBuildNumberString = totBuildNumber?.toLocaleString() ?? totBuildNumber\r\n  const totalUnskipped = totBuildNumber - generationSkipped\r\n  const generationProgressString = generationProgress?.toLocaleString() ?? generationProgress\r\n  const generationSkippedString = generationSkipped?.toLocaleString() ?? generationSkipped\r\n  const totalUnskippedString = totalUnskipped?.toLocaleString() ?? totalUnskipped\r\n  const generationSkippedText = !!generationSkipped && <span>(<b>{generationSkippedString}</b> skipped)</span>\r\n\r\n  let color = \"success\" as \"success\" | \"warning\" | \"error\"\r\n  let title = \"\" as ReactNode\r\n  let subtitle = \"\" as ReactNode\r\n  let progress = undefined as undefined | number\r\n\r\n  if (generatingBuilds) {\r\n    progress = generationProgress * 100 / (totalUnskipped)\r\n    title = <Typography>Generating and testing <Monospace>{generationProgressString}/{totalUnskippedString}</Monospace> build configurations against the criteria for <b>{characterName}</b>. {generationSkippedText}</Typography>\r\n    subtitle = <Typography>Time elapsed: <Monospace>{timeStringMs(Math.round(generationDuration))}</Monospace></Typography>\r\n  } else if (!generatingBuilds && generationProgress) {//done\r\n    progress = 100\r\n    title = <Typography>Generated and tested <Monospace>{totalUnskippedString}</Monospace> Build configurations against the criteria for <b>{characterName}</b>. {generationSkippedText}</Typography>\r\n    subtitle = <Typography>Total duration: <Monospace>{timeStringMs(Math.round(generationDuration))}</Monospace></Typography>\r\n  } else {\r\n    if (totBuildNumber === 0) {\r\n      title = <Typography>Current configuration will not generate any builds for <b>{characterName}</b>. Please change your Artifact configurations, or add/include more Artifacts.</Typography>\r\n      color = \"error\"\r\n    } else if (totBuildNumber > warningBuildNumber) {\r\n      title = <Typography>Current configuration will generate <Monospace>{totalBuildNumberString}</Monospace> potential builds for <b>{characterName}</b>. This might take quite a while to generate...</Typography>\r\n      color = \"warning\"\r\n    } else\r\n      title = <Typography>Current configuration {totBuildNumber <= maxBuildsToShow ? \"generated\" : \"will generate\"} <Monospace>{totalBuildNumberString}</Monospace> builds for <b>{characterName}</b>.</Typography>\r\n  }\r\n\r\n  return <Alert severity={color} variant=\"filled\" sx={{\r\n    \"& .MuiAlert-message\": {\r\n      flexGrow: 1\r\n    }\r\n  }}>\r\n    {title && title}\r\n    {subtitle && subtitle}\r\n    {progress !== undefined && <Grid container spacing={1} alignItems=\"center\">\r\n      <Grid item>\r\n        <Typography>{`${progress.toFixed(1)}%`}</Typography>\r\n      </Grid>\r\n      <Grid item flexGrow={1} >\r\n        <BorderLinearProgress variant=\"determinate\" value={progress} color=\"primary\" />\r\n      </Grid>\r\n    </Grid>}\r\n  </Alert>\r\n}\r\n\r\n","import { ExpandMore } from '@mui/icons-material';\r\nimport { CardContent, CardHeader, Collapse, Divider, Grid, Typography } from '@mui/material';\r\nimport React, { useContext, useState } from 'react';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport { EnemyEditor, EnemyResText } from '../../Components/EnemyEditor';\r\nimport ExpandButton from '../../Components/ExpandButton';\r\nimport { DataContext } from '../../DataContext';\r\nimport { uiInput as input } from '../../Formula/index';\r\nimport KeyMap, { valueString } from '../../KeyMap';\r\nimport { allElementsWithPhy } from '../../Types/consts';\r\n\r\nexport default function EnemyEditorCard() {\r\n  const [expanded, setExpanded] = useState(false);\r\n  const { data } = useContext(DataContext)\r\n  const eLvlNode = data.get(input.enemy.level)\r\n  const eDefRed = data.get(input.enemy.defRed)\r\n  const eDefIgn = data.get(input.enemy.defIgn)\r\n  return <CardLight>\r\n    <CardHeader\r\n      action={\r\n        <ExpandButton\r\n          expand={expanded}\r\n          onClick={() => setExpanded(!expanded)}\r\n          aria-expanded={expanded}\r\n          aria-label=\"show more\"\r\n          size=\"small\"\r\n        >\r\n          <ExpandMore />\r\n        </ExpandButton>\r\n      }\r\n      title={<Typography>\r\n        {KeyMap.get(eLvlNode.info.key)} <strong>{valueString(eLvlNode.value, eLvlNode.unit, 0)}</strong>\r\n      </Typography>}\r\n    />\r\n    <Divider />\r\n    <CardContent>\r\n      <Grid container spacing={1}>\r\n        {allElementsWithPhy.map(element => <Grid item xs={3} key={element}><EnemyResText element={element} /></Grid>)}\r\n        <Grid item xs={4} ><Typography>DEF Reduction {valueString(eDefRed.value, eDefRed.unit)}</Typography></Grid>\r\n        <Grid item xs={4} ><Typography>DEF Reduction {valueString(eDefIgn.value, eDefIgn.unit)}</Typography></Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <EnemyEditor bsProps={{ xs: 12 }} />\r\n      </CardContent>\r\n    </Collapse>\r\n  </CardLight>\r\n}\r\n","import { CardContent, Divider, Grid, Typography } from '@mui/material';\r\nimport React from 'react';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport { HitModeToggle, InfusionAuraDropdown, ReactionToggle } from '../../Components/HitModeEditor';\r\nexport default function HitModeCard({ disabled }: { disabled: boolean }) {\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Grid container>\r\n        <Grid item flexGrow={1}><Typography>Hit Mode Options</Typography></Grid>\r\n        <Grid item ><InfusionAuraDropdown size=\"small\" disabled={disabled} /></Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent >\r\n      <HitModeToggle fullWidth size=\"small\" disabled={disabled} />\r\n      <ReactionToggle fullWidth size=\"small\" disabled={disabled} sx={{ mt: 1 }} />\r\n    </CardContent>\r\n  </CardLight >\r\n}\r\n","import { Info, Replay } from '@mui/icons-material';\r\nimport { Button, CardContent, Divider, Grid, MenuItem, Typography } from '@mui/material';\r\nimport React from 'react';\r\nimport SlotNameWithIcon from '../../Components/Artifact/SlotNameWIthIcon';\r\nimport BootstrapTooltip from '../../Components/BootstrapTooltip';\r\nimport CardDark from '../../Components/Card/CardDark';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport DropdownButton from '../../Components/DropdownMenu/DropdownButton';\r\nimport SqBadge from '../../Components/SqBadge';\r\nimport StatIcon from '../../Components/StatIcon';\r\nimport KeyMap from '../../KeyMap';\r\nimport { MainStatKey } from '../../Types/artifact';\r\nimport { BuildSetting } from '../../Types/Build';\r\nimport { SlotKey } from '../../Types/consts';\r\nimport Artifact from '../../Data/Artifacts/Artifact';\r\n\r\nexport const artifactsSlotsToSelectMainStats = [\"sands\", \"goblet\", \"circlet\"] as const\r\n\r\nexport default function MainStatSelectionCard({ mainStatAssumptionLevel, mainStatKeys, onChangeMainStatKey, onChangeAssLevel, disabled = false, }: {\r\n  mainStatAssumptionLevel: number\r\n  mainStatKeys: BuildSetting[\"mainStatKeys\"]\r\n  onChangeMainStatKey: (slotKey: SlotKey, mainStatKey?: MainStatKey) => void\r\n  onChangeAssLevel: (level: number) => void\r\n  disabled?: boolean\r\n}) {\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }} >\r\n      <Grid container alignItems=\"center\" spacing={2}>\r\n        <Grid item flexGrow={1}>\r\n          <Typography>Artifact Main Stat</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <BootstrapTooltip placement=\"top\" title={<Typography><strong>Level Assumption</strong> changes mainstat value to be at least a specific level. Does not change substats.</Typography>}>\r\n            <Info />\r\n          </BootstrapTooltip>\r\n        </Grid>\r\n        <Grid item>\r\n          <AssumeFullLevelToggle mainStatAssumptionLevel={mainStatAssumptionLevel} setmainStatAssumptionLevel={v => onChangeAssLevel(v)} disabled={disabled} />\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent sx={{\r\n      // select all excluding last\r\n      \"> div:nth-last-of-type(n+2)\": { mb: 1 }\r\n    }}>\r\n      {artifactsSlotsToSelectMainStats.map(slotKey => {\r\n        const numSel = mainStatKeys[slotKey].length\r\n        return <CardDark key={slotKey}>\r\n          <CardContent sx={{ py: 1 }}><Grid container spacing={1}>\r\n            <Grid item ><SlotNameWithIcon slotKey={slotKey} /></Grid>\r\n            <Grid item flexGrow={1}>\r\n              <SqBadge color=\"info\">{numSel ? `${numSel} Selected` : `Any`}</SqBadge>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button color=\"error\" size=\"small\" disabled={!mainStatKeys[slotKey].length || disabled}\r\n                onClick={() => onChangeMainStatKey(slotKey)}>\r\n                <Replay />\r\n              </Button>\r\n            </Grid>\r\n          </Grid></CardContent>\r\n          <Divider />\r\n          <CardContent>\r\n            <Grid container spacing={1}>\r\n              {Artifact.slotMainStats(slotKey).map((mainStatKey, i) => {\r\n                const selected = mainStatKeys[slotKey].includes(mainStatKey)\r\n                return <Grid item xs={i < 3 ? 4 : 6} key={mainStatKey} >\r\n                  <Button fullWidth size=\"small\" color={selected ? \"success\" : \"secondary\"} disabled={disabled} sx={{ height: \"100%\" }}\r\n                    onClick={() => onChangeMainStatKey(slotKey, mainStatKey)} startIcon={StatIcon[mainStatKey]}>\r\n                    {KeyMap.get(mainStatKey)}\r\n                  </Button>\r\n                </Grid>\r\n              })}\r\n            </Grid>\r\n          </CardContent>\r\n        </CardDark>\r\n      })}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n\r\nconst levels = {\r\n  0: <span>No level assumption</span>,\r\n  4: <span>Assume at least level 4</span>,\r\n  8: <span>Assume at least level 8</span>,\r\n  12: <span>Assume at least level 12</span>,\r\n  16: <span>Assume at least level 16</span>,\r\n  20: <span>Assume at least level 20</span>\r\n} as const\r\nfunction AssumeFullLevelToggle({ mainStatAssumptionLevel = 0, setmainStatAssumptionLevel, disabled }) {\r\n  return <DropdownButton color={mainStatAssumptionLevel ? \"warning\" : \"primary\"} disabled={disabled} title={levels[mainStatAssumptionLevel]}>\r\n    {Object.entries(levels).map(([key, text]) => <MenuItem key={key} onClick={() => setmainStatAssumptionLevel(parseInt(key))}>{text}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n","import { Masonry } from '@mui/lab';\r\nimport { Button, CardContent, CardHeader, Divider, MenuItem, MenuList, styled } from '@mui/material';\r\nimport React, { useCallback, useContext, useState } from 'react';\r\nimport CardDark from '../../Components/Card/CardDark';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport ColorText from '../../Components/ColoredText';\r\nimport ImgIcon from '../../Components/Image/ImgIcon';\r\nimport ModalWrapper from '../../Components/ModalWrapper';\r\nimport { DataContext } from '../../DataContext';\r\nimport { getDisplayHeader, getDisplaySections } from '../../Formula/DisplayUtil';\r\nimport { DisplaySub } from '../../Formula/type';\r\nimport { NodeDisplay } from '../../Formula/uiData';\r\nimport KeyMap from '../../KeyMap';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport { objPathValue } from '../../Util/Util';\r\n\r\nconst WhiteButton = styled(Button)({\r\n  color: \"black\",\r\n  backgroundColor: \"white\",\r\n  \"&:hover\": {\r\n    backgroundColor: \"#e1e1e1\",\r\n  }\r\n})\r\nexport default function OptimizationTargetSelector({ optimizationTarget, setTarget, disabled = false }: {\r\n  optimizationTarget?: string[], setTarget: (target: string[]) => void, disabled\r\n}) {\r\n  const [open, setOpen] = useState(false)\r\n  const onOpen = useCallback(() => !disabled && setOpen(true), [setOpen, disabled])\r\n  const onClose = useCallback(() => setOpen(false), [setOpen])\r\n\r\n  const setTargetHandler = useCallback(\r\n    (target: string[]) => {\r\n      onClose()\r\n      setTarget(target)\r\n    },\r\n    [onClose, setTarget],\r\n  )\r\n  const { data } = useContext(DataContext)\r\n  const sections = getDisplaySections(data)\r\n  return <>\r\n    <WhiteButton onClick={onOpen} disabled={disabled} >\r\n      <TargetDisplayText optimizationTarget={optimizationTarget} />\r\n    </WhiteButton>\r\n    <ModalWrapper open={open} onClose={onClose}>\r\n      <CardDark >\r\n        <CardContent>\r\n          <Masonry columns={{ xs: 1, sm: 2, md: 3 }} spacing={1}>\r\n            {sections.map(([key, Nodes]) =>\r\n              <SelectorSection key={key} displayNs={Nodes} sectionKey={key} setTarget={setTargetHandler} />)}\r\n          </Masonry >\r\n        </CardContent>\r\n      </CardDark>\r\n    </ModalWrapper>\r\n  </>\r\n}\r\nfunction SelectorSection({ displayNs, sectionKey, setTarget }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string, setTarget: (target: string[]) => void }) {\r\n  const { data } = useContext(DataContext)\r\n  const header = usePromise(getDisplayHeader(data, sectionKey), [data, sectionKey])\r\n  if (!header || Object.values(displayNs).every(n => n.isEmpty)) return null\r\n  return <CardLight key={sectionKey as string}>\r\n    <CardHeader avatar={header.icon && <ImgIcon size={2} sx={{ m: -1 }} src={header.icon} />} title={header.title} action={header.action} titleTypographyProps={{ variant: \"subtitle1\" }} />\r\n    <Divider />\r\n    <MenuList>\r\n      {Object.entries(displayNs).map(([key, n]) =>\r\n        <TargetSelectorMenuItem key={key} node={n} onClick={() => setTarget([sectionKey, key])} />)}\r\n    </MenuList>\r\n  </CardLight>\r\n}\r\nfunction NoTarget() {\r\n  return <b>Please select an Optimization Target</b>\r\n}\r\nfunction TargetDisplayText({ optimizationTarget }: { optimizationTarget?: string[] }) {\r\n  const { data } = useContext(DataContext)\r\n  const displayHeader = usePromise(optimizationTarget && getDisplayHeader(data, optimizationTarget[0]), [data, optimizationTarget])\r\n\r\n  if (!optimizationTarget || !displayHeader) return <NoTarget />\r\n  const node: NodeDisplay | undefined = objPathValue(data.getDisplay(), optimizationTarget) as any\r\n  if (!node) return <NoTarget />\r\n\r\n  return <b>{displayHeader.title} : {<ColorText color={node.info.variant}>{KeyMap.get(node.info.key)}</ColorText>}</b>\r\n}\r\nfunction TargetSelectorMenuItem({ node, onClick }: { node: NodeDisplay, onClick: () => void }) {\r\n  if (node.isEmpty) return null\r\n  return <MenuItem onClick={onClick} style={{ overflow: \"hidden\", textOverflow: \"ellipsis\" }}>\r\n    <ColorText color={node.info.variant} >{KeyMap.get(node.info.key)}</ColorText>\r\n  </MenuItem>\r\n}\r\n","import { CardContent, Divider, ListItem, Typography } from '@mui/material';\r\nimport React, { useContext } from 'react';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport { FieldDisplayList, NodeFieldDisplay } from '../../Components/FieldDisplay';\r\nimport { DataContext } from '../../DataContext';\r\nimport { NodeDisplay } from '../../Formula/uiData';\r\nexport default function TeamBuffCard() {\r\n  const { data } = useContext(DataContext)\r\n  const teamBuffs = data.getTeamBuff()\r\n  const nodes: Array<NodeDisplay<number>> = []\r\n  Object.values(teamBuffs.total ?? {}).forEach(node =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push(node))\r\n  Object.values(teamBuffs.premod ?? {}).forEach(node =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push(node))\r\n  Object.values(teamBuffs.enemy ?? {}).forEach(node =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push(node))\r\n  if (!nodes.length) return null\r\n\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Typography>Team Buff Stats</Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      <FieldDisplayList sx={{ my: 0 }} >\r\n        {nodes.map((n, i) => n && <NodeFieldDisplay key={i.toString() + (n.info.key ?? \"\")} node={n} component={ListItem} />)}\r\n      </FieldDisplayList>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import Artifact from \"../Data/Artifacts/Artifact\";\r\nimport { input } from \"../Formula\";\r\nimport { computeUIData } from \"../Formula/api\";\r\nimport { formulaString } from \"../Formula/debug\";\r\nimport { Data, NumNode } from \"../Formula/type\";\r\nimport { constant, setReadNodeKeys } from \"../Formula/utils\";\r\nimport { allMainStatKeys, allSubstats, ICachedArtifact } from \"../Types/artifact\";\r\nimport { SetFilter } from \"../Types/Build\";\r\nimport { allSlotKeys, ArtifactSetKey } from \"../Types/consts\";\r\nimport { deepClone, objectKeyMap, objectMap } from \"../Util/Util\";\r\nimport type { ArtifactBuildData, ArtifactsBySlot, DynStat, RequestFilter } from \"./background\";\r\nimport { countBuilds, filterArts } from \"./common\";\r\n\r\nconst dynamic = setReadNodeKeys(deepClone({ dyn: { ...input.art, ...input.artSet } }))\r\nexport const dynamicData = {\r\n  art: objectKeyMap([...allMainStatKeys, ...allSubstats], key => dynamic.dyn[key]),\r\n  artSet: objectMap(input.artSet, (_, key) => dynamic.dyn[key]),\r\n}\r\n\r\nexport function compactArtifacts(arts: ICachedArtifact[], mainStatAssumptionLevel: number): ArtifactsBySlot {\r\n  const result: ArtifactsBySlot = {\r\n    base: {},\r\n    values: { flower: [], plume: [], goblet: [], circlet: [], sands: [] }\r\n  }\r\n  const keys = new Set<string>()\r\n\r\n  for (const art of arts) {\r\n    const mainStatVal = Artifact.mainStatValue(art.mainStatKey, art.rarity, Math.max(Math.min(mainStatAssumptionLevel, art.rarity * 4), art.level))\r\n\r\n    const data: ArtifactBuildData = {\r\n      id: art.id, set: art.setKey,\r\n      values: {\r\n        [art.setKey]: 1,\r\n        [art.mainStatKey]: art.mainStatKey.endsWith('_') ? mainStatVal / 100 : mainStatVal,\r\n        ...Object.fromEntries(art.substats.map(substat =>\r\n          [substat.key, substat.key.endsWith('_') ? substat.accurateValue / 100 : substat.accurateValue]))\r\n      },\r\n    }\r\n    delete data.values[\"\"]\r\n    result.values[art.slotKey].push(data)\r\n    Object.keys(data.values).forEach(x => keys.add(x))\r\n  }\r\n  result.base = objectKeyMap([...keys], _ => 0)\r\n  return result\r\n}\r\nexport function* artSetPerm(filters: SetFilter[]): Iterable<RequestFilter> {\r\n  function* check(request: RequestFilter, filters: Dict<ArtifactSetKey, number>[], remainingSlots: number) {\r\n    if (!filters.length) return\r\n    if (filters.some(filter => !Object.keys(filter).length)) {\r\n      yield request\r\n      return\r\n    }\r\n\r\n    const slot = allSlotKeys[remainingSlots - 1]\r\n    const keys = new Set(filters.flatMap(filter => Object.keys(filter)))\r\n    for (const key of keys) {\r\n      const newRequest = { ...request, [slot]: { kind: \"required\", sets: new Set([key]) } }\r\n      const newFilters = filters\r\n        .filter(filter => filter[key])\r\n        .map(filter => {\r\n          const result = { ...filter }\r\n          result[key]! -= 1\r\n          if (!result[key]) delete result[key]\r\n          return result\r\n        })\r\n      yield* check(newRequest, newFilters, remainingSlots - 1)\r\n    }\r\n    {\r\n      const newRequest = { ...request, [slot]: { kind: \"exclude\", sets: keys } }\r\n      const newFilters = filters.filter(filter =>\r\n        Object.values(filter).reduce((a, b) => a + b, 0) < remainingSlots)\r\n      yield* check(newRequest, newFilters, remainingSlots - 1)\r\n    }\r\n  }\r\n  yield* check(objectKeyMap(allSlotKeys, _ => noFilter), filters.map(filter => {\r\n    const result: Dict<ArtifactSetKey, number> = {}\r\n    filter.forEach(({ key, num }) => key && num && (result[key] = (result[key] ?? 0) + num))\r\n    return result\r\n  }), 5)\r\n}\r\nexport function* splitFiltersBySet(_arts: ArtifactsBySlot, filters: Iterable<RequestFilter>, limit: number): Iterable<RequestFilter> {\r\n  if (limit < 10000) limit = 10000\r\n\r\n  for (const filter of filters) {\r\n    const filters = [filter]\r\n\r\n    while (filters.length) {\r\n      const filter = filters.pop()!\r\n      const arts = filterArts(_arts, filter)\r\n      const count = countBuilds(arts)\r\n      if (count <= limit) {\r\n        if (count) yield filter\r\n        continue\r\n      }\r\n\r\n      const candidates = allSlotKeys\r\n        // TODO: Cache this loop\r\n        .map(slot => ({ slot, sets: new Set(arts.values[slot].map(x => x.set)) }))\r\n        .filter(({ sets }) => sets.size > 1)\r\n      if (!candidates.length) {\r\n        yield* splitFilterByIds(arts, filter, limit)\r\n        continue\r\n      }\r\n      const { sets, slot } = candidates.reduce((a, b) => a.sets.size < b.sets.size ? a : b)\r\n      sets.forEach(set => filters.push({ ...filter, [slot]: { kind: \"required\", sets: new Set([set]) } }))\r\n    }\r\n  }\r\n}\r\nfunction* splitFilterByIds(_arts: ArtifactsBySlot, filter: RequestFilter, limit: number): Iterable<RequestFilter> {\r\n  const filters = [filter]\r\n\r\n  while (filters.length) {\r\n    const filter = filters.pop()!\r\n    const arts = filterArts(_arts, filter)\r\n    const count = countBuilds(arts)\r\n    if (count <= limit) {\r\n      if (count) yield filter\r\n      continue\r\n    }\r\n\r\n    const candidates = allSlotKeys\r\n      .map(slot => ({ slot, length: arts.values[slot].length }))\r\n      .filter(x => x.length > 1)\r\n    const { slot, length } = candidates.reduce((a, b) => a.length < b.length ? a : b)\r\n\r\n    const numChunks = Math.ceil(count / limit)\r\n    const boundedNumChunks = Math.min(numChunks, length)\r\n    const chunk = Array(boundedNumChunks).fill(0).map(_ => new Set<string>())\r\n    arts.values[slot].forEach(({ id }, i) => chunk[i % boundedNumChunks].add(id))\r\n    if (numChunks > length) {\r\n      chunk.forEach(ids => filters.push({ ...filter, [slot]: { kind: \"id\", ids } }))\r\n    } else {\r\n      for (const ids of chunk)\r\n        yield { ...filter, [slot]: { kind: \"id\", ids } }\r\n    }\r\n  }\r\n}\r\n\r\nconst noFilter = { kind: \"exclude\" as const, sets: new Set<ArtifactSetKey>() }\r\n\r\nexport function debugCompute(nodes: NumNode[], base: DynStat, arts: ArtifactBuildData[]) {\r\n  const stats = { ...base }\r\n  for (const art of arts) {\r\n    for (const [key, value] of Object.entries(art.values)) {\r\n      stats[key] = (stats[key] ?? 0) + value\r\n    }\r\n  }\r\n  const data = { dyn: Object.fromEntries(Object.entries(stats).map(([key, value]) => [key, constant(value)])) } as Data\r\n  const uiData = computeUIData([data])\r\n  return {\r\n    base, arts, stats,\r\n    data, uiData,\r\n    nodes: nodes.map(formulaString),\r\n    results: nodes.map(node => uiData.get(node)),\r\n  }\r\n}\r\n","import { faCalculator } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { CheckBox, CheckBoxOutlineBlank, Close } from '@mui/icons-material';\r\nimport { Alert, Box, Button, ButtonGroup, CardContent, Divider, Grid, Link, MenuItem, Skeleton, ToggleButton, Typography } from '@mui/material';\r\nimport React, { Suspense, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\r\nimport ReactGA from 'react-ga';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\n// eslint-disable-next-line\r\nimport Worker from \"worker-loader!./BackgroundWorker\";\r\nimport ArtifactLevelSlider from '../Components/Artifact/ArtifactLevelSlider';\r\nimport CardDark from '../Components/Card/CardDark';\r\nimport CardLight from '../Components/Card/CardLight';\r\nimport CharacterDropdownButton from '../Components/Character/CharacterDropdownButton';\r\nimport DropdownButton from '../Components/DropdownMenu/DropdownButton';\r\nimport InfoComponent from '../Components/InfoComponent';\r\nimport SolidToggleButtonGroup from '../Components/SolidToggleButtonGroup';\r\nimport StatFilterCard from '../Components/StatFilterCard';\r\nimport CharacterSheet from '../Data/Characters/CharacterSheet';\r\nimport { DatabaseContext } from '../Database/Database';\r\nimport { DataContext, dataContextObj } from '../DataContext';\r\nimport { mergeData, uiDataForTeam } from '../Formula/api';\r\nimport { uiInput as input } from '../Formula/index';\r\nimport { optimize } from '../Formula/optimization';\r\nimport { NumNode } from '../Formula/type';\r\nimport { UIData } from '../Formula/uiData';\r\nimport { initGlobalSettings } from '../GlobalSettings';\r\nimport KeyMap from '../KeyMap';\r\nimport CharacterCard from '../PageCharacter/CharacterCard';\r\nimport useCharacter from '../ReactHooks/useCharacter';\r\nimport useCharacterReducer, { characterReducerAction } from '../ReactHooks/useCharacterReducer';\r\nimport useCharSelectionCallback from '../ReactHooks/useCharSelectionCallback';\r\nimport useDBState from '../ReactHooks/useDBState';\r\nimport useForceUpdate from '../ReactHooks/useForceUpdate';\r\nimport useTeamData, { getTeamData } from '../ReactHooks/useTeamData';\r\nimport { ICachedArtifact } from '../Types/artifact';\r\nimport { BuildSetting } from '../Types/Build';\r\nimport { ICachedCharacter } from '../Types/character';\r\nimport { ArtifactSetKey, CharacterKey } from '../Types/consts';\r\nimport { objPathValue, range } from '../Util/Util';\r\nimport { Build, ChartData, Finalize, FinalizeResult, Request, Setup, WorkerResult } from './background';\r\nimport { maxBuildsToShowList } from './Build';\r\nimport { initialBuildSettings } from './BuildSetting';\r\nimport ChartCard from './ChartCard';\r\nimport { countBuilds, filterArts, mergeBuilds, mergePlot, pruneAll } from './common';\r\nimport ArtifactBuildDisplayItem from './Components/ArtifactBuildDisplayItem';\r\nimport ArtifactConditionalCard from './Components/ArtifactConditionalCard';\r\nimport ArtifactSetPicker from './Components/ArtifactSetPicker';\r\nimport BonusStatsCard from './Components/BonusStatsCard';\r\nimport BuildAlert, { warningBuildNumber } from './Components/BuildAlert';\r\nimport EnemyEditorCard from './Components/EnemyEditorCard';\r\nimport HitModeCard from './Components/HitModeCard';\r\nimport MainStatSelectionCard from './Components/MainStatSelectionCard';\r\nimport OptimizationTargetSelector from './Components/OptimizationTargetSelector';\r\nimport TeamBuffCard from './Components/TeamBuffCard';\r\nimport { artSetPerm, compactArtifacts, dynamicData, splitFiltersBySet } from './foreground';\r\n\r\nconst InfoDisplay = React.lazy(() => import('./InfoDisplay'));\r\n\r\nfunction buildSettingsReducer(state: BuildSetting, action): BuildSetting {\r\n  switch (action.type) {\r\n    case 'mainStatKey': {\r\n      const { slotKey, mainStatKey } = action\r\n      const mainStatKeys = { ...state.mainStatKeys }//create a new object to update react dependencies\r\n\r\n      if (state.mainStatKeys[slotKey].includes(mainStatKey))\r\n        mainStatKeys[slotKey] = mainStatKeys[slotKey].filter(k => k !== mainStatKey)\r\n      else\r\n        mainStatKeys[slotKey].push(mainStatKey)\r\n      return { ...state, mainStatKeys }\r\n    }\r\n    case 'mainStatKeyReset': {\r\n      const { slotKey } = action\r\n      const mainStatKeys = { ...state.mainStatKeys }//create a new object to update react dependencies\r\n      mainStatKeys[slotKey] = []\r\n      return { ...state, mainStatKeys }\r\n    }\r\n    case `setFilter`: {\r\n      const { index, key, num = 0 } = action\r\n      state.setFilters[index] = { key, num }\r\n      return { ...state, setFilters: [...state.setFilters] }//do this because this is a dependency, so needs to be a \"new\" array\r\n    }\r\n    default:\r\n      break;\r\n  }\r\n  return { ...state, ...action }\r\n}\r\nfunction initialBuildDisplayState(): {\r\n  characterKey: CharacterKey | \"\"\r\n} {\r\n  return {\r\n    characterKey: \"\"\r\n  }\r\n}\r\n\r\nexport default function BuildDisplay({ location: { characterKey: propCharacterKey } }) {\r\n  const [{ tcMode }] = useDBState(\"GlobalSettings\", initGlobalSettings)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [{ characterKey }, setBuildSettings] = useDBState(\"BuildDisplay\", initialBuildDisplayState)\r\n  const setcharacterKey = useCallback(characterKey => {\r\n    if (characterKey && database._getChar(characterKey)) setBuildSettings({ characterKey })\r\n    else setBuildSettings({ characterKey: \"\" })\r\n  }, [setBuildSettings, database])\r\n\r\n  // propCharacterKey can override the selected character, on initial load. This is intended to run on component startup.\r\n  useEffect(() => {\r\n    if (propCharacterKey && propCharacterKey !== characterKey)\r\n      setcharacterKey(propCharacterKey)\r\n    // eslint-disable-next-line\r\n  }, [])\r\n\r\n  const [generatingBuilds, setgeneratingBuilds] = useState(false)\r\n  const [generationProgress, setgenerationProgress] = useState(0)\r\n  const [generationDuration, setgenerationDuration] = useState(0)//in ms\r\n  const [generationSkipped, setgenerationSkipped] = useState(0)\r\n\r\n  const [chartData, setchartData] = useState(undefined as ChartData | undefined)\r\n\r\n  const [artsDirty, setArtsDirty] = useForceUpdate()\r\n\r\n  const [maxWorkers, setMaxWorkers] = useState(navigator.hardwareConcurrency || 4)\r\n\r\n  const setCharacter = useCharSelectionCallback()\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const character = useCharacter(characterKey)\r\n  const buildSettings = character?.buildSettings ?? initialBuildSettings()\r\n  const { plotBase, setFilters, statFilters, mainStatKeys, optimizationTarget, mainStatAssumptionLevel, useExcludedArts, useEquippedArts, builds, buildDate, maxBuildsToShow, levelLow, levelHigh } = buildSettings\r\n  const buildsArts = useMemo(() => builds.map(build => build.map(i => database._getArt(i)!)), [builds, database])\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\r\n  const { characterSheet, target: data } = teamData?.[characterKey as CharacterKey] ?? {}\r\n  const compareData = character?.compareData ?? false\r\n\r\n  const noCharacter = useMemo(() => !database._getCharKeys().length, [database])\r\n  const noArtifact = useMemo(() => !database._getArts().length, [database])\r\n\r\n  const buildSettingsDispatch = useCallback((action) =>\r\n    characterDispatch && characterDispatch({ buildSettings: buildSettingsReducer(buildSettings, action) })\r\n    , [characterDispatch, buildSettings])\r\n\r\n  useEffect(() => ReactGA.pageview('/build'), [])\r\n\r\n  //select a new character Key\r\n  const selectCharacter = useCallback((cKey = \"\") => {\r\n    if (characterKey === cKey) return\r\n    setcharacterKey(cKey)\r\n    setchartData(undefined)\r\n  }, [setcharacterKey, characterKey])\r\n\r\n  //register changes in artifact database\r\n  useEffect(() =>\r\n    database.followAnyArt(setArtsDirty),\r\n    [setArtsDirty, database])\r\n\r\n  const { split, setPerms, totBuildNumber } = useMemo(() => {\r\n    if (!characterKey) // Make sure we have all slotKeys\r\n      return { totBuildNumber: 0 }\r\n    const arts = database._getArts().filter(art => {\r\n      if (art.level < levelLow) return false\r\n      if (art.level > levelHigh) return false\r\n      const mainStats = mainStatKeys[art.slotKey]\r\n      if (mainStats?.length && !mainStats.includes(art.mainStatKey)) return false\r\n\r\n      // If its equipped on the selected character, bypass the check\r\n      if (art.location === characterKey) return true\r\n\r\n      if (art.exclude && !useExcludedArts) return false\r\n      if (art.location && !useEquippedArts) return false\r\n      return true\r\n    })\r\n    const split = compactArtifacts(arts, mainStatAssumptionLevel)\r\n    const setPerms = [...artSetPerm([setFilters])]\r\n    const totBuildNumber = [...setPerms].map(perm => countBuilds(filterArts(split, perm))).reduce((a, b) => a + b, 0)\r\n    return artsDirty && { split, setPerms, totBuildNumber }\r\n  }, [characterKey, useExcludedArts, useEquippedArts, mainStatKeys, setFilters, levelLow, levelHigh, artsDirty, database, mainStatAssumptionLevel])\r\n\r\n  // Reset the Alert by setting progress to zero.\r\n  useEffect(() => {\r\n    setgenerationProgress(0)\r\n  }, [totBuildNumber])\r\n\r\n  // Provides a function to cancel the work\r\n  const cancelToken = useRef(() => { })\r\n  //terminate worker when component unmounts\r\n  useEffect(() => () => cancelToken.current(), [])\r\n  const generateBuilds = useCallback(async () => {\r\n    if (!characterKey || !optimizationTarget || !split || !setPerms) return\r\n    const teamData = await getTeamData(database, characterKey, mainStatAssumptionLevel, [])\r\n    if (!teamData) return\r\n    const workerData = uiDataForTeam(teamData.teamData, characterKey)[characterKey as CharacterKey]?.target.data![0]\r\n    if (!workerData) return\r\n    Object.assign(workerData, mergeData([workerData, dynamicData])) // Mark art fields as dynamic\r\n    let optimizationTargetNode = objPathValue(workerData.display ?? {}, optimizationTarget) as NumNode | undefined\r\n    if (!optimizationTargetNode) return\r\n    const targetNode = optimizationTargetNode\r\n    const valueFilter: { value: NumNode, minimum: number }[] = Object.entries(statFilters).map(([key, value]) => {\r\n      if (key.endsWith(\"_\")) value = value / 100 // TODO: Conversion\r\n      return { value: input.total[key], minimum: value }\r\n    }).filter(x => x.value && x.minimum > -Infinity)\r\n\r\n    const t1 = performance.now()\r\n    setgeneratingBuilds(true)\r\n    setchartData(undefined)\r\n    setgenerationDuration(0)\r\n    setgenerationProgress(0)\r\n    setgenerationSkipped(0)\r\n\r\n    const cancelled = new Promise<void>(r => cancelToken.current = r)\r\n\r\n    let nodes = [...valueFilter.map(x => x.value), optimizationTargetNode], arts = split!\r\n    const origCount = totBuildNumber, minimum = [...valueFilter.map(x => x.minimum), -Infinity]\r\n    if (plotBase) {\r\n      nodes.push(input.total[plotBase])\r\n      minimum.push(-Infinity)\r\n    }\r\n\r\n    nodes = optimize(nodes, workerData, ({ path: [p] }) => p !== \"dyn\");\r\n    ({ nodes, arts } = pruneAll(nodes, minimum, arts, maxBuildsToShow,\r\n      new Set(setFilters.map(x => x.key as ArtifactSetKey)), {\r\n      reaffine: true, pruneArtRange: true, pruneNodeRange: true, pruneOrder: true\r\n    }))\r\n\r\n    const plotBaseNode = plotBase ? nodes.pop() : undefined\r\n    optimizationTargetNode = nodes.pop()!\r\n\r\n    let wrap = {\r\n      buildCount: 0, failedCount: 0, skippedCount: origCount,\r\n      buildValues: Array(maxBuildsToShow).fill(0).map(_ => -Infinity)\r\n    }\r\n    setPerms.forEach(filter => wrap.skippedCount -= countBuilds(filterArts(arts, filter)))\r\n\r\n    const setPerm = splitFiltersBySet(arts, setPerms,\r\n      maxWorkers === 1\r\n        // Don't split for single worker\r\n        ? Infinity\r\n        // 8 perms / worker, up to 1M builds / perm\r\n        : Math.min(origCount / maxWorkers / 4, 1_000_000))[Symbol.iterator]()\r\n\r\n    function fetchWork(): Request | undefined {\r\n      const { done, value } = setPerm.next()\r\n      return done ? undefined : {\r\n        command: \"request\",\r\n        threshold: wrap.buildValues[maxBuildsToShow - 1], filter: value,\r\n      }\r\n    }\r\n\r\n    const filters = nodes\r\n      .map((value, i) => ({ value, min: minimum[i] }))\r\n      .filter(x => x.min > -Infinity)\r\n\r\n    const finalizedList: Promise<FinalizeResult>[] = []\r\n    for (let i = 0; i < maxWorkers; i++) {\r\n      const worker = new Worker()\r\n\r\n      const setup: Setup = {\r\n        command: \"setup\",\r\n        id: `${i}`,\r\n        arts,\r\n        optimizationTarget: optimizationTargetNode,\r\n        plotBase: plotBaseNode,\r\n        maxBuilds: maxBuildsToShow,\r\n        filters\r\n      }\r\n      worker.postMessage(setup, undefined)\r\n      let finalize: (_: FinalizeResult) => void\r\n      const finalized = new Promise<FinalizeResult>(r => finalize = r)\r\n      worker.onmessage = async ({ data }: { data: WorkerResult }) => {\r\n        switch (data.command) {\r\n          case \"interim\":\r\n            wrap.buildCount += data.buildCount\r\n            wrap.failedCount += data.failedCount\r\n            wrap.skippedCount += data.skippedCount\r\n            if (data.buildValues) {\r\n              wrap.buildValues.push(...data.buildValues)\r\n              wrap.buildValues.sort((a, b) => b - a).splice(maxBuildsToShow)\r\n            }\r\n            break\r\n          case \"request\":\r\n            const work = fetchWork()\r\n            if (work) {\r\n              worker.postMessage(work)\r\n            } else {\r\n              const finalizeCommand: Finalize = { command: \"finalize\" }\r\n              worker.postMessage(finalizeCommand)\r\n            }\r\n            break\r\n          case \"finalize\":\r\n            worker.terminate()\r\n            finalize(data);\r\n            break\r\n          default: console.log(\"DEBUG\", data)\r\n        }\r\n      }\r\n\r\n      cancelled.then(() => worker.terminate())\r\n      finalizedList.push(finalized)\r\n    }\r\n\r\n    const buildTimer = setInterval(() => {\r\n      setgenerationProgress(wrap.buildCount)\r\n      setgenerationSkipped(wrap.skippedCount)\r\n      setgenerationDuration(performance.now() - t1)\r\n    }, 100)\r\n    const results = await Promise.any([Promise.all(finalizedList), cancelled])\r\n    clearInterval(buildTimer)\r\n    cancelToken.current = () => { }\r\n\r\n    if (!results) {\r\n      setgenerationDuration(0)\r\n      setgenerationProgress(0)\r\n      setgenerationSkipped(0)\r\n    } else {\r\n      if (plotBase) {\r\n        const plotData = mergePlot(results.map(x => x.plotData!))\r\n        const plotBaseNode = input.total[plotBase] as NumNode\r\n        let data = Object.values(plotData)\r\n        if (KeyMap.unit(targetNode.info?.key) === \"%\")\r\n          data = data.map(({ value, plot }) => ({ value: value * 100, plot })) as Build[]\r\n        if (KeyMap.unit(plotBaseNode!.info?.key) === \"%\")\r\n          data = data.map(({ value, plot }) => ({ value, plot: (plot ?? 0) * 100 })) as Build[]\r\n        setchartData({\r\n          valueNode: targetNode,\r\n          plotNode: plotBaseNode,\r\n          data\r\n        })\r\n      }\r\n      const builds = mergeBuilds(results.map(x => x.builds), maxBuildsToShow)\r\n      if (process.env.NODE_ENV === \"development\") console.log(\"Build Result\", builds)\r\n      buildSettingsDispatch({ builds: builds.map(build => build.artifactIds), buildDate: Date.now() })\r\n      const totalDuration = performance.now() - t1\r\n\r\n      setgenerationProgress(wrap.buildCount)\r\n      setgenerationSkipped(wrap.skippedCount)\r\n      setgenerationDuration(totalDuration)\r\n\r\n      ReactGA.timing({\r\n        category: \"Build Generation\",\r\n        variable: \"timing\",\r\n        value: totalDuration,\r\n        label: totBuildNumber.toString()\r\n      })\r\n    }\r\n    setgeneratingBuilds(false)\r\n  }, [characterKey, database, totBuildNumber, mainStatAssumptionLevel, maxBuildsToShow, optimizationTarget, plotBase, setPerms, split, buildSettingsDispatch, setFilters, statFilters, maxWorkers])\r\n\r\n  const characterName = characterSheet?.name ?? \"Character Name\"\r\n\r\n  const setPlotBase = useCallback(plotBase => {\r\n    buildSettingsDispatch({ plotBase })\r\n    setchartData(undefined)\r\n  }, [buildSettingsDispatch])\r\n  const dataContext: dataContextObj | undefined = useMemo(() => {\r\n    return data && characterSheet && character && teamData && {\r\n      data,\r\n      characterSheet,\r\n      character,\r\n      mainStatAssumptionLevel,\r\n      teamData,\r\n      characterDispatch\r\n    }\r\n  }, [data, characterSheet, character, teamData, characterDispatch, mainStatAssumptionLevel])\r\n\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1} sx={{ my: 1 }}>\r\n    <InfoComponent\r\n      pageKey=\"buildPage\"\r\n      modalTitle=\"Character Management Page Guide\"\r\n      text={[\"For self-infused attacks, like Noelle's Sweeping Time, enable the skill in the character talent page.\",\r\n        \"You can compare the difference between equipped artifacts and generated builds.\",\r\n        \"Rainbow builds can sometimes be \\\"optimal\\\". Good substat combinations can sometimes surpass set effects.\",\r\n        \"The more complex the formula, the longer the generation time.\",]}\r\n    ><InfoDisplay /></InfoComponent>\r\n    {noCharacter && <Alert severity=\"error\" variant=\"filled\"> Opps! It looks like you haven't added a character to GO yet! You should go to the <Link component={RouterLink} to=\"/character\">Characters</Link> page and add some!</Alert>}\r\n    {noArtifact && <Alert severity=\"warning\" variant=\"filled\"> Opps! It looks like you haven't added any artifacts to GO yet! You should go to the <Link component={RouterLink} to=\"/artifact\">Artifacts</Link> page and add some!</Alert>}\r\n    {/* Build Generator Editor */}\r\n    {!dataContext && <CardDark>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Typography variant=\"h6\">Build Generator</Typography>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <CardLight>\r\n          <CardContent>\r\n            <CharacterDropdownButton fullWidth value={characterKey} onChange={selectCharacter} disabled={generatingBuilds} />\r\n          </CardContent>\r\n        </CardLight>\r\n      </CardContent>\r\n    </CardDark>}\r\n    {dataContext && <DataContext.Provider value={dataContext}>\r\n      <CardDark>\r\n        <CardContent sx={{ py: 1 }}>\r\n          <Typography variant=\"h6\">Build Generator</Typography>\r\n        </CardContent>\r\n        <Divider />\r\n        <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n          <Grid container spacing={1} >\r\n            {/* Left half */}\r\n            <Grid item xs={12} md={6} lg={5} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n              <CardLight>\r\n                <CardContent>\r\n                  <CharacterDropdownButton fullWidth value={characterKey} onChange={selectCharacter} disabled={generatingBuilds} />\r\n                </CardContent>\r\n              </CardLight>\r\n              {/* character card */}\r\n              <Box><CharacterCard characterKey={characterKey} onClick={generatingBuilds ? undefined : setCharacter} /></Box>\r\n\r\n              <BonusStatsCard />\r\n              <TeamBuffCard />\r\n              {/* Enemy Editor */}\r\n              <EnemyEditorCard />\r\n              {/*Minimum Final Stat Filter */}\r\n              <StatFilterCard statFilters={statFilters} setStatFilters={sFs => buildSettingsDispatch({ statFilters: sFs })} disabled={generatingBuilds} />\r\n              {/* Hit mode options */}\r\n              <HitModeCard disabled={generatingBuilds} />\r\n            </Grid>\r\n\r\n            {/* Right half */}\r\n            <Grid item xs={12} md={6} lg={7} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n              <ArtifactConditionalCard disabled={generatingBuilds} />\r\n\r\n              {/* Artifact set pickers */}\r\n              {setFilters.map((setFilter, index) => (index <= setFilters.filter(s => s.key).length) && <ArtifactSetPicker key={index} index={index} setFilters={setFilters}\r\n                disabled={generatingBuilds} onChange={(index, key, num) => buildSettingsDispatch({ type: 'setFilter', index, key, num })} />)}\r\n\r\n              {/* use equipped/excluded */}\r\n              {characterKey && <CardLight><CardContent>\r\n                <Grid container spacing={1}>\r\n                  <Grid item flexGrow={1}>\r\n                    <Button fullWidth onClick={() => buildSettingsDispatch({ useEquippedArts: !useEquippedArts })} disabled={generatingBuilds} startIcon={useEquippedArts ? <CheckBox /> : <CheckBoxOutlineBlank />}>\r\n                      Use Equipped Artifacts\r\n                    </Button>\r\n                  </Grid>\r\n                  <Grid item flexGrow={1}>\r\n                    <Button fullWidth onClick={() => buildSettingsDispatch({ useExcludedArts: !useExcludedArts })} disabled={generatingBuilds} startIcon={useExcludedArts ? <CheckBox /> : <CheckBoxOutlineBlank />}>\r\n                      Use Excluded Artifacts\r\n                    </Button>\r\n                  </Grid>\r\n                </Grid>\r\n              </CardContent></CardLight>}\r\n\r\n              { /* Level Filter */}\r\n              {characterKey && <CardLight>\r\n                <CardContent sx={{ py: 1 }}>\r\n                  Artifact Level Filter\r\n                </CardContent>\r\n                <Divider />\r\n                <CardContent>\r\n                  <ArtifactLevelSlider levelLow={levelLow} levelHigh={levelHigh} dark\r\n                    setLow={levelLow => buildSettingsDispatch({ levelLow })}\r\n                    setHigh={levelHigh => buildSettingsDispatch({ levelHigh })}\r\n                    setBoth={(levelLow, levelHigh) => buildSettingsDispatch({ levelLow, levelHigh })}\r\n                    disabled={generatingBuilds}\r\n                  />\r\n                </CardContent>\r\n              </CardLight>}\r\n              {/* main stat selector */}\r\n              {characterKey && <MainStatSelectionCard\r\n                mainStatAssumptionLevel={mainStatAssumptionLevel}\r\n                mainStatKeys={mainStatKeys}\r\n                onChangeMainStatKey={(slotKey, mainStatKey = undefined) => {\r\n                  if (mainStatKey === undefined)\r\n                    buildSettingsDispatch({ type: \"mainStatKeyReset\", slotKey })\r\n                  else\r\n                    buildSettingsDispatch({ type: \"mainStatKey\", slotKey, mainStatKey })\r\n                }}\r\n                onChangeAssLevel={mainStatAssumptionLevel => buildSettingsDispatch({ mainStatAssumptionLevel })}\r\n                disabled={generatingBuilds}\r\n              />}\r\n            </Grid>\r\n          </Grid>\r\n          {/* Footer */}\r\n          <Grid container spacing={1}>\r\n            <Grid item flexGrow={1} >\r\n              <ButtonGroup>\r\n                <Button\r\n                  disabled={!characterKey || generatingBuilds || !optimizationTarget || !totBuildNumber || !objPathValue(data?.getDisplay(), optimizationTarget)}\r\n                  color={(characterKey && totBuildNumber <= warningBuildNumber) ? \"success\" : \"warning\"}\r\n                  onClick={generateBuilds}\r\n                  startIcon={<FontAwesomeIcon icon={faCalculator} />}\r\n                >Generate</Button>\r\n                {/* <Tooltip title={<Typography></Typography>} placement=\"top\" arrow> */}\r\n                <DropdownButton disabled={generatingBuilds || !characterKey}\r\n                  title={<span><b>{maxBuildsToShow}</b> {maxBuildsToShow === 1 ? \"Build\" : \"Builds\"}</span>}>\r\n                  <MenuItem>\r\n                    <Typography variant=\"caption\" color=\"info.main\">\r\n                      Decreasing the number of generated build will decrease build calculation time for large number of builds.\r\n                    </Typography>\r\n                  </MenuItem>\r\n                  <Divider />\r\n                  {maxBuildsToShowList.map(v => <MenuItem key={v}\r\n                    onClick={() => buildSettingsDispatch({ maxBuildsToShow: v })}>{v} {v === 1 ? \"Build\" : \"Builds\"}</MenuItem>)}\r\n                </DropdownButton>\r\n                <DropdownButton disabled={generatingBuilds || !characterKey} color=\"info\"\r\n                  title={<span><b>{maxWorkers}</b> {maxWorkers === 1 ? \"Thread\" : \"Threads\"}</span>}>\r\n                  <MenuItem>\r\n                    <Typography variant=\"caption\" color=\"info.main\">\r\n                      Increasing the number of threads will speed up build time, but will use more CPU power.\r\n                    </Typography>\r\n                  </MenuItem>\r\n                  <Divider />\r\n                  {range(1, navigator.hardwareConcurrency || 4).reverse().map(v => <MenuItem key={v}\r\n                    onClick={() => setMaxWorkers(v)}>{v} {v === 1 ? \"Thread\" : \"Threads\"}</MenuItem>)}\r\n                </DropdownButton>\r\n                {/* </Tooltip> */}\r\n                <Button\r\n                  disabled={!generatingBuilds}\r\n                  color=\"error\"\r\n                  onClick={() => cancelToken.current()}\r\n                  startIcon={<Close />}\r\n                >Cancel</Button>\r\n              </ButtonGroup>\r\n            </Grid>\r\n            <Grid item>\r\n              <span>Optimization Target: </span>\r\n              {<OptimizationTargetSelector\r\n                optimizationTarget={optimizationTarget}\r\n                setTarget={target => buildSettingsDispatch({ optimizationTarget: target })}\r\n                disabled={!!generatingBuilds}\r\n              />}\r\n            </Grid>\r\n          </Grid>\r\n\r\n          {!!characterKey && <Box >\r\n            <BuildAlert {...{ totBuildNumber, generatingBuilds, generationSkipped, generationProgress, generationDuration, characterName, maxBuildsToShow }} />\r\n          </Box>}\r\n          {tcMode && <Box >\r\n            <ChartCard disabled={generatingBuilds} chartData={chartData} plotBase={plotBase} setPlotBase={setPlotBase} />\r\n          </Box>}\r\n        </CardContent>\r\n      </CardDark>\r\n      <CardDark>\r\n        <CardContent>\r\n          <Box display=\"flex\" alignItems=\"center\" gap={1} >\r\n            <Typography sx={{ flexGrow: 1 }}>\r\n              {builds ? <span>Showing <strong>{builds.length}</strong> Builds generated for {characterName}. {!!buildDate && <span>Build generated on: <strong>{(new Date(buildDate)).toLocaleString()}</strong></span>}</span>\r\n                : <span>Select a character to generate builds.</span>}\r\n            </Typography>\r\n            <Button disabled={!builds.length} color=\"error\" onClick={() => buildSettingsDispatch({ builds: [], buildDate: 0 })} >Clear Builds</Button>\r\n            <SolidToggleButtonGroup exclusive value={compareData} onChange={(e, v) => characterDispatch({ compareData: v })} size=\"small\">\r\n              <ToggleButton value={false} disabled={!compareData}>\r\n                <small>Show New artifact Stats</small>\r\n              </ToggleButton>\r\n              <ToggleButton value={true} disabled={compareData}>\r\n                <small>Compare against equipped artifacts</small>\r\n              </ToggleButton>\r\n            </SolidToggleButtonGroup>\r\n          </Box>\r\n        </CardContent>\r\n      </CardDark>\r\n      <BuildList {...{ buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled: !!generatingBuilds }} />\r\n    </DataContext.Provider>}\r\n  </Box>\r\n}\r\nfunction BuildList({ buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled }: {\r\n  buildsArts: ICachedArtifact[][],\r\n  character?: ICachedCharacter,\r\n  characterKey?: \"\" | CharacterKey,\r\n  characterSheet?: CharacterSheet,\r\n  data?: UIData,\r\n  compareData: boolean,\r\n  mainStatAssumptionLevel: number,\r\n  characterDispatch: (action: characterReducerAction) => void\r\n  disabled: boolean,\r\n}) {\r\n  // Memoize the build list because calculating/rendering the build list is actually very expensive, which will cause longer builder times.\r\n  const list = useMemo(() => <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n    {buildsArts?.map((build, index) => character && characterKey && characterSheet && data && <DataContextWrapper\r\n      key={index + build.join()}\r\n      characterKey={characterKey}\r\n      character={character}\r\n      build={build}\r\n      characterSheet={characterSheet}\r\n      oldData={data}\r\n      mainStatAssumptionLevel={mainStatAssumptionLevel}\r\n      characterDispatch={characterDispatch} >\r\n      <ArtifactBuildDisplayItem index={index} compareBuild={compareData} disabled={disabled} />\r\n    </DataContextWrapper>\r\n    )}\r\n  </Suspense>, [buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled])\r\n  return list\r\n}\r\n\r\ntype Prop = {\r\n  children: React.ReactNode\r\n  characterKey: CharacterKey,\r\n  character: ICachedCharacter,\r\n  build: ICachedArtifact[],\r\n  mainStatAssumptionLevel?: number, characterSheet: CharacterSheet, oldData: UIData,\r\n  characterDispatch: (action: characterReducerAction) => void\r\n}\r\nfunction DataContextWrapper({ children, characterKey, character, build, characterDispatch, mainStatAssumptionLevel = 0, characterSheet, oldData }: Prop) {\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build)\r\n  if (!teamData) return null\r\n  return <DataContext.Provider value={{ characterSheet, character, characterDispatch, mainStatAssumptionLevel, data: teamData[characterKey]!.target, teamData, oldData }}>\r\n    {children}\r\n  </DataContext.Provider>\r\n}\r\n","import { useContext, useEffect, useState } from \"react\";\r\nimport { DatabaseContext } from \"../Database/Database\";\r\nimport { CharacterKey } from \"../Types/consts\";\r\n\r\nexport default function useCharacter(characterKey: CharacterKey | \"\" | undefined = \"\") {\r\n  const { database } = useContext(DatabaseContext)\r\n  const [character, updateCharacter] = useState(database._getChar(characterKey))\r\n  useEffect(() => updateCharacter(database._getChar(characterKey)), [database, characterKey])\r\n  useEffect(() =>\r\n    characterKey ? database.followChar(characterKey, updateCharacter) : undefined,\r\n    [characterKey, updateCharacter, database])\r\n  return character\r\n}\r\n","import { useCallback, useContext, useEffect, useState } from \"react\";\r\nimport { DatabaseContext } from \"../Database/Database\";\r\n\r\nexport default function useDBState<O extends object>(key: string, init: () => O): [O, (value: Partial<O>) => void] {\r\n  const { database } = useContext(DatabaseContext)\r\n  const [state, setState] = useState(database._getState<O>(key, init))\r\n\r\n  useEffect(() => setState(database._getState(key, init)), [database, key, init])\r\n  useEffect(() =>\r\n    key ? database.followState(key, setState) : undefined,\r\n    [key, setState, database])\r\n  const updateState = useCallback(\r\n    value => database.updateState(key, value),\r\n    [database, key],\r\n  )\r\n\r\n  return [state, updateState]\r\n}\r\n","import { strPadLeft } from \"./Util\"\r\n\r\nexport const SECOND_MS = 1000\r\nexport const MINUTE_MS = 60 * SECOND_MS\r\nexport const HOUR_MS = 60 * MINUTE_MS\r\nexport const DAY_MS = 24 * HOUR_MS\r\n\r\nexport function msToUnits(ms: number) {\r\n  let milliseconds = ms % 1000\r\n  let seconds = Math.floor((ms / 1000) % 60)\r\n  let minutes = Math.floor((ms / (1000 * 60)) % 60)\r\n  let hours = Math.floor((ms / (1000 * 60 * 60)))\r\n  return { hours, minutes, seconds, milliseconds }\r\n}\r\nexport function timeString(ms: number) {\r\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\r\n  let { hours, minutes, seconds } = msToUnits(ms)\r\n  let timeText = \"Minutes\"\r\n  if (hours) timeText = \"Hours\"\r\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)} ${timeText}`;\r\n}\r\nexport function timeStringMs(ms: number) {\r\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\r\n  let { hours, minutes, seconds, milliseconds } = msToUnits(ms)\r\n  let timeText = \"Minutes\"\r\n  if (hours) timeText = \"Hours\"\r\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)}.${strPadLeft(milliseconds, '0', 3)} ${timeText}`;\r\n}\r\n"],"names":["ArtifactLevelSlider","levelLow","levelHigh","setLow","setHigh","setBoth","dark","disabled","useState","sliderLow","setsliderLow","sliderHigh","setsliderHigh","setSlider","useCallback","e","l","h","useEffect","sx","width","display","alignItems","bgcolor","value","onChange","val","clamp","pl","inputProps","textAlign","startAdornment","flexGrow","mx","getAriaLabel","onChangeCommitted","valueLabelDisplay","min","max","step","marks","px","ArtifactSetDropdown","selectedSetKey","artifactSetsByRarity","hasUnselect","props","t","useTranslation","artifactSheets","usePromise","ArtifactSheet","sheet","displaySets","useMemo","title","name","startIcon","defIconSrc","src","color","onClick","selected","i18nKey","Object","keys","length","entries","reverse","flatMap","i","star","sets","stars","parseInt","map","setKey","fontSize","initialInfoShownState","artifactPage","buildPage","characterPage","InfoComponent","pageKey","text","modalTitle","children","useDBState","stateInfoShown","setStateInfoShown","showInfoModal","setshowInfoModal","Array","isArray","getRandomElementFromArray","displayText","closeModal","container","item","variant","xs","size","icon","faQuestionCircle","ns","key18","containerProps","maxWidth","open","onClose","py","Suspense","fallback","height","large","StatFilterCard","statFilters","setStatFilters","data","useContext","DataContext","statKeys","get","input","push","charEle","remainingKeys","filter","key","some","k","setFilter","sKey","spacing","statKey","StatFilterItem","close","undefined","isFloat","KeyMap","s","flexBasis","float","placeholder","faTrashAlt","initGlobalSettings","tcMode","Worker_fn","Worker","ChartCard","chartData","plotBase","setPlotBase","showDownload","setshowDownload","showMin","setshowMin","displayData","downloadData","increasingX","y","x","plot","sort","a","b","minimumData","point","last","pop","forEach","minimum","allData","CardLight","CardContent","Grid","Typography","DropdownButton","MenuItem","Divider","Tooltip","placement","Info","Button","CheckBox","CheckBoxOutlineBlank","Download","Collapse","in","CardDark","mb","DataDisplay","Chart","plotNode","valueNode","TextArea","styled","fontFamily","resize","minHeight","readOnly","JSON","stringify","target","selectionStart","selectionEnd","plotBaseUnit","info","valueUnit","ResponsiveContainer","ComposedChart","CartesianGrid","strokeDasharray","XAxis","dataKey","scale","unit","domain","tick","fill","type","tickFormatter","n","toFixed","YAxis","allowDecimals","ZAxis","range","Legend","Scatter","line","lineType","isAnimationActive","Line","stroke","connectNulls","strokeWidth","pruneAll","nodes","arts","numTop","keepArtifacts","forced","should","deps","pruneNodeRange","reaffine","pruneOrder","pruneArtRange","count","values","newArts","newNodes","forceRename","affineNodes","Set","topLevelAffine","visit","node","isAffine","add","operands","_op","op","has","dynKeys","forEachNodes","_","f","operation","path","accu","Error","every","nonConst","assertUnreachable","base","current","nextDynKey","affine","affineMap","Map","customRead","reaffineArt","stat","constantFold","dyn","objectMap","constant","fromEntries","v","result","mapFormulas","objectKeyMap","allSlotKeys","slot","id","set","offsets","baseValue","progress","list","newList","art","other","greaterEqual","greater","baseRange","wrap","artRanges","computeArtRange","otherArtRanges","addArtRange","read","newRange","computeNodeRange","Infinity","nodeRange","operandRanges","threshold","pass","fail","isFinite","newOperands","op1","op2","j","ranges","reads","_f","computeMinMax","allOperations","reduce","c","sum","NaN","minMaxes","Math","filterArts","filters","kind","ids","mergeBuilds","builds","maxNum","slice","mergePlot","plots","round","build","countBuilds","_count","ArtifactCardNano","artifactId","mainStatAssumptionLevel","useArtifact","actionWrapperFunc","CardActionArea","slotKey","rarity","level","mainStatKey","substats","location","mainStatLevel","mainStatUnit","levelVariant","floor","ConditionalWrapper","condition","wrapper","flexWrap","className","mt","CardMedia","component","image","slotIcons","pr","pt","Box","justifyContent","gap","Chip","label","LocationIcon","overflow","StatIcon","cacheValueString","Artifact","p","SubstatDisplay","numRolls","rolls","rollColor","alignContent","BootstrapTooltip","characterSheet","CharacterSheet","ImgIcon","thumbImgSide","marginTop","marginLeft","BusinessCenter","WeaponCardNano","weaponId","weapon","useWeapon","weaponSheet","WeaponSheet","UIData","computeUIData","dataObjForWeapon","img","flexDirection","hasRefinement","refinement","WeaponStat","valueString","CharacterDisplayCard","lazy","ArtifactBuildDisplayItem","index","compareBuild","database","DatabaseContext","dataContext","showModal","setshowModal","openModal","character","oldData","teamData","newOld","setNewOld","equipArts","window","confirm","newBuild","equipArtifacts","currentlyEquipped","statProviderContext","setToSlots","Skeleton","ModalWrapper","characterKey","newteamData","footer","CloseButton","CompareArtifactModal","pb","SqBadge","slotarr1","slotarr","artifactSlotIcon","sm","md","lg","oldId","equippedArtifacts","newId","equippedWeapon","StatDisplayComponent","console","log","history","useHistory","edit","artid","pathname","state","artToEditId","ArtifactCard","onEdit","ChevronRight","ArtifactConditionalCard","setOpen","onOpen","artifactCondCount","conditional","allArtifactSets","fullWidth","ArtConditionalModal","characterDispatch","resetArtConds","artSetKeyList","Replay","setEffects","entry","document","d","setNumKey","SetEffectDisplay","ArtifactSetPicker","setFilters","setNum","num","setsNumArr","artsAccountedOther","cur","ind","artsAccounted","ButtonGroup","setNKey","setNkey","BonusStatsCard","bonusStatsKeys","bonusStats","FieldDisplay","my","ListItem","warningBuildNumber","Monospace","BorderLinearProgress","LinearProgress","theme","borderRadius","BuildAlert","totBuildNumber","generatingBuilds","generationSkipped","generationProgress","generationDuration","characterName","maxBuildsToShow","totalBuildNumberString","toLocaleString","totalUnskipped","generationProgressString","generationSkippedString","totalUnskippedString","generationSkippedText","subtitle","timeStringMs","Alert","severity","EnemyEditorCard","expanded","setExpanded","eLvlNode","eDefRed","eDefIgn","CardHeader","action","ExpandButton","expand","ExpandMore","allElementsWithPhy","element","timeout","unmountOnExit","EnemyEditor","bsProps","HitModeCard","artifactsSlotsToSelectMainStats","MainStatSelectionCard","mainStatKeys","onChangeMainStatKey","onChangeAssLevel","AssumeFullLevelToggle","setmainStatAssumptionLevel","numSel","includes","levels","WhiteButton","backgroundColor","OptimizationTargetSelector","optimizationTarget","setTarget","setTargetHandler","sections","getDisplaySections","TargetDisplayText","Masonry","columns","Nodes","SelectorSection","displayNs","sectionKey","header","getDisplayHeader","isEmpty","avatar","m","titleTypographyProps","MenuList","TargetSelectorMenuItem","NoTarget","displayHeader","objPathValue","getDisplay","style","textOverflow","TeamBuffCard","teamBuffs","getTeamBuff","total","premod","enemy","toString","artSetPerm","splitFiltersBySet","splitFilterByIds","dynamic","setReadNodeKeys","deepClone","dynamicData","allMainStatKeys","allSubstats","artSet","check","request","remainingSlots","newRequest","newFilters","noFilter","_arts","limit","candidates","numChunks","ceil","boundedNumChunks","chunk","InfoDisplay","React","buildSettingsReducer","initialBuildDisplayState","BuildDisplay","propCharacterKey","setBuildSettings","setcharacterKey","_getChar","setgeneratingBuilds","setgenerationProgress","setgenerationDuration","setgenerationSkipped","setchartData","useForceUpdate","artsDirty","setArtsDirty","navigator","hardwareConcurrency","maxWorkers","setMaxWorkers","setCharacter","useCharSelectionCallback","useCharacterReducer","updateCharacter","followChar","useCharacter","buildSettings","initialBuildSettings","useExcludedArts","useEquippedArts","buildDate","buildsArts","_getArt","useTeamData","compareData","noCharacter","_getCharKeys","noArtifact","_getArts","buildSettingsDispatch","ReactGA","selectCharacter","cKey","followAnyArt","split","flower","plume","goblet","circlet","sands","mainStatVal","endsWith","substat","accurateValue","compactArtifacts","mainStats","exclude","setPerms","perm","cancelToken","useRef","generateBuilds","fetchWork","setPerm","next","done","command","buildValues","getTeamData","workerData","uiDataForTeam","assign","mergeData","optimizationTargetNode","targetNode","valueFilter","t1","performance","now","cancelled","Promise","r","origCount","optimize","plotBaseNode","buildCount","failedCount","skippedCount","Symbol","iterator","finalizedList","worker","setup","maxBuilds","postMessage","finalize","finalized","onmessage","splice","work","finalizeCommand","terminate","then","buildTimer","setInterval","any","all","results","clearInterval","plotData","artifactIds","Date","totalDuration","category","variable","Link","RouterLink","to","CharacterDropdownButton","CharacterCard","sFs","faCalculator","maxBuildsToShowList","Close","SolidToggleButtonGroup","exclusive","ToggleButton","BuildList","DataContextWrapper","join","init","_getState","setState","followState","updateState","SECOND_MS","MINUTE_MS","HOUR_MS","DAY_MS","msToUnits","ms","milliseconds","seconds","minutes","hours","timeString","timeText","strPadLeft"],"sourceRoot":""}
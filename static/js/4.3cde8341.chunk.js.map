{"version":3,"sources":["Character/Character.ts","Assets/Element_Anemo.png","Assets/Assets.ts","Assets/Element_Cryo.png","Assets/Element_Dendro.png","Assets/Element_Electro.png","Assets/Element_Geo.png","Assets/Element_Hydro.png","Assets/Element_Pyro.png","Assets/Weapon-class-bow-icon.png","Assets/Weapon-class-catalyst-icon.png","Assets/Weapon-class-claymore-icon.png","Assets/Weapon-class-polearm-icon.png","Assets/Weapon-class-sword-icon.png","Assets/Item_Fragile_Resin.png","Assets/Item_Condensed_Resin.png","Assets/Item_Wanderer's_Advice.png","Assets/Item_Hero's_Wit.png","Assets/Item_Adventurer's_Experience.png","Weapon/Weapon.ts","Formula.ts","Data/WeaponData.ts","StatDependency.ts","Data/CharacterData.ts"],"names":["Character","this","Error","characterKey","character","CharacterDatabase","get","Object","values","equippedArtifacts","forEach","artid","ArtifactDatabase","moveToNewLocation","remove","key","characterSheet","weaponSheet","startsWith","subkey","split","getTalent","name","getElementalName","elementalKey","defVal","ElementalData","getlevelKeys","keys","LevelsData","getlevelTemplateName","levelKey","getLevelString","levelOverride","getStatValueWithOverride","getLevel","getIndexFromlevelkey","indexOf","level","getAscension","asend","getTalentFieldValue","field","stats","evalIfFunc","hasOverride","statKey","baseStatOverrides","getBaseStatValue","characetSheet","specializeStat","value","Weapon","getWeaponMainStatValWithOverride","weapon","includes","characterStatBase","baseStat","equipArtifacts","artIds","artIdsOnCharacter","allSlotKeys","slotKey","artNotOnChar","location","artOnChar","notCharLoc","id","equipArtifactOnSlot","equipArtifactBuild","calculateBuild","artifactSheets","artifacts","mainStatAssumptionLevel","fromEntries","map","art","i","entries","initialStats","createInitialStats","calculateBuildwithArtifact","setToSlots","Artifact","artifactSetEffectsStats","ArtifactSheet","setEffectsStats","deepClone","mainStatKey","mainStatValue","numStars","Math","max","min","substats","substat","stat","Conditional","parseConditionalValues","artifact","conditionalValues","conditional","conditionalValue","setKey","setNumKey","parseInt","length","condStats","resolve","val","dependencies","GetDependencies","modifiers","PreprocessFormulas","formula","mergeStats","modifier","mkey","multiplier","undefined","hitMode","infusionAura","reactionMode","talentLevelKeys","constellation","ascension","statKeys","characterEle","elementKey","weaponType","weaponTypeKey","tlvl","allElements","eleKey","overrides","hasOwnProperty","specializedStatVal","specialStatKey","getTalentStatsAll","s","weaponSubKey","getWeaponSubstatKey","getWeaponSubstatValWithOverride","weaponCond","otherCond","canShow","getDisplayStatKeys","basicKeys","isAutoElemental","push","transReactions","ElementToReactionKeys","Formula","formulas","charFormulas","talentKey","formKey","weaponFormulas","genericAvgHit","reactions","filter","replace","Assets","elements","anemo","cryo","dendro","electro","geo","hydro","pyro","weaponTypes","bow","catalyst","claymore","polearm","sword","resin","fragile","condensed","exp_books","advice","wit","experience","getLevelName","LevelNameData","getLevelIndex","WeaponLevelKeys","getWeaponMainStatVal","baseStats","main","getWeaponSubstatVal","sub","substatKey","getWeaponTypeName","WeaponTypeData","getWeaponTypeKeys","weaponObj","overrideMainVal","overrideSubVal","formulaImport","then","imp","default","crawlObject","f","objPathValue","GetFormulaDependency","dependency","Set","Proxy","target","prop","receiver","add","formulaKeyDependency","freeze","Formulas","StatData","InsertDependencies","has","k","critRate_","critDMG_","enerRech_","stamina","CharacterSpecializedStatKey"],"mappings":"wVAkBqBA,E,WAEnB,aAAgB,GAAD,oBAAKC,gBAAgBD,EAAW,MAAME,MAAM,0C,+CAoE3D,SAAcC,GACZ,IAAMC,EAAYC,IAAkBC,IAAIH,GACnCC,IACLG,OAAOC,OAAOJ,EAAUK,mBAAmBC,SAAQ,SAAAC,GAAK,OACtDC,IAAiBC,kBAAkBF,EAAO,OAC5CN,IAAkBS,OAAOX,M,+BAyL3B,SAAyBY,EAAaC,EAAgCC,GACpE,GAAY,cAARF,EAAqB,MAAO,cAC3B,GAAY,kBAARA,EAAyB,MAAO,8BACpC,GAAY,mBAARA,EAA0B,MAAO,0BACrC,GAAIA,EAAIG,WAAW,cAAe,CAAC,IAAD,IAC/BC,EAASJ,EAAIK,MAAM,cAAc,GACvC,wBAAQJ,QAAR,IAAQA,GAAR,UAAQA,EAAgBK,UAAUF,UAAlC,aAAQ,EAAmCG,YAA3C,QAAmDH,EAC9C,GAAIJ,EAAIG,WAAW,WAAY,CAAC,IAAD,EAC9BC,EAASJ,EAAIK,MAAM,WAAW,GACpC,wBAAQH,QAAR,IAAQA,OAAR,EAAQA,EAAaK,YAArB,QAA6BH,EAE/B,MAAO,O,KA/QUnB,EAIZuB,iBAAmB,SAACC,GAAD,MAAeC,EAAf,uDAAwB,GAAxB,OAA6C,OAAbC,UAAa,IAAbA,KAAA,UAAAA,IAAgBF,UAAhB,eAA+BF,OAAQG,GAJ9EzB,EAOZ2B,aAAe,kBAAgBpB,OAAOqB,KAAKC,MAP/B7B,EAQZ8B,qBAAuB,SAACC,GAAD,MAAWN,EAAX,uDAAoB,GAApB,OAAsC,OAAVI,UAAU,IAAVA,KAAA,UAAAA,IAAaE,UAAb,eAAwBT,OAAQG,GARvEzB,EASZgC,eAAiB,SAAC5B,EAAuBY,EAAgCC,GAC9E,IAAMgB,EAAgBjC,EAAUkC,yBAAyB9B,EAAWY,EAAgBC,EAAa,kBACjG,OAAOjB,EAAUmC,SAAS/B,EAAU2B,YAAcE,EAAgBjC,EAAU8B,qBAAqB1B,EAAU2B,UAApG,eAAwHE,IAX9GjC,EAaZoC,qBAAuB,SAACL,GAAD,OAAc/B,EAAU2B,eAAeU,QAAQN,IAb1D/B,EAcZmC,SAAW,SAACJ,GAAD,MAAWN,EAAX,uDAAoB,EAApB,OAAqC,OAAVI,UAAU,IAAVA,KAAA,UAAAA,IAAaE,UAAb,eAAwBO,QAASb,GAd3DzB,EAeZuC,aAAe,SAACR,GAAD,MAAWN,EAAX,uDAAoB,EAApB,OAAqC,OAAVI,UAAU,IAAVA,KAAA,UAAAA,IAAaE,UAAb,eAAwBS,QAASf,GAf/DzB,EAiBZyC,oBAAsB,SAACC,EAAO3B,GAAkC,IAA7B4B,EAA4B,uDAApB,GAAIlB,EAAgB,uDAAP,GAC7D,OAAI,OAACiB,QAAD,IAACA,OAAD,EAACA,EAAQ3B,IACN6B,YAAU,OAACF,QAAD,IAACA,OAAD,EAACA,EAAQ3B,GAAM4B,GADNlB,GAlBTzB,EAsBZ6C,YAAc,SAACzC,EAAW0C,GAC/B,MAAgB,YAAZA,EACK9C,EAAU6C,YAAYzC,EAAW,OAASJ,EAAU6C,YAAYzC,EAAW,QAAUJ,EAAU6C,YAAYzC,EAAW,iBAAkB,EAC5H,aAAZ0C,EACA9C,EAAU6C,YAAYzC,EAAW,QAAUJ,EAAU6C,YAAYzC,EAAW,SAAWJ,EAAU6C,YAAYzC,EAAW,kBAAmB,EAC/H,aAAZ0C,EACA9C,EAAU6C,YAAYzC,EAAW,QAAUJ,EAAU6C,YAAYzC,EAAW,SAAWJ,EAAU6C,YAAYzC,EAAW,kBAAmB,KACpI,OAATA,QAAS,IAATA,OAAA,EAAAA,EAAW2C,oBAAqBD,KAAW1C,EAAU2C,mBA7B3C/C,EAgCZgD,iBAAmB,SAAC5C,EAAuB6C,EAA+BhC,EAA0B6B,GAAiC,IAAhBrB,EAAe,uDAAN,EAC3HM,EAAa3B,EAAb2B,SACR,MAAgB,uBAAZe,EAAyCG,EAAcC,eAAenC,IAC1D,uBAAZ+B,EAAyCG,EAAcC,eAAeC,MAAMnD,EAAUoC,qBAAqBL,IAC/F,cAAZe,EAAgCM,IAAOC,iCAAP,OAAwCjD,QAAxC,IAAwCA,OAAxC,EAAwCA,EAAWkD,OAAQrC,GAC/E,mBAAZ6B,GAA4C,eAAZA,EAAiC9C,EAAUmC,SAASJ,GACpFe,EAAQS,SAAS,aAAqB,GACtCT,KAAWU,IAA0BA,IAAkBV,GACvDA,KAAWG,EAAcQ,SAAiBR,EAAcQ,SAASX,GAAS9C,EAAUoC,qBAAqBL,IACtGN,GAzCUzB,EA2CZkC,yBAA2B,SAAC9B,EAAuBY,EAAgCC,EAA0B6B,GAAiC,IAAD,IAAfrB,EAAe,uDAAN,EAC5I,OAAIzB,EAAU6C,YAAYzC,EAAW0C,GAAU,iBAAO1C,QAAP,IAAOA,GAAP,UAAOA,EAAW2C,yBAAlB,aAAO,EAA+BD,UAAtC,QAAkDrB,EACrFzB,EAAUgD,iBAAiB5C,EAAWY,EAAgBC,EAAa6B,EAASrB,IA7CvEzB,EAiDZ0D,eAAiB,SAACvD,EAAiCwD,GACxD,IAAMvD,EAAYC,IAAkBC,IAAIH,GACxC,GAAKC,EAAL,CACA,IAAMwD,EAAoBxD,EAAUK,kBAGpCoD,IAAYnD,SAAQ,SAAAoD,GAAY,IAAD,IACvBC,EAAenD,IAAiBN,IAAIqD,EAAOG,IACjD,IAAgB,OAAZC,QAAY,IAAZA,OAAA,EAAAA,EAAcC,YAAa7D,EAA/B,CACA,IAAM8D,EAAYrD,IAAiBN,IAAjB,OAAqBsD,QAArB,IAAqBA,OAArB,EAAqBA,EAAoBE,IACrDI,EAAU,iBAAIH,QAAJ,IAAIA,OAAJ,EAAIA,EAAcC,gBAAlB,QAA8B,GAE1CC,GAAWrD,IAAiBC,kBAAkBoD,EAAUE,GAAID,GAE5DA,GAAY7D,IAAkB+D,oBAAoBF,EAAYJ,EAAlD,iBAA2DG,QAA3D,IAA2DA,OAA3D,EAA2DA,EAAWE,UAAtE,QAA4E,IAExFJ,GAAcnD,IAAiBC,kBAAkBkD,EAAaI,GAAIhE,OAGxEE,IAAkBgE,mBAAmBlE,EAAcwD,KApElC3D,EA8EZsE,eAAiB,SAAClE,EAAuBY,EAAgCC,EAA0BsD,GAAiD,IACrJC,EADoHC,EAAgC,uDAAN,EAElJ,GAAIrE,EAAUoE,UACZA,EAAYjE,OAAOmE,YAAYtE,EAAUoE,UAAUG,KAAI,SAACC,EAAKC,GAAN,MAAY,CAACA,EAAGD,WACpE,KAAIxE,EAAUK,kBAEd,MAAO,GADV+D,EAAYjE,OAAOmE,YAAYnE,OAAOuE,QAAQ1E,EAAUK,mBAAmBkE,KAAI,mCAAE5D,EAAF,KAAOJ,EAAP,WAAkB,CAACI,EAAKH,IAAiBN,IAAIK,QAE9H,IAAMoE,EAAe/E,EAAUgF,mBAAmB5E,EAAWY,EAAgBC,GAE7E,OADA8D,EAAaN,wBAA0BA,EAChCzE,EAAUiF,2BAA2BF,EAAcP,EAAWD,IAvFpDvE,EA0FZiF,2BAA6B,SAACF,EAAcP,EAAWD,GAAoB,IAAD,EACzEW,EAAaC,IAASD,WAAWV,GACnCY,EAA0BC,IAAcC,gBAAgBf,EAAgBQ,EAAcG,GAEtFvC,EAAQ4C,YAAUR,GAEtBxE,OAAOC,OAAOgE,GAAW9D,SAAQ,SAACkE,GAC3BA,IAELjC,EAAMiC,EAAIY,cAAgB7C,EAAMiC,EAAIY,cAAgB,GAAKL,IAASM,cAAcb,EAAIY,YAAaZ,EAAIc,SAAUC,KAAKC,IAAID,KAAKE,IAAIlD,EAAM8B,wBAAwC,EAAfG,EAAIc,UAAed,EAAItC,QAEvLsC,EAAIkB,SAASpF,SAAQ,SAACqF,GAAD,OACnBA,GAAWA,EAAQhF,MAAQ4B,EAAMoD,EAAQhF,MAAQ4B,EAAMoD,EAAQhF,MAAQ,GAAKgF,EAAQ5C,cAGxFiC,EAAwB1E,SAAQ,SAAAsF,GAAI,OAAIrD,EAAMqD,EAAKjF,MAAQ4B,EAAMqD,EAAKjF,MAAQ,GAAKiF,EAAK7C,SAExF8C,IAAYC,uBAAuB,CAAEC,SAAQ,OAAExD,QAAF,IAAEA,GAAF,UAAEA,EAAOyD,yBAAT,aAAE,EAA0BD,WAAY,SAACE,EAAaC,EAAd,GAAgD,IAAD,IAAZC,EAAY,oBAC1HC,EAAcH,EAAdG,UACR,KAAIC,SAASD,IAAT,iBAAuBtB,QAAvB,IAAuBA,GAAvB,UAAuBA,EAAaqB,UAApC,aAAuB,EAAsBG,cAA7C,QAAuD,IAA3D,CAFkI,IAGnHC,EAAcV,IAAYW,QAAQP,EAAa1D,EAAO2D,GAA7D3D,MACRpC,OAAOuE,QAAQ6B,GAAWjG,SAAQ,mCAAEoC,EAAF,KAAW+D,EAAX,YAAoBlE,EAAMG,IAAYH,EAAMG,IAAY,GAAK+D,SAGjGlE,EAAMlC,kBAAoBF,OAAOmE,YAAYnE,OAAOuE,QAAQN,GAAWG,KAAI,mCAAE5D,EAAF,KAAO8F,EAAP,WAAqB,CAAC9F,EAAD,OAAM8F,QAAN,IAAMA,OAAN,EAAMA,EAAK1C,QAC3GxB,EAAMuC,WAAaA,EACnB,IAAI4B,EAAeC,YAAe,OAACpE,QAAD,IAACA,OAAD,EAACA,EAAOqE,WAE1C,OADAC,YAAmBH,EAAcnE,GAAOuE,QAAQvE,GACzCA,GAtHU3C,EAwHZmH,WAAa,SAACpC,EAAcpC,GAAf,OAAyBA,GAASpC,OAAOuE,QAAQnC,GAAOjC,SAAQ,YAAsB,IAAD,mBAAnBK,EAAmB,KAAd8F,EAAc,KACvG,GAAY,cAAR9F,EAAqB,CAAC,IAAD,EACvBgE,EAAaiC,UAAb,UAAyBjC,EAAaiC,iBAAtC,QAAmD,GAD5B,oBAEYzG,OAAOuE,QAAQ+B,IAF3B,IAEvB,2BAAgE,CAAC,IAAD,2BAApD/D,EAAoD,KAA3CsE,EAA2C,KAC9DrC,EAAaiC,UAAUlE,GAAvB,UAAkCiC,EAAaiC,UAAUlE,UAAzD,QAAqE,GADP,oBAE5BvC,OAAOuE,QAAQsC,IAFa,IAE9D,2DAAYC,EAAZ,KAAkBC,EAAlB,KACEvC,EAAaiC,UAAUlE,GAASuE,IAAQ,UAACtC,EAAaiC,UAAUlE,GAASuE,UAAjC,QAA0C,GAAKC,GAH3B,gCAFzC,yCAQGC,IAAtBxC,EAAahE,GAAoBgE,EAAahE,GAAO8F,EACnB,kBAAtB9B,EAAahE,KAAmBgE,EAAahE,IAAQ8F,OAlItD7G,EAsIZgF,mBAAqB,SAAC5E,EAAuBY,EAAgCC,GAAgD,IAAD,MACjIb,EAAYmF,YAAUnF,GACdD,EAFyH,EAEzHA,aAAc4B,EAF2G,EAE3GA,SAAUyF,EAFiG,EAEjGA,QAASC,EAFwF,EAExFA,aAAcC,EAF0E,EAE1EA,aAAcC,EAF4D,EAE5DA,gBAAiBC,EAF2C,EAE3CA,cAAenH,EAF4B,EAE5BA,kBAF4B,IAET2F,yBAFS,MAEW,GAFX,MAEe9C,cAFf,MAEwB,CAAEvC,IAAK,IAF/B,EAG3H8G,EAAY7H,EAAUuC,aAAaR,GAGnC+F,EAAQ,CAAI,cAAe,eAAgB,eAAgB,YAAa,iBAAkB,aAAc,qBAAsB,0BAAtH,mBAAmJvH,OAAOqB,KAAK4B,OACvKuB,EAAexE,OAAOmE,YAAYoD,EAASnD,KAAI,SAAA5D,GAAG,MAAI,CAACA,EAAKf,EAAUkC,yBAAyB9B,EAAWY,EAAgBC,EAAaF,QAC7IgE,EAAagD,aAAe/G,EAAegH,WAC3CjD,EAAa5E,aAAeA,EAC5B4E,EAAayC,QAAUA,EACvBzC,EAAa0C,aAAeA,EAC5B1C,EAAa2C,aAAeA,EAC5B3C,EAAaqB,kBAAoBA,EACjCrB,EAAakD,WAAajH,EAAekH,cACzCnD,EAAaoD,KAAOR,EACpB5C,EAAa6C,cAAgBA,EAC7B7C,EAAa8C,UAAYA,EACzB9C,EAAazB,OAASA,EACtByB,EAAatE,kBAAoBA,EAIjC,CAAC,YAAD,mBAAgB2H,MAAa1H,SAAQ,SAAA2H,GACnC,IAAIvF,EAAO,UAAMuF,EAAN,cACXtD,EAAajC,GAAW9C,EAAUkC,yBAAyB9B,EAAWY,EAAgBC,EAAa6B,GACnGA,EAAO,UAAMuF,EAAN,kBACPtD,EAAajC,GAAW9C,EAAUkC,yBAAyB9B,EAAWY,EAAgBC,EAAa6B,MAIrG,IAAIwF,GAAqB,QAAT,EAAAlI,SAAA,eAAW2C,oBAAqB,GAChDxC,OAAOuE,QAAQwD,GAAW5H,SAAQ,YAA0B,IAAD,mBAAvBoC,EAAuB,KAAd+D,EAAc,KACzC,uBAAZ/D,GAAgD,uBAAZA,IACnCiC,EAAawD,eAAezF,KAAUiC,EAAajC,GAAW+D,OAIrE,IAAI2B,EAAqBxI,EAAUkC,yBAAyB9B,EAAWY,EAAgBC,EAAa,sBAChGwH,EAAiBzI,EAAUkC,yBAAyB9B,EAAWY,EAAgBC,EAAa,sBAOhG,IAAK,IAAMF,KANXf,EAAUmH,WAAWpC,EAArB,eAAsC0D,EAAiBD,IAGvDxH,EAAe0H,kBAAkB3D,GAAkCrE,SAAQ,SAAAiI,GAAC,OAAI3I,EAAUmH,WAAWpC,EAAc4D,MAGjG5D,EAAaoD,KAA/B,OACEpD,EAAaoD,KAAKpH,IAAlB,UAA0BgE,EAAa,GAAD,OAAIhE,EAAJ,iBAAtC,QAAyD,EAG3D,IAAM6H,EAAexF,IAAOyF,oBAAoB5H,GAC5C2H,GAAc5I,EAAUmH,WAAWpC,EAArB,eAAsC6D,EAAexF,IAAO0F,gCAAP,UAAuC1I,SAAvC,aAAuC,EAAWkD,OAAQrC,KACjIjB,EAAUmH,WAAWpC,EAAc9D,EAAY0B,MAAMoC,IAIgBqB,EAA7DD,SAxDyH,IAwDzF4C,EAA6B3C,EAArC9C,OAAuB0F,EAxD0E,YAwD5D5C,EAxD4D,uBAgEjI,OALAH,IAAYC,uBAAZ,2BAAwC5C,EAAOvC,KAAO,CAAEuC,OAAO,eAAIA,EAAOvC,IAAZ,OAAkBgI,QAAlB,IAAkBA,OAAlB,EAAkBA,EAAazF,EAAOvC,QAAaiI,IAAa,SAAC3C,EAAaC,EAAkB1E,GAC5J,GAAKqE,IAAYgD,QAAQ5C,EAAatB,GAAtC,CADqK,IAEtJ4B,EAAcV,IAAYW,QAAQP,EAAatB,EAAcuB,GAApE3D,MACR3C,EAAUmH,WAAWpC,EAAc4B,OAE9B5B,GAtMU/E,EAwMZkJ,mBAAqB,SAACvG,EAAyB3B,GAAoC,IAAD,EAC/Eb,EAAiBwC,EAAjBxC,aACJkI,EAASrH,EAAegH,WACtBmB,EAAY,CAAC,UAAW,WAAY,WAAY,SAAU,YAAa,WAAY,QAAS,YAAhF,UAAgGd,EAAhG,UACZe,EAAkBpI,EAAeoI,gBAClCA,GAAiBD,EAAUE,KAAK,iBAGrC,IAAMC,EAAiB/D,YAAUgE,IAAsBlB,IACjDH,EAAgBlH,EAAekH,cAErC,GADKoB,EAAe/F,SAAS,kBAAsC,aAAlB2E,GAA8BoB,EAAeD,KAAK,iBACnG,UAAIG,IAAQC,SAASrJ,iBAArB,aAAI,EAA6BD,GAAe,CAC9C,IAAMuJ,EAAe,GACrBnJ,OAAOuE,QAAQ0E,IAAQC,SAASrJ,UAAUD,IAAeO,SAAQ,YAAiC,IAAD,mBAA9BiJ,EAA8B,KAAnBF,EAAmB,KAC/FlJ,OAAOC,OAAOiJ,GAAiB/I,SAAQ,SAACwG,GACtC,GAAKA,EAAQxE,MAAMuG,QAAQtG,GAA3B,CACkB,WAAdgH,GAAwC,YAAdA,GAAyC,aAAdA,IAA0BA,EAAY,QAC/F,IAAMC,EAAO,oBAAgBD,GACxBD,EAAaE,KAAUF,EAAaE,GAAW,IACpDF,EAAaE,GAASP,KAAKnC,EAAQtF,aAIvC,IAAMiI,EAAiBL,IAAQC,SAASnG,OAAOX,EAAMW,OAAOvC,KAU5D,OARI8I,GACFtJ,OAAOC,OAAOqJ,GAAuBnJ,SAAQ,SAACwG,GAC5C,GAAKA,EAAQxE,MAAMuG,QAAQtG,GAA3B,CACA,IAAMiH,EAAO,iBAAajH,EAAMW,OAAOvC,KAClC2I,EAAaE,KAAUF,EAAaE,GAAW,IACpDF,EAAaE,GAASP,KAAKnC,EAAQtF,UAGhC,yBAAEuH,aAAcO,GAAvB,IAAqCJ,mBAGrC,IAAMQ,EAA0B,GAWhC,GAVKV,EAGsB,QAAlBlB,GACP4B,EAAcT,KAAd,UAAsBhB,EAAtB,oBAHAyB,EAAcT,KAAK,yBAA0B,2BAM/CS,EAAcT,KAAd,UAAsBhB,EAAtB,2BAAgDA,EAAhD,kBAGe,SAAXA,EAAmB,CACrB,IAAM0B,EAAsB,GAC5BA,EAAUV,KAAV,MAAAU,EAAS,YAASD,EAAcE,QAAO,SAAAjJ,GAAG,OAAIA,EAAIG,WAAJ,UAAkBmH,EAAlB,SAA8B1D,KAAI,SAAA5D,GAAG,OAAIA,EAAIkJ,QAAJ,UAAe5B,EAAf,eAA6BA,EAA7B,oBACvF0B,EAAUV,KAAV,MAAAU,EAAS,YAASD,EAAcE,QAAO,SAAAjJ,GAAG,OAAIA,EAAIG,WAAJ,UAAkBmH,EAAlB,SAA8B1D,KAAI,SAAA5D,GAAG,OAAIA,EAAIkJ,QAAJ,UAAe5B,EAAf,eAA6BA,EAA7B,gBACvFyB,EAAcT,KAAd,MAAAS,EAAsBC,OACF,SAAX1B,EACTyB,EAAcT,KAAd,MAAAS,EAAa,YAASA,EAAcE,QAAO,SAAAjJ,GAAG,OAAIA,EAAIG,WAAJ,UAAkBmH,EAAlB,SAA8B1D,KAAI,SAAA5D,GAAG,OAAIA,EAAIkJ,QAAJ,UAAe5B,EAAf,eAA6BA,EAA7B,gBACzE,UAAXA,GACPyB,EAAcT,KAAd,MAAAS,EAAa,YAASA,EAAcE,QAAO,SAAAjJ,GAAG,OAAIA,EAAIG,WAAJ,UAAkBmH,EAAlB,SAA8B1D,KAAI,SAAA5D,GAAG,OAAIA,EAAIkJ,QAAJ,UAAe5B,EAAf,eAA6BA,EAA7B,oBAE7F,MAAO,CAAEc,YAAWW,gBAAeR,oB,iCCnR1B,ICsBXY,EAAS,CACXC,SAAU,CAAEC,MDvBC,IAA0B,0CCuBpBC,KCvBN,IAA0B,yCDuBdC,OEvBZ,IAA0B,2CFuBNC,QGvBpB,IAA0B,4CHuBGC,IIvB7B,IAA0B,wCJuBQC,MKvBlC,IAA0B,0CLuBeC,KMvBzC,IAA0B,0CNwBvCC,YAAa,CAAEC,IOxBF,IAA0B,kDPwBnBC,SQxBP,IAA0B,uDRwBTC,SSxBjB,IAA0B,uDTwBCC,QUxB3B,IAA0B,sDVwBUC,MWxBpC,IAA0B,qDXyBvCC,MAAO,CACLC,QY1BW,IAA0B,+CZ2BrCC,Ua3BW,IAA0B,kDb6BvCC,UAAW,CACTC,Oc9BW,IAA0B,mDd+BrCC,Ie/BW,IAA0B,4CfgCrCC,WgBhCW,IAA0B,2DhBmC1BrB,O,wFiBjCM9G,EAEnB,aAAgB,GAAD,oBAAKnD,gBAAgBmD,EAAQ,MAAMlD,MAAM,2CAFrCkD,EAIZoI,aAAe,SAACzJ,GAAD,IAAWN,EAAX,uDAAoB,GAApB,OAA4BgK,IAAc1J,IAAaN,GAJ1D2B,EAKZsI,cAAgB,SAAC3J,GAAD,OAAsB4J,IAAgBtJ,QAAQN,IALlDqB,EAQZwI,qBAAuB,SAAC3K,EAA0Bc,GAA3B,IAAqCN,EAArC,uDAA8C,EAA9C,OAAqDR,EAAY4K,UAAUC,KAAK1I,EAAOsI,cAAc3J,KAAcN,GAR9H2B,EASZ2I,oBAAsB,SAAC9K,EAA0Bc,GAA3B,MAAqCN,EAArC,uDAA8C,EAA9C,OAAqD,UAAAR,EAAY4K,UAAUG,WAAtB,eAA4B5I,EAAOsI,cAAc3J,MAAcN,GAT9H2B,EAUZyF,oBAAsB,SAAC5H,GAAD,MAA2BQ,EAA3B,uDAAoC,GAApC,OAA4C,UAAAR,EAAY4K,iBAAZ,eAAuBI,aAAcxK,GAV3F2B,EAYZ8I,kBAAoB,SAACjE,GAAD,IAAaxG,EAAb,uDAAsB,GAAtB,OAA8B0K,IAAelE,IAAexG,GAZpE2B,EAaZgJ,kBAAoB,kBAAgB7L,OAAOqB,KAAKuK,MAbpC/I,EAeZC,iCAAmC,SAACgJ,EAAgBpL,GAAjB,IAA2CQ,EAA3C,uDAAoD,EAApD,OAC/B,OAAT4K,QAAS,IAATA,OAAA,EAAAA,EAAWC,kBAAmBlJ,EAAOwI,qBAAqB3K,EAA5B,OAAyCoL,QAAzC,IAAyCA,OAAzC,EAAyCA,EAAWtK,SAAUN,IAhB3E2B,EAiBZ0F,gCAAkC,SAACuD,EAAgBpL,GAAjB,IAA2CQ,EAA3C,uDAAoD,EAApD,OAC9B,OAAT4K,QAAS,IAATA,OAAA,EAAAA,EAAWE,iBAAkBnJ,EAAO2I,oBAAoB9K,EAA3B,OAAwCoL,QAAxC,IAAwCA,OAAxC,EAAwCA,EAAWtK,SAAUN,K,sFCjBjF+K,EAAgB,qDAAyBC,MAAK,SAAAC,GACzDlD,EAAQC,SAAWiD,EAAIC,QACvBC,YAAYF,EAAIC,QAAS,IAAI,SAAAE,GAAC,MAAiB,oBAANA,KAAkB,SAAC3F,EAAStF,GAAV,OAAmBsF,EAAQtF,KAAOA,QAG1E4H,EACnB,aAAgB,GAAD,oBAAKvJ,gBAAgBuJ,EAAS,MAAMtJ,MAAM,2CADtCsJ,EAEZC,SAAgB,GAFJD,EAGZlJ,IAAM,SAACsB,GAAD,OAA+E4K,EAAcC,MAAK,kBAAMK,YAAatD,EAAQC,SAAU7H,Q,iCCXtJ,0GAAM+J,EAAkB,CAAC,KAAM,KAAM,MAAO,MAAO,MAAO,OAAQ,MAAO,MAAO,MAAO,MAAO,OAAQ,MAAO,MAAO,OAAQ,MAAO,MAAO,OAAQ,MAAO,MAAO,OAAQ,MAAO,MAAO,OAAQ,MAAO,OAC/LF,EAAgB,CAAE,GAAM,SAAU,GAAM,SAAU,IAAO,UAAW,IAAO,UAAW,IAAO,UAAW,KAAQ,aAAc,IAAO,UAAW,IAAO,UAAW,IAAO,UAAW,IAAO,UAAW,KAAQ,aAAc,IAAO,UAAW,IAAO,UAAW,KAAQ,aAAc,IAAO,UAAW,IAAO,UAAW,KAAQ,aAAc,IAAO,UAAW,IAAO,UAAW,KAAQ,aAAc,IAAO,UAAW,IAAO,UAAW,KAAQ,aAAc,IAAO,UAAW,IAAO,WAC7dU,EAAiB,CACrBnB,MAAO,QACPF,SAAU,WACVD,SAAU,WACVD,IAAK,MACLG,QAAS,Y,8FCJX,SAASgC,EAAqB7F,GAC5B,IAAM8F,EAAa,IAAIC,IAIvB,OAHA/F,EACE,IAAIgG,MAAM,GAAI,CAAE5M,IAAK,SAAC6M,EAAQC,EAAMC,GAAeL,EAAWM,IAAIF,MAClE,IAAIF,MAAM,GAAI,CAAE5M,IAAK,SAAC6M,EAAQC,EAAMC,GAAeL,EAAWM,IAAIF,OAC7D,YAAIJ,GAEb,IAAMO,EAAuBhN,OAAOiN,OAAOjN,OAAOmE,YAChDnE,OAAOqB,KAAK6L,KAAU9I,KAAI,SAAA5D,GAAG,MAAI,CAACA,EAAKgM,EAAqBU,IAAS1M,UAkBvE,SAASgG,IAA+D,IAA/CC,EAA8C,uDAAlC,GAAIpF,EAA8B,uDAAvBrB,OAAOqB,KAAK8L,KACtD5G,EAAe,IAAImG,IAEvB,OADArL,EAAKlB,SAAQ,SAAAK,GAAG,OAAI4M,EAAmB5M,EAAKiG,EAAWF,MAChD,YAAIA,GAEb,SAAS6G,EAAmB5M,EAAKiG,EAAWF,GAAe,IAAD,IACpDA,EAAa8G,IAAI7M,KACrB,UAAAwM,EAAqBxM,UAArB,SAA2BL,SAAQ,SAAAmN,GAAC,OAAIF,EAAmBE,EAAG7G,EAAWF,MACzEvG,OAAOqB,KAAP,UAAYoF,EAAUjG,UAAtB,QAA8B,IAAIL,SAAQ,SAAAmN,GAAC,OAAIF,EAAmBE,EAAG7G,EAAWF,MAChFA,EAAawG,IAAIvM,M,iCCtCnB,sGACA,IAAMc,EAAa,CACjB,GAAM,CACJP,KAAM,QACNgB,MAAO,EACPE,MAAO,GAET,IAAO,CACLlB,KAAM,SACNgB,MAAO,GACPE,MAAO,GAET,KAAQ,CACNlB,KAAM,YACNgB,MAAO,GACPE,MAAO,GAGT,IAAO,CACLlB,KAAM,SACNgB,MAAO,GACPE,MAAO,GAET,KAAQ,CACNlB,KAAM,YACNgB,MAAO,GACPE,MAAO,GAGT,IAAO,CACLlB,KAAM,SACNgB,MAAO,GACPE,MAAO,GAET,KAAQ,CACNlB,KAAM,YACNgB,MAAO,GACPE,MAAO,GAET,IAAO,CACLlB,KAAM,SACNgB,MAAO,GACPE,MAAO,GAET,KAAQ,CACNlB,KAAM,YACNgB,MAAO,GACPE,MAAO,GAET,IAAO,CACLlB,KAAM,SACNgB,MAAO,GACPE,MAAO,GAET,KAAQ,CACNlB,KAAM,YACNgB,MAAO,GACPE,MAAO,GAGT,IAAO,CACLlB,KAAM,SACNgB,MAAO,GACPE,MAAO,GAET,KAAQ,CACNlB,KAAM,YACNgB,MAAO,GACPE,MAAO,GAET,IAAO,CACLlB,KAAM,SACNgB,MAAO,GACPE,MAAO,IAILgB,EAAoB,CACxBsK,UAAW,EACXC,SAAU,GACVC,UAAW,IACXC,QAAS,KAELC,EAA8B,CAAC,MAAO,OAAQ,OAAQ,SAAU,YAAa,QAAS,YAAa,WAAY,gBAAiB,aAAc,WAAY,eAAgB,aAAc,YAAa","file":"static/js/4.3cde8341.chunk.js","sourcesContent":["import Artifact from \"../Artifact/Artifact\";\r\nimport { ArtifactSheet } from \"../Artifact/ArtifactSheet\";\r\nimport Conditional from \"../Conditional/Conditional\";\r\nimport { characterStatBase, LevelsData } from \"../Data/CharacterData\";\r\nimport ElementalData from \"../Data/ElementalData\";\r\nimport ArtifactDatabase from \"../Database/ArtifactDatabase\";\r\nimport CharacterDatabase from \"../Database/CharacterDatabase\";\r\nimport Formula from \"../Formula\";\r\nimport { ElementToReactionKeys, PreprocessFormulas } from \"../StatData\";\r\nimport { GetDependencies } from \"../StatDependency\";\r\nimport { ICharacter } from \"../Types/character\";\r\nimport { allElements, allSlotKeys, CharacterKey, SlotKey } from \"../Types/consts\";\r\nimport ICalculatedStats from \"../Types/ICalculatedStats\";\r\nimport { deepClone, evalIfFunc } from \"../Util/Util\";\r\nimport Weapon from \"../Weapon/Weapon\";\r\nimport WeaponSheet from \"../Weapon/WeaponSheet\";\r\nimport CharacterSheet from \"./CharacterSheet\";\r\n\r\nexport default class Character {\r\n  //do not instantiate.\r\n  constructor() { if (this instanceof Character) throw Error('A static class cannot be instantiated.'); }\r\n\r\n  static getElementalName = (elementalKey, defVal = \"\") => (ElementalData?.[elementalKey]?.name || defVal)\r\n\r\n  //LEVEL\r\n  static getlevelKeys = (): string[] => Object.keys(LevelsData)\r\n  static getlevelTemplateName = (levelKey, defVal = \"\") => (LevelsData?.[levelKey]?.name || defVal)\r\n  static getLevelString = (character: ICharacter, characterSheet: CharacterSheet, weaponSheet: WeaponSheet) => {\r\n    const levelOverride = Character.getStatValueWithOverride(character, characterSheet, weaponSheet, \"characterLevel\")\r\n    return Character.getLevel(character.levelKey) === levelOverride ? Character.getlevelTemplateName(character.levelKey) : `Lvl. ${levelOverride}`\r\n  }\r\n  static getIndexFromlevelkey = (levelKey) => Character.getlevelKeys().indexOf(levelKey);\r\n  static getLevel = (levelKey, defVal = 1) => (LevelsData?.[levelKey]?.level || defVal)\r\n  static getAscension = (levelKey, defVal = 0) => (LevelsData?.[levelKey]?.asend || defVal)\r\n\r\n  static getTalentFieldValue = (field, key, stats = {}, defVal = \"\") => {\r\n    if (!field?.[key]) return defVal\r\n    return evalIfFunc(field?.[key], stats)\r\n  }\r\n\r\n  static hasOverride = (character, statKey) => {\r\n    if (statKey === \"finalHP\")\r\n      return Character.hasOverride(character, \"hp\") || Character.hasOverride(character, \"hp_\") || Character.hasOverride(character, \"characterHP\") || false\r\n    else if (statKey === \"finalDEF\")\r\n      return Character.hasOverride(character, \"def\") || Character.hasOverride(character, \"def_\") || Character.hasOverride(character, \"characterDEF\") || false\r\n    else if (statKey === \"finalATK\")\r\n      return Character.hasOverride(character, \"atk\") || Character.hasOverride(character, \"atk_\") || Character.hasOverride(character, \"characterATK\") || false\r\n    return character?.baseStatOverrides ? (statKey in character.baseStatOverrides) : false;\r\n  }\r\n\r\n  static getBaseStatValue = (character: ICharacter, characetSheet: CharacterSheet, weaponSheet: WeaponSheet, statKey: string, defVal = 0) => {\r\n    const { levelKey } = character\r\n    if (statKey === \"specializedStatKey\") return characetSheet.specializeStat.key\r\n    if (statKey === \"specializedStatVal\") return characetSheet.specializeStat.value[Character.getIndexFromlevelkey(levelKey)]\r\n    if (statKey === \"weaponATK\") return Weapon.getWeaponMainStatValWithOverride(character?.weapon, weaponSheet)\r\n    if (statKey === \"characterLevel\" || statKey === \"enemyLevel\") return Character.getLevel(levelKey)\r\n    if (statKey.includes(\"enemyRes_\")) return 10\r\n    if (statKey in characterStatBase) return characterStatBase[statKey]\r\n    if (statKey in characetSheet.baseStat) return characetSheet.baseStat[statKey][Character.getIndexFromlevelkey(levelKey)]\r\n    return defVal\r\n  }\r\n  static getStatValueWithOverride = (character: ICharacter, characterSheet: CharacterSheet, weaponSheet: WeaponSheet, statKey: string, defVal = 0) => {\r\n    if (Character.hasOverride(character, statKey)) return character?.baseStatOverrides?.[statKey] ?? defVal\r\n    else return Character.getBaseStatValue(character, characterSheet, weaponSheet, statKey, defVal)\r\n  }\r\n\r\n  //equipment, with consideration on swapping equipped.\r\n  static equipArtifacts = (characterKey: CharacterKey | \"\", artIds: StrictDict<SlotKey, string>) => {\r\n    const character = CharacterDatabase.get(characterKey)\r\n    if (!character) return;\r\n    const artIdsOnCharacter = character.equippedArtifacts;\r\n\r\n    //swap, by slot\r\n    allSlotKeys.forEach(slotKey => {\r\n      const artNotOnChar = ArtifactDatabase.get(artIds[slotKey])\r\n      if (artNotOnChar?.location === characterKey) return; //it is already equipped\r\n      const artOnChar = ArtifactDatabase.get(artIdsOnCharacter?.[slotKey])\r\n      const notCharLoc = (artNotOnChar?.location ?? \"\")\r\n      //move current art to other char\r\n      if (artOnChar) ArtifactDatabase.moveToNewLocation(artOnChar.id, notCharLoc)\r\n      //move current art to other char\r\n      if (notCharLoc) CharacterDatabase.equipArtifactOnSlot(notCharLoc, slotKey, artOnChar?.id ?? \"\")\r\n      //move other art to current char\r\n      if (artNotOnChar) ArtifactDatabase.moveToNewLocation(artNotOnChar.id, characterKey)\r\n    })\r\n    //move other art to current char\r\n    CharacterDatabase.equipArtifactBuild(characterKey, artIds);\r\n  }\r\n  static remove(characterKey) {\r\n    const character = CharacterDatabase.get(characterKey)\r\n    if (!character) return\r\n    Object.values(character.equippedArtifacts).forEach(artid =>\r\n      ArtifactDatabase.moveToNewLocation(artid, \"\"))\r\n    CharacterDatabase.remove(characterKey)\r\n  }\r\n\r\n  static calculateBuild = (character: ICharacter, characterSheet: CharacterSheet, weaponSheet: WeaponSheet, artifactSheets, mainStatAssumptionLevel = 0) => {\r\n    let artifacts\r\n    if (character.artifacts) //from flex\r\n      artifacts = Object.fromEntries(character.artifacts.map((art, i) => [i, art]))\r\n    else if (character.equippedArtifacts)\r\n      artifacts = Object.fromEntries(Object.entries(character.equippedArtifacts).map(([key, artid]) => [key, ArtifactDatabase.get(artid)]))\r\n    else return {}//probably won't happen. just in case.\r\n    const initialStats = Character.createInitialStats(character, characterSheet, weaponSheet)\r\n    initialStats.mainStatAssumptionLevel = mainStatAssumptionLevel\r\n    return Character.calculateBuildwithArtifact(initialStats, artifacts, artifactSheets)\r\n  }\r\n\r\n  static calculateBuildwithArtifact = (initialStats, artifacts, artifactSheets) => {\r\n    const setToSlots = Artifact.setToSlots(artifacts)\r\n    let artifactSetEffectsStats = ArtifactSheet.setEffectsStats(artifactSheets, initialStats, setToSlots)\r\n\r\n    let stats = deepClone(initialStats)\r\n    //add artifact and artifactsets\r\n    Object.values(artifacts).forEach((art: any) => {\r\n      if (!art) return\r\n      //main stats\r\n      stats[art.mainStatKey] = (stats[art.mainStatKey] || 0) + Artifact.mainStatValue(art.mainStatKey, art.numStars, Math.max(Math.min(stats.mainStatAssumptionLevel, art.numStars * 4), art.level))\r\n      //substats\r\n      art.substats.forEach((substat) =>\r\n        substat && substat.key && (stats[substat.key] = (stats[substat.key] || 0) + substat.value))\r\n    })\r\n    //setEffects\r\n    artifactSetEffectsStats.forEach(stat => stats[stat.key] = (stats[stat.key] || 0) + stat.value)\r\n    //setEffects conditionals\r\n    Conditional.parseConditionalValues({ artifact: stats?.conditionalValues?.artifact }, (conditional, conditionalValue, [, setKey]) => {\r\n      const { setNumKey } = conditional\r\n      if (parseInt(setNumKey) > (setToSlots?.[setKey]?.length ?? 0)) return\r\n      const { stats: condStats } = Conditional.resolve(conditional, stats, conditionalValue)\r\n      Object.entries(condStats).forEach(([statKey, val]) => stats[statKey] = (stats[statKey] || 0) + val)\r\n    })\r\n\r\n    stats.equippedArtifacts = Object.fromEntries(Object.entries(artifacts).map(([key, val]: any) => [key, val?.id]))\r\n    stats.setToSlots = setToSlots\r\n    let dependencies = GetDependencies(stats?.modifiers)\r\n    PreprocessFormulas(dependencies, stats).formula(stats)\r\n    return stats\r\n  }\r\n  static mergeStats = (initialStats, stats) => stats && Object.entries(stats).forEach(([key, val]: any) => {\r\n    if (key === \"modifiers\") {\r\n      initialStats.modifiers = initialStats.modifiers ?? {}\r\n      for (const [statKey, modifier] of (Object.entries(val) as any)) {\r\n        initialStats.modifiers[statKey] = initialStats.modifiers[statKey] ?? {}\r\n        for (const [mkey, multiplier] of (Object.entries(modifier) as any))\r\n          initialStats.modifiers[statKey][mkey] = (initialStats.modifiers[statKey][mkey] ?? 0) + multiplier\r\n      }\r\n    } else {\r\n      if (initialStats[key] === undefined) initialStats[key] = val\r\n      else if (typeof initialStats[key] === \"number\") initialStats[key] += val\r\n    }\r\n  })\r\n\r\n  static createInitialStats = (character: ICharacter, characterSheet: CharacterSheet, weaponSheet: WeaponSheet): ICalculatedStats => {\r\n    character = deepClone(character)\r\n    const { characterKey, levelKey, hitMode, infusionAura, reactionMode, talentLevelKeys, constellation, equippedArtifacts, conditionalValues = {}, weapon = { key: \"\" } } = character\r\n    const ascension = Character.getAscension(levelKey)\r\n\r\n    //generate the initalStats obj with data from Character & overrides\r\n    const statKeys = [\"characterHP\", \"characterATK\", \"characterDEF\", \"weaponATK\", \"characterLevel\", \"enemyLevel\", \"physical_enemyRes_\", \"physical_enemyImmunity\", ...Object.keys(characterStatBase)]\r\n    const initialStats = Object.fromEntries(statKeys.map(key => [key, Character.getStatValueWithOverride(character, characterSheet, weaponSheet, key)]))\r\n    initialStats.characterEle = characterSheet.elementKey;\r\n    initialStats.characterKey = characterKey\r\n    initialStats.hitMode = hitMode;\r\n    initialStats.infusionAura = infusionAura\r\n    initialStats.reactionMode = reactionMode;\r\n    initialStats.conditionalValues = conditionalValues\r\n    initialStats.weaponType = characterSheet.weaponTypeKey\r\n    initialStats.tlvl = talentLevelKeys;\r\n    initialStats.constellation = constellation\r\n    initialStats.ascension = ascension\r\n    initialStats.weapon = weapon\r\n    initialStats.equippedArtifacts = equippedArtifacts;\r\n\r\n\r\n    //enemy stuff\r\n    [\"physical\", ...allElements].forEach(eleKey => {\r\n      let statKey = `${eleKey}_enemyRes_`\r\n      initialStats[statKey] = Character.getStatValueWithOverride(character, characterSheet, weaponSheet, statKey);\r\n      statKey = `${eleKey}_enemyImmunity`\r\n      initialStats[statKey] = Character.getStatValueWithOverride(character, characterSheet, weaponSheet, statKey);\r\n    })\r\n\r\n    //all the rest of the overrides\r\n    let overrides = character?.baseStatOverrides || {}\r\n    Object.entries(overrides).forEach(([statKey, val]: any) => {\r\n      if (statKey === \"specializedStatKey\" || statKey === \"specializedStatVal\") return\r\n      if (!initialStats.hasOwnProperty(statKey)) initialStats[statKey] = val\r\n    })\r\n\r\n    //add specialized stat\r\n    let specializedStatVal = Character.getStatValueWithOverride(character, characterSheet, weaponSheet, \"specializedStatVal\")\r\n    let specialStatKey = Character.getStatValueWithOverride(character, characterSheet, weaponSheet, \"specializedStatKey\")\r\n    Character.mergeStats(initialStats, { [specialStatKey]: specializedStatVal })\r\n\r\n    //add stats from all talents\r\n    characterSheet.getTalentStatsAll(initialStats as ICalculatedStats).forEach(s => Character.mergeStats(initialStats, s))\r\n\r\n    //add levelBoosts, from Talent stats.\r\n    for (const key in initialStats.tlvl)\r\n      initialStats.tlvl[key] += initialStats[`${key}Boost`] ?? 0\r\n\r\n    //add stats from weapons\r\n    const weaponSubKey = Weapon.getWeaponSubstatKey(weaponSheet)\r\n    if (weaponSubKey) Character.mergeStats(initialStats, { [weaponSubKey]: Weapon.getWeaponSubstatValWithOverride(character?.weapon, weaponSheet) })\r\n    Character.mergeStats(initialStats, weaponSheet.stats(initialStats as ICalculatedStats))\r\n\r\n\r\n    //Handle conditionals, without artifact, since the pipeline for that comes later.\r\n    const { artifact: artifactCond, weapon: weaponCond, ...otherCond } = conditionalValues\r\n\r\n    //handle conditionals. only the conditional applicable to the equipped weapon is parsed.\r\n    Conditional.parseConditionalValues({ ...weapon.key && { weapon: { [weapon.key]: weaponCond?.[weapon.key] } }, ...otherCond }, (conditional, conditionalValue, keys) => {\r\n      if (!Conditional.canShow(conditional, initialStats)) return\r\n      const { stats: condStats } = Conditional.resolve(conditional, initialStats, conditionalValue)\r\n      Character.mergeStats(initialStats, condStats)\r\n    })\r\n    return initialStats as ICalculatedStats\r\n  }\r\n  static getDisplayStatKeys = (stats: ICalculatedStats, characterSheet: CharacterSheet) => {\r\n    const { characterKey } = stats\r\n    let eleKey = characterSheet.elementKey\r\n    const basicKeys = [\"finalHP\", \"finalATK\", \"finalDEF\", \"eleMas\", \"critRate_\", \"critDMG_\", \"heal_\", \"enerRech_\", `${eleKey}_dmg_`]\r\n    const isAutoElemental = characterSheet.isAutoElemental\r\n    if (!isAutoElemental) basicKeys.push(\"physical_dmg_\")\r\n\r\n    //show elemental interactions\r\n    const transReactions = deepClone(ElementToReactionKeys[eleKey])\r\n    const weaponTypeKey = characterSheet.weaponTypeKey\r\n    if (!transReactions.includes(\"shattered_hit\") && weaponTypeKey === \"claymore\") transReactions.push(\"shattered_hit\")\r\n    if (Formula.formulas.character?.[characterKey]) {\r\n      const charFormulas = {}\r\n      Object.entries(Formula.formulas.character[characterKey]).forEach(([talentKey, formulas]: any) => {\r\n        Object.values(formulas as any).forEach((formula: any) => {\r\n          if (!formula.field.canShow(stats)) return\r\n          if (talentKey === \"normal\" || talentKey === \"charged\" || talentKey === \"plunging\") talentKey = \"auto\"\r\n          const formKey = `talentKey_${talentKey}`\r\n          if (!charFormulas[formKey]) charFormulas[formKey] = []\r\n          charFormulas[formKey].push(formula.keys)\r\n        })\r\n      })\r\n\r\n      const weaponFormulas = Formula.formulas.weapon[stats.weapon.key]\r\n\r\n      if (weaponFormulas) {\r\n        Object.values(weaponFormulas as any).forEach((formula: any) => {\r\n          if (!formula.field.canShow(stats)) return\r\n          const formKey = `weapon_${stats.weapon.key}`\r\n          if (!charFormulas[formKey]) charFormulas[formKey] = []\r\n          charFormulas[formKey].push(formula.keys)\r\n        })\r\n      }\r\n      return { basicKeys, ...charFormulas, transReactions }\r\n    } else {//TODO: doesnt have character sheet\r\n      //generic average hit parameters.\r\n      const genericAvgHit: string[] = []\r\n      if (!isAutoElemental) //add phy auto + charged + physical\r\n        genericAvgHit.push(\"physical_normal_avgHit\", \"physical_charged_avgHit\")\r\n\r\n      else if (weaponTypeKey === \"bow\") {//bow charged atk does elemental dmg on charge\r\n        genericAvgHit.push(`${eleKey}_charged_avgHit`)\r\n      }\r\n      //show skill/burst\r\n      genericAvgHit.push(`${eleKey}_skill_avgHit`, `${eleKey}_burst_avgHit`)\r\n\r\n      //add reactions.\r\n      if (eleKey === \"pyro\") {\r\n        const reactions: string[] = []\r\n        reactions.push(...genericAvgHit.filter(key => key.startsWith(`${eleKey}_`)).map(key => key.replace(`${eleKey}_`, `${eleKey}_vaporize_`)))\r\n        reactions.push(...genericAvgHit.filter(key => key.startsWith(`${eleKey}_`)).map(key => key.replace(`${eleKey}_`, `${eleKey}_melt_`)))\r\n        genericAvgHit.push(...reactions)\r\n      } else if (eleKey === \"cryo\")\r\n        genericAvgHit.push(...genericAvgHit.filter(key => key.startsWith(`${eleKey}_`)).map(key => key.replace(`${eleKey}_`, `${eleKey}_melt_`)))\r\n      else if (eleKey === \"hydro\")\r\n        genericAvgHit.push(...genericAvgHit.filter(key => key.startsWith(`${eleKey}_`)).map(key => key.replace(`${eleKey}_`, `${eleKey}_vaporize_`)))\r\n\r\n      return { basicKeys, genericAvgHit, transReactions }\r\n    }\r\n  }\r\n  static getDisplayHeading(key: string, characterSheet: CharacterSheet, weaponSheet: WeaponSheet) {\r\n    if (key === \"basicKeys\") return \"Basic Stats\"\r\n    else if (key === \"genericAvgHit\") return \"Generic Optimization Values\"\r\n    else if (key === \"transReactions\") return \"Transformation Reaction\"\r\n    else if (key.startsWith(\"talentKey_\")) {\r\n      const subkey = key.split(\"talentKey_\")[1]\r\n      return (characterSheet?.getTalent(subkey)?.name ?? subkey)\r\n    } else if (key.startsWith(\"weapon_\")) {\r\n      const subkey = key.split(\"weapon_\")[1]\r\n      return (weaponSheet?.name ?? subkey)\r\n    }\r\n    return \"\"\r\n  }\r\n}","export default __webpack_public_path__ + \"static/media/Element_Anemo.f809fde3.png\";","import anemo from './Element_Anemo.png'\r\nimport cryo from './Element_Cryo.png'\r\nimport dendro from './Element_Dendro.png'\r\nimport electro from './Element_Electro.png'\r\nimport geo from './Element_Geo.png'\r\nimport hydro from './Element_Hydro.png'\r\nimport pyro from './Element_Pyro.png'\r\n\r\nimport bow from './Weapon-class-bow-icon.png'\r\nimport catalyst from './Weapon-class-catalyst-icon.png'\r\nimport claymore from './Weapon-class-claymore-icon.png'\r\nimport polearm from './Weapon-class-polearm-icon.png'\r\nimport sword from './Weapon-class-sword-icon.png'\r\n\r\nimport fragile from './Item_Fragile_Resin.png'\r\nimport condensed from './Item_Condensed_Resin.png'\r\n\r\n//EXP BOOKS\r\nimport advice from './Item_Wanderer\\'s_Advice.png'\r\nimport wit from './Item_Hero\\'s_Wit.png'\r\nimport experience from './Item_Adventurer\\'s_Experience.png'\r\n\r\nlet Assets = {\r\n  elements: { anemo, cryo, dendro, electro, geo, hydro, pyro },\r\n  weaponTypes: { bow, catalyst, claymore, polearm, sword },\r\n  resin: {\r\n    fragile,\r\n    condensed\r\n  },\r\n  exp_books: {\r\n    advice,\r\n    wit,\r\n    experience,\r\n  }\r\n};\r\nexport default Assets;","export default __webpack_public_path__ + \"static/media/Element_Cryo.019d72f9.png\";","export default __webpack_public_path__ + \"static/media/Element_Dendro.8ee0f26d.png\";","export default __webpack_public_path__ + \"static/media/Element_Electro.342332ac.png\";","export default __webpack_public_path__ + \"static/media/Element_Geo.b7e865c6.png\";","export default __webpack_public_path__ + \"static/media/Element_Hydro.f2f8bd8a.png\";","export default __webpack_public_path__ + \"static/media/Element_Pyro.f65c2e38.png\";","export default __webpack_public_path__ + \"static/media/Weapon-class-bow-icon.b8e7b5ca.png\";","export default __webpack_public_path__ + \"static/media/Weapon-class-catalyst-icon.2cbef800.png\";","export default __webpack_public_path__ + \"static/media/Weapon-class-claymore-icon.17418b20.png\";","export default __webpack_public_path__ + \"static/media/Weapon-class-polearm-icon.a4e7fffc.png\";","export default __webpack_public_path__ + \"static/media/Weapon-class-sword-icon.4470b487.png\";","export default __webpack_public_path__ + \"static/media/Item_Fragile_Resin.f9ec8223.png\";","export default __webpack_public_path__ + \"static/media/Item_Condensed_Resin.1cecf64a.png\";","export default __webpack_public_path__ + \"static/media/Item_Wanderer's_Advice.58c62cf7.png\";","export default __webpack_public_path__ + \"static/media/Item_Hero's_Wit.a79e36d0.png\";","export default __webpack_public_path__ + \"static/media/Item_Adventurer's_Experience.92b5d195.png\";","import { LevelNameData, WeaponLevelKeys, WeaponTypeData } from '../Data/WeaponData';\r\nimport WeaponSheet from './WeaponSheet';\r\nexport default class Weapon {\r\n  //do not instantiate.\r\n  constructor() { if (this instanceof Weapon) throw Error('A static class cannot be instantiated.'); }\r\n\r\n  static getLevelName = (levelKey, defVal = \"\") => (LevelNameData[levelKey] || defVal)\r\n  static getLevelIndex = (levelKey): number => WeaponLevelKeys.indexOf(levelKey)\r\n\r\n  //base Stat\r\n  static getWeaponMainStatVal = (weaponSheet: WeaponSheet, levelKey, defVal = 0) => (weaponSheet.baseStats.main[Weapon.getLevelIndex(levelKey)] || defVal)\r\n  static getWeaponSubstatVal = (weaponSheet: WeaponSheet, levelKey, defVal = 0) => (weaponSheet.baseStats.sub?.[Weapon.getLevelIndex(levelKey)] || defVal)\r\n  static getWeaponSubstatKey = (weaponSheet: WeaponSheet, defVal = \"\") => (weaponSheet.baseStats?.substatKey || defVal)\r\n\r\n  static getWeaponTypeName = (weaponType, defVal = \"\") => (WeaponTypeData[weaponType] || defVal)\r\n  static getWeaponTypeKeys = (): string[] => Object.keys(WeaponTypeData)\r\n\r\n  static getWeaponMainStatValWithOverride = (weaponObj: any, weaponSheet: WeaponSheet, defVal = 0) =>\r\n    weaponObj?.overrideMainVal || Weapon.getWeaponMainStatVal(weaponSheet, weaponObj?.levelKey, defVal);\r\n  static getWeaponSubstatValWithOverride = (weaponObj: any, weaponSheet: WeaponSheet, defVal = 0) =>\r\n    weaponObj?.overrideSubVal || Weapon.getWeaponSubstatVal(weaponSheet, weaponObj?.levelKey, defVal);\r\n}","import ICalculatedStats from './Types/ICalculatedStats';\r\nimport { crawlObject, objPathValue } from './Util/Util';\r\n\r\nexport const formulaImport = import('./Data/formula').then(imp => {\r\n  Formula.formulas = imp.default\r\n  crawlObject(imp.default, [], f => typeof f === \"function\", (formula, keys) => formula.keys = keys)\r\n})\r\n\r\nexport default class Formula {\r\n  constructor() { if (this instanceof Formula) throw Error('A static class cannot be instantiated.'); }\r\n  static formulas: any = {}\r\n  static get = (keys: string[]): Promise<((stats: ICalculatedStats) => any[]) | undefined> => formulaImport.then(() => objPathValue(Formula.formulas, keys))\r\n}\r\n","const WeaponLevelKeys = [\"L1\", \"L5\", \"L10\", \"L15\", \"L20\", \"L20A\", \"L25\", \"L30\", \"L35\", \"L40\", \"L40A\", \"L45\", \"L50\", \"L50A\", \"L55\", \"L60\", \"L60A\", \"L65\", \"L70\", \"L70A\", \"L75\", \"L80\", \"L80A\", \"L85\", \"L90\",]\r\nconst LevelNameData = { \"L1\": \"Lvl. 1\", \"L5\": \"Lvl. 5\", \"L10\": \"Lvl. 10\", \"L15\": \"Lvl. 15\", \"L20\": \"Lvl. 20\", \"L20A\": \"Lvl. 20/40\", \"L25\": \"Lvl. 25\", \"L30\": \"Lvl. 30\", \"L35\": \"Lvl. 35\", \"L40\": \"Lvl. 40\", \"L40A\": \"Lvl. 40/50\", \"L45\": \"Lvl. 45\", \"L50\": \"Lvl. 50\", \"L50A\": \"Lvl. 50/60\", \"L55\": \"Lvl. 55\", \"L60\": \"Lvl. 60\", \"L60A\": \"Lvl. 60/70\", \"L65\": \"Lvl. 65\", \"L70\": \"Lvl. 70\", \"L70A\": \"Lvl. 70/80\", \"L75\": \"Lvl. 75\", \"L80\": \"Lvl. 80\", \"L80A\": \"Lvl. 80/90\", \"L85\": \"Lvl. 85\", \"L90\": \"Lvl. 90\", }\r\nconst WeaponTypeData = {\r\n  sword: \"Sword\",\r\n  claymore: \"Claymore\",\r\n  catalyst: \"Catalyst\",\r\n  bow: \"Bow\",\r\n  polearm: \"Polearm\"\r\n}\r\n\r\nexport {\r\n  WeaponLevelKeys,\r\n  LevelNameData,\r\n  WeaponTypeData\r\n}","import { Formulas, StatData } from \"./StatData\"\r\n\r\n//generate a statKey dependency, to reduce build generation calculation on a single stat.\r\nfunction GetFormulaDependency(formula) {\r\n  const dependency = new Set()\r\n  formula(\r\n    new Proxy({}, { get: (target, prop, receiver) => { dependency.add(prop) } }),\r\n    new Proxy({}, { get: (target, prop, receiver) => { dependency.add(prop) } }))\r\n  return [...dependency]\r\n}\r\nconst formulaKeyDependency = Object.freeze(Object.fromEntries(\r\n  Object.keys(Formulas).map(key => [key, GetFormulaDependency(Formulas[key])])\r\n))\r\n\r\nif (process.env.NODE_ENV === \"development\") {\r\n  let statKeys = Object.keys(StatData)\r\n  Object.entries(formulaKeyDependency).forEach(([formulaKey, dependencies]: any) =>\r\n    dependencies.forEach(key =>\r\n      !statKeys.includes(key as any) &&\r\n      console.error(`Formula ${formulaKey} depends key ${key} that does not Exist in StatData.`))\r\n  )\r\n  Object.entries(formulaKeyDependency).forEach(([formulaKey, dependencies]: any) =>\r\n    StatData[formulaKey]?.const && dependencies.forEach(key =>\r\n      !StatData[key as any]?.const &&\r\n      console.error(`Constant formula ${formulaKey} depends on dynamic key ${key}.`)\r\n    )\r\n  )\r\n}\r\n\r\nfunction GetDependencies(modifiers = {}, keys = Object.keys(StatData)) {\r\n  let dependencies = new Set()\r\n  keys.forEach(key => InsertDependencies(key, modifiers, dependencies))\r\n  return [...dependencies]\r\n}\r\nfunction InsertDependencies(key, modifiers, dependencies) {\r\n  if (dependencies.has(key)) return\r\n  formulaKeyDependency[key]?.forEach(k => InsertDependencies(k, modifiers, dependencies))\r\n  Object.keys(modifiers[key] ?? {}).forEach(k => InsertDependencies(k, modifiers, dependencies))\r\n  dependencies.add(key)\r\n}\r\n\r\n//if the optimizationTarget is in the form of {dmg:0.6}, it can be reduced to \"dmg\" for the purpose to build generation.\r\nconst reduceOptimizationTarget = (optimizationTarget) =>\r\n  (typeof optimizationTarget === \"object\" && Object.keys(optimizationTarget).length === 1 && typeof optimizationTarget[Object.keys(optimizationTarget)[0] as any] === \"number\") ? Object.keys(optimizationTarget)[0] : optimizationTarget\r\n\r\n\r\nexport {\r\n  GetFormulaDependency,\r\n  GetDependencies,\r\n  reduceOptimizationTarget,\r\n}\r\n","// import characters from\r\nconst LevelsData = {\r\n  \"L1\": {\r\n    name: \"Lv. 1\",\r\n    level: 1,\r\n    asend: 0\r\n  },\r\n  \"L20\": {\r\n    name: \"Lv. 20\",\r\n    level: 20,\r\n    asend: 0\r\n  },\r\n  \"L20A\": {\r\n    name: \"Lv. 20/40\",\r\n    level: 20,\r\n    asend: 1\r\n\r\n  },\r\n  \"L40\": {\r\n    name: \"Lv. 40\",\r\n    level: 40,\r\n    asend: 1\r\n  },\r\n  \"L40A\": {\r\n    name: \"Lv. 40/50\",\r\n    level: 40,\r\n    asend: 2\r\n  },\r\n\r\n  \"L50\": {\r\n    name: \"Lv. 50\",\r\n    level: 50,\r\n    asend: 2\r\n  },\r\n  \"L50A\": {\r\n    name: \"Lv. 50/60\",\r\n    level: 50,\r\n    asend: 3\r\n  },\r\n  \"L60\": {\r\n    name: \"Lv. 60\",\r\n    level: 60,\r\n    asend: 3\r\n  },\r\n  \"L60A\": {\r\n    name: \"Lv. 60/70\",\r\n    level: 60,\r\n    asend: 4\r\n  },\r\n  \"L70\": {\r\n    name: \"Lv. 70\",\r\n    level: 70,\r\n    asend: 4\r\n  },\r\n  \"L70A\": {\r\n    name: \"Lv. 70/80\",\r\n    level: 70,\r\n    asend: 5\r\n  },\r\n\r\n  \"L80\": {\r\n    name: \"Lv. 80\",\r\n    level: 80,\r\n    asend: 5\r\n  },\r\n  \"L80A\": {\r\n    name: \"Lv. 80/90\",\r\n    level: 80,\r\n    asend: 6\r\n  },\r\n  \"L90\": {\r\n    name: \"Lv. 90\",\r\n    level: 90,\r\n    asend: 6\r\n  }\r\n\r\n}\r\nconst characterStatBase = {\r\n  critRate_: 5,\r\n  critDMG_: 50,\r\n  enerRech_: 100,\r\n  stamina: 100\r\n}\r\nconst CharacterSpecializedStatKey = [\"hp_\", \"atk_\", \"def_\", \"eleMas\", \"enerRech_\", \"heal_\", \"critRate_\", \"critDMG_\", \"physical_dmg_\", \"anemo_dmg_\", \"geo_dmg_\", \"electro_dmg_\", \"hydro_dmg_\", \"pyro_dmg_\", \"cryo_dmg_\"]\r\n\r\nexport {\r\n  LevelsData,\r\n  characterStatBase,\r\n  CharacterSpecializedStatKey\r\n}"],"sourceRoot":""}
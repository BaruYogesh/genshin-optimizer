{"version":3,"file":"static/js/427.a3d45f0a.chunk.js","mappings":"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","sources":["Components/Artifact/ArtifactAutocomplete.tsx","Components/Artifact/ArtifactLevelSlider.tsx","Components/Conditional/ConditionalSelector.tsx","Components/Conditional/ConditionalDisplay.tsx","Components/DocumentDisplay.tsx","Components/ExpandButton.tsx","Components/TextButton.tsx","Data/Characters/dataUtil.tsx","Formula/reaction.ts","Components/StatInput.tsx","Components/EnemyEditor.tsx","Components/HitModeEditor.tsx","Formula/DisplayUtil.tsx","Components/Artifact/SetEffectDisplay.tsx","Components/Character/StatDisplayComponent.tsx","ReactHooks/useBoolState.tsx","Components/Artifact/ArtifactCardNano.tsx","Components/Weapon/WeaponCardNano.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildDisplayItem.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/CompareBuildButton.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/ArtifactSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/WeaponSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/BackgroundWorker.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/common.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ArtifactSetConditional.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ArtifactSetPicker.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/AssumeFullLevelToggle.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BonusStatsCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildAlert.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ChartCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/MainStatSelectionCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/OptimizationTargetSelector.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/DBState.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseEquipped.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseExcluded.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/foreground.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview.tsx","PageCharacter/CharacterDisplay/Tabs/TabTalent.tsx","PageCharacter/CharacterDisplay/Tabs/TabTeambuffs.tsx","PageCharacter/CharacterDisplay/index.tsx","PageWeapon/WeaponCard.tsx","ReactHooks/useWeapon.tsx","Util/TimeUtil.ts","Util/WeaponSort.ts"],"sourcesContent":["import { Autocomplete, AutocompleteProps, Chip, TextField, useTheme } from '@mui/material';\r\nimport { useMemo } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ArtifactSheet } from '../../Data/Artifacts/ArtifactSheet';\r\nimport KeyMap from '../../KeyMap';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport { allMainStatKeys, allSubstatKeys, MainStatKey, SubstatKey } from '../../Types/artifact';\r\nimport { allArtifactSets, allElementsWithPhy, ArtifactSetKey } from '../../Types/consts';\r\nimport MenuItemWithImage from '../MenuItemWithImage';\r\nimport SolidColoredTextField from '../SolidColoredTextfield';\r\nimport StatIcon from '../StatIcon';\r\n\r\ntype ArtifactMultiAutocompleteKey = ArtifactSetKey | MainStatKey | SubstatKey\r\ntype ArtifactMultiAutocompleteOption<T extends ArtifactMultiAutocompleteKey> = {\r\n  key: T\r\n  label: string\r\n}\r\ntype ArtifactMultiAutocompleteProps<T extends ArtifactMultiAutocompleteKey> = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<T>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  allArtifactKeys: readonly T[]\r\n  selectedArtifactKeys: T[]\r\n  setArtifactKeys: (keys: T[]) => void\r\n  getName: (key: T) => string\r\n  getImage: (key: T) => JSX.Element\r\n  label: string\r\n}\r\nfunction ArtifactMultiAutocomplete<T extends ArtifactMultiAutocompleteKey>({ allArtifactKeys, selectedArtifactKeys, setArtifactKeys, getName, getImage, label, ...props }:\r\n  ArtifactMultiAutocompleteProps<T>) {\r\n  const theme = useTheme();\r\n\r\n  const handleChange = (_, value: ArtifactMultiAutocompleteOption<T>[]) => {\r\n    setArtifactKeys(value.map(v => v.key))\r\n  };\r\n  const options = useMemo(() => allArtifactKeys.map(key => ({ key: key, label: getName(key) })), [allArtifactKeys, getName])\r\n  return <Autocomplete\r\n    autoHighlight\r\n    multiple\r\n    options={options}\r\n    value={selectedArtifactKeys.map(key => ({ key: key, label: getName(key) }))}\r\n    onChange={handleChange}\r\n    getOptionLabel={(option) => option.label}\r\n    isOptionEqualToValue={(option, value) => option.key === value.key}\r\n    renderInput={(params) => <TextField\r\n      {...params}\r\n      label={label}\r\n      variant=\"filled\"\r\n      InputLabelProps={{ style: { color: theme.palette.text.primary } }}\r\n      color={selectedArtifactKeys.length ? \"success\" : \"primary\"}\r\n      type=\"search\"\r\n    />}\r\n    renderOption={(props, option) => (\r\n      <MenuItemWithImage\r\n        key={option.key}\r\n        value={option.key}\r\n        image={getImage(option.key)}\r\n        text={option.label}\r\n        theme={theme}\r\n        isSelected={selectedArtifactKeys.includes(option.key)}\r\n        props={props}\r\n      />\r\n    )}\r\n    renderTags={(selected, getTagProps) => selected.map((value, index) => {\r\n      const element = allElementsWithPhy.find(ele => value.key === `${ele}_dmg_`)\r\n      const color = element ? element : undefined\r\n      return <Chip {...getTagProps({ index })} key={value.key} icon={getImage(value.key)} label={value.label} color={color} />\r\n    })}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactSetMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<ArtifactSetKey>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  artSetKeys: ArtifactSetKey[]\r\n  setArtSetKeys: (keys: ArtifactSetKey[]) => void\r\n}\r\nexport function ArtifactSetMultiAutocomplete({ artSetKeys, setArtSetKeys, ...props }: ArtifactSetMultiAutocompleteProps) {\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const { t } = useTranslation(\"artifact\")\r\n  if (!artifactSheets) return null\r\n  return <ArtifactMultiAutocomplete<ArtifactSetKey>\r\n    allArtifactKeys={allArtifactSets}\r\n    selectedArtifactKeys={artSetKeys}\r\n    setArtifactKeys={setArtSetKeys}\r\n    getName={(key: ArtifactSetKey) => artifactSheets[key].nameRaw}\r\n    getImage={(key: ArtifactSetKey) => artifactSheets[key].defIcon}\r\n    label={t(\"autocompleteLabels.set\")}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactMainStatMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<MainStatKey>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  mainStatKeys: MainStatKey[]\r\n  setMainStatKeys: (keys: MainStatKey[]) => void\r\n}\r\nexport function ArtifactMainStatMultiAutocomplete({ mainStatKeys, setMainStatKeys, ...props }: ArtifactMainStatMultiAutocompleteProps) {\r\n  const { t } = useTranslation(\"artifact\")\r\n  return <ArtifactMultiAutocomplete<MainStatKey>\r\n    allArtifactKeys={allMainStatKeys}\r\n    selectedArtifactKeys={mainStatKeys}\r\n    setArtifactKeys={setMainStatKeys}\r\n    getName={(key: MainStatKey) => KeyMap.getArtStr(key)}\r\n    getImage={(key: MainStatKey) => StatIcon[key]}\r\n    label={t(\"autocompleteLabels.mainStat\")}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactSubstatMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<SubstatKey>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  substatKeys: SubstatKey[]\r\n  setSubstatKeys: (keys: SubstatKey[]) => void\r\n}\r\nexport function ArtifactSubstatMultiAutocomplete({ substatKeys, setSubstatKeys, ...props }: ArtifactSubstatMultiAutocompleteProps) {\r\n  const { t } = useTranslation(\"artifact\")\r\n  return <ArtifactMultiAutocomplete<SubstatKey>\r\n    allArtifactKeys={allSubstatKeys}\r\n    selectedArtifactKeys={substatKeys}\r\n    setArtifactKeys={setSubstatKeys}\r\n    getName={(key: SubstatKey) => KeyMap.getArtStr(key)}\r\n    getImage={(key: SubstatKey) => StatIcon[key]}\r\n    label={t(\"autocompleteLabels.substat\")}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactSingleAutocompleteKey = (ArtifactSetKey | \"\") | (MainStatKey | \"\") | (SubstatKey | \"\")\r\ntype ArtifactSingleAutocompleteOption<T extends ArtifactSingleAutocompleteKey> = {\r\n  key: T\r\n  label: string\r\n}\r\ntype ArtifactSingleAutocompleteProps<T extends ArtifactSingleAutocompleteKey> = Omit<AutocompleteProps<ArtifactSingleAutocompleteOption<T>, false, true, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  allArtifactKeys: readonly T[]\r\n  selectedArtifactKey: T\r\n  setArtifactKey: (key: T | \"\") => void\r\n  getName: (key: T) => string\r\n  getImage: (key: T) => JSX.Element\r\n  label: string\r\n  disable?: (v: any) => boolean\r\n  showDefault?: boolean\r\n  defaultText?: string\r\n  defaultIcon?: Displayable\r\n  flattenCorners?: boolean\r\n}\r\nfunction ArtifactSingleAutocomplete<T extends ArtifactSingleAutocompleteKey>({ allArtifactKeys, selectedArtifactKey, setArtifactKey, getName, getImage, label, disable= () => false, showDefault = false, defaultText = \"\", defaultIcon = \"\", flattenCorners = false, ...props }:\r\n  ArtifactSingleAutocompleteProps<T>) {\r\n  const theme = useTheme();\r\n\r\n  const options = useMemo(() =>\r\n    (showDefault\r\n      ? [{ key: \"\" as T, label: defaultText }]\r\n      : []\r\n    ).concat(allArtifactKeys.map(key => (\r\n      { key: key, label: getName(key) }\r\n    ))), [allArtifactKeys, getName, defaultText, showDefault])\r\n  return <Autocomplete\r\n    autoHighlight\r\n    options={options}\r\n    value={{ key: selectedArtifactKey, label: getName(selectedArtifactKey) }}\r\n    onChange={(_, newValue) => setArtifactKey(newValue ? newValue.key : \"\")}\r\n    getOptionLabel={(option) => option.label ? option.label : defaultText}\r\n    isOptionEqualToValue={(option, value) => option.key === value.key}\r\n    getOptionDisabled={option => option.key ? disable(option.key) : false}\r\n    renderInput={(props) => <SolidColoredTextField\r\n      {...props}\r\n      label={label}\r\n      startAdornment={getImage(selectedArtifactKey)}\r\n      hasValue={selectedArtifactKey ? true : false}\r\n      flattenCorners={flattenCorners}\r\n    />}\r\n    renderOption={(props, option) => (\r\n      <MenuItemWithImage\r\n        key={option.key}\r\n        value={option.key}\r\n        image={getImage(option.key)}\r\n        text={option.label}\r\n        theme={theme}\r\n        isSelected={selectedArtifactKey === option.key}\r\n        props={props}\r\n      />\r\n    )}\r\n    {...props}\r\n  />\r\n}\r\n\r\ntype ArtifactSetSingleAutocompleteProps = Omit<AutocompleteProps<ArtifactSingleAutocompleteOption<ArtifactSetKey | \"\">, false, true, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\r\n  allArtSetKeys?: readonly ArtifactSetKey[]\r\n  artSetKey: ArtifactSetKey | \"\"\r\n  setArtSetKey: (key: ArtifactSetKey | \"\") => void\r\n  label?: string\r\n  disable?: (v: any) => boolean\r\n  showDefault?: boolean\r\n  defaultText?: string\r\n  defaultIcon?: Displayable\r\n  flattenCorners?: boolean\r\n}\r\nexport function ArtifactSetSingleAutocomplete({ allArtSetKeys = allArtifactSets, artSetKey, setArtSetKey, label = \"\", flattenCorners, ...props }: ArtifactSetSingleAutocompleteProps) {\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const { t } = useTranslation(\"artifact\")\r\n  label = label ? label : t(\"autocompleteLabels.set\")\r\n  if (!artifactSheets) return null\r\n  return <ArtifactSingleAutocomplete<ArtifactSetKey | \"\">\r\n    allArtifactKeys={allArtSetKeys}\r\n    selectedArtifactKey={artSetKey}\r\n    setArtifactKey={setArtSetKey}\r\n    getName={(key: ArtifactSetKey | \"\") => key && artifactSheets[key].nameRaw}\r\n    getImage={(key: ArtifactSetKey | \"\") => key ? artifactSheets[key].defIcon : <></>}\r\n    label={label}\r\n    flattenCorners={flattenCorners}\r\n    {...props}\r\n  />\r\n}\r\n","import { Card, Slider } from \"@mui/material\"\r\nimport { useCallback, useEffect, useState } from \"react\"\r\nimport { clamp } from \"../../Util/Util\"\r\nimport CustomNumberInput from \"../CustomNumberInput\"\r\n\r\nexport default function ArtifactLevelSlider({ levelLow, levelHigh, setLow, setHigh, setBoth, dark = false, disabled = false, showLevelText = false }: {\r\n  levelLow: number,\r\n  levelHigh: number,\r\n  setLow: (low: number) => void,\r\n  setHigh: (high: number) => void,\r\n  setBoth: (low: number, high: number) => void,\r\n  dark?: boolean,\r\n  disabled?: boolean,\r\n  showLevelText?: boolean,\r\n}) {\r\n  const [sliderLow, setsliderLow] = useState(levelLow)\r\n  const [sliderHigh, setsliderHigh] = useState(levelHigh)\r\n  const setSlider = useCallback(\r\n    (e: unknown, value: number | number[]) => {\r\n      if (typeof value == \"number\") throw new TypeError()\r\n      const [l, h] = value\r\n      setsliderLow(l)\r\n      setsliderHigh(h)\r\n    },\r\n    [setsliderLow, setsliderHigh])\r\n  useEffect(() => setsliderLow(levelLow), [setsliderLow, levelLow])\r\n\r\n  useEffect(() => setsliderHigh(levelHigh), [setsliderHigh, levelHigh])\r\n  return <Card sx={{ width: \"100%\", display: \"flex\", alignItems: \"center\", bgcolor: dark ? \"contentDark.main\" : \"contentLight.main\" }}>\r\n    <CustomNumberInput\r\n      value={sliderLow}\r\n      onChange={val => setLow(clamp(val, 0, levelHigh))}\r\n      sx={{ px: 1, pl: showLevelText ? 2 : undefined, width: showLevelText ? 100 : 50, }}\r\n      inputProps={{ sx: { textAlign: \"center\" } }}\r\n      startAdornment={showLevelText ? \"Level: \" : undefined}\r\n      disabled={disabled}\r\n    />\r\n    <Slider sx={{ width: 100, flexGrow: 1, mx: 2 }}\r\n      getAriaLabel={() => 'Arifact Level Range'}\r\n      value={[sliderLow, sliderHigh]}\r\n      onChange={setSlider}\r\n      onChangeCommitted={(e, value) => setBoth(value[0], value[1])}\r\n      valueLabelDisplay=\"auto\"\r\n      min={0} max={20} step={1} marks\r\n      disabled={disabled}\r\n    />\r\n    <CustomNumberInput\r\n      value={sliderHigh}\r\n      onChange={val => setHigh(clamp(val, levelLow, 20))}\r\n      sx={{ px: 1, width: 50, }}\r\n      inputProps={{ sx: { textAlign: \"center\" } }}\r\n      disabled={disabled}\r\n    />\r\n  </Card>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank } from '@mui/icons-material';\r\nimport { Button, ButtonGroup, Divider, MenuItem } from '@mui/material';\r\nimport React, { useCallback, useContext } from 'react';\r\nimport { DataContext } from '../../DataContext';\r\nimport { DocumentConditional, IDocumentConditionalExclusive, IDocumentConditionalMultiple } from '../../Types/sheet';\r\nimport { deepClone, deletePropPath, layeredAssignment } from '../../Util/Util';\r\nimport DropdownButton from '../DropdownMenu/DropdownButton';\r\nimport SqBadge from '../SqBadge';\r\nimport { Translate } from '../Translate';\r\n\r\ninterface ConditionalSelectorProps {\r\n  conditional: DocumentConditional,\r\n  disabled?: boolean,\r\n}\r\nexport default function ConditionalSelector({ conditional, disabled = false, }: ConditionalSelectorProps) {\r\n  if (Object.keys(conditional.states).length === 1 && \"path\" in conditional) {\r\n    return <SimpleConditionalSelector conditional={conditional} disabled={disabled} />\r\n  } else if (\"path\" in conditional) {\r\n    return <ExclusiveConditionalSelector conditional={conditional} disabled={disabled} />\r\n  } else /*if (\"path\" in Object.entries(conditional.states)[0]) */ {\r\n    return <MultipleConditionalSelector conditional={conditional} disabled={disabled} />\r\n  }\r\n}\r\n\r\ninterface SimpleConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalExclusive\r\n}\r\nfunction SimpleConditionalSelector({ conditional, disabled }: SimpleConditionalSelectorProps) {\r\n  const { character, characterDispatch, data } = useContext(DataContext)\r\n  const setConditional = useCallback((v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, conditional.path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, conditional.path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [conditional, character, characterDispatch])\r\n\r\n  const conditionalValue = data.get(conditional.value).value\r\n  const [stateKey, st] = Object.entries(conditional.states)[0]\r\n  const badge = getStateBadge(st.name)\r\n  const condName = getCondName(conditional.name)\r\n\r\n  return <Button fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} onClick={() => setConditional(conditionalValue ? undefined : stateKey)} disabled={disabled} startIcon={conditionalValue ? <CheckBox /> : <CheckBoxOutlineBlank />}>\r\n    {condName} {badge}\r\n  </Button>\r\n}\r\n\r\ninterface ExclusiveConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalExclusive\r\n}\r\nfunction ExclusiveConditionalSelector({ conditional, disabled }: ExclusiveConditionalSelectorProps) {\r\n  const { character, characterDispatch, data } = useContext(DataContext)\r\n  const setConditional = useCallback((v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, conditional.path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, conditional.path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [conditional, character, characterDispatch])\r\n\r\n  const conditionalValue = data.get(conditional.value).value\r\n  const state = conditionalValue ? conditional.states[conditionalValue] : undefined\r\n  const badge = state ? getStateBadge(state.name) : <SqBadge color=\"secondary\">Not Active</SqBadge>\r\n  const condName = getCondName(conditional.name)\r\n\r\n  return <DropdownButton fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} title={<span>{condName} {badge}</span>} disabled={disabled}>\r\n    <MenuItem onClick={() => setConditional()} selected={!state} disabled={!state}>\r\n      <span>Not Active</span>\r\n    </MenuItem>\r\n    <Divider />\r\n    {Object.entries(conditional.states).map(([stateKey, st]) =>\r\n      <MenuItem key={stateKey} onClick={() => setConditional(stateKey)} selected={conditionalValue === stateKey} disabled={conditionalValue === stateKey} >{st.name}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n\r\ninterface MultipleConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalMultiple\r\n}\r\nfunction MultipleConditionalSelector({ conditional, disabled }: MultipleConditionalSelectorProps) {\r\n  const { character, characterDispatch, data } = useContext(DataContext)\r\n  const setConditional = useCallback((path: readonly string[], v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [character, characterDispatch])\r\n\r\n  return <ButtonGroup fullWidth orientation=\"vertical\" disableElevation color=\"secondary\" >\r\n    {Object.entries(conditional.states).map(([stateKey, st]) => {\r\n      const conditionalValue = data.get(st.value).value\r\n      const isSelected = conditionalValue === stateKey\r\n      return <Button\r\n        color={isSelected ? \"success\" : \"primary\"}\r\n        disabled={disabled}\r\n        fullWidth\r\n        key={stateKey}\r\n        onClick={() => setConditional(st.path, conditionalValue ? undefined : stateKey)}\r\n        size=\"small\"\r\n        startIcon={isSelected ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n        sx={{ borderRadius: 0 }}\r\n      >\r\n        {getCondName(st.name)}\r\n      </Button>\r\n    })}\r\n  </ButtonGroup>\r\n}\r\n\r\nfunction isElement(disp: Displayable): disp is JSX.Element {\r\n  return (typeof disp !== \"string\")\r\n}\r\n\r\n// Use colored badges instead of colored text inside these buttons\r\nfunction getStateBadge(stateName: Displayable | undefined): Displayable {\r\n  if (!stateName) return \"\"\r\n\r\n  let badgeColor = \"primary\"\r\n  let badgeText = stateName\r\n  if (stateName && isElement(stateName)) {\r\n    if (stateName.props.color) {\r\n      badgeColor = stateName.props.color\r\n      badgeText = <span>{stateName.props.children}</span>\r\n    }\r\n  }\r\n  return <SqBadge sx={{ ml: 0.5 }} color={badgeColor}>{badgeText}</SqBadge>\r\n}\r\n\r\n// Use colored badges instead of colored text inside these buttons\r\nfunction getCondName(condName: Displayable): Displayable {\r\n  if (isElement(condName)) {\r\n    const key = condName.props.key18\r\n    const ns = condName.props.ns\r\n    const values = condName.props.values\r\n    return <Translate ns={ns} key18={key} values={values} useBadge />\r\n  }\r\n  return condName\r\n}\r\n","import { CardContent } from \"@mui/material\"\r\nimport { useContext } from \"react\"\r\nimport { DataContext } from \"../../DataContext\"\r\nimport { DocumentConditional, DocumentSection } from \"../../Types/sheet\"\r\nimport { evalIfFunc } from \"../../Util/Util\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport { HeaderDisplay } from \"../DocumentDisplay\"\r\nimport FieldsDisplay from \"../FieldDisplay\"\r\nimport ConditionalSelector from \"./ConditionalSelector\"\r\n\r\ntype ConditionalDisplayProps = {\r\n  conditional: DocumentConditional,\r\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\r\n  hideDesc?: boolean,\r\n}\r\n\r\nexport default function ConditionalDisplay({ conditional, hideHeader = false, hideDesc = false }: ConditionalDisplayProps) {\r\n  const { data } = useContext(DataContext)\r\n  let fields\r\n  if (\"path\" in conditional) {\r\n    const condVal = data.get(conditional.value).value\r\n    fields = condVal && conditional.states[condVal]?.fields\r\n  } else /* if (\"path\" in Object.entries(conditional.states)[0]) */ {\r\n    fields = Object.values(conditional.states).flatMap(state => {\r\n      const stateVal = data.get(state.value).value\r\n      return stateVal ? state.fields : []\r\n    })\r\n  }\r\n  return <CardDark>\r\n    {!evalIfFunc(hideHeader, conditional) && <HeaderDisplay header={conditional.header} hideDesc={hideDesc} />}\r\n    <CardContent sx={{ p: 0, \"&:last-child\": { pb: 0 } }}>\r\n      <ConditionalSelector conditional={conditional} />\r\n    </CardContent>\r\n    {fields && <FieldsDisplay fields={fields} />}\r\n  </CardDark>\r\n}\r\n","import { Box, CardHeader, Divider, Typography } from \"@mui/material\"\r\nimport { useContext } from \"react\"\r\nimport { DataContext } from \"../DataContext\"\r\nimport { DocumentSection, IDocumentFields, IDocumentHeader, IDocumentText } from \"../Types/sheet\"\r\nimport { evalIfFunc } from \"../Util/Util\"\r\nimport CardDark from \"./Card/CardDark\"\r\nimport ConditionalDisplay from \"./Conditional/ConditionalDisplay\"\r\nimport FieldsDisplay from \"./FieldDisplay\"\r\nimport InfoTooltip from \"./InfoTooltip\"\r\n\r\ntype DocumentDisplayProps = {\r\n  sections: DocumentSection[],\r\n  teamBuffOnly?: boolean,\r\n  hideDesc?: boolean,\r\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\r\n}\r\n\r\nexport default function DocumentDisplay({ sections, teamBuffOnly, hideDesc = false, hideHeader = false }: DocumentDisplayProps) {\r\n  const { data } = useContext(DataContext)\r\n  if (!sections.length) return null\r\n  const sectionDisplays = sections.map((s, i) => {\r\n    // If we can't show this section, return null\r\n    if (s.canShow && !data.get(s.canShow).value ) return null\r\n    // If we are showing only teambuffs, and this section is not a teambuff, return null\r\n    if (teamBuffOnly && !s.teamBuff) return null\r\n    return <SectionDisplay section={s} key={i} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  }).filter(s => s)\r\n  if (!sectionDisplays.length) return null\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>{sectionDisplays}</Box>\r\n}\r\n\r\nfunction SectionDisplay({ section, hideDesc = false, hideHeader = false }: { section: DocumentSection, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  if (\"fields\" in section) {\r\n    return <FieldsSectionDisplay section={section} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  } else if (\"states\" in section) {\r\n    return <ConditionalDisplay conditional={section} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  } else /* if (\"text\" in section) */ {\r\n    return <TextSectionDisplay section={section} />\r\n  }\r\n}\r\n\r\nfunction FieldsSectionDisplay({ section, hideDesc, hideHeader }: { section: IDocumentFields, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  return <CardDark>\r\n    {!evalIfFunc(hideHeader, section) && section.header &&\r\n      <HeaderDisplay header={section.header} hideDesc={hideDesc} hideDivider={section.fields.length === 0} />\r\n    }\r\n    <FieldsDisplay fields={section.fields} />\r\n  </CardDark>\r\n}\r\n\r\nfunction TextSectionDisplay({ section }: { section: IDocumentText }) {\r\n  const { data } = useContext(DataContext)\r\n  return <div>\r\n    {evalIfFunc(section.text, data)}\r\n  </div>\r\n}\r\n\r\nexport function HeaderDisplay({ header, hideDesc, hideDivider }: { header: IDocumentHeader, hideDesc?: boolean, hideDivider?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  const { data } = useContext(DataContext)\r\n  let { icon, title, action } = header\r\n  icon = evalIfFunc(icon, data)\r\n  const description = !hideDesc && evalIfFunc(header.description, data)\r\n  const displayTitle = hideDesc ? title : <span>{title} <InfoTooltip title={<Typography>{description}</Typography>} /></span>\r\n  return <>\r\n    <CardHeader avatar={icon} title={displayTitle} action={action} titleTypographyProps={{ variant: \"subtitle2\" }} />\r\n    {!hideDivider && <Divider />}\r\n  </>\r\n}\r\n","import { IconButton, IconButtonProps, styled } from \"@mui/material\";\r\n\r\ninterface ExpandMoreProps extends IconButtonProps {\r\n  expand: boolean;\r\n}\r\nconst ExpandButton = styled((props: ExpandMoreProps) => {\r\n  const { expand, ...other } = props;\r\n  return <IconButton {...other} />;\r\n})(({ theme, expand }) => ({\r\n  transform: !expand ? 'rotate(0deg)' : 'rotate(180deg)',\r\n  marginLeft: 'auto',\r\n  transition: (theme as any).transitions.create('transform', {\r\n    duration: (theme as any).transitions.duration.shortest,\r\n  }),\r\n}));\r\n\r\nexport default ExpandButton","import { Button, ButtonProps, styled } from \"@mui/material\";\r\n\r\nconst DisabledButton = styled(Button)(({ theme }) => ({\r\n  \"&.Mui-disabled\": {\r\n    backgroundColor: theme.palette.primary.dark,\r\n    color: theme.palette.text.secondary,\r\n  }\r\n}))\r\n\r\nexport default function TextButton({ children, disabled, ...props }: ButtonProps) {\r\n  return <DisabledButton {...props} disabled  >\r\n    {children}\r\n  </DisabledButton>\r\n}\r\n","import { SubstatKey } from \"pipeline\";\r\nimport { input } from \"../../Formula\";\r\nimport { inferInfoMut, mergeData } from \"../../Formula/api\";\r\nimport { reactions } from \"../../Formula/reaction\";\r\nimport { Data, DisplaySub, NumNode } from \"../../Formula/type\";\r\nimport { constant, data, infoMut, lookup, percent, prod, stringPrio, subscript, sum, unit } from \"../../Formula/utils\";\r\nimport { allMainStatKeys, MainStatKey } from \"../../Types/artifact\";\r\nimport { CharacterKey, ElementKey, Region } from \"../../Types/consts\";\r\nimport { layeredAssignment, objectKeyMap, objectMap } from \"../../Util/Util\";\r\nimport _charCurves from \"./expCurve_gen.json\";\r\n\r\n// TODO: Remove this conversion after changing the file format\r\nconst charCurves = objectMap(_charCurves, value => [0, ...Object.values(value)])\r\n\r\nconst commonBasic = objectKeyMap([\"hp\", \"atk\", \"def\", \"eleMas\", \"enerRech_\", \"critRate_\", \"critDMG_\", \"heal_\"], key => input.total[key])\r\n\r\nexport const infusionNode = stringPrio(\r\n  input.infusion.nonOverridableSelf,\r\n  input.infusion.team,\r\n  input.infusion.overridableSelf)\r\nconst inferredHitEle = stringPrio(\r\n  lookup(input.hit.move, {\r\n    \"skill\": input.charEle, \"burst\": input.charEle,\r\n  }, undefined),\r\n  lookup(input.weaponType, {\r\n    sword: infusionNode, claymore: infusionNode, polearm: infusionNode,\r\n    catalyst: input.charEle,\r\n  }, undefined),\r\n  \"physical\"\r\n)\r\n\r\nfunction getTalentType(move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\") {\r\n  switch (move) {\r\n    case \"normal\": case \"charged\": case \"plunging\": return \"auto\";\r\n    case \"skill\": return \"skill\";\r\n    case \"burst\": return \"burst\";\r\n  }\r\n}\r\n\r\n/** Note: `additional` applies only to this formula */\r\nexport function customDmgNode(base: NumNode, move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\" | \"elemental\", additional: Data = {}): NumNode {\r\n  return data(input.hit.dmg, mergeData([{\r\n    hit: { base, move: constant(move), ele: additional?.hit?.ele ? undefined : inferredHitEle },\r\n  }, additional]))\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function customShieldNode(base: NumNode, additional?: Data): NumNode {\r\n  const shieldNode = prod(base, sum(unit, input.total.shield_))\r\n  return additional ? data(shieldNode, additional) : shieldNode\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function customHealNode(base: NumNode, additional?: Data): NumNode {\r\n  const healNode = prod(base, sum(unit, input.total.heal_, input.total.incHeal_))\r\n  return additional ? data(healNode, additional) : healNode\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function dmgNode(base: MainStatKey | SubstatKey, lvlMultiplier: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional: Data = {}): NumNode {\r\n  const talentType = getTalentType(move)\r\n  return customDmgNode(prod(subscript(input.total[`${talentType}Index`], lvlMultiplier, { key: '_' }), input.total[base]), move, additional)\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function shieldNode(base: MainStatKey | SubstatKey, percent: NumNode | number, flat: NumNode | number, additional?: Data): NumNode {\r\n  return customShieldNode(sum(prod(percent, input.total[base]), flat), additional)\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function healNode(base: MainStatKey | SubstatKey, percent: NumNode | number, flat: NumNode | number, additional?: Data): NumNode {\r\n  return customHealNode(sum(prod(percent, input.total[base]), flat), additional)\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function shieldNodeTalent(base: MainStatKey | SubstatKey, baseMultiplier: number[], flat: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional?: Data): NumNode {\r\n  const talentType = getTalentType(move)\r\n  const talentIndex = input.total[`${talentType}Index`]\r\n  return customShieldNode(sum(\r\n    prod(subscript(talentIndex, baseMultiplier, { key: '_' }), input.total[base]),\r\n    subscript(talentIndex, flat)\r\n  ), additional)\r\n}\r\nexport function shieldElement(element: \"electro\" | \"cryo\" | \"hydro\" | \"pyro\" | \"geo\", shieldNode: NumNode) {\r\n  return infoMut(prod(percent(element === \"geo\" ? 1.5 : 2.5), shieldNode), { variant: element })\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function healNodeTalent(base: MainStatKey | SubstatKey, baseMultiplier: number[], flat: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional?: Data): NumNode {\r\n  const talentType = getTalentType(move)\r\n  const talentIndex = input.total[`${talentType}Index`]\r\n  return customHealNode(sum(\r\n    prod(subscript(talentIndex, baseMultiplier, { key: '_' }), input.total[base]),\r\n    subscript(talentIndex, flat)\r\n  ), additional)\r\n}\r\nexport function dataObjForCharacterSheet(\r\n  key: CharacterKey,\r\n  element: ElementKey | undefined,\r\n  region: Region | undefined,\r\n  gen: {\r\n    weaponTypeKey: string,\r\n    base: { hp: number, atk: number, def: number },\r\n    curves: { [key in string]?: string },\r\n    ascensions: { props: { [key in string]?: number } }[]\r\n  },\r\n  display: { [key: string]: DisplaySub },\r\n  additional: Data = {},\r\n): Data {\r\n  function curve(base: number, lvlCurve: string): NumNode {\r\n    return prod(base, subscript(input.lvl, charCurves[lvlCurve]))\r\n  }\r\n  display.basic = { ...commonBasic }\r\n  const data: Data = {\r\n    charKey: constant(key),\r\n    base: {},\r\n    weaponType: constant(gen.weaponTypeKey),\r\n    premod: {},\r\n    display,\r\n  }\r\n  if (element) {\r\n    data.charEle = constant(element)\r\n    data.teamBuff = { tally: { [element]: constant(1) } }\r\n    data.display!.basic[`${element}_dmg_`] = input.total[`${element}_dmg_`]\r\n    data.display!.reaction = reactions[element]\r\n  }\r\n  if (region)\r\n    layeredAssignment(data, [\"teamBuff\", \"tally\", region], constant(1))\r\n  if (gen.weaponTypeKey !== \"catalyst\") {\r\n    if (!data.display!.basic) data.display!.basic = {}\r\n    data.display!.basic!.physical_dmg_ = input.total.physical_dmg_\r\n  }\r\n\r\n  let foundSpecial: boolean | undefined\r\n  for (const stat of [...allMainStatKeys, \"def\" as const]) {\r\n    const list: NumNode[] = []\r\n    if (gen.curves[stat])\r\n      list.push(curve(gen.base[stat], gen.curves[stat]!))\r\n    const asc = gen.ascensions.some(x => x.props[stat])\r\n    if (asc)\r\n      list.push(subscript(input.asc, gen.ascensions.map(x => x.props[stat] ?? NaN)))\r\n\r\n    if (!list.length) continue\r\n\r\n    const result = infoMut(list.length === 1 ? list[0] : sum(...list), { key: stat, prefix: \"char\", asConst: true })\r\n    if (stat.endsWith(\"_dmg_\")) result.info!.variant = stat.slice(0, -5) as any\r\n    if (stat === \"atk\" || stat === \"def\" || stat === \"hp\")\r\n      data.base![stat] = result\r\n    else {\r\n      if (foundSpecial) throw new Error(\"Duplicated Char Special\")\r\n      foundSpecial = true\r\n      data.special = result\r\n      data.premod![stat] = input.special\r\n    }\r\n  }\r\n\r\n  return mergeData([data, inferInfoMut(additional)])\r\n}\r\n","import { transformativeReactions } from \"../KeyMap/StatConstants\";\r\nimport { absorbableEle } from \"../Types/consts\";\r\nimport { objectKeyMap } from \"../Util/Util\";\r\nimport { input } from \"./index\";\r\nimport { frac, infoMut, percent, prod, subscript, sum, unit } from \"./utils\";\r\n\r\n// https://github.com/Dimbreath/GenshinData/blob/72c9112a7c5e8e5014f61009a1a2764e266aeab7/ExcelBinOutput/ElementCoeffExcelConfigData.json\r\n//   or if the permalink is dead,\r\n// https://github.com/Dimbreath/GenshinData/blob/master/ExcelBinOutput/ElementCoeffExcelConfigData.json\r\n//\r\n// PlayerElementLevelCo\r\nexport const transformativeReactionLevelMultipliers = [-1.0, // lvl 0\r\n  17.165606, 18.535048, 19.904854, 21.274902, 22.6454, 24.649612, 26.640642, 28.868587, 31.36768, 34.143345, 37.201, 40.66, 44.446667, 48.56352, 53.74848, 59.081898, 64.420044, 69.72446, 75.12314, 80.58478, 86.11203, 91.70374, 97.24463, 102.812645, 108.40956, 113.20169, 118.102905, 122.97932, 129.72733, 136.29291, 142.67085, 149.02902, 155.41699, 161.8255, 169.10631, 176.51808, 184.07274, 191.70952, 199.55692, 207.38205, 215.3989, 224.16566, 233.50217, 243.35057, 256.06308, 268.5435, 281.52606, 295.01364, 309.0672, 323.6016, 336.75754, 350.5303, 364.4827, 378.61917, 398.6004, 416.39825, 434.387, 452.95105, 472.60623, 492.8849, 513.56854, 539.1032, 565.51056, 592.53876, 624.4434, 651.47015, 679.4968, 707.79407, 736.67145, 765.64026, 794.7734, 824.67737, 851.1578, 877.74207, 914.2291, 946.74677, 979.4114, 1011.223, 1044.7917, 1077.4437, 1109.9976, 1142.9766, 1176.3695, 1210.1844, 1253.8357, 1288.9528, 1325.4841, 1363.4569, 1405.0974, 1446.8535]\r\n// PlayerShieldLevelCo\r\nexport const crystallizeLevelMultipliers = [-1.0, // lvl 0\r\n  91.1791, 98.707664, 106.23622, 113.76477, 121.29332, 128.82188, 136.35042, 143.87898, 151.40752, 158.93608, 169.99149, 181.07625, 192.19037, 204.0482, 215.939, 227.86275, 247.68594, 267.5421, 287.4312, 303.82642, 320.22522, 336.62762, 352.31927, 368.01093, 383.70255, 394.43237, 405.18146, 415.94992, 426.73764, 437.5447, 450.6, 463.7003, 476.84558, 491.1275, 502.55457, 514.0121, 531.4096, 549.9796, 568.5849, 584.9965, 605.67035, 626.3862, 646.0523, 665.7556, 685.4961, 700.8394, 723.3331, 745.8653, 768.4357, 786.79193, 809.5388, 832.32904, 855.16266, 878.0396, 899.4848, 919.362, 946.0396, 974.7642, 1003.5786, 1030.077, 1056.635, 1085.2463, 1113.9244, 1149.2587, 1178.0648, 1200.2238, 1227.6603, 1257.243, 1284.9174, 1314.7529, 1342.6652, 1372.7524, 1396.321, 1427.3124, 1458.3745, 1482.3358, 1511.9109, 1541.5493, 1569.1537, 1596.8143, 1622.4197, 1648.074, 1666.3761, 1684.6782, 1702.9803, 1726.1047, 1754.6715, 1785.8666, 1817.1375, 1851.0603]\r\n\r\n\r\nconst asConst = true as const\r\n\r\nconst crystallizeMulti1 = subscript(input.lvl, crystallizeLevelMultipliers)\r\nconst crystallizeElemas = prod(40 / 9, frac(input.total.eleMas, 1400))\r\nconst crystallizeHit = infoMut(prod(sum(unit, /** + Crystallize bonus */ crystallizeElemas), crystallizeMulti1), { key: \"crystallize\", variant: \"geo\" })\r\n\r\nconst transMulti1 = subscript(input.lvl, transformativeReactionLevelMultipliers)\r\nconst transMulti2 = prod(16, frac(input.total.eleMas, 2000))\r\nconst trans = {\r\n  ...objectKeyMap([\"overloaded\", \"electrocharged\", \"superconduct\", \"shattered\"] as const, reaction => {\r\n    const { multi, variants: [ele] } = transformativeReactions[reaction]\r\n    return infoMut(prod(\r\n      infoMut(prod(multi, transMulti1), { asConst }),\r\n      sum(unit, transMulti2, input.total[`${reaction}_dmg_`]),\r\n      input.enemy[`${ele}_resMulti`]),\r\n      { key: `${reaction}_hit`, variant: reaction })\r\n  }),\r\n  swirl: objectKeyMap(transformativeReactions.swirl.variants, ele => infoMut(\r\n    prod(\r\n      infoMut(prod(transformativeReactions.swirl.multi, transMulti1), { asConst }),\r\n      sum(unit, transMulti2, input.total.swirl_dmg_),\r\n      input.enemy[`${ele}_resMulti`]),\r\n    { key: `${ele}_swirl_hit`, variant: ele }))\r\n}\r\nexport const reactions = {\r\n  anemo: {\r\n    electroSwirl: trans.swirl.electro,\r\n    pyroSwirl: trans.swirl.pyro,\r\n    cryoSwirl: trans.swirl.cryo,\r\n    hydroSwirl: trans.swirl.hydro,\r\n    shattered: trans.shattered,\r\n  },\r\n  geo: {\r\n    crystallize: crystallizeHit,\r\n    ...Object.fromEntries(absorbableEle.map(e => [`${e}Crystallize`,\r\n    infoMut(prod(percent(2.5), crystallizeHit), { key: `${e}_crystallize`, variant: e })])),\r\n    shattered: trans.shattered,\r\n  },\r\n  electro: {\r\n    overloaded: trans.overloaded,\r\n    electrocharged: trans.electrocharged,\r\n    superconduct: trans.superconduct,\r\n    shattered: trans.shattered,\r\n  },\r\n  hydro: {\r\n    electrocharged: trans.electrocharged,\r\n    shattered: trans.shattered,\r\n  },\r\n  pyro: {\r\n    overloaded: trans.overloaded,\r\n    shattered: trans.shattered,\r\n  },\r\n  cryo: {\r\n    superconduct: trans.superconduct,\r\n    shattered: trans.shattered,\r\n  },\r\n}\r\n","import { Replay } from \"@mui/icons-material\"\r\nimport { Button, ButtonGroup, ButtonGroupProps, styled } from \"@mui/material\"\r\nimport { ReactNode } from \"react\"\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"./CustomNumberInput\"\r\nimport TextButton from \"./TextButton\"\r\n\r\ntype StatInputInput = ButtonGroupProps & {\r\n  name: Displayable,\r\n  children?: ReactNode,\r\n  value: number,\r\n  placeholder?: string,\r\n  defaultValue?: number,\r\n  onValueChange: (newValue: number | undefined) => void,\r\n  percent?: boolean,\r\n  disabled?: boolean,\r\n  onReset?: () => void\r\n}\r\nconst FlexButtonGroup = styled(ButtonGroup)({\r\n  display: \"flex\"\r\n})\r\n\r\nexport default function StatInput({ name, children, value, placeholder, defaultValue = 0, onValueChange, percent = false, disabled = false, onReset, ...restProps }: StatInputInput) {\r\n\r\n  return <FlexButtonGroup {...restProps} >\r\n    {children}\r\n    <TextButton sx={{ whiteSpace: \"nowrap\" }} >\r\n      {name}\r\n    </TextButton>\r\n    <CustomNumberInputButtonGroupWrapper sx={{ flexBasis: 30, flexGrow: 1 }} >\r\n      <CustomNumberInput\r\n        sx={{ px: 1 }}\r\n        inputProps={{\r\n          sx: { textAlign: \"right\" }\r\n        }}\r\n        float={percent}\r\n        placeholder={placeholder}\r\n        value={value}\r\n        onChange={onValueChange}\r\n        disabled={disabled}\r\n        endAdornment={percent ? \"%\" : undefined}\r\n      />\r\n    </CustomNumberInputButtonGroupWrapper>\r\n    <Button onClick={() => onReset ? onReset() : onValueChange(defaultValue)} disabled={disabled || value === defaultValue} >\r\n      <Replay />\r\n    </Button>\r\n  </FlexButtonGroup>\r\n}\r\n","import { faCheckSquare, faSquare } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { ExpandMore } from \"@mui/icons-material\";\r\nimport { Button, CardContent, Chip, Collapse, Grid, Typography } from \"@mui/material\";\r\nimport { useCallback, useContext, useState } from 'react';\r\nimport StatInput from \"./StatInput\";\r\nimport { DataContext } from \"../DataContext\";\r\nimport { uiInput as input } from \"../Formula\";\r\nimport KeyMap, { valueString } from '../KeyMap';\r\nimport { allElementsWithPhy, ElementKeyWithPhy } from \"../Types/consts\";\r\nimport CardLight from \"./Card/CardLight\";\r\nimport ColorText from \"./ColoredText\";\r\nimport ExpandButton from \"./ExpandButton\";\r\nimport { uncoloredEleIcons } from \"./StatIcon\";\r\n\r\nexport function EnemyExpandCard() {\r\n  const { data } = useContext(DataContext)\r\n  const [expanded, setexpanded] = useState(false)\r\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\r\n  const eLvlNode = data.get(input.enemy.level)\r\n  const eDefRed = data.get(input.enemy.defRed)\r\n  const eDefIgn = data.get(input.enemy.defIgn)\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container>\r\n        <Grid item flexGrow={1} alignItems=\"center\">\r\n          <Grid container spacing={1}>\r\n            <Grid item>\r\n              <Chip size=\"small\" color=\"success\" label={<span>{KeyMap.get(eLvlNode.info.key)} <strong>{eLvlNode.value}</strong></span>} />\r\n            </Grid>\r\n            {allElementsWithPhy.map(element => <Grid item key={element}>\r\n              <Typography key={element} ><EnemyResText element={element} /></Typography>\r\n            </Grid>)}\r\n            <Grid item>\r\n              <Typography>DEF Reduction {valueString(eDefRed.value, eDefRed.unit)}</Typography>\r\n            </Grid>\r\n            <Grid item>\r\n              <Typography>DEF Ignore {valueString(eDefIgn.value, eDefIgn.unit)}</Typography>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid item>\r\n          <ExpandButton\r\n            expand={expanded}\r\n            onClick={toggle}\r\n            aria-expanded={expanded}\r\n            aria-label=\"show more\"\r\n            size=\"small\"\r\n            sx={{ p: 0 }}\r\n          >\r\n            <ExpandMore />\r\n          </ExpandButton>\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <EnemyEditor />\r\n      </CardContent>\r\n    </Collapse>\r\n  </CardLight>\r\n}\r\n\r\nexport function EnemyResText({ element }: { element: ElementKeyWithPhy }) {\r\n  const { data } = useContext(DataContext)\r\n  const node = data.get(input.enemy[`${element}_res_`])\r\n  const immune = !isFinite(node.value)\r\n  const content = immune ? <span >{uncoloredEleIcons[element]} IMMUNE</span> :\r\n    <span >{uncoloredEleIcons[element]}RES <strong>{valueString(node.value, node.unit)}</strong></span>\r\n  return <ColorText color={element}>{content}</ColorText>\r\n}\r\n\r\nexport function EnemyEditor({ bsProps = { xs: 12, md: 6 } }: { bsProps?: object }) {\r\n  const { data, character: { enemyOverride }, characterDispatch } = useContext(DataContext)\r\n  const defaultVal = 10\r\n\r\n  const eLvl = enemyOverride.enemyLevel ?? data.get(input.lvl).value\r\n  const eDefRed = enemyOverride.enemyDefIgn_ ?? 0\r\n  const eDefIgn = enemyOverride.enemyDefRed_ ?? 0\r\n  return <Grid container spacing={1}>\r\n    <Grid item {...bsProps}>\r\n      <Button fullWidth sx={{ height: \"100%\" }} size=\"small\" component=\"a\" color=\"warning\" href=\"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances\" target=\"_blank\" rel=\"noreferrer\">\r\n        To get the specific resistance values of enemies, please visit the wiki.\r\n      </Button>\r\n    </Grid>\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyLevel\")}</b>}\r\n        value={eLvl}\r\n        placeholder={KeyMap.getStr(\"enemyLevel\")}\r\n        defaultValue={data.get(input.lvl).value}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value })}\r\n        onReset={() => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value: undefined })}\r\n      />\r\n    </Grid>\r\n    {allElementsWithPhy.map(eleKey => {\r\n      const statKey = `${eleKey}_enemyRes_`\r\n      const val = enemyOverride[statKey]\r\n      const elementImmunity = val === Number.MAX_VALUE\r\n      return <Grid item key={eleKey} {...bsProps}>\r\n        <StatInput\r\n          sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n          name={<ColorText color={eleKey}><b>{KeyMap.get(statKey)}</b></ColorText>}\r\n          value={val ? (elementImmunity ? Infinity : val) : 10}\r\n          placeholder={elementImmunity ? \"Immune \" : KeyMap.getStr(statKey)}\r\n          defaultValue={defaultVal}\r\n          onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey, value })}\r\n          disabled={elementImmunity}\r\n          percent\r\n        >\r\n          <Button color={eleKey} onClick={() => characterDispatch({ type: \"enemyOverride\", statKey, value: elementImmunity ? defaultVal : Number.MAX_VALUE })} >\r\n            <FontAwesomeIcon icon={elementImmunity ? faCheckSquare : faSquare} className=\"fa-fw\" /> Immunity\r\n          </Button>\r\n        </StatInput>\r\n      </Grid>\r\n    })}\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyDefIgn_\")}</b>}\r\n        value={eDefRed}\r\n        placeholder={KeyMap.getStr(\"enemyDefIgn_\")}\r\n        defaultValue={0}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefIgn_\", value })}\r\n        percent\r\n      />\r\n    </Grid>\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyDefRed_\")}</b>}\r\n        value={eDefIgn}\r\n        placeholder={KeyMap.getStr(\"enemyDefRed_\")}\r\n        defaultValue={0}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefRed_\", value })}\r\n        percent\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12}>\r\n      <small>Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and GO will do the rest. (e.g. 10% - 20% = -10%)</small>\r\n    </Grid>\r\n  </Grid>\r\n}\r\n","import { Box, MenuItem, ToggleButton, ToggleButtonGroupProps } from \"@mui/material\";\r\nimport { useContext } from 'react';\r\nimport { infusionNode } from \"../Data/Characters/dataUtil\";\r\nimport { DataContext } from \"../DataContext\";\r\nimport { uiInput as input } from \"../Formula\";\r\nimport { ElementKey } from \"../Types/consts\";\r\nimport ColorText from \"./ColoredText\";\r\nimport DropdownButton, { DropdownButtonProps } from \"./DropdownMenu/DropdownButton\";\r\nimport SolidToggleButtonGroup from \"./SolidToggleButtonGroup\";\r\nimport SqBadge from \"./SqBadge\";\r\nimport { uncoloredEleIcons } from \"./StatIcon\";\r\nconst infusionVals = {\r\n  \"\": <span>No Team Melee Infusion</span>,\r\n  \"pyro\": <span >{uncoloredEleIcons.pyro} <SqBadge>Bennett C6</SqBadge> Fire Ventures with Me</span>,\r\n  \"cryo\": <span >{uncoloredEleIcons.cryo} <SqBadge>Chongyun Skill</SqBadge> Spirit Blade: Chonghua's Layered Frost</span>,\r\n}\r\ntype InfusionAuraDropdownProps = Omit<DropdownButtonProps, \"title\" | \"onChange\" | \"children\">\r\nexport function InfusionAuraDropdown(props: InfusionAuraDropdownProps) {\r\n  const { characterSheet, character: { infusionAura }, characterDispatch } = useContext(DataContext)\r\n  if (!characterSheet?.isMelee()) return null\r\n  return <DropdownButton title={infusionVals[infusionAura]} color={infusionAura || \"secondary\"} disableElevation {...props}>\r\n    {Object.entries(infusionVals).map(([key, text]) =>\r\n      <MenuItem key={key} sx={key ? { color: `${key}.main` } : undefined}\r\n        selected={key === infusionAura} disabled={key === infusionAura}\r\n        onClick={() => characterDispatch({ infusionAura: key })}>{text}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n\r\ntype ReactionToggleProps = Omit<ToggleButtonGroupProps, \"color\">\r\nconst sqBadgeStyle = { mx: 0.25, px: 0.25, fontSize: \"1em\" }\r\nexport function ReactionToggle(props: ReactionToggleProps) {\r\n  const { data, character: { reactionMode }, characterDispatch } = useContext(DataContext)\r\n  const charEleKey = data.get(input.charEle).value as ElementKey\r\n  const infusion = data.get(infusionNode).value as ElementKey\r\n  if (![\"pyro\", \"hydro\", \"cryo\"].includes(charEleKey) && ![\"pyro\", \"hydro\", \"cryo\"].includes(infusion)) return null\r\n  return <SolidToggleButtonGroup exclusive baseColor=\"secondary\"\r\n    value={reactionMode} onChange={(_, reactionMode) => characterDispatch({ reactionMode })} {...props}>\r\n    <ToggleButton value=\"\" disabled={reactionMode === \"\"} >No Reactions</ToggleButton >\r\n    {(charEleKey === \"pyro\" || infusion === \"pyro\") && <ToggleButton value=\"pyro_vaporize\" disabled={reactionMode === \"pyro_vaporize\"}>\r\n      <ColorText color=\"vaporize\">\r\n        Vaporize(Pyro)\r\n      </ColorText>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <SqBadge sx={sqBadgeStyle} color=\"hydro\">{uncoloredEleIcons.hydro}</SqBadge>\r\n        +\r\n        <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\r\n      </Box>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"pyro\" || infusion === \"pyro\") && <ToggleButton value={\"pyro_melt\"} disabled={reactionMode === \"pyro_melt\"}>\r\n      <ColorText color=\"melt\">\r\n        Melt(Pyro)\r\n      </ColorText>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <SqBadge sx={sqBadgeStyle} color=\"cryo\">{uncoloredEleIcons.cryo}</SqBadge>\r\n        +\r\n        <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\r\n      </Box>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"hydro\" || infusion === \"hydro\") && <ToggleButton value={\"hydro_vaporize\"} disabled={reactionMode === \"hydro_vaporize\"}>\r\n      <ColorText color=\"vaporize\">\r\n        Vaporize(Hydro)\r\n      </ColorText>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\r\n        +\r\n        <SqBadge sx={sqBadgeStyle} color=\"hydro\">{uncoloredEleIcons.hydro}</SqBadge>\r\n      </Box>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"cryo\" || infusion === \"cryo\") && <ToggleButton value={\"cryo_melt\"} disabled={reactionMode === \"cryo_melt\"}>\r\n      <ColorText color=\"melt\">\r\n        Melt(Cryo)\r\n      </ColorText>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\r\n        +\r\n        <SqBadge sx={sqBadgeStyle} color=\"cryo\">{uncoloredEleIcons.cryo}</SqBadge>\r\n      </Box>\r\n    </ToggleButton >}\r\n  </SolidToggleButtonGroup>\r\n}\r\ntype HitModeToggleProps = Omit<ToggleButtonGroupProps, \"color\">\r\nexport function HitModeToggle(props: HitModeToggleProps) {\r\n  const { character: { hitMode }, characterDispatch } = useContext(DataContext)\r\n  return <SolidToggleButtonGroup exclusive baseColor=\"secondary\"\r\n    value={hitMode} onChange={(_, hitMode) => characterDispatch({ hitMode })} {...props} >\r\n    <ToggleButton value=\"avgHit\" disabled={hitMode === \"avgHit\"}>Avg. DMG</ToggleButton>\r\n    <ToggleButton value=\"hit\" disabled={hitMode === \"hit\"}>Non Crit DMG</ToggleButton>\r\n    <ToggleButton value=\"critHit\" disabled={hitMode === \"critHit\"}>Crit Hit DMG</ToggleButton>\r\n  </SolidToggleButtonGroup>\r\n}\r\n","import { Typography } from \"@mui/material\";\r\nimport { input } from \".\";\r\nimport { ArtifactSheet } from \"../Data/Artifacts/ArtifactSheet\";\r\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\";\r\nimport ColorText from \"../Components/ColoredText\";\r\nimport SqBadge from \"../Components/SqBadge\";\r\nimport { ArtifactSetKey, CharacterKey, ElementKey, WeaponKey } from \"../Types/consts\";\r\nimport { range } from \"../Util/Util\";\r\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\";\r\nimport { DisplaySub } from \"./type\";\r\nimport { NodeDisplay, UIData } from \"./uiData\";\r\n\r\nconst errHeader = {\r\n  title: <ColorText color=\"warning\">ERROR</ColorText>\r\n}\r\n\r\nconst talentMap = {\r\n  normal: \"Normal Atk.\",\r\n  charged: \"Charged Atk.\",\r\n  plunging: \"Plunging Atk.\",\r\n  skill: \"Ele. Skill\",\r\n  burst: \"Ele. Burst\",\r\n  passive: \"Passive\",\r\n  passive1: \"1st Asc. Pass.\",\r\n  passive2: \"4th Asc. Pass.\",\r\n  passive3: \"Util. Pass.\",\r\n  ...Object.fromEntries(range(1, 6).map(i => [`constellation${i}`, `Const. ${i}`]))\r\n}\r\nexport async function getDisplayHeader(data: UIData, sectionKey: string): Promise<{\r\n  title: Displayable,\r\n  icon?: string,\r\n  action?: Displayable\r\n}> {\r\n  if (!sectionKey) return errHeader\r\n  if (sectionKey === \"basic\") return { title: \"Basic Stats\" }\r\n  else if (sectionKey === \"reaction\") return { title: \"Transformative Reactions\" }\r\n  else if (sectionKey.includes(\":\")) {\r\n    const [namespace, key] = sectionKey.split(\":\")\r\n    if (namespace === \"artifact\") {\r\n      const sheet = await ArtifactSheet.get(key as ArtifactSetKey)\r\n      if (!sheet) return errHeader\r\n      return {\r\n        title: sheet.name,\r\n        icon: sheet.defIconSrc\r\n      }\r\n    } else if (namespace === \"weapon\") {\r\n      const sheet = await WeaponSheet.get(key as WeaponKey)\r\n      if (!sheet) return errHeader\r\n      const asc = data.get(input.weapon.asc).value\r\n      return {\r\n        title: sheet.name,\r\n        icon: asc < 2 ? sheet.img : sheet.imgAwaken\r\n      }\r\n    }\r\n  } else {\r\n    const cKey = data.get(input.charKey).value\r\n    const cEle = data.get(input.charEle).value\r\n    if (!cKey || !cEle) return errHeader\r\n    const sheet = await CharacterSheet.get(cKey as CharacterKey)\r\n    const talentKey = [\"normal\", \"charged\", \"plunging\"].includes(sectionKey) ? \"auto\" : sectionKey\r\n    const talent = sheet?.getTalentOfKey(talentKey as any, cEle as ElementKey)\r\n    if (!talent) return errHeader\r\n    const actionText = talentMap[sectionKey]\r\n    return {\r\n      icon: talent.img,\r\n      title: talent.name,\r\n      action: actionText ? <SqBadge ><Typography variant=\"subtitle2\">{actionText}</Typography></SqBadge> : undefined\r\n    }\r\n  }\r\n  return errHeader\r\n}\r\n/**\r\n * Use this function to reorganize the sections to have basic stats at the beginning, and reation at the end.\r\n * @param data\r\n * @returns\r\n */\r\nexport function getDisplaySections(data: UIData,): [string, DisplaySub<NodeDisplay>][] {\r\n  const display = data.getDisplay()\r\n  const sections = Object.entries(display).filter(([key, nodes]) => !Object.values(nodes).every(x => x.isEmpty))\r\n  const basic = sections.filter(([k]) => k === \"basic\")\r\n  const reaction = sections.filter(([k]) => k === \"reaction\")\r\n  const weapon = sections.filter(([k]) => k.startsWith(\"weapon\"))\r\n  const artifact = sections.filter(([k]) => k.startsWith(\"artifact\"))\r\n  const rest = sections.filter(([k]) => k !== \"basic\" && k !== \"reaction\" && !k.startsWith(\"weapon\") && !k.startsWith(\"artifact\"))\r\n\r\n  return [\r\n    ...basic,\r\n    ...rest,\r\n    ...weapon,\r\n    ...artifact,\r\n    ...reaction\r\n  ]\r\n}\r\n","import { Box } from \"@mui/material\"\r\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { ArtifactSetKey, SetNum } from \"../../Types/consts\"\r\nimport DocumentDisplay from \"../DocumentDisplay\"\r\n\r\ntype Data = {\r\n  setKey: ArtifactSetKey,\r\n  setNumKey: SetNum,\r\n  hideHeader?: boolean,\r\n  conditionalsOnly?: boolean\r\n}\r\n\r\nexport default function SetEffectDisplay({ setKey, setNumKey, hideHeader = false, conditionalsOnly = false }: Data) {\r\n  const sheet = usePromise(ArtifactSheet.get(setKey), [setKey])\r\n  if (!sheet) return null\r\n\r\n  const document = conditionalsOnly ? sheet.setEffectDocument(setNumKey)?.filter(section => \"states\" in section) : sheet.setEffectDocument(setNumKey)\r\n  return <Box display=\"flex\" flexDirection=\"column\">\r\n    {document ? <DocumentDisplay sections={document} hideHeader={hideHeader} /> : null}\r\n  </Box>\r\n}\r\n","import { Masonry } from \"@mui/lab\"\r\nimport { CardContent, CardHeader, Divider } from \"@mui/material\"\r\nimport { Box } from \"@mui/system\"\r\nimport { useContext, useMemo } from \"react\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport { NodeFieldDisplay } from \"../FieldDisplay\"\r\nimport ImgIcon from \"../Image/ImgIcon\"\r\nimport { DataContext } from \"../../DataContext\"\r\nimport { getDisplayHeader, getDisplaySections } from \"../../Formula/DisplayUtil\"\r\nimport { DisplaySub } from \"../../Formula/type\"\r\nimport { NodeDisplay } from \"../../Formula/uiData\"\r\nimport { customRead } from \"../../Formula/utils\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { objectMap } from \"../../Util/Util\"\r\n\r\nexport default function StatDisplayComponent() {\r\n  const { data } = useContext(DataContext)\r\n  const sections = getDisplaySections(data)\r\n  return <Box sx={{ mr: -1, mb: -1 }}>\r\n    <Masonry columns={{ xs: 1, sm: 2, md: 3, xl: 4 }} spacing={1}>\r\n      {sections.map(([key, Nodes]) =>\r\n        <Section key={key} displayNs={Nodes} sectionKey={key} />)}\r\n    </Masonry >\r\n  </Box>\r\n}\r\n\r\nfunction Section({ displayNs, sectionKey }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\r\n  const { data, oldData } = useContext(DataContext)\r\n  const header = usePromise(getDisplayHeader(data, sectionKey), [data, sectionKey])\r\n  const displayNsReads = useMemo(() => objectMap(displayNs, (n, nodeKey) => customRead([\"display\", sectionKey, nodeKey])), [displayNs, sectionKey]);\r\n  if (!header) return <CardDark></CardDark>\r\n\r\n  const { title, icon, action } = header\r\n  return <CardDark >\r\n    <CardHeader avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action} titleTypographyProps={{ variant: \"subtitle1\" }} />\r\n    <Divider />\r\n    <CardContent>\r\n      {Object.entries(displayNs).map(([nodeKey, n]) => <NodeFieldDisplay key={nodeKey} node={n} oldValue={oldData ? oldData.get(displayNsReads[nodeKey]!).value : undefined} />)}\r\n    </CardContent>\r\n  </CardDark>\r\n}\r\n","import { useCallback, useState } from \"react\"\r\n\r\nexport default function useBoolState(initial: boolean = false) {\r\n  const [bool, setBool] = useState(initial)\r\n  const onTrue = useCallback(() => setBool(true), [setBool],)\r\n  const onFalse = useCallback(() => setBool(false), [setBool],)\r\n  return [bool, onTrue, onFalse] as [boolean, () => void, () => void]\r\n}\r\n","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { alpha, Box, CardActionArea, Chip, Typography, useTheme } from \"@mui/material\";\r\nimport { useCallback } from \"react\";\r\nimport Assets from \"../../Assets/Assets\";\r\nimport Artifact from \"../../Data/Artifacts/Artifact\";\r\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\";\r\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\r\nimport KeyMap, { cacheValueString } from \"../../KeyMap\";\r\nimport useArtifact from \"../../ReactHooks/useArtifact\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport { ICachedSubstat } from \"../../Types/artifact\";\r\nimport { allElementsWithPhy, SlotKey } from \"../../Types/consts\";\r\nimport { clamp } from \"../../Util/Util\";\r\nimport BootstrapTooltip from \"../BootstrapTooltip\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport ColorText from \"../ColoredText\";\r\nimport ConditionalWrapper from \"../ConditionalWrapper\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport StatIcon, { uncoloredEleIcons } from \"../StatIcon\";\r\nimport ArtifactSetSlotTooltip from \"./ArtifactSetSlotTooltip\";\r\n\r\ntype Data = {\r\n  artifactId?: string,\r\n  slotKey: SlotKey,\r\n  mainStatAssumptionLevel?: number,\r\n  onClick?: () => void,\r\n  showLocation?: boolean,\r\n  BGComponent?: React.ElementType\r\n}\r\n\r\nexport default function ArtifactCardNano({ artifactId, slotKey: pSlotKey, mainStatAssumptionLevel = 0, showLocation = false, onClick, BGComponent = CardDark }: Data) {\r\n  const art = useArtifact(artifactId)\r\n  const sheet = usePromise(ArtifactSheet.get(art?.setKey), [art])\r\n  const actionWrapperFunc = useCallback(children => <CardActionArea onClick={onClick} sx={{ height: \"100%\" }}>{children}</CardActionArea>, [onClick],)\r\n  const theme = useTheme()\r\n  if (!art) return <BGComponent sx={{ display: \"flex\", height: \"100%\", alignItems: \"center\", justifyContent: \"center\" }}>\r\n    <Box component=\"img\" src={Assets.slot[pSlotKey]} sx={{ width: \"25%\", height: \"auto\", opacity: 0.7 }} />\r\n  </BGComponent>\r\n\r\n  const { slotKey, rarity, level, mainStatKey, substats, location } = art\r\n  const mainStatLevel = Math.max(Math.min(mainStatAssumptionLevel, rarity * 4), level)\r\n  const mainStatUnit = KeyMap.unit(mainStatKey)\r\n  const levelVariant = \"roll\" + (Math.floor(Math.max(level, 0) / 4) + 1)\r\n  const element = allElementsWithPhy.find(ele => art.mainStatKey.includes(ele))\r\n  const color = element ? alpha(theme.palette[element].main, 0.6) : alpha(theme.palette.secondary.main, 0.6)\r\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\r\n    <Box display=\"flex\" height=\"100%\">\r\n      <Box className={`grad-${rarity}star`} sx={{ position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"center\" }} >\r\n        <ArtifactSetSlotTooltip slotKey={slotKey} sheet={sheet}>\r\n          <Box\r\n            component=\"img\"\r\n            src={sheet?.slotIcons[slotKey] ?? \"\"}\r\n            sx={{ m: -1, maxHeight: \"110%\", maxWidth: \"110%\" }}\r\n          />\r\n        </ArtifactSetSlotTooltip>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\r\n          <Chip size=\"small\" label={<strong>{` +${level}`}</strong>} color={levelVariant as any} />\r\n          {showLocation && <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\r\n            overflow: \"visible\", \".MuiChip-label\": {\r\n              overflow: \"visible\"\r\n            }\r\n          }} />}\r\n        </Box>\r\n        {/* mainstats */}\r\n        <Chip size=\"small\" sx={{ position: \"absolute\", bottom: 0, mb: 1, backgroundColor: color }}\r\n          label={<Typography variant=\"h6\" sx={{ display: \"flex\", gap: 1, px: 1, zIndex: 1 }}>\r\n            <BootstrapTooltip placement=\"top\" title={<Typography>{KeyMap.getArtStr(mainStatKey)}</Typography>} disableInteractive>\r\n              <span>{element ? uncoloredEleIcons[element] : StatIcon[mainStatKey]}</span>\r\n            </BootstrapTooltip>\r\n            <ColorText color={mainStatLevel !== level ? \"warning\" : undefined}>{cacheValueString(Artifact.mainStatValue(mainStatKey, rarity, mainStatLevel) ?? 0, KeyMap.unit(mainStatKey))}{mainStatUnit}</ColorText>\r\n          </Typography>} />\r\n      </Box>\r\n      {/* substats */}\r\n      <Box display=\"flex\" flexDirection=\"column\" justifyContent=\"space-between\" sx={{ p: 1, }}>\r\n        {substats.map((stat: ICachedSubstat, i: number) => <SubstatDisplay key={i + stat.key} stat={stat} />)}\r\n      </Box>\r\n    </Box>\r\n  </ConditionalWrapper></BGComponent >\r\n}\r\nfunction SubstatDisplay({ stat }: { stat: ICachedSubstat }) {\r\n  if (!stat.value) return null\r\n  const numRolls = stat.rolls?.length ?? 0\r\n  const rollColor = `roll${clamp(numRolls, 1, 6)}`\r\n  const unit = KeyMap.unit(stat.key)\r\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\r\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} color={(numRolls ? `${rollColor}.main` : \"error.main\") as any} component=\"span\">\r\n      <BootstrapTooltip placement=\"top\" title={<Typography>{stat.key && KeyMap.getArtStr(stat.key)}</Typography>} disableInteractive>\r\n        <span>{StatIcon[stat.key]}</span>\r\n      </BootstrapTooltip>\r\n      <span>{`${cacheValueString(stat.value, KeyMap.unit(stat.key))}${unit}`}</span>\r\n    </Typography>\r\n  </Box>)\r\n}\r\nfunction LocationIcon({ location }) {\r\n  const characterSheet = usePromise(CharacterSheet.get(location ?? \"\"), [location])\r\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\r\n}\r\n","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { Box, CardActionArea, Chip, Skeleton, Typography } from \"@mui/material\";\r\nimport { useCallback, useMemo } from \"react\";\r\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\r\nimport WeaponSheet from \"../../Data/Weapons/WeaponSheet\";\r\nimport { input } from \"../../Formula\";\r\nimport { computeUIData, dataObjForWeapon } from \"../../Formula/api\";\r\nimport { NodeDisplay } from '../../Formula/uiData';\r\nimport KeyMap, { valueString } from \"../../KeyMap\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport useWeapon from \"../../ReactHooks/useWeapon\";\r\nimport { MainStatKey, SubstatKey } from \"../../Types/artifact\";\r\nimport BootstrapTooltip from \"../BootstrapTooltip\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport ConditionalWrapper from \"../ConditionalWrapper\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport StatIcon from \"../StatIcon\";\r\nimport WeaponNameTooltip from \"./WeaponNameTooltip\";\r\n\r\ntype Data = {\r\n  weaponId?: string,\r\n  onClick?: () => void,\r\n  showLocation?: boolean,\r\n  BGComponent?: React.ElementType,\r\n}\r\n\r\nexport default function WeaponCardNano({ weaponId, showLocation = false, onClick, BGComponent = CardDark, }: Data) {\r\n  const weapon = useWeapon(weaponId)\r\n  const weaponSheet = usePromise(weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\r\n  const actionWrapperFunc = useCallback(children => <CardActionArea sx={{ height: \"100%\" }} onClick={onClick}>{children}</CardActionArea>, [onClick],)\r\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\r\n  if (!weapon || !weaponSheet || !UIData) return <BGComponent sx={{ height: \"100%\" }}><Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\" }} /></BGComponent>;\r\n  const { refinement, location } = weapon\r\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\r\n    <Box display=\"flex\" height=\"100%\" alignItems=\"stretch\" >\r\n      <Box className={`grad-${weaponSheet.rarity}star`} sx={{ height: \"100%\", position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"flex-end\" }} >\r\n        <WeaponNameTooltip sheet={weaponSheet}>\r\n          <Box\r\n            component=\"img\"\r\n            src={weaponSheet.img}\r\n            sx={{ mx: -1, maxHeight: \"100%\", maxWidth: \"100%\" }}\r\n          />\r\n        </WeaponNameTooltip>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\r\n          <Chip size=\"small\" label={<strong>{WeaponSheet.getLevelString(weapon)}</strong>} color=\"primary\" />\r\n          {showLocation && <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\r\n            overflow: \"visible\", \".MuiChip-label\": {\r\n              overflow: \"visible\"\r\n            }\r\n          }} />}\r\n        </Box>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"flex-end\", alignItems: \"flex-end\" }} >\r\n          {weaponSheet.hasRefinement && <Chip size=\"small\" color=\"info\" label={<strong>R{refinement}</strong>} />}\r\n        </Box>\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"column\" sx={{ p: 1, }}>\r\n        <WeaponStat node={UIData.get(input.weapon.main)} />\r\n        <WeaponStat node={UIData.get(input.weapon.sub)} />\r\n      </Box>\r\n    </Box>\r\n  </ConditionalWrapper></BGComponent >\r\n}\r\nfunction WeaponStat({ node }: { node: NodeDisplay }) {\r\n  if (!node.info.key) return null\r\n  const val = valueString(node.value, node.unit, !node.unit ? 0 : undefined)\r\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\r\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} component=\"span\">\r\n      <BootstrapTooltip placement=\"top\" title={<Typography>{node.info.key && KeyMap.getArtStr(node.info.key as MainStatKey | SubstatKey)}</Typography>} disableInteractive>\r\n        <span>{StatIcon[node.info.key]}</span>\r\n      </BootstrapTooltip>\r\n      <span>{val}</span>\r\n    </Typography>\r\n  </Box>)\r\n}\r\nfunction LocationIcon({ location }) {\r\n  const characterSheet = usePromise(CharacterSheet.get(location ?? \"\"), [location])\r\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\r\n}\r\n","import { ChevronRight } from '@mui/icons-material';\r\nimport { Button, CardContent, Grid, Skeleton, Typography } from '@mui/material';\r\nimport { Box } from '@mui/system';\r\nimport React, { Suspense, useCallback, useContext, useState } from 'react';\r\nimport ArtifactCardNano from '../../../../../Components/Artifact/ArtifactCardNano';\r\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport StatDisplayComponent from '../../../../../Components/Character/StatDisplayComponent';\r\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport WeaponCardNano from '../../../../../Components/Weapon/WeaponCardNano';\r\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../../../../Database/Database';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport { uiInput as input } from '../../../../../Formula';\r\nimport ArtifactCard from '../../../../../PageArtifact/ArtifactCard';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from '../../../../../Types/consts';\r\n\r\ntype NewOld = {\r\n  newId: string,\r\n  oldId?: string\r\n}\r\n\r\ntype BuildDisplayItemProps = {\r\n  index?: number,\r\n  compareBuild: boolean,\r\n  disabled?: boolean,\r\n  extraButtons?: JSX.Element\r\n}\r\n//for displaying each artifact build\r\nexport default function BuildDisplayItem({ index, compareBuild, extraButtons, disabled }: BuildDisplayItemProps) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const dataContext = useContext(DataContext)\r\n\r\n  const { character, data, oldData, mainStatAssumptionLevel } = dataContext\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const [newOld, setNewOld] = useState(undefined as NewOld | undefined)\r\n  const close = useCallback(() => setNewOld(undefined), [setNewOld],)\r\n\r\n  const equipBuild = useCallback(() => {\r\n    if (!window.confirm(\"Do you want to equip this build to this character?\")) return\r\n    const newBuild = Object.fromEntries(allSlotKeys.map(s => [s, data.get(input.art[s].id).value])) as Record<SlotKey, string>\r\n    database.equipArtifacts(character.key, newBuild)\r\n    database.setWeaponLocation(data.get(input.weapon.id).value!, character.key)\r\n  }, [character, data, database])\r\n  if (!character || !artifactSheets || !oldData) return null\r\n  const currentlyEquipped = allSlotKeys.every(slotKey => data.get(input.art[slotKey].id).value === oldData.get(input.art[slotKey].id).value) && data.get(input.weapon.id).value === oldData.get(input.weapon.id).value\r\n  const statProviderContext = { ...dataContext }\r\n  if (!compareBuild) statProviderContext.oldData = undefined\r\n  const setToSlots: Partial<Record<ArtifactSetKey, SlotKey[]>> = {}\r\n  allSlotKeys.forEach(slotKey => {\r\n    const set = data.get(input.art[slotKey].set).value as ArtifactSetKey | undefined\r\n    if (!set) return\r\n    if (setToSlots[set]) setToSlots[set]!.push(slotKey)\r\n    else setToSlots[set] = [slotKey]\r\n  })\r\n\r\n  return <CardLight>\r\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n      {newOld && <CompareArtifactModal newOld={newOld} mainStatAssumptionLevel={mainStatAssumptionLevel} onClose={close} />}\r\n      <CardContent>\r\n        <Box display=\"flex\" gap={1} sx={{ pb: 1 }} flexWrap=\"wrap\">\r\n          {index !== undefined && <SqBadge color=\"info\"><Typography><strong>#{index + 1}{currentlyEquipped ? \" (Equipped)\" : \"\"}</strong></Typography></SqBadge>}\r\n          {(Object.entries(setToSlots) as [ArtifactSetKey, SlotKey[]][]).sort(([k1, slotarr1], [k2, slotarr2]) => slotarr2.length - slotarr1.length).map(([key, slotarr]) =>\r\n            <Box key={key}><SqBadge color={currentlyEquipped ? \"success\" : \"primary\"} ><Typography >\r\n              {slotarr.map(slotKey => artifactSlotIcon(slotKey))} {artifactSheets?.[key].name ?? \"\"}\r\n            </Typography></SqBadge></Box>\r\n          )}\r\n          <Box sx={{ flexGrow: 1, display: \"flex\", justifyContent: \"flex-end\" }}>\r\n          </Box>\r\n          <Button size='small' color=\"success\" onClick={equipBuild} disabled={disabled || currentlyEquipped}>Equip Build</Button>\r\n          {extraButtons}\r\n        </Box>\r\n        <Grid container spacing={1} sx={{ pb: 1 }}>\r\n          <Grid item xs={6} sm={4} md={3} lg={2}>\r\n            <WeaponCardNano showLocation weaponId={data.get(input.weapon.id).value} />\r\n          </Grid>\r\n          {allSlotKeys.map(slotKey =>\r\n            <Grid item xs={6} sm={4} md={3} lg={2} key={slotKey} >\r\n              <ArtifactCardNano showLocation slotKey={slotKey} artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel} onClick={() => {\r\n                const oldId = character.equippedArtifacts[slotKey]\r\n                const newId = data.get(input.art[slotKey].id).value!\r\n                setNewOld({ oldId: oldId !== newId ? oldId : undefined, newId })\r\n              }} />\r\n            </Grid>)}\r\n        </Grid>\r\n        <DataContext.Provider value={statProviderContext}>\r\n          <StatDisplayComponent />\r\n        </DataContext.Provider>\r\n      </CardContent>\r\n    </Suspense>\r\n  </CardLight>\r\n}\r\n\r\nfunction CompareArtifactModal({ newOld: { newId, oldId }, mainStatAssumptionLevel, onClose }: { newOld: NewOld, mainStatAssumptionLevel: number, onClose: () => void }) {\r\n  return <ModalWrapper open={!!newId} onClose={onClose} containerProps={{ maxWidth: oldId ? \"md\" : \"xs\" }}>\r\n    <CardDark>\r\n      <CardContent sx={{ display: \"flex\", justifyContent: \"center\", alignItems: \"stretch\", gap: 2, height: \"100%\" }}>\r\n        {oldId && <Box><ArtifactCard artifactId={oldId} mainStatAssumptionLevel={mainStatAssumptionLevel} disableEditSetSlot canExclude canEquip /></Box>}\r\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\r\n        {oldId && <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\"><CardLight sx={{ display: \"flex\" }}><ChevronRight sx={{ fontSize: 40 }} /></CardLight></Box>}\r\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\r\n        <Box><ArtifactCard artifactId={newId} mainStatAssumptionLevel={mainStatAssumptionLevel} disableEditSetSlot canExclude canEquip /></Box>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { Close, Difference } from \"@mui/icons-material\"\r\nimport { Button, Skeleton, Tooltip, Typography } from \"@mui/material\"\r\nimport { Suspense, useContext, useMemo } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { HitModeToggle, ReactionToggle } from \"../../../../Components/HitModeEditor\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport { DataContext } from \"../../../../DataContext\"\r\nimport useBoolState from \"../../../../ReactHooks/useBoolState\"\r\nimport useTeamData from \"../../../../ReactHooks/useTeamData\"\r\nimport { objectMap } from \"../../../../Util/Util\"\r\nimport BuildDisplayItem from \"../TabOptimize/Components/BuildDisplayItem\"\r\n\r\nexport default function CompareBuildButton({ artId, weaponId }: { artId?: string, weaponId?: string }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const [show, onShow, onHide] = useBoolState(false)\r\n  const { database } = useContext(DatabaseContext)\r\n  const { character, character: { key: characterKey, equippedArtifacts }, characterSheet, data: oldData, mainStatAssumptionLevel, characterDispatch } = useContext(DataContext)\r\n  const build = useMemo(() => {\r\n    const newArt = database._getArt(artId ?? \"\")\r\n    const artmap = objectMap(equippedArtifacts, (id, slot) => slot === newArt?.slotKey ? newArt : database._getArt(id))\r\n    return Object.values(artmap)\r\n  }, [database, equippedArtifacts, artId])\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build, weaponId ? database._getWeapon(weaponId) : undefined)\r\n  if (!teamData) return null\r\n  return <>\r\n    <ModalWrapper open={show} onClose={onHide} containerProps={{ maxWidth: \"xl\" }}>\r\n      <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n        <DataContext.Provider value={{ characterSheet, character, characterDispatch, mainStatAssumptionLevel, data: teamData[characterKey]!.target, teamData, oldData }}>\r\n          <BuildDisplayItem compareBuild={true} extraButtons={<><HitModeToggle size=\"small\" /><ReactionToggle size=\"small\" /><Button size='small' color=\"error\" onClick={onHide} ><Close /></Button></>} />\r\n        </DataContext.Provider>\r\n      </Suspense>\r\n    </ModalWrapper>\r\n    <Tooltip title={<Typography>{t`tabEquip.compare`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onShow} ><Difference /></Button>\r\n    </Tooltip>\r\n  </>\r\n}\r\n","import { Box, CardContent, Divider, Grid, Skeleton, Typography } from \"@mui/material\"\r\nimport { lazy, Suspense, useCallback, useContext, useEffect, useMemo, useReducer } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../../../../Assets/Assets\"\r\nimport CardDark from \"../../../../Components/Card/CardDark\"\r\nimport CloseButton from \"../../../../Components/CloseButton\"\r\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport ArtifactCard from \"../../../../PageArtifact/ArtifactCard\"\r\nimport { artifactFilterConfigs, FilterOption, initialFilterOption } from \"../../../../PageArtifact/ArtifactSort\"\r\nimport useForceUpdate from \"../../../../ReactHooks/useForceUpdate\"\r\nimport useMediaQueryUp from \"../../../../ReactHooks/useMediaQueryUp\"\r\nimport { SlotKey } from \"../../../../Types/consts\"\r\nimport { filterFunction } from \"../../../../Util/SortByFilters\"\r\nimport CompareBuildButton from \"./CompareBuildButton\"\r\nconst numToShowMap = { xs: 6, sm: 6, md: 9, lg: 12, xl: 12 }\r\n\r\nconst ArtifactFilterDisplay = lazy(() => import('../../../../Components/Artifact/ArtifactFilterDisplay'))\r\n\r\nexport default function ArtifactSwapModal({ onChangeId, slotKey, show, onClose }:\r\n  { onChangeId: (id: string) => void, slotKey: SlotKey, show: boolean, onClose: () => void }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const clickHandler = useCallback((id) => {\r\n    onChangeId(id)\r\n    onClose()\r\n  }, [onChangeId, onClose])\r\n  const filterOptionReducer = useCallback((state, action) => ({ ...state, ...action, slotKeys: [slotKey] }), [slotKey],)\r\n\r\n  const [filterOption, filterOptionDispatch]: [FilterOption, (action: any) => void] = useReducer(filterOptionReducer, { ...initialFilterOption(), slotKeys: [slotKey] })\r\n\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  useEffect(() => { return database.followAnyArt(forceUpdate) }, [database, forceUpdate])\r\n\r\n  const brPt = useMediaQueryUp()\r\n\r\n  const filterConfigs = useMemo(() => artifactFilterConfigs(), [])\r\n  const artIdList = useMemo(() => {\r\n    const filterFunc = filterFunction(filterOption, filterConfigs)\r\n    return dbDirty && database._getArts().filter(filterFunc).map(art => art.id).slice(0, numToShowMap[brPt])\r\n  }, [dbDirty, database, filterConfigs, filterOption, brPt])\r\n\r\n  return <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"xl\" }} >\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1, display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n        <Typography variant=\"h6\">{slotKey ? <ImgIcon src={Assets.slot[slotKey]} /> : null} {t`tabEquip.swapArt`}</Typography>\r\n        <CloseButton onClick={onClose} />\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={200} />}>\r\n          <ArtifactFilterDisplay filterOption={filterOption} filterOptionDispatch={filterOptionDispatch} />\r\n        </Suspense>\r\n        <Box mt={1}>\r\n          <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={300} />}>\r\n            <Grid container spacing={1} columns={{ xs: 2, md: 3, lg: 4 }}>\r\n              {artIdList.map(id =>\r\n                <Grid item key={id} xs={1} >\r\n                  <ArtifactCard\r\n                    artifactId={id}\r\n                    extraButtons={<CompareBuildButton artId={id} />}\r\n                    onClick={clickHandler}\r\n                  />\r\n                </Grid>)}\r\n            </Grid>\r\n          </Suspense>\r\n        </Box>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { Box, CardContent, Divider, Grid, ToggleButton, Typography } from \"@mui/material\"\r\nimport { useCallback, useContext, useEffect, useMemo, useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../../../../Assets/Assets\"\r\nimport CardDark from \"../../../../Components/Card/CardDark\"\r\nimport CloseButton from \"../../../../Components/CloseButton\"\r\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport SolidToggleButtonGroup from \"../../../../Components/SolidToggleButtonGroup\"\r\nimport { Stars } from \"../../../../Components/StarDisplay\"\r\nimport WeaponSheet from \"../../../../Data/Weapons/WeaponSheet\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport WeaponCard from \"../../../../PageWeapon/WeaponCard\"\r\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate'\r\nimport usePromise from \"../../../../ReactHooks/usePromise\"\r\nimport { allRarities, WeaponTypeKey } from \"../../../../Types/consts\"\r\nimport { filterFunction, sortFunction } from '../../../../Util/SortByFilters'\r\nimport { weaponFilterConfigs, weaponSortConfigs } from '../../../../Util/WeaponSort'\r\nimport CompareBuildButton from \"./CompareBuildButton\"\r\nexport default function WeaponSwapModal({ onChangeId, weaponTypeKey, show, onClose }: { onChangeId: (id: string) => void, weaponTypeKey: WeaponTypeKey, show: boolean, onClose: () => void }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const clickHandler = useCallback((id) => {\r\n    onChangeId(id)\r\n    onClose()\r\n  }, [onChangeId, onClose])\r\n\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  useEffect(() => database.followAnyWeapon(forceUpdate), [forceUpdate, database])\r\n\r\n  const weaponSheets = usePromise(WeaponSheet.getAll, [])\r\n\r\n  const filterConfigs = useMemo(() => weaponSheets && weaponFilterConfigs(weaponSheets), [weaponSheets])\r\n  const sortConfigs = useMemo(() => weaponSheets && weaponSortConfigs(weaponSheets), [weaponSheets])\r\n\r\n  const [rarity, setRarity] = useState([5, 4, 3])\r\n\r\n  const weaponIdList = useMemo(() => (filterConfigs && sortConfigs && dbDirty && database._getWeapons()\r\n    .filter(filterFunction({ weaponType: weaponTypeKey, rarity }, filterConfigs))\r\n    .sort(sortFunction(\"level\", false, sortConfigs))\r\n    .map(weapon => weapon.id)) ?? []\r\n    , [dbDirty, database, filterConfigs, sortConfigs, rarity, weaponTypeKey])\r\n\r\n  return <ModalWrapper open={show} onClose={onClose} >\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Grid container>\r\n          <Grid item flexGrow={1}>\r\n            <Typography variant=\"h6\">{weaponTypeKey ? <ImgIcon src={Assets.weaponTypes[weaponTypeKey]} /> : null} {t`tabEquip.swapWeapon`}</Typography>\r\n          </Grid>\r\n          <Grid item>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <Box mb={1}>\r\n          <SolidToggleButtonGroup sx={{ height: \"100%\" }} onChange={(e, newVal) => setRarity(newVal)} value={rarity} size=\"small\">\r\n            {allRarities.map(star => <ToggleButton key={star} value={star}><Box display=\"flex\" gap={1}><strong>{star}</strong><Stars stars={1} /></Box></ToggleButton>)}\r\n          </SolidToggleButtonGroup>\r\n        </Box>\r\n        <Grid container spacing={1}>\r\n          {weaponIdList.map(weaponId =>\r\n            <Grid item key={weaponId} xs={6} sm={6} md={4} lg={3} >\r\n              <WeaponCard\r\n                weaponId={weaponId}\r\n                onClick={clickHandler}\r\n                extraButtons={<CompareBuildButton weaponId={weaponId} />}\r\n              />\r\n            </Grid>)}\r\n        </Grid>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { SwapHoriz } from '@mui/icons-material';\r\nimport { Box, Button, CardContent, Divider, Grid, Tooltip, Typography, useMediaQuery } from '@mui/material';\r\nimport { useTheme } from \"@mui/system\";\r\nimport { lazy, Suspense, useCallback, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport SetEffectDisplay from '../../../../Components/Artifact/SetEffectDisplay';\r\nimport SlotNameWithIcon from '../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport CardLight from '../../../../Components/Card/CardLight';\r\nimport StatDisplayComponent from '../../../../Components/Character/StatDisplayComponent';\r\nimport DocumentDisplay from \"../../../../Components/DocumentDisplay\";\r\nimport { ArtifactSheet } from '../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../../../Database/Database';\r\nimport { DataContext } from '../../../../DataContext';\r\nimport { uiInput as input } from '../../../../Formula';\r\nimport ArtifactCard from '../../../../PageArtifact/ArtifactCard';\r\nimport WeaponCard from '../../../../PageWeapon/WeaponCard';\r\nimport useBoolState from '../../../../ReactHooks/useBoolState';\r\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate';\r\nimport usePromise from '../../../../ReactHooks/usePromise';\r\nimport { allSlotKeys, SlotKey, WeaponTypeKey } from '../../../../Types/consts';\r\nimport { objectKeyMap } from '../../../../Util/Util';\r\nimport ArtifactSwapModal from './ArtifactSwapModal';\r\nimport WeaponSwapModal from './WeaponSwapModal';\r\n\r\nconst WeaponEditor = lazy(() => import('../../../../PageWeapon/WeaponEditor'))\r\n\r\nfunction TabEquip() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { teamData, data, character, character: { equippedWeapon, key: characterKey, equippedArtifacts }, characterSheet, mainStatAssumptionLevel } = useContext(DataContext)\r\n  const { weaponSheet } = teamData[characterKey]!\r\n  const [weaponId, setweaponId] = useState(\"\")\r\n  const showWeapon = useCallback(() => setweaponId(equippedWeapon), [equippedWeapon],)\r\n  const hideWeapon = useCallback(() => setweaponId(\"\"), [])\r\n\r\n  //triggers when character swap weapons\r\n  useEffect(() => {\r\n    if (weaponId && weaponId !== equippedWeapon)\r\n      setweaponId(equippedWeapon)\r\n  }, [weaponId, equippedWeapon])\r\n\r\n  const { database } = useContext(DatabaseContext)\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n\r\n  // TODO: We can also listen only to equipped artifacts\r\n  const [, updateArt] = useForceUpdate()\r\n  useEffect(() => database.followAnyArt(updateArt))\r\n\r\n  const hasEquipped = useMemo(() => !!Object.values(equippedArtifacts).filter(i => i).length, [equippedArtifacts])\r\n  const unequipArts = useCallback(() => {\r\n    if (!character) return\r\n    if (!window.confirm(\"Do you want to move all currently equipped artifacts to inventory?\")) return\r\n    database.equipArtifacts(character.key, objectKeyMap(allSlotKeys, _ => \"\"))\r\n  }, [character, database])\r\n  const setEffects = useMemo(() => artifactSheets && ArtifactSheet.setEffects(artifactSheets, data), [artifactSheets, data])\r\n\r\n  const theme = useTheme();\r\n  const grxl = useMediaQuery(theme.breakpoints.up('xl'));\r\n  const artifactFields = useMemo(() => artifactSheets && setEffects && Object.entries(setEffects).map(([setKey, setNumKeyArr]) =>\r\n    <CardLight key={setKey} sx={{ flexGrow: 1, }} >\r\n      <CardContent >\r\n        <Grid container spacing={1} flexDirection=\"column\" height=\"100%\" >\r\n          <Grid item display=\"flex\" flexDirection=\"column\" gap={2}>\r\n            {setNumKeyArr.map(setNumKey => <SetEffectDisplay key={setKey + setNumKey} setKey={setKey} setNumKey={setNumKey} />)}\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n    </CardLight>), [artifactSheets, setEffects])\r\n  const weaponDoc = useMemo(() => weaponSheet.document.length > 0 && <CardLight><CardContent><DocumentDisplay sections={weaponSheet.document} /></CardContent></CardLight>, [weaponSheet])\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    <Suspense fallback={false}>\r\n      <WeaponEditor\r\n        weaponId={weaponId}\r\n        footer\r\n        onClose={hideWeapon}\r\n        extraButtons={<LargeWeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />}\r\n      />\r\n    </Suspense>\r\n    <CardLight >\r\n      <CardContent>\r\n        <StatDisplayComponent />\r\n      </CardContent>\r\n    </CardLight>\r\n    <Grid container spacing={1}>\r\n      {grxl && <Grid item xs={12} md={12} xl={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\r\n        {weaponDoc}\r\n        {hasEquipped && <Button color=\"error\" onClick={unequipArts} fullWidth>{t`tabEquip.unequipArts`}</Button>}\r\n        {artifactFields}\r\n      </Grid>}\r\n      <Grid item xs={12} md={12} xl={9} container spacing={1}>\r\n        <Grid item xs={12} sm={6} md={4} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          <WeaponCard weaponId={equippedWeapon} onEdit={showWeapon} canEquip extraButtons={<WeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />} />\r\n        </Grid>\r\n        {allSlotKeys.map(slotKey => <Grid item xs={12} sm={6} md={4} key={slotKey} >\r\n          {!!data.get(input.art[slotKey].id).value ?\r\n            <ArtifactCard artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel}\r\n              extraButtons={<ArtifactSwapButton slotKey={slotKey} />} editor canExclude canEquip /> :\r\n            <ArtSwapCard slotKey={slotKey} />}\r\n        </Grid>)}\r\n      </Grid>\r\n      {!grxl && <Grid item xs={12} md={12} xl={3} container spacing={1} >\r\n        <Grid item xs={12} md={6} lg={4}>{weaponDoc}</Grid>\r\n        <Grid item xs={12} md={6} lg={4}>{artifactFields}</Grid>\r\n      </Grid>}\r\n    </Grid>\r\n  </Box>\r\n}\r\nexport default TabEquip\r\nfunction ArtSwapCard({ slotKey }: { slotKey: SlotKey }) {\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <CardLight sx={{ height: \"100%\", width: \"100%\", minHeight: 300, display: \"flex\", flexDirection: \"column\" }}>\r\n    <CardContent>\r\n      <Typography><SlotNameWithIcon slotKey={slotKey} /></Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <Box sx={{\r\n      flexGrow: 1,\r\n      display: \"flex\",\r\n      justifyContent: \"center\",\r\n      alignItems: \"center\"\r\n    }}\r\n    >\r\n      <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.setArtLocation(id, characterKey)} />\r\n      <Button onClick={onOpen} color=\"info\" sx={{ borderRadius: \"1em\", }}>\r\n        <SwapHoriz sx={{ height: 100, width: 100 }} />\r\n      </Button>\r\n    </Box>\r\n  </CardLight>\r\n}\r\nfunction WeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Tooltip title={<Typography>{t`tabEquip.swapWeapon`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\r\n    </Tooltip>\r\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.setWeaponLocation(id, characterKey)} show={show} onClose={onClose} />\r\n  </>\r\n}\r\nfunction LargeWeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Button color=\"info\" onClick={onOpen} startIcon={<SwapHoriz />} >{t`tabEquip.swapWeapon`}</Button>\r\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.setWeaponLocation(id, characterKey)} show={show} onClose={onClose} />\r\n  </>\r\n}\r\nfunction ArtifactSwapButton({ slotKey }: { slotKey: SlotKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Tooltip title={<Typography>{t`tabEquip.swapArt`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\r\n    </Tooltip>\r\n    <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.setArtLocation(id, characterKey)} />\r\n  </>\r\n}\r\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/BackgroundWorker.e6da42fd.worker.js\");\n}\n","import { forEachNodes, mapFormulas } from \"../../../../Formula/internal\";\r\nimport { allOperations, constantFold } from \"../../../../Formula/optimization\";\r\nimport { ConstantNode, NumNode } from \"../../../../Formula/type\";\r\nimport { constant, customRead, max, min } from \"../../../../Formula/utils\";\r\nimport { allSlotKeys, ArtifactSetKey } from \"../../../../Types/consts\";\r\nimport { assertUnreachable, objectKeyMap, objectMap } from \"../../../../Util/Util\";\r\nimport type { ArtifactBuildData, ArtifactsBySlot, Build, DynStat, PlotData, RequestFilter } from \"./background\";\r\n\r\ntype DynMinMax = { [key in string]: MinMax }\r\ntype MinMax = { min: number, max: number }\r\n\r\ntype MicropassOperation = \"reaffine\" | \"pruneArtRange\" | \"pruneNodeRange\" | \"pruneOrder\"\r\nexport function pruneAll(nodes: NumNode[], minimum: number[], arts: ArtifactsBySlot, numTop: number, keepArtifacts: Set<ArtifactSetKey>, forced: Dict<MicropassOperation, boolean>): { nodes: NumNode[], arts: ArtifactsBySlot } {\r\n  let should = forced\r\n  /** If `key` makes progress, all operations in `value` should be performed */\r\n  const deps: StrictDict<MicropassOperation, Dict<MicropassOperation, true>> = {\r\n    pruneOrder: { pruneNodeRange: true },\r\n    pruneArtRange: { pruneNodeRange: true },\r\n    pruneNodeRange: { reaffine: true },\r\n    reaffine: { pruneOrder: true, pruneArtRange: true, pruneNodeRange: true }\r\n  }\r\n  let count = 0\r\n  while (Object.values(should).some(x => x) && count++ < 20) {\r\n    if (should.pruneOrder) {\r\n      delete should.pruneOrder\r\n      const newArts = pruneOrder(arts, numTop, keepArtifacts)\r\n      if (arts !== newArts) {\r\n        arts = newArts\r\n        should = { ...should, ...deps.pruneOrder }\r\n      }\r\n    }\r\n    if (should.pruneArtRange) {\r\n      delete should.pruneArtRange\r\n      const newArts = pruneArtRange(nodes, arts, minimum)\r\n      if (arts !== newArts) {\r\n        arts = newArts\r\n        should = { ...should, ...deps.pruneArtRange }\r\n      }\r\n    }\r\n    if (should.pruneNodeRange) {\r\n      delete should.pruneNodeRange\r\n      const newNodes = pruneNodeRange(nodes, arts)\r\n      if (nodes !== newNodes) {\r\n        nodes = newNodes\r\n        should = { ...should, ...deps.pruneNodeRange }\r\n      }\r\n    }\r\n    if (should.reaffine) {\r\n      delete should.reaffine\r\n      const { nodes: newNodes, arts: newArts } = reaffine(nodes, arts)\r\n      if (nodes !== newNodes || arts !== newArts) {\r\n        nodes = newNodes\r\n        arts = newArts\r\n        should = { ...should, ...deps.reaffine }\r\n      }\r\n    }\r\n  }\r\n  return { nodes, arts }\r\n}\r\n\r\nfunction reaffine(nodes: NumNode[], arts: ArtifactsBySlot, forceRename: boolean = false): { nodes: NumNode[], arts: ArtifactsBySlot } {\r\n  const affineNodes = new Set<NumNode>(), topLevelAffine = new Set<NumNode>()\r\n\r\n  function visit(node: NumNode, isAffine: boolean) {\r\n    if (isAffine) affineNodes.add(node)\r\n    else node.operands.forEach(_op => {\r\n      const op = _op as NumNode\r\n      affineNodes.has(op) && topLevelAffine.add(op)\r\n    })\r\n  }\r\n\r\n  const dynKeys = new Set<string>()\r\n\r\n  forEachNodes(nodes, _ => { }, f => {\r\n    const operation = f.operation\r\n    switch (operation) {\r\n      case \"read\":\r\n        if (f.type !== \"number\" || f.path[0] !== \"dyn\" || f.accu !== \"add\")\r\n          throw new Error(`Found unsupported ${operation} node at path ${f.path} when computing affine nodes`)\r\n        dynKeys.add(f.path[1])\r\n        visit(f, true)\r\n        break\r\n      case \"add\": visit(f, f.operands.every(op => affineNodes.has(op))); break\r\n      case \"mul\": {\r\n        const nonConst = f.operands.filter(op => op.operation !== \"const\")\r\n        visit(f, nonConst.length === 0 || (nonConst.length === 1 && affineNodes.has(nonConst[0])))\r\n        break\r\n      }\r\n      case \"const\":\r\n        if (typeof f.value === \"string\" || f.value === undefined)\r\n          throw new Error(`Found constant ${f.value} while compacting`)\r\n        visit(f as NumNode, true); break\r\n      case \"res\": case \"threshold\": case \"sum_frac\":\r\n      case \"max\": case \"min\": visit(f, false); break\r\n      case \"data\": case \"subscript\": case \"lookup\": case \"match\": case \"prio\": case \"small\":\r\n        throw new Error(`Found unsupported ${operation} node when computing affine nodes`)\r\n      default: assertUnreachable(operation)\r\n    }\r\n  })\r\n\r\n  if ([...topLevelAffine].every(({ operation }) => operation === \"read\" || operation === \"const\") &&\r\n    Object.keys(arts.base).length === dynKeys.size)\r\n    return { nodes, arts }\r\n\r\n  let current = -1\r\n  function nextDynKey(): string {\r\n    while (dynKeys.has(`${++current}`));\r\n    return `${current}`\r\n  }\r\n\r\n  nodes.forEach(node => affineNodes.has(node) && topLevelAffine.add(node))\r\n  const affine = [...topLevelAffine].filter(f => f.operation !== \"const\")\r\n  const affineMap = new Map(affine.map(node => [node,\r\n    !forceRename && node.operation === \"read\" && node.path[0] === \"dyn\"\r\n      ? node\r\n      : { ...customRead([\"dyn\", `${nextDynKey()}`]), accu: \"add\" as const }]))\r\n  nodes = mapFormulas(nodes, f => affineMap.get(f as NumNode) ?? f, f => f)\r\n\r\n  function reaffineArt(stat: DynStat): DynStat {\r\n    const values = constantFold([...affineMap.keys()], {\r\n      dyn: objectMap(stat, (value) => constant(value))\r\n    } as any, _ => true)\r\n    return Object.fromEntries([...affineMap.values()].map((v, i) => [v.path[1], (values[i] as ConstantNode<number>).value]))\r\n  }\r\n  const result = {\r\n    nodes, arts: {\r\n      base: reaffineArt(arts.base),\r\n      values: objectKeyMap(allSlotKeys, slot =>\r\n        arts.values[slot].map(({ id, set, values }) => ({ id, set, values: reaffineArt(values) })))\r\n    }\r\n  }\r\n  const offsets = Object.entries(reaffineArt({}))\r\n  for (const arts of Object.values(result.arts.values))\r\n    for (const { values } of arts)\r\n      for (const [key, baseValue] of offsets)\r\n        values[key] -= baseValue\r\n  return result\r\n}\r\n/** Remove artifacts that cannot be in top `numTop` builds */\r\nexport function pruneOrder(arts: ArtifactsBySlot, numTop: number, keepArtifacts: Set<ArtifactSetKey>): ArtifactsBySlot {\r\n  let progress = false\r\n  const values = objectKeyMap(allSlotKeys, slot => {\r\n    const list = arts.values[slot]\r\n    const newList = list.filter(art => {\r\n      let count = 0\r\n      return list.every(other => {\r\n        const greaterEqual = Object.entries(other.values).every(([k, o]) => o >= art.values[k])\r\n        const greater = Object.entries(other.values).some(([k, o]) => o > art.values[k])\r\n        if (greaterEqual && (greater || other.id > art.id) &&\r\n          (!keepArtifacts.has(art.set!) || art.set === other.set))\r\n          count++\r\n        return count < numTop\r\n      })\r\n    })\r\n    if (newList.length !== list.length) progress = true\r\n    return newList\r\n  })\r\n  return progress ? { base: arts.base, values } : arts\r\n}\r\n/** Remove artifacts that cannot reach `minimum` in any build */\r\nfunction pruneArtRange(nodes: NumNode[], arts: ArtifactsBySlot, minimum: number[]): ArtifactsBySlot {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  const wrap = { arts }\r\n  while (true) {\r\n    const artRanges = objectKeyMap(allSlotKeys, slot => computeArtRange(wrap.arts.values[slot]))\r\n    const otherArtRanges = objectKeyMap(allSlotKeys, key =>\r\n      addArtRange(Object.entries(artRanges).map(a => a[0] === key ? baseRange : a[1]).filter(x => x)))\r\n\r\n    let progress = false\r\n    const values = objectKeyMap(allSlotKeys, slot => {\r\n      const result = wrap.arts.values[slot].filter(art => {\r\n        const read = addArtRange([computeArtRange([art]), otherArtRanges[slot]])\r\n        const newRange = computeNodeRange(nodes, read)\r\n        return nodes.every((node, i) => newRange.get(node)!.max >= (minimum[i] ?? -Infinity))\r\n      })\r\n      if (result.length !== wrap.arts.values[slot].length)\r\n        progress = true\r\n      return result\r\n    })\r\n    if (!progress) break\r\n    wrap.arts = { base: wrap.arts.base, values }\r\n  }\r\n  return wrap.arts\r\n}\r\nfunction pruneNodeRange(nodes: NumNode[], arts: ArtifactsBySlot): NumNode[] {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  const reads = addArtRange([baseRange, ...Object.values(arts.values).map(values => computeArtRange(values))])\r\n  const nodeRange = computeNodeRange(nodes, reads)\r\n\r\n  return mapFormulas(nodes, f => {\r\n    const { operation } = f\r\n    const operandRanges = f.operands.map(x => nodeRange.get(x)!)\r\n    switch (operation) {\r\n      case \"threshold\": {\r\n        const [value, threshold, pass, fail] = operandRanges\r\n        if (value.min >= threshold.max) return f.operands[2]\r\n        else if (value.max < threshold.min) return constant(0)\r\n        if (pass.max === pass.min &&\r\n          fail.max === fail.min &&\r\n          pass.min === fail.min && isFinite(pass.min))\r\n          return constant(pass.max)\r\n        break\r\n      }\r\n      case \"min\": {\r\n        const newOperands = f.operands.filter((_, i) => {\r\n          const op1 = operandRanges[i]\r\n          return operandRanges.every((op2, j) => op1.min <= op2.max)\r\n        })\r\n        if (newOperands.length < operandRanges.length) return min(...newOperands)\r\n        break\r\n      }\r\n      case \"max\": {\r\n        const newOperands = f.operands.filter((_, i) => {\r\n          const op1 = operandRanges[i]\r\n          return operandRanges.every(op2 => op1.max >= op2.min)\r\n        })\r\n        if (newOperands.length < operandRanges.length) return max(...newOperands)\r\n        break\r\n      }\r\n    }\r\n    return f\r\n  }, f => f)\r\n}\r\nfunction addArtRange(ranges: DynMinMax[]): DynMinMax {\r\n  const result: DynMinMax = {}\r\n  ranges.forEach(range => {\r\n    Object.entries(range).forEach(([key, value]) => {\r\n      if (result[key]) {\r\n        result[key].min += value.min\r\n        result[key].max += value.max\r\n      } else result[key] = { ...value }\r\n    })\r\n  })\r\n  return result\r\n}\r\nfunction computeArtRange(arts: ArtifactBuildData[]): DynMinMax {\r\n  const result: DynMinMax = {}\r\n  if (arts.length) {\r\n    Object.keys(arts[0].values)\r\n      .filter(key => arts.every(art => art.values[key]))\r\n      .forEach(key => result[key] = { min: arts[0].values[key], max: arts[0].values[key] })\r\n    arts.forEach(({ values }) => {\r\n      for (const [key, value] of Object.entries(values)) {\r\n        if (!result[key]) result[key] = { min: 0, max: value }\r\n        else {\r\n          if (result[key].max < value) result[key].max = value\r\n          if (result[key].min > value) result[key].min = value\r\n        }\r\n      }\r\n    })\r\n  }\r\n  return result\r\n}\r\nfunction computeNodeRange(nodes: NumNode[], reads: DynMinMax): Map<NumNode, MinMax> {\r\n  const range = new Map<NumNode, MinMax>()\r\n\r\n  forEachNodes(nodes, _ => { }, _f => {\r\n    const f = _f as NumNode\r\n    const { operation } = f\r\n    const operands = f.operands.map(op => range.get(op)!)\r\n    let current: MinMax\r\n    switch (operation) {\r\n      case \"read\":\r\n        if (f.path[0] !== \"dyn\")\r\n          throw new Error(`Found non-dyn path ${f.path} while computing range`)\r\n        current = reads[f.path[1]] ?? { min: 0, max: 0 }\r\n        break\r\n      case \"const\": current = computeMinMax([f.value]); break\r\n      case \"subscript\": current = computeMinMax(f.list); break\r\n      case \"add\": case \"min\": case \"max\":\r\n        current = {\r\n          min: allOperations[operation](operands.map(x => x.min)),\r\n          max: allOperations[operation](operands.map(x => x.max)),\r\n        }; break\r\n      case \"res\": current = {\r\n        min: allOperations[operation]([operands[0].max]),\r\n        max: allOperations[operation]([operands[0].min]),\r\n      }; break\r\n      case \"mul\": current = operands.reduce((accu, current) => computeMinMax([\r\n        accu.min * current.min, accu.min * current.max,\r\n        accu.max * current.min, accu.max * current.max,\r\n      ])); break\r\n      case \"threshold\":\r\n        if (operands[0].min >= operands[1].max) current = operands[2]\r\n        else if (operands[0].max < operands[1].min) current = computeMinMax([0])\r\n        else current = computeMinMax([0], [operands[2]])\r\n        break\r\n      case \"sum_frac\": {\r\n        const [x, c] = operands, sum = { min: x.min + c.min, max: x.max + c.max }\r\n        if (sum.min <= 0 && sum.max >= 0)\r\n          current = (x.min <= 0 && x.max >= 0) ? { min: NaN, max: NaN } : { min: -Infinity, max: Infinity }\r\n        else\r\n          // TODO: Check this\r\n          current = computeMinMax([\r\n            x.min / sum.min, x.min / sum.max,\r\n            x.max / sum.min, x.max / sum.max\r\n          ])\r\n        break\r\n      }\r\n      case \"data\": case \"lookup\": case \"match\":\r\n        throw new Error(`Unsupported ${operation} node`)\r\n      default: assertUnreachable(operation)\r\n    }\r\n    range.set(f, current)\r\n  })\r\n  return range\r\n}\r\nfunction computeMinMax(values: readonly number[], minMaxes: readonly MinMax[] = []): MinMax {\r\n  const max = Math.max(...values, ...minMaxes.map(x => x.max))\r\n  const min = Math.min(...values, ...minMaxes.map(x => x.min))\r\n  return { min, max }\r\n}\r\n\r\nexport function filterArts(arts: ArtifactsBySlot, filters: RequestFilter): ArtifactsBySlot {\r\n  return {\r\n    base: arts.base,\r\n    values: objectKeyMap(allSlotKeys, slot => {\r\n      const filter = filters[slot]\r\n      switch (filter.kind) {\r\n        case \"id\": return arts.values[slot].filter(art => filter.ids.has(art.id))\r\n        case \"exclude\": return arts.values[slot].filter(art => !filter.sets.has(art.set!))\r\n        case \"required\": return arts.values[slot].filter(art => filter.sets.has(art.set!))\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport function mergeBuilds(builds: Build[][], maxNum: number): Build[] {\r\n  return builds.flatMap(x => x).sort((a, b) => b.value - a.value).slice(0, maxNum)\r\n}\r\nexport function mergePlot(plots: PlotData[]): PlotData {\r\n  let scale = 0.01, reductionScaling = 2, maxCount = 1500\r\n  let keys = new Set(plots.flatMap(x => Object.values(x).map(v => Math.round(v.plot! / scale))))\r\n  while (keys.size > maxCount) {\r\n    scale *= reductionScaling\r\n    keys = new Set([...keys].map(key => Math.round(key / reductionScaling)))\r\n  }\r\n  const result: PlotData = {}\r\n  for (const plot of plots)\r\n    for (const build of Object.values(plot)) {\r\n      const x = Math.round(build.plot! / scale) * scale\r\n      if (!result[x] || result[x]!.value < build.value)\r\n        result[x] = build\r\n    }\r\n  return result\r\n}\r\n\r\nexport function countBuilds(arts: ArtifactsBySlot): number {\r\n  return allSlotKeys.reduce((_count, slot) => _count * arts.values[slot].length, 1)\r\n}\r\n","import { Replay } from '@mui/icons-material';\r\nimport { Box, Button, CardContent, Divider, Grid, Typography } from '@mui/material';\r\nimport React, { useCallback, useContext, useMemo, useState } from 'react';\r\nimport SetEffectDisplay from '../../../../../Components/Artifact/SetEffectDisplay';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport CloseButton from '../../../../../Components/CloseButton';\r\nimport InfoTooltip from '../../../../../Components/InfoTooltip';\r\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport { Stars } from '../../../../../Components/StarDisplay';\r\nimport { Translate } from '../../../../../Components/Translate';\r\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DataContext, dataContextObj } from '../../../../../DataContext';\r\nimport { UIData } from '../../../../../Formula/uiData';\r\nimport { constant } from '../../../../../Formula/utils';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { allArtifactSets, SetNum } from '../../../../../Types/consts';\r\nimport { objectKeyMap } from '../../../../../Util/Util';\r\n\r\nexport default function ArtifactSetConditional({ disabled }: { disabled?: boolean }) {\r\n  const { character } = useContext(DataContext)\r\n  const [open, setOpen] = useState(false)\r\n  const onOpen = useCallback(() => setOpen(true), [setOpen])\r\n  const onClose = useCallback(() => setOpen(false), [setOpen])\r\n  const artifactCondCount = useMemo(() =>\r\n    (Object.keys(character.conditional) as any).filter(k =>\r\n      allArtifactSets.includes(k) && Object.keys(character.conditional[k]).length !== 0).length\r\n    , [character])\r\n  return <>\r\n    <Button fullWidth onClick={onOpen} disabled={disabled} color=\"info\">\r\n      <span>Default Artifact Set Effects Conditionals {!!artifactCondCount && <SqBadge color=\"success\">{artifactCondCount} Selected</SqBadge>}</span>\r\n    </Button>\r\n    <ArtConditionalModal open={open} onClose={onClose} artifactCondCount={artifactCondCount} />\r\n  </>\r\n}\r\n\r\nfunction ArtConditionalModal({ open, onClose, artifactCondCount }: {\r\n  open: boolean, onClose: () => void, artifactCondCount: number\r\n}) {\r\n  const dataContext = useContext(DataContext)\r\n  const { character, characterDispatch } = dataContext\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const resetArtConds = useCallback(() => {\r\n    const conditional = Object.fromEntries(Object.entries(character.conditional).filter(([k, v]) => !allArtifactSets.includes(k as any)))\r\n    characterDispatch({ conditional })\r\n  }, [character, characterDispatch]);\r\n\r\n  if (!artifactSheets) return null\r\n  const artSetKeyList = Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets)).reverse().flatMap(([, sets]) => sets)\r\n  return <ModalWrapper open={open} onClose={onClose} ><CardDark>\r\n    <CardContent>\r\n      <Grid container spacing={1}>\r\n        <Grid item flexGrow={1}>\r\n          <Typography variant=\"h6\">Default Artifact Set Effects {!!artifactCondCount && <SqBadge color=\"success\">{artifactCondCount} Selected</SqBadge>}</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <Button onClick={resetArtConds} color=\"error\" startIcon={<Replay />}>Reset All</Button>\r\n        </Grid>\r\n        <Grid item>\r\n          <CloseButton onClick={onClose} />\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      <CardLight sx={{ mb: 1 }}>\r\n        <CardContent>\r\n          <Typography>Some artifacts provide conditional stats. This windows allows you to select those stats, so they can take effect during build calculation, when artifact sets are not specified.</Typography>\r\n        </CardContent>\r\n      </CardLight>\r\n      <Grid container spacing={1}>\r\n        {artSetKeyList.map(setKey => {\r\n          const sheet: ArtifactSheet = artifactSheets[setKey]\r\n          // Don't display if no conditional in artifact\r\n          if (!Object.values(sheet.setEffects).some(entry => entry.document && entry.document.some(d => \"states\" in d))) return null\r\n          return <Grid item key={setKey} xs={6} lg={4}>\r\n            <CardLight sx={{ height: \"100%\" }}>\r\n              <Box className={`grad-${sheet.rarity[0]}star`} width=\"100%\" sx={{ display: \"flex\" }} >\r\n                <Box component=\"img\" src={sheet.defIconSrc} sx={{ height: 100, width: \"auto\" }} />\r\n                <Box sx={{ flexGrow: 1, px: 1, display: \"flex\", flexDirection: \"column\", justifyContent: \"center\" }}>\r\n                  <Typography variant=\"h6\">{sheet.name ?? \"\"}</Typography>\r\n                  <Box display=\"flex\" gap={1}>\r\n                    <Typography variant=\"subtitle1\">{sheet.rarity.map((ns, i) => <span key={ns}>{ns} <Stars stars={1} /> {i < (sheet.rarity.length - 1) ? \"/ \" : null}</span>)}</Typography>\r\n                    {/* If there is ever a 2-set conditional, we will need to change this */}\r\n                    <InfoTooltip title={<Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.4\"} /></Typography>} />\r\n                  </Box>\r\n                </Box>\r\n              </Box>\r\n              <DataContext.Provider value={fakeData(dataContext) /* TODO: Do we need to Memo this? */}>\r\n                <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\r\n                  {Object.keys(sheet.setEffects)\r\n                    .filter(setNumKey => sheet.setEffects[setNumKey]?.document\r\n                      .some(doc => \"states\" in doc)\r\n                    )\r\n                    .map(setNumKey =>\r\n                      <SetEffectDisplay key={setNumKey} setKey={setKey} setNumKey={parseInt(setNumKey) as SetNum} hideHeader conditionalsOnly />\r\n                    )\r\n                  }\r\n                </CardContent>\r\n              </DataContext.Provider>\r\n            </CardLight>\r\n          </Grid>\r\n        })}\r\n      </Grid>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent sx={{ py: 1 }}>\r\n      <CloseButton large onClick={onClose} />\r\n    </CardContent>\r\n  </CardDark></ModalWrapper>\r\n}\r\n\r\nfunction fakeData(currentContext: dataContextObj): dataContextObj {\r\n  return {\r\n    ...currentContext,\r\n    data: new UIData({ ...currentContext.data.data[0], artSet: objectKeyMap(allArtifactSets, _ => constant(4)) }, undefined)\r\n  }\r\n}\r\n","import { ButtonGroup, CardContent, Divider, MenuItem } from '@mui/material';\r\nimport React, { useMemo } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ArtifactSetSingleAutocomplete } from '../../../../../Components/Artifact/ArtifactAutocomplete';\r\nimport SetEffectDisplay from '../../../../../Components/Artifact/SetEffectDisplay';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport DropdownButton from '../../../../../Components/DropdownMenu/DropdownButton';\r\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { allArtifactSets, ArtifactSetKey, SetNum } from '../../../../../Types/consts';\r\nimport { BuildSetting } from '../BuildSetting';\r\n\r\ntype PickerProps = {\r\n  index: number\r\n  setFilters: BuildSetting[\"setFilters\"],\r\n  disabled?: boolean,\r\n  onChange: (index: number, key: ArtifactSetKey | \"\", num: number) => void,\r\n}\r\n\r\nexport default function ArtifactSetPicker({ index, setFilters, onChange, disabled = false }: PickerProps) {\r\n  const { key: setKey, num: setNum } = setFilters[index]\r\n  const { t } = useTranslation(\"page_character\")\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const artifactSets = useMemo(() => {\r\n    if (!artifactSheets) return undefined\r\n    return allArtifactSets.filter(set => {\r\n      const setsNumArr = set ? Object.keys(artifactSheets[set].setEffects) : []\r\n      const artsAccountedOther = setFilters.reduce((accu, cur, ind) => (cur.key && ind !== index) ? accu + cur.num : accu, 0)\r\n      if (setsNumArr.every((num: any) => parseInt(num) + artsAccountedOther > 5)) return false\r\n      return true\r\n    })\r\n  }, [artifactSheets, setFilters, index])\r\n\r\n  if (!artifactSets) return null\r\n\r\n  const artsAccounted = setFilters.reduce((accu, cur) => cur.key ? accu + cur.num : accu, 0)\r\n\r\n  return <CardLight>\r\n    <ButtonGroup sx={{ width: \"100%\" }}>\r\n      {/* Artifact set */}\r\n      {artifactSheets && <ArtifactSetSingleAutocomplete\r\n        flattenCorners\r\n        showDefault\r\n        size=\"small\"\r\n        artSetKey={setKey}\r\n        setArtSetKey={setKey => onChange(index, setKey as ArtifactSetKey, parseInt(Object.keys(artifactSheets[setKey]?.setEffects ?? {})[0] as string) ?? 0)}\r\n        allArtSetKeys={artifactSets}\r\n        label={t(\"forceSet\")}\r\n        disabled={disabled}\r\n        sx={{ flexGrow: 1 }}\r\n        disable={(setKey) => setFilters.some(setFilter => setFilter.key === setKey)}\r\n        defaultText={t(\"none\")}\r\n      />}\r\n      {/* set number */}\r\n      <DropdownButton title={`${setNum}-set`}\r\n        disabled={disabled || !setKey || artsAccounted >= 5}\r\n        sx={{ borderRadius: 0 }}\r\n      >\r\n        {Object.keys(artifactSheets?.[setKey]?.setEffects ?? {}).map((num: any) => {\r\n          let artsAccountedOther = setFilters.reduce((accu, cur) => (cur.key && cur.key !== setKey) ? accu + cur.num : accu, 0)\r\n          return (parseInt(num) + artsAccountedOther <= 5) &&\r\n            (<MenuItem key={num} onClick={() => onChange(index, setFilters[index].key, parseInt(num) ?? 0)} >\r\n              {`${num}-set`}\r\n            </MenuItem>)\r\n        })}\r\n      </DropdownButton>\r\n    </ButtonGroup>\r\n    {!!setKey && <Divider />}\r\n    {!!setKey && <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\r\n      {Object.keys(artifactSheets?.[setKey].setEffects ?? {}).map(setNKey => parseInt(setNKey as string) as SetNum).filter(setNkey => setNkey <= setNum).map(setNumKey =>\r\n        <SetEffectDisplay key={setKey + setNumKey} setKey={setKey} setNumKey={setNumKey} />)}\r\n    </CardContent>}\r\n  </CardLight>\r\n}\r\n","import { MenuItem } from \"@mui/material\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport DropdownButton from \"../../../../../Components/DropdownMenu/DropdownButton\"\r\n\r\nconst levels = [0, 4, 8, 12, 16, 20] as const\r\nexport default function AssumeFullLevelToggle({ mainStatAssumptionLevel = 0, setmainStatAssumptionLevel, disabled }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  return <DropdownButton fullWidth color={mainStatAssumptionLevel ? \"success\" : \"primary\"} disabled={disabled}\r\n    title={mainStatAssumptionLevel ? t(\"tabOptimize.assumptionLvl.lvl\", { lvl: mainStatAssumptionLevel }) : t(\"tabOptimize.assumptionLvl.no\")}>\r\n    {levels.map((lvl) => <MenuItem key={lvl} onClick={() => setmainStatAssumptionLevel(lvl)}>{lvl ? t(\"tabOptimize.assumptionLvl.lvl\", { lvl }) : t(\"tabOptimize.assumptionLvl.no\")}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n","import { CardContent, Divider, Typography } from '@mui/material';\r\nimport { useContext } from 'react';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport { NodeFieldDisplay } from '../../../../../Components/FieldDisplay';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport { uiInput as input } from '../../../../../Formula';\r\nimport { NumNode } from '../../../../../Formula/type';\r\nexport default function BonusStatsCard() {\r\n  const { data, character } = useContext(DataContext)\r\n  const bonusStatsKeys = Object.keys(character?.bonusStats)\r\n  if (!bonusStatsKeys.length) return null\r\n  const nodes = bonusStatsKeys.map(k => data.get(input.customBonus[k] as NumNode))\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Typography>Bonus Stats</Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      {nodes.map(n => <NodeFieldDisplay key={n.info.key} node={n} />)}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { Alert, Grid, LinearProgress, styled, Typography } from '@mui/material';\r\nimport React, { ReactNode } from 'react';\r\nimport { timeStringMs } from '../../../../../Util/TimeUtil';\r\n\r\nexport const warningBuildNumber = 10000000\r\n\r\nconst Monospace = styled(\"strong\")({\r\n  fontFamily: \"monospace\"\r\n})\r\n\r\nconst BorderLinearProgress = styled(LinearProgress)(({ theme }) => ({\r\n  height: 10,\r\n  borderRadius: 5,\r\n}));\r\nexport default function BuildAlert({ totBuildNumber, generatingBuilds, generationSkipped, generationProgress, generationDuration, characterName, maxBuildsToShow }) {\r\n  const totalBuildNumberString = totBuildNumber?.toLocaleString() ?? totBuildNumber\r\n  const totalUnskipped = totBuildNumber - generationSkipped\r\n  const generationProgressString = generationProgress?.toLocaleString() ?? generationProgress\r\n  const generationSkippedString = generationSkipped?.toLocaleString() ?? generationSkipped\r\n  const totalUnskippedString = totalUnskipped?.toLocaleString() ?? totalUnskipped\r\n  const generationSkippedText = !!generationSkipped && <span>(<b>{generationSkippedString}</b> skipped)</span>\r\n\r\n  let color = \"success\" as \"success\" | \"warning\" | \"error\"\r\n  let title = \"\" as ReactNode\r\n  let subtitle = \"\" as ReactNode\r\n  let progress = undefined as undefined | number\r\n\r\n  if (generatingBuilds) {\r\n    progress = generationProgress * 100 / (totalUnskipped)\r\n    title = <Typography>Generating and testing <Monospace>{generationProgressString}/{totalUnskippedString}</Monospace> build configurations against the criteria for <b>{characterName}</b>. {generationSkippedText}</Typography>\r\n    subtitle = <Typography>Time elapsed: <Monospace>{timeStringMs(Math.round(generationDuration))}</Monospace></Typography>\r\n  } else if (!generatingBuilds && generationProgress) {//done\r\n    progress = 100\r\n    title = <Typography>Generated and tested <Monospace>{totalUnskippedString}</Monospace> Build configurations against the criteria for <b>{characterName}</b>. {generationSkippedText}</Typography>\r\n    subtitle = <Typography>Total duration: <Monospace>{timeStringMs(Math.round(generationDuration))}</Monospace></Typography>\r\n  } else {\r\n    if (totBuildNumber === 0) {\r\n      title = <Typography>Current configuration will not generate any builds for <b>{characterName}</b>. Please change your Artifact configurations, or add/include more Artifacts.</Typography>\r\n      color = \"error\"\r\n    } else if (totBuildNumber > warningBuildNumber) {\r\n      title = <Typography>Current configuration will generate <Monospace>{totalBuildNumberString}</Monospace> potential builds for <b>{characterName}</b>. This might take quite a while to generate...</Typography>\r\n      color = \"warning\"\r\n    } else\r\n      title = <Typography>Current configuration {totBuildNumber <= maxBuildsToShow ? \"generated\" : \"will generate\"} <Monospace>{totalBuildNumberString}</Monospace> builds for <b>{characterName}</b>.</Typography>\r\n  }\r\n\r\n  return <Alert severity={color} variant=\"filled\" sx={{\r\n    \"& .MuiAlert-message\": {\r\n      flexGrow: 1\r\n    }\r\n  }}>\r\n    {title && title}\r\n    {subtitle && subtitle}\r\n    {progress !== undefined && <Grid container spacing={1} alignItems=\"center\">\r\n      <Grid item>\r\n        <Typography>{`${progress.toFixed(1)}%`}</Typography>\r\n      </Grid>\r\n      <Grid item flexGrow={1} >\r\n        <BorderLinearProgress variant=\"determinate\" value={progress} color=\"primary\" />\r\n      </Grid>\r\n    </Grid>}\r\n  </Alert>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank, Download, Info } from '@mui/icons-material';\r\nimport { Button, CardContent, Collapse, Divider, Grid, MenuItem, styled, Tooltip, Typography } from '@mui/material';\r\nimport { useContext, useMemo, useState } from 'react';\r\nimport { CartesianGrid, ComposedChart, Legend, Line, ResponsiveContainer, Scatter, XAxis, YAxis, ZAxis } from 'recharts';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport DropdownButton from '../../../../../Components/DropdownMenu/DropdownButton';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport { uiInput as input } from '../../../../../Formula';\r\nimport { NumNode } from '../../../../../Formula/type';\r\nimport KeyMap from '../../../../../KeyMap';\r\nimport { MainStatKey, SubstatKey } from '../../../../../Types/artifact';\r\nimport { ChartData } from '../background';\r\ntype ChartCardProps = {\r\n  chartData?: ChartData\r\n  plotBase: MainStatKey | SubstatKey | \"\",\r\n  setPlotBase: (key: MainStatKey | SubstatKey | \"\") => void\r\n  disabled?: boolean\r\n}\r\ntype Point = { x: number, y: number, min?: number }\r\nexport default function ChartCard({ chartData, plotBase, setPlotBase, disabled = false }: ChartCardProps) {\r\n  const [showDownload, setshowDownload] = useState(false)\r\n  const [showMin, setshowMin] = useState(true)\r\n  const { data } = useContext(DataContext)\r\n  const statKeys = [\"atk\", \"hp\", \"def\", \"eleMas\", \"critRate_\", \"critDMG_\", \"heal_\", \"enerRech_\"]\r\n  if (data.get(input.weaponType).value !== \"catalyst\") statKeys.push(\"physical_dmg_\")\r\n  statKeys.push(`${data.get(input.charEle).value}_dmg_`)\r\n\r\n  const { displayData, downloadData } = useMemo(() => {\r\n    if (!chartData) return { displayData: null, downloadData: null }\r\n    const points = chartData.data.map(({ value: y, plot: x }) => ({ x, y })) as Point[]\r\n    const increasingX: Point[] = points.sort((a, b) => a.x - b.x)\r\n    const minimumData: Point[] = []\r\n    for (const point of increasingX) {\r\n      let last: Point | undefined\r\n      while ((last = minimumData.pop())) {\r\n        if (last.y > point.y) {\r\n          minimumData.push(last)\r\n          break\r\n        }\r\n      }\r\n      minimumData.push(point)\r\n    }\r\n\r\n    // Note:\r\n    // We can also just use `minimumData` if the plotter supports multiple data sources.\r\n    // It could be faster too since there're no empty entries in `minimumData`.\r\n    if (minimumData[0]?.x !== increasingX[0]?.x)\r\n      increasingX[0].min = minimumData[0].y\r\n    minimumData.forEach(x => { x.min = x.y })\r\n\r\n    const downloadData = {\r\n      minimum: minimumData.map(({ x, y }) => [x, y]),\r\n      allData: increasingX.map(({ x, y }) => [x, y]),\r\n    }\r\n    return { displayData: increasingX, downloadData }\r\n  }, [chartData])\r\n\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container spacing={1} alignItems=\"center\">\r\n        <Grid item>\r\n          <Typography variant=\"h6\" >Optimization Target vs</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <DropdownButton title={plotBase ? KeyMap.get(plotBase) : \"Not Selected\"}\r\n            color={plotBase ? \"success\" : \"primary\"}\r\n            disabled={disabled}\r\n          >\r\n            <MenuItem onClick={() => { setPlotBase(\"\") }}>Unselect</MenuItem>\r\n            <Divider />\r\n            {statKeys.map(sKey => <MenuItem key={sKey} onClick={() => { setPlotBase(sKey as any) }}>{KeyMap.get(sKey)}</MenuItem>)}\r\n          </DropdownButton>\r\n        </Grid>\r\n        <Grid item flexGrow={1}>\r\n          <Tooltip placement=\"top\" title=\"Using data from the builder, this will generate a graph to visualize Optimization Target vs. a selected stat. The graph will show the maximum Optimization Target value per 0.01 of the selected stat.\">\r\n            <Info />\r\n          </Tooltip>\r\n        </Grid>\r\n        {!!downloadData && <Grid item>\r\n          <Button startIcon={showMin ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n            color={showMin ? \"success\" : \"secondary\"}\r\n            onClick={() => setshowMin(!showMin)}>Show Min Stat Threshold</Button>\r\n        </Grid>}\r\n        {!!downloadData && <Grid item>\r\n          <Button color=\"info\" startIcon={<Download />} onClick={() => setshowDownload(!showDownload)}>Download Data</Button>\r\n        </Grid>}\r\n      </Grid>\r\n    </CardContent>\r\n    {!!displayData && <Divider />}\r\n    {chartData && !!displayData && <CardContent>\r\n      <Collapse in={!!downloadData && showDownload}>\r\n        <CardDark sx={{ mb: 2 }}>\r\n          <CardContent>\r\n            <Typography>Min Data</Typography>\r\n            <DataDisplay data={downloadData?.minimum} />\r\n            <Typography>All Data</Typography>\r\n            <DataDisplay data={downloadData?.allData} />\r\n          </CardContent>\r\n        </CardDark>\r\n      </Collapse>\r\n      <Chart displayData={displayData} plotNode={chartData.plotNode} valueNode={chartData.valueNode} showMin={showMin} />\r\n    </CardContent>}\r\n  </CardLight >\r\n}\r\nconst TextArea = styled(\"textarea\")({\r\n  width: \"100%\",\r\n  fontFamily: \"monospace\",\r\n  resize: \"vertical\",\r\n  minHeight: \"5em\"\r\n})\r\nfunction DataDisplay({ data, }: { data?: object }) {\r\n  return <TextArea readOnly value={JSON.stringify(data)} onClick={e => {\r\n    const target = e.target as HTMLTextAreaElement;\r\n    target.selectionStart = 0;\r\n    target.selectionEnd = target.value.length;\r\n  }} />\r\n}\r\nfunction Chart({ displayData, plotNode, valueNode, showMin }: {\r\n  displayData: Point[],\r\n  plotNode: NumNode,\r\n  valueNode: NumNode,\r\n  showMin: boolean\r\n}) {\r\n  const plotBaseUnit = KeyMap.unit(plotNode.info?.key)\r\n  const valueUnit = KeyMap.unit(valueNode.info?.key)\r\n  return <ResponsiveContainer width=\"100%\" height={600}>\r\n    <ComposedChart data={displayData}>\r\n      <CartesianGrid strokeDasharray=\"3 3\" />\r\n      <XAxis dataKey=\"x\" scale=\"linear\" unit={plotBaseUnit} domain={[\"auto\", \"auto\"]} tick={{ fill: 'white' }} type=\"number\" tickFormatter={n => n > 10000 ? n.toFixed() : n.toFixed(1)} />\r\n      <YAxis name=\"DMG\" domain={[\"auto\", \"auto\"]} unit={valueUnit} allowDecimals={false} tick={{ fill: 'white' }} type=\"number\" />\r\n      <ZAxis dataKey=\"y\" range={[3, 25]} />\r\n      <Legend />\r\n      <Scatter name=\"Optimization Target\" dataKey=\"y\" fill=\"#8884d8\" line lineType=\"fitting\" isAnimationActive={false} />\r\n      {showMin && <Line name=\"Minimum Stat Requirement Threshold\" dataKey=\"min\" stroke=\"#ff7300\" type=\"stepBefore\" connectNulls strokeWidth={2} isAnimationActive={false} />}\r\n    </ComposedChart>\r\n  </ResponsiveContainer>\r\n}\r\n","import { Replay } from '@mui/icons-material';\r\nimport { Button, CardContent, Divider, Grid, Typography } from '@mui/material';\r\nimport { Box } from '@mui/system';\r\nimport React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport BootstrapTooltip from '../../../../../Components/BootstrapTooltip';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport StatIcon, { uncoloredEleIcons } from '../../../../../Components/StatIcon';\r\nimport Artifact from '../../../../../Data/Artifacts/Artifact';\r\nimport KeyMap from '../../../../../KeyMap';\r\nimport { MainStatKey } from '../../../../../Types/artifact';\r\nimport { allElementsWithPhy, SlotKey } from '../../../../../Types/consts';\r\nimport { BuildSetting } from '../BuildSetting';\r\n\r\nexport const artifactsSlotsToSelectMainStats = [\"sands\", \"goblet\", \"circlet\"] as const\r\n\r\nexport default function MainStatSelectionCard({ mainStatKeys, onChangeMainStatKey, disabled = false, }: {\r\n  mainStatKeys: BuildSetting[\"mainStatKeys\"]\r\n  onChangeMainStatKey: (slotKey: SlotKey, mainStatKey?: MainStatKey) => void\r\n  disabled?: boolean\r\n}) {\r\n  const { t } = useTranslation(\"artifact\")\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    {artifactsSlotsToSelectMainStats.map(slotKey => {\r\n      const numSel = mainStatKeys[slotKey].length\r\n      return <Box key={slotKey}>\r\n        <Divider />\r\n        <CardContent sx={{ pt: 1 }}>\r\n          <Box sx={{ display: \"flex\", gap: 1, alignItems: \"center\", pb: 1 }}>\r\n            <BootstrapTooltip placement=\"top\" title={<Typography>{t(`slotName.${slotKey}`)}</Typography>}>\r\n              <span>{artifactSlotIcon(slotKey)}</span>\r\n            </BootstrapTooltip>\r\n            <Box flexGrow={1}>\r\n              <SqBadge color=\"info\">{numSel ? `${numSel} Selected` : `Any`}</SqBadge>\r\n            </Box>\r\n            <Button color=\"error\" size=\"small\" disabled={!mainStatKeys[slotKey].length || disabled} sx={{ mt: -1, mb: -1 }}\r\n              onClick={() => onChangeMainStatKey(slotKey)}>\r\n              <Replay />\r\n            </Button>\r\n          </Box>\r\n          <Grid container spacing={1}>\r\n            {Artifact.slotMainStats(slotKey).map((mainStatKey, i) => {\r\n              const element = allElementsWithPhy.find(ele => mainStatKey.includes(ele))\r\n              const color = mainStatKeys[slotKey].includes(mainStatKey)\r\n                ? element ?? \"success\"\r\n                : \"secondary\"\r\n              return <Grid item key={mainStatKey} flexGrow={1} xs={i < 3 ? 4 : undefined} >\r\n                <BootstrapTooltip placement=\"top\" title={<Typography><strong>{KeyMap.getArtStr(mainStatKey)}</strong></Typography>} disableInteractive>\r\n                  <Button fullWidth size=\"small\" color={color} sx={{ fontSize: \"1.2em\", height: \"100%\", pointerEvents: disabled ? \"none\" : undefined, cursor: disabled ? \"none\" : undefined }}\r\n                    onClick={() => onChangeMainStatKey(slotKey, mainStatKey)}>\r\n                    {element ? uncoloredEleIcons[element] : StatIcon[mainStatKey]}\r\n                  </Button>\r\n                </BootstrapTooltip>\r\n              </Grid>\r\n            })}\r\n          </Grid>\r\n        </CardContent>\r\n      </Box>\r\n    })}\r\n  </Box >\r\n}\r\n","import { Masonry } from '@mui/lab';\r\nimport { Button, CardContent, CardHeader, Divider, MenuItem, MenuList, styled } from '@mui/material';\r\nimport React, { useCallback, useContext, useState } from 'react';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport ColorText from '../../../../../Components/ColoredText';\r\nimport ImgIcon from '../../../../../Components/Image/ImgIcon';\r\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport { getDisplayHeader, getDisplaySections } from '../../../../../Formula/DisplayUtil';\r\nimport { DisplaySub } from '../../../../../Formula/type';\r\nimport { NodeDisplay } from '../../../../../Formula/uiData';\r\nimport KeyMap from '../../../../../KeyMap';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { objPathValue } from '../../../../../Util/Util';\r\n\r\nconst WhiteButton = styled(Button)({\r\n  color: \"black\",\r\n  backgroundColor: \"white\",\r\n  \"&:hover\": {\r\n    backgroundColor: \"#e1e1e1\",\r\n  }\r\n})\r\nexport default function OptimizationTargetSelector({ optimizationTarget, setTarget, disabled = false }: {\r\n  optimizationTarget?: string[], setTarget: (target: string[]) => void, disabled\r\n}) {\r\n  const [open, setOpen] = useState(false)\r\n  const onOpen = useCallback(() => !disabled && setOpen(true), [setOpen, disabled])\r\n  const onClose = useCallback(() => setOpen(false), [setOpen])\r\n\r\n  const setTargetHandler = useCallback(\r\n    (target: string[]) => {\r\n      onClose()\r\n      setTarget(target)\r\n    },\r\n    [onClose, setTarget],\r\n  )\r\n  const { data } = useContext(DataContext)\r\n  const sections = getDisplaySections(data)\r\n  return <>\r\n    <WhiteButton onClick={onOpen} disabled={disabled} >\r\n      <TargetDisplayText optimizationTarget={optimizationTarget} />\r\n    </WhiteButton>\r\n    <ModalWrapper open={open} onClose={onClose}>\r\n      <CardDark >\r\n        <CardContent>\r\n          <Masonry columns={{ xs: 1, sm: 2, md: 3 }} spacing={1}>\r\n            {sections.map(([key, Nodes]) =>\r\n              <SelectorSection key={key} displayNs={Nodes} sectionKey={key} setTarget={setTargetHandler} />)}\r\n          </Masonry >\r\n        </CardContent>\r\n      </CardDark>\r\n    </ModalWrapper>\r\n  </>\r\n}\r\nfunction SelectorSection({ displayNs, sectionKey, setTarget }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string, setTarget: (target: string[]) => void }) {\r\n  const { data } = useContext(DataContext)\r\n  const header = usePromise(getDisplayHeader(data, sectionKey), [data, sectionKey])\r\n  return <CardLight key={sectionKey as string}>\r\n    {header && <CardHeader avatar={header.icon && <ImgIcon size={2} sx={{ m: -1 }} src={header.icon} />} title={header.title} action={header.action} titleTypographyProps={{ variant: \"subtitle1\" }} />}\r\n    <Divider />\r\n    <MenuList>\r\n      {Object.entries(displayNs).map(([key, n]) =>\r\n        <TargetSelectorMenuItem key={key} node={n} onClick={() => setTarget([sectionKey, key])} />)}\r\n    </MenuList>\r\n  </CardLight>\r\n}\r\nfunction NoTarget() {\r\n  return <b>Select an Optimization Target</b>\r\n}\r\nfunction TargetDisplayText({ optimizationTarget }: { optimizationTarget?: string[] }) {\r\n  const { data } = useContext(DataContext)\r\n  const displayHeader = usePromise(optimizationTarget && getDisplayHeader(data, optimizationTarget[0]), [data, optimizationTarget])\r\n\r\n  if (!optimizationTarget || !displayHeader) return <NoTarget />\r\n  const node: NodeDisplay | undefined = objPathValue(data.getDisplay(), optimizationTarget) as any\r\n  if (!node) return <NoTarget />\r\n\r\n  return <b>{displayHeader.title} : {<ColorText color={node.info.variant}>{KeyMap.get(node.info.key)}</ColorText>}</b>\r\n}\r\nfunction TargetSelectorMenuItem({ node, onClick }: { node: NodeDisplay, onClick: () => void }) {\r\n  if (node.isEmpty) return null\r\n  return <MenuItem onClick={onClick} style={{ overflow: \"hidden\", textOverflow: \"ellipsis\" }}>\r\n    <ColorText color={node.info.variant} >{KeyMap.get(node.info.key)}</ColorText>\r\n  </MenuItem>\r\n}\r\n","import useDBState from \"../../../../ReactHooks/useDBState\";\r\nimport { CharacterKey } from \"../../../../Types/consts\";\r\n\r\nexport const defThreads = navigator.hardwareConcurrency || 4\r\n\r\nexport function initialTabOptimizeDBState(): {\r\n  equipmentPriority: CharacterKey[],\r\n  threads: number,\r\n} {\r\n  return {\r\n    equipmentPriority: [],\r\n    threads: defThreads\r\n  }\r\n}\r\n\r\nexport function useOptimizeDBState() {\r\n  return useDBState(\"TabOptimize\", initialTabOptimizeDBState)\r\n}\r\n","import { Add, CheckBox, CheckBoxOutlineBlank, Close, KeyboardArrowDown, KeyboardArrowUp, KeyboardDoubleArrowDown, KeyboardDoubleArrowUp, Replay, Settings } from \"@mui/icons-material\";\r\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Typography } from \"@mui/material\";\r\nimport { useCallback, useContext, useMemo } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport ArtifactCardPico from \"../../../../../Components/Artifact/ArtifactCardPico\";\r\nimport CardDark from \"../../../../../Components/Card/CardDark\";\r\nimport CardLight from \"../../../../../Components/Card/CardLight\";\r\nimport CharacterCardPico from \"../../../../../Components/Character/CharacterCardPico\";\r\nimport { CharacterSelectionModal } from \"../../../../../Components/Character/CharacterSelectionModal\";\r\nimport CloseButton from \"../../../../../Components/CloseButton\";\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"../../../../../Components/CustomNumberInput\";\r\nimport ModalWrapper from \"../../../../../Components/ModalWrapper\";\r\nimport SqBadge from \"../../../../../Components/SqBadge\";\r\nimport WeaponCardPico from \"../../../../../Components/Weapon/WeaponCardPico\";\r\nimport { DatabaseContext } from \"../../../../../Database/Database\";\r\nimport { DataContext } from \"../../../../../DataContext\";\r\nimport useBoolState from \"../../../../../ReactHooks/useBoolState\";\r\nimport useCharacter from \"../../../../../ReactHooks/useCharacter\";\r\nimport { ICachedCharacter } from \"../../../../../Types/character\";\r\nimport { CharacterKey } from \"../../../../../Types/consts\";\r\nimport { useOptimizeDBState } from \"../DBState\";\r\n\r\nexport default function UseEquipped({ useEquippedArts, buildSettingsDispatch, disabled }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState(false)\r\n  const [{ equipmentPriority: tempEquipmentPriority }, setOptimizeDBState] = useOptimizeDBState()\r\n  //Basic validate for the equipmentPrio list to remove dups and characters that doesnt exist.\r\n  const equipmentPriority = useMemo(() => [...new Set(tempEquipmentPriority)].filter(ck => database._getChar(ck)), [database, tempEquipmentPriority])\r\n  const setPrio = useCallback((equipmentPriority: CharacterKey[]) => setOptimizeDBState({ equipmentPriority }), [setOptimizeDBState])\r\n\r\n  const setPrioRank = useCallback((fromIndex, toIndex) => {\r\n    const arr = [...equipmentPriority]\r\n    var element = arr[fromIndex];\r\n    arr.splice(fromIndex, 1);\r\n    arr.splice(toIndex, 0, element);\r\n    setPrio(arr)\r\n  }, [equipmentPriority, setPrio])\r\n  const removePrio = useCallback((fromIndex) => {\r\n    const arr = [...equipmentPriority]\r\n    arr.splice(fromIndex, 1)\r\n    setPrio(arr)\r\n  }, [equipmentPriority, setPrio])\r\n  const addPrio = useCallback((ck: CharacterKey) => setPrio([...equipmentPriority, ck]), [equipmentPriority, setPrio])\r\n  const resetPrio = useCallback(() => setPrio([]), [setPrio])\r\n\r\n  const numAbove = useMemo(() => {\r\n    let numAbove = equipmentPriority.length\r\n    const index = equipmentPriority.indexOf(characterKey)\r\n    if (index >= 0) numAbove = index\r\n    return numAbove\r\n  }, [characterKey, equipmentPriority])\r\n  const numUseEquippedChar = useMemo(() => {\r\n    return database._getCharKeys().length - 1 - numAbove\r\n  }, [numAbove, database])\r\n  const numUnlisted = useMemo(() => {\r\n    return database._getCharKeys().length - equipmentPriority.length\r\n  }, [equipmentPriority, database])\r\n\r\n  return <Box display=\"flex\" gap={1}>\r\n    <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"sm\" }}><CardDark>\r\n      <CardContent>\r\n        <Grid container spacing={1}>\r\n          <Grid item flexGrow={1}>\r\n            <Typography variant=\"h6\"><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.title\">Character Priority for Equipped Artifacts</Trans></Typography>\r\n          </Grid>\r\n          <Grid item sx={{ mb: -1 }}>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <CardLight sx={{ mb: 1 }}>\r\n          <CardContent>\r\n            <Typography gutterBottom><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.desc1\">When generating a build, the Optimizer will only consider equipped artifacts from characters below the current character or those not on the list.</Trans></Typography>\r\n            <Typography gutterBottom><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.desc2\">If the current character is not on the list, the Optimizer will only consider equipped artifacts from others characters that are not on the list.</Trans></Typography>\r\n          </CardContent>\r\n        </CardLight>\r\n        <Box display=\"flex\" flexDirection=\"column\" gap={2}>\r\n          {equipmentPriority.map((ck, i) =>\r\n            <SelectItem key={ck} characterKey={ck} rank={i + 1} maxRank={equipmentPriority.length} setRank={(num) => num && setPrioRank(i, num - 1)} onRemove={() => removePrio(i)} numAbove={numAbove} />)}\r\n          <Box sx={{ display: \"flex\", gap: 1 }}>\r\n            <NewItem onAdd={addPrio} list={equipmentPriority} />\r\n            <Button color=\"error\" onClick={resetPrio} startIcon={<Replay />}><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.clearList\">Clear List</Trans></Button>\r\n          </Box>\r\n          {!!numUseEquippedChar && <SqBadge color=\"success\"><Typography><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.usingNum\" count={numUnlisted}>Using artifacts from <strong>{{ count: numUnlisted }}</strong> unlisted characters</Trans></Typography></SqBadge>}\r\n        </Box>\r\n      </CardContent>\r\n    </CardDark ></ModalWrapper>\r\n    <ButtonGroup sx={{ display: \"flex\", width: \"100%\" }}>\r\n      <Button sx={{ flexGrow: 1 }} onClick={() => buildSettingsDispatch({ useEquippedArts: !useEquippedArts })} disabled={disabled} startIcon={useEquippedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useEquippedArts ? \"success\" : \"secondary\"}>\r\n        <Box>\r\n          <span><Trans t={t} i18nKey=\"tabOptimize.useEquipped.title\">Use Equipped Artifacts</Trans></span>\r\n          {useEquippedArts && <SqBadge><Trans t={t} i18nKey=\"tabOptimize.useEquipped.usingNum\" count={numUseEquippedChar}>Using from <strong>{{ count: numUseEquippedChar }}</strong> characters</Trans></SqBadge>}\r\n        </Box>\r\n      </Button>\r\n      {useEquippedArts && <Button sx={{ flexShrink: 1 }} color=\"info\" onClick={onOpen}><Settings /></Button>}\r\n    </ButtonGroup>\r\n  </Box>\r\n}\r\n\r\nconst itemSize = 60\r\nfunction SelectItem({ characterKey, rank, maxRank, setRank, onRemove, numAbove }: {\r\n  characterKey: CharacterKey,\r\n  rank: number,\r\n  maxRank: number,\r\n  setRank: (r: number | undefined) => void,\r\n  onRemove: () => void,\r\n  numAbove: number,\r\n}) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const character = useCharacter(characterKey)\r\n  if (!character) return null\r\n  const { equippedWeapon, equippedArtifacts } = character\r\n  return <CardLight sx={{ p: 1 }}  >\r\n    <Box sx={{ pb: 1, display: \"flex\", justifyContent: \"space-between\", gap: 1 }}>\r\n      <SqBadge color=\"info\">\r\n        <Typography>#{rank}</Typography>\r\n      </SqBadge>\r\n      <SqBadge sx={{ flexGrow: 1 }} color={numAbove === (rank - 1) ? \"warning\" : (rank - 1) < numAbove ? \"error\" : \"success\"}>\r\n        <Typography>{numAbove === (rank - 1) ? <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.curr\">Current character</Trans>\r\n          : (rank - 1) < numAbove ? <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.dont\">Don't Use artifacts</Trans> :\r\n            <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.use\">Use artifacts</Trans>}</Typography>\r\n      </SqBadge>\r\n      <Box>\r\n        <ButtonGroup sx={{ flexGrow: 1 }} size=\"small\">\r\n          <CustomNumberInputButtonGroupWrapper >\r\n            <CustomNumberInput onChange={setRank} value={rank}\r\n              // startAdornment=\"Rank:\"\r\n              inputProps={{ min: 1, max: maxRank, sx: { textAlign: \"center\" } }}\r\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }} />\r\n          </CustomNumberInputButtonGroupWrapper>\r\n          <Button disabled={rank === 1} onClick={() => setRank(1)} >\r\n            <KeyboardDoubleArrowUp />\r\n          </Button>\r\n          <Button disabled={rank === 1} onClick={() => setRank(rank - 1)}  >\r\n            <KeyboardArrowUp />\r\n          </Button>\r\n          <Button disabled={rank === maxRank} onClick={() => setRank(rank + 1)}  >\r\n            <KeyboardArrowDown />\r\n          </Button>\r\n          <Button disabled={rank === maxRank} onClick={() => setRank(maxRank)}  >\r\n            <KeyboardDoubleArrowDown />\r\n          </Button>\r\n          <Button color=\"error\" onClick={onRemove}>\r\n            <Close />\r\n          </Button>\r\n        </ButtonGroup>\r\n      </Box>\r\n    </Box>\r\n    <Grid container columns={7} spacing={1}>\r\n      <Grid item xs={1} >\r\n        <CharacterCardPico characterKey={characterKey} />\r\n      </Grid>\r\n      <Grid item xs={1}><WeaponCardPico weaponId={equippedWeapon} /></Grid>\r\n      {Object.entries(equippedArtifacts).map(([slotKey, aId]) => <Grid item xs={1} key={slotKey} ><ArtifactCardPico slotKey={slotKey} artifactObj={database._getArt(aId)} /></Grid>)}\r\n    </Grid>\r\n\r\n  </CardLight>\r\n}\r\nfunction NewItem({ onAdd, list }: { onAdd: (ck: CharacterKey) => void, list: CharacterKey[] }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const [show, onOpen, onClose] = useBoolState(false)\r\n  const filter = useCallback((char?: ICachedCharacter) => {\r\n    if (!char) return false\r\n    return !list.includes(char.key)\r\n  }, [list])\r\n  return <>\r\n    <CharacterSelectionModal show={show} onHide={onClose} onSelect={onAdd} filter={filter} />\r\n    <Button fullWidth sx={{ height: itemSize }} color=\"info\" onClick={onOpen} startIcon={<Add />} >\r\n      <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.add\">Add character to list</Trans>\r\n    </Button>\r\n  </>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank } from \"@mui/icons-material\";\r\nimport { Box, Button } from \"@mui/material\";\r\nimport { useContext, useMemo } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport SqBadge from \"../../../../../Components/SqBadge\";\r\nimport { DatabaseContext } from \"../../../../../Database/Database\";\r\n\r\nexport default function UseExcluded({ buildSettingsDispatch, useExcludedArts, disabled, artsDirty }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const numExcludedArt = useMemo(() => artsDirty && database._getArts().reduce((a, art) => a + (art.exclude ? 1 : 0), 0), [database, artsDirty])\r\n  return <Button fullWidth onClick={() => buildSettingsDispatch({ useExcludedArts: !useExcludedArts })} disabled={!numExcludedArt || disabled} startIcon={useExcludedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useExcludedArts ? \"success\" : \"secondary\"}>\r\n    <Box>\r\n      <span><Trans t={t} i18nKey=\"tabOptimize.useExcluded.title\" count={numExcludedArt}>Use Excluded Artifacts</Trans></span>\r\n      {useExcludedArts && <SqBadge><Trans t={t} i18nKey=\"tabOptimize.useExcluded.usingNum\" count={numExcludedArt}>Using <strong>{{ count: numExcludedArt }}</strong> excluded artifacts</Trans></SqBadge>}\r\n    </Box>\r\n  </Button>\r\n}\r\n","import Artifact from \"../../../../Data/Artifacts/Artifact\";\r\nimport { input } from \"../../../../Formula\";\r\nimport { computeUIData } from \"../../../../Formula/api\";\r\nimport { formulaString } from \"../../../../Formula/debug\";\r\nimport { Data, NumNode } from \"../../../../Formula/type\";\r\nimport { constant, setReadNodeKeys } from \"../../../../Formula/utils\";\r\nimport { allMainStatKeys, allSubstatKeys, ICachedArtifact } from \"../../../../Types/artifact\";\r\nimport { allSlotKeys, ArtifactSetKey } from \"../../../../Types/consts\";\r\nimport { deepClone, objectKeyMap, objectMap } from \"../../../../Util/Util\";\r\nimport type { ArtifactBuildData, ArtifactsBySlot, DynStat, RequestFilter } from \"./background\";\r\nimport { countBuilds, filterArts } from \"./common\";\r\n\r\nconst dynamic = setReadNodeKeys(deepClone({ dyn: { ...input.art, ...input.artSet } }))\r\nexport const dynamicData = {\r\n  art: objectKeyMap([...allMainStatKeys, ...allSubstatKeys], key => dynamic.dyn[key]),\r\n  artSet: objectMap(input.artSet, (_, key) => dynamic.dyn[key]),\r\n}\r\n\r\nexport function compactArtifacts(arts: ICachedArtifact[], mainStatAssumptionLevel: number): ArtifactsBySlot {\r\n  const result: ArtifactsBySlot = {\r\n    base: {},\r\n    values: { flower: [], plume: [], goblet: [], circlet: [], sands: [] }\r\n  }\r\n  const keys = new Set<string>()\r\n\r\n  for (const art of arts) {\r\n    const mainStatVal = Artifact.mainStatValue(art.mainStatKey, art.rarity, Math.max(Math.min(mainStatAssumptionLevel, art.rarity * 4), art.level))\r\n\r\n    const data: ArtifactBuildData = {\r\n      id: art.id, set: art.setKey,\r\n      values: {\r\n        [art.setKey]: 1,\r\n        [art.mainStatKey]: art.mainStatKey.endsWith('_') ? mainStatVal / 100 : mainStatVal,\r\n        ...Object.fromEntries(art.substats.map(substat =>\r\n          [substat.key, substat.key.endsWith('_') ? substat.accurateValue / 100 : substat.accurateValue]))\r\n      },\r\n    }\r\n    delete data.values[\"\"]\r\n    result.values[art.slotKey].push(data)\r\n    Object.keys(data.values).forEach(x => keys.add(x))\r\n  }\r\n  result.base = objectKeyMap([...keys], _ => 0)\r\n  for (const value of Object.values(result.values))\r\n    value.push({ id: \"\", values: {} })\r\n  return result\r\n}\r\n// TODO: Use this as the new set filter\r\ntype _SetFilter = { key: ArtifactSetKey | \"\", min?: number, max?: number }[]\r\n/**\r\n * Computes a (disjoint) list of all request filters that satisfy `filter`.\r\n * `filters` is expressed as a disjunctive normal form, e.g., a request filter\r\n * satisfies `filter` of\r\n *\r\n * ```\r\n * [\r\n *   [ condition1, condition2 ],\r\n *   [ condition3, condition4 ],\r\n * ]\r\n * ```\r\n *\r\n * if\r\n * - Both `condition1` AND `condition2` are met, or\r\n * - Both `condition3` and `condition4` are met.\r\n */\r\nexport function* artSetPerm(_filters: _SetFilter[]): Iterable<RequestFilter> {\r\n  type Filters = Dict<ArtifactSetKey, { min: number, max: number }>\r\n\r\n  const allFilters: Filters[] = _filters.map(fs => {\r\n    const result: Dict<ArtifactSetKey, { min: number, max: number }> = {}\r\n    fs.forEach(({ key, min, max }) => {\r\n      if (!key) return\r\n      if (!result[key]) result[key] = { min: 0, max: 5 }\r\n      const obj = result[key]!\r\n      obj.min = Math.max(obj.min, min ?? 0)\r\n      obj.max = Math.min(obj.max, max ?? 5)\r\n    })\r\n    return result\r\n  }).filter(fs => Object.values(fs).every(f => f.min <= f.max))\r\n\r\n  // Remove unnecessary or impossible filters\r\n  function cleanFilters(result: Filters[], remainingSlots: number): Filters[] {\r\n    return result.map(result => {\r\n      result = { ...result }\r\n      for (const [key, value] of Object.entries(result)) {\r\n        if (value.min === 0 && value.max >= remainingSlots)\r\n          // Unnecessary filter\r\n          delete result[key]\r\n      }\r\n      return result\r\n    }).filter(fs =>\r\n      // Keep only possible filters\r\n      Object.values(fs).reduce((a, b) => a + b.min, 0) <= remainingSlots\r\n    )\r\n  }\r\n\r\n  const noFilter = { kind: \"exclude\" as const, sets: new Set<ArtifactSetKey>() }\r\n  const result: RequestFilter = objectKeyMap(allSlotKeys, _ => noFilter)\r\n  function* check(_filters: Filters[], remainingSlots: number) {\r\n    const filters = cleanFilters(_filters, remainingSlots)\r\n    if (!filters.length) return\r\n    if (filters.some(fs => !Object.keys(fs).length)) {\r\n      yield { ...result }\r\n      return\r\n    }\r\n\r\n    const slot = allSlotKeys[remainingSlots - 1]\r\n    const relevantSets = new Set(filters.flatMap(fs => Object.keys(fs)))\r\n    for (const set of relevantSets) {\r\n      result[slot] = { kind: \"required\", sets: new Set([set]) }\r\n      const newFilters = filters.map(fs => {\r\n        const obj = fs[set]\r\n        if (obj)\r\n          return { ...fs, [set]: { min: obj.min ? obj.min - 1 : 0, max: obj.max - 1 } }\r\n        return fs\r\n      })\r\n      yield* check(newFilters, remainingSlots - 1)\r\n    }\r\n    result[slot] = { kind: \"exclude\", sets: relevantSets }\r\n    yield* check(filters, remainingSlots - 1)\r\n    result[slot] = noFilter\r\n  }\r\n  yield* check(allFilters, 5)\r\n}\r\nexport function* splitFiltersBySet(_arts: ArtifactsBySlot, filters: Iterable<RequestFilter>, limit: number): Iterable<RequestFilter> {\r\n  if (limit < 10000) limit = 10000\r\n\r\n  for (const filter of filters) {\r\n    const filters = [filter]\r\n\r\n    while (filters.length) {\r\n      const filter = filters.pop()!\r\n      const arts = filterArts(_arts, filter)\r\n      const count = countBuilds(arts)\r\n      if (count <= limit) {\r\n        if (count) yield filter\r\n        continue\r\n      }\r\n\r\n      const candidates = allSlotKeys\r\n        // TODO: Cache this loop\r\n        .map(slot => ({ slot, sets: new Set(arts.values[slot].map(x => x.set)) }))\r\n        .filter(({ sets }) => sets.size > 1)\r\n      if (!candidates.length) {\r\n        yield* splitFilterByIds(arts, filter, limit)\r\n        continue\r\n      }\r\n      const { sets, slot } = candidates.reduce((a, b) => a.sets.size < b.sets.size ? a : b)\r\n      sets.forEach(set => filters.push({ ...filter, [slot]: { kind: \"required\", sets: new Set([set]) } }))\r\n    }\r\n  }\r\n}\r\nfunction* splitFilterByIds(_arts: ArtifactsBySlot, filter: RequestFilter, limit: number): Iterable<RequestFilter> {\r\n  const filters = [filter]\r\n\r\n  while (filters.length) {\r\n    const filter = filters.pop()!\r\n    const arts = filterArts(_arts, filter)\r\n    const count = countBuilds(arts)\r\n    if (count <= limit) {\r\n      if (count) yield filter\r\n      continue\r\n    }\r\n\r\n    const candidates = allSlotKeys\r\n      .map(slot => ({ slot, length: arts.values[slot].length }))\r\n      .filter(x => x.length > 1)\r\n    const { slot, length } = candidates.reduce((a, b) => a.length < b.length ? a : b)\r\n\r\n    const numChunks = Math.ceil(count / limit)\r\n    const boundedNumChunks = Math.min(numChunks, length)\r\n    const chunk = Array(boundedNumChunks).fill(0).map(_ => new Set<string>())\r\n    arts.values[slot].forEach(({ id }, i) => chunk[i % boundedNumChunks].add(id))\r\n    if (numChunks > length) {\r\n      chunk.forEach(ids => filters.push({ ...filter, [slot]: { kind: \"id\", ids } }))\r\n    } else {\r\n      for (const ids of chunk)\r\n        yield { ...filter, [slot]: { kind: \"id\", ids } }\r\n    }\r\n  }\r\n}\r\n\r\n// const noFilter = { kind: \"exclude\" as const, sets: new Set<ArtifactSetKey>() }\r\n\r\nexport function debugCompute(nodes: NumNode[], base: DynStat, arts: ArtifactBuildData[]) {\r\n  const stats = { ...base }\r\n  for (const art of arts) {\r\n    for (const [key, value] of Object.entries(art.values)) {\r\n      stats[key] = (stats[key] ?? 0) + value\r\n    }\r\n  }\r\n  const data = { dyn: Object.fromEntries(Object.entries(stats).map(([key, value]) => [key, constant(value)])) } as Data\r\n  const uiData = computeUIData([data])\r\n  return {\r\n    base, arts, stats,\r\n    data, uiData,\r\n    nodes: nodes.map(formulaString),\r\n    results: nodes.map(node => uiData.get(node)),\r\n  }\r\n}\r\n","import { faCalculator } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { Close } from '@mui/icons-material';\r\nimport { Alert, Box, Button, ButtonGroup, CardContent, Divider, Grid, Link, MenuItem, Skeleton, ToggleButton, Typography } from '@mui/material';\r\nimport React, { Suspense, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\n// eslint-disable-next-line\r\nimport Worker from \"worker-loader!./BackgroundWorker\";\r\nimport ArtifactLevelSlider from '../../../../Components/Artifact/ArtifactLevelSlider';\r\nimport BootstrapTooltip from '../../../../Components/BootstrapTooltip';\r\nimport CardLight from '../../../../Components/Card/CardLight';\r\nimport CharacterCard from '../../../../Components/Character/CharacterCard';\r\nimport DropdownButton from '../../../../Components/DropdownMenu/DropdownButton';\r\nimport { HitModeToggle, ReactionToggle } from '../../../../Components/HitModeEditor';\r\nimport SolidToggleButtonGroup from '../../../../Components/SolidToggleButtonGroup';\r\nimport StatFilterCard from '../../../../Components/StatFilterCard';\r\nimport CharacterSheet from '../../../../Data/Characters/CharacterSheet';\r\nimport { DatabaseContext } from '../../../../Database/Database';\r\nimport { DataContext, dataContextObj } from '../../../../DataContext';\r\nimport { mergeData, uiDataForTeam } from '../../../../Formula/api';\r\nimport { uiInput as input } from '../../../../Formula/index';\r\nimport { optimize } from '../../../../Formula/optimization';\r\nimport { NumNode } from '../../../../Formula/type';\r\nimport { UIData } from '../../../../Formula/uiData';\r\nimport { initGlobalSettings } from '../../../../GlobalSettings';\r\nimport KeyMap from '../../../../KeyMap';\r\nimport useCharacterReducer, { characterReducerAction } from '../../../../ReactHooks/useCharacterReducer';\r\nimport useDBState from '../../../../ReactHooks/useDBState';\r\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate';\r\nimport useTeamData, { getTeamData } from '../../../../ReactHooks/useTeamData';\r\nimport { ICachedArtifact, MainStatKey } from '../../../../Types/artifact';\r\nimport { ICachedCharacter } from '../../../../Types/character';\r\nimport { ArtifactSetKey, CharacterKey, SlotKey } from '../../../../Types/consts';\r\nimport { objPathValue, range } from '../../../../Util/Util';\r\nimport { Build, ChartData, Finalize, FinalizeResult, Request, Setup, WorkerResult } from './background';\r\nimport { maxBuildsToShowList } from './Build';\r\nimport { buildSettingsReducer, initialBuildSettings } from './BuildSetting';\r\nimport { countBuilds, filterArts, mergeBuilds, mergePlot, pruneAll } from './common';\r\nimport ArtifactSetConditional from './Components/ArtifactSetConditional';\r\nimport ArtifactSetPicker from './Components/ArtifactSetPicker';\r\nimport AssumeFullLevelToggle from './Components/AssumeFullLevelToggle';\r\nimport BonusStatsCard from './Components/BonusStatsCard';\r\nimport BuildAlert, { warningBuildNumber } from './Components/BuildAlert';\r\nimport BuildDisplayItem from './Components/BuildDisplayItem';\r\nimport ChartCard from './Components/ChartCard';\r\nimport MainStatSelectionCard from './Components/MainStatSelectionCard';\r\nimport OptimizationTargetSelector from './Components/OptimizationTargetSelector';\r\nimport UseEquipped from './Components/UseEquipped';\r\nimport UseExcluded from './Components/UseExcluded';\r\nimport { defThreads, useOptimizeDBState } from './DBState';\r\nimport { artSetPerm, compactArtifacts, dynamicData, splitFiltersBySet } from './foreground';\r\n\r\nexport default function TabBuild() {\r\n  const { character, character: { key: characterKey } } = useContext(DataContext)\r\n  const [{ tcMode }] = useDBState(\"GlobalSettings\", initGlobalSettings)\r\n  const { database } = useContext(DatabaseContext)\r\n\r\n  const [generatingBuilds, setgeneratingBuilds] = useState(false)\r\n  const [generationProgress, setgenerationProgress] = useState(0)\r\n  const [generationDuration, setgenerationDuration] = useState(0)//in ms\r\n  const [generationSkipped, setgenerationSkipped] = useState(0)\r\n\r\n  const [chartData, setchartData] = useState(undefined as ChartData | undefined)\r\n\r\n  const [artsDirty, setArtsDirty] = useForceUpdate()\r\n\r\n  const [{ equipmentPriority, threads = defThreads }, setOptimizeDBState] = useOptimizeDBState()\r\n  const maxWorkers = threads > defThreads ? defThreads : threads\r\n  const setMaxWorkers = useCallback(threads => setOptimizeDBState({ threads }), [setOptimizeDBState],)\r\n\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const buildSettings = character?.buildSettings ?? initialBuildSettings()\r\n  const { plotBase, setFilters, statFilters, mainStatKeys, optimizationTarget, mainStatAssumptionLevel, useExcludedArts, useEquippedArts, builds, buildDate, maxBuildsToShow, levelLow, levelHigh } = buildSettings\r\n  const buildsArts = useMemo(() => builds.map(build => build.map(i => database._getArt(i)!)), [builds, database])\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\r\n  const { characterSheet, target: data } = teamData?.[characterKey as CharacterKey] ?? {}\r\n  const compareData = character?.compareData ?? false\r\n\r\n  const noArtifact = useMemo(() => !database._getArts().length, [database])\r\n\r\n  const buildSettingsDispatch = useCallback((action) =>\r\n    characterDispatch && characterDispatch({ buildSettings: buildSettingsReducer(buildSettings, action) })\r\n    , [characterDispatch, buildSettings])\r\n\r\n  const onChangeMainStatKey = useCallback((slotKey: SlotKey, mainStatKey?: MainStatKey) => {\r\n    if (mainStatKey === undefined) buildSettingsDispatch({ type: \"mainStatKeyReset\", slotKey })\r\n    else buildSettingsDispatch({ type: \"mainStatKey\", slotKey, mainStatKey })\r\n  }, [buildSettingsDispatch])\r\n\r\n  //register changes in artifact database\r\n  useEffect(() =>\r\n    database.followAnyArt(setArtsDirty),\r\n    [setArtsDirty, database])\r\n\r\n  const { split, setPerms, totBuildNumber } = useMemo(() => {\r\n    if (!characterKey) // Make sure we have all slotKeys\r\n      return { totBuildNumber: 0 }\r\n    let cantTakeList: CharacterKey[] = []\r\n    if (useEquippedArts) {\r\n      const index = equipmentPriority.indexOf(characterKey)\r\n      if (index < 0) cantTakeList = [...equipmentPriority]\r\n      else cantTakeList = equipmentPriority.slice(0, index)\r\n    }\r\n    const arts = database._getArts().filter(art => {\r\n      if (art.level < levelLow) return false\r\n      if (art.level > levelHigh) return false\r\n      const mainStats = mainStatKeys[art.slotKey]\r\n      if (mainStats?.length && !mainStats.includes(art.mainStatKey)) return false\r\n\r\n      // If its equipped on the selected character, bypass the check\r\n      if (art.location === characterKey) return true\r\n\r\n      if (art.exclude && !useExcludedArts) return false\r\n      if (art.location && !useEquippedArts) return false\r\n      if (art.location && useEquippedArts && cantTakeList.includes(art.location)) return false\r\n      return true\r\n    })\r\n    const split = compactArtifacts(arts, mainStatAssumptionLevel)\r\n    const setPerms = [...artSetPerm([setFilters.map(({ key, num }) => ({ key, min: num }))])]\r\n    const totBuildNumber = [...setPerms].map(perm => countBuilds(filterArts(split, perm))).reduce((a, b) => a + b, 0)\r\n    return artsDirty && { split, setPerms, totBuildNumber }\r\n  }, [characterKey, useExcludedArts, useEquippedArts, equipmentPriority, mainStatKeys, setFilters, levelLow, levelHigh, artsDirty, database, mainStatAssumptionLevel])\r\n\r\n  // Reset the Alert by setting progress to zero.\r\n  useEffect(() => {\r\n    setgenerationProgress(0)\r\n  }, [totBuildNumber])\r\n\r\n  // Provides a function to cancel the work\r\n  const cancelToken = useRef(() => { })\r\n  //terminate worker when component unmounts\r\n  useEffect(() => () => cancelToken.current(), [])\r\n  const generateBuilds = useCallback(async () => {\r\n    if (!characterKey || !optimizationTarget || !split || !setPerms) return\r\n    const teamData = await getTeamData(database, characterKey, mainStatAssumptionLevel, [])\r\n    if (!teamData) return\r\n    const workerData = uiDataForTeam(teamData.teamData, characterKey)[characterKey as CharacterKey]?.target.data![0]\r\n    if (!workerData) return\r\n    Object.assign(workerData, mergeData([workerData, dynamicData])) // Mark art fields as dynamic\r\n    let optimizationTargetNode = objPathValue(workerData.display ?? {}, optimizationTarget) as NumNode | undefined\r\n    if (!optimizationTargetNode) return\r\n    const targetNode = optimizationTargetNode\r\n    const valueFilter: { value: NumNode, minimum: number }[] = Object.entries(statFilters).map(([key, value]) => {\r\n      if (key.endsWith(\"_\")) value = value / 100 // TODO: Conversion\r\n      return { value: input.total[key], minimum: value }\r\n    }).filter(x => x.value && x.minimum > -Infinity)\r\n\r\n    const t1 = performance.now()\r\n    setgeneratingBuilds(true)\r\n    setchartData(undefined)\r\n    setgenerationDuration(0)\r\n    setgenerationProgress(0)\r\n    setgenerationSkipped(0)\r\n\r\n    const cancelled = new Promise<void>(r => cancelToken.current = r)\r\n\r\n    let nodes = [...valueFilter.map(x => x.value), optimizationTargetNode], arts = split!\r\n    const origCount = totBuildNumber, minimum = [...valueFilter.map(x => x.minimum), -Infinity]\r\n    if (plotBase) {\r\n      nodes.push(input.total[plotBase])\r\n      minimum.push(-Infinity)\r\n    }\r\n\r\n    nodes = optimize(nodes, workerData, ({ path: [p] }) => p !== \"dyn\");\r\n    ({ nodes, arts } = pruneAll(nodes, minimum, arts, maxBuildsToShow,\r\n      new Set(setFilters.map(x => x.key as ArtifactSetKey)), {\r\n      reaffine: true, pruneArtRange: true, pruneNodeRange: true, pruneOrder: true\r\n    }))\r\n\r\n    const plotBaseNode = plotBase ? nodes.pop() : undefined\r\n    optimizationTargetNode = nodes.pop()!\r\n\r\n    let wrap = {\r\n      buildCount: 0, failedCount: 0, skippedCount: origCount,\r\n      buildValues: Array(maxBuildsToShow).fill(0).map(_ => -Infinity)\r\n    }\r\n    setPerms.forEach(filter => wrap.skippedCount -= countBuilds(filterArts(arts, filter)))\r\n\r\n    const setPerm = splitFiltersBySet(arts, setPerms,\r\n      maxWorkers === 1\r\n        // Don't split for single worker\r\n        ? Infinity\r\n        // 8 perms / worker, up to 1M builds / perm\r\n        : Math.min(origCount / maxWorkers / 4, 1_000_000))[Symbol.iterator]()\r\n\r\n    function fetchWork(): Request | undefined {\r\n      const { done, value } = setPerm.next()\r\n      return done ? undefined : {\r\n        command: \"request\",\r\n        threshold: wrap.buildValues[maxBuildsToShow - 1], filter: value,\r\n      }\r\n    }\r\n\r\n    const filters = nodes\r\n      .map((value, i) => ({ value, min: minimum[i] }))\r\n      .filter(x => x.min > -Infinity)\r\n\r\n    const finalizedList: Promise<FinalizeResult>[] = []\r\n    for (let i = 0; i < maxWorkers; i++) {\r\n      const worker = new Worker()\r\n\r\n      const setup: Setup = {\r\n        command: \"setup\",\r\n        id: `${i}`,\r\n        arts,\r\n        optimizationTarget: optimizationTargetNode,\r\n        plotBase: plotBaseNode,\r\n        maxBuilds: maxBuildsToShow,\r\n        filters\r\n      }\r\n      worker.postMessage(setup, undefined)\r\n      let finalize: (_: FinalizeResult) => void\r\n      const finalized = new Promise<FinalizeResult>(r => finalize = r)\r\n      worker.onmessage = async ({ data }: { data: WorkerResult }) => {\r\n        switch (data.command) {\r\n          case \"interim\":\r\n            wrap.buildCount += data.buildCount\r\n            wrap.failedCount += data.failedCount\r\n            wrap.skippedCount += data.skippedCount\r\n            if (data.buildValues) {\r\n              wrap.buildValues.push(...data.buildValues)\r\n              wrap.buildValues.sort((a, b) => b - a).splice(maxBuildsToShow)\r\n            }\r\n            break\r\n          case \"request\":\r\n            const work = fetchWork()\r\n            if (work) {\r\n              worker.postMessage(work)\r\n            } else {\r\n              const finalizeCommand: Finalize = { command: \"finalize\" }\r\n              worker.postMessage(finalizeCommand)\r\n            }\r\n            break\r\n          case \"finalize\":\r\n            worker.terminate()\r\n            finalize(data);\r\n            break\r\n          default: console.log(\"DEBUG\", data)\r\n        }\r\n      }\r\n\r\n      cancelled.then(() => worker.terminate())\r\n      finalizedList.push(finalized)\r\n    }\r\n\r\n    const buildTimer = setInterval(() => {\r\n      setgenerationProgress(wrap.buildCount)\r\n      setgenerationSkipped(wrap.skippedCount)\r\n      setgenerationDuration(performance.now() - t1)\r\n    }, 100)\r\n    const results = await Promise.any([Promise.all(finalizedList), cancelled])\r\n    clearInterval(buildTimer)\r\n    cancelToken.current = () => { }\r\n\r\n    if (!results) {\r\n      setgenerationDuration(0)\r\n      setgenerationProgress(0)\r\n      setgenerationSkipped(0)\r\n    } else {\r\n      if (plotBase) {\r\n        const plotData = mergePlot(results.map(x => x.plotData!))\r\n        const plotBaseNode = input.total[plotBase] as NumNode\r\n        let data = Object.values(plotData)\r\n        if (KeyMap.unit(targetNode.info?.key) === \"%\")\r\n          data = data.map(({ value, plot }) => ({ value: value * 100, plot })) as Build[]\r\n        if (KeyMap.unit(plotBaseNode!.info?.key) === \"%\")\r\n          data = data.map(({ value, plot }) => ({ value, plot: (plot ?? 0) * 100 })) as Build[]\r\n        setchartData({\r\n          valueNode: targetNode,\r\n          plotNode: plotBaseNode,\r\n          data\r\n        })\r\n      }\r\n      const builds = mergeBuilds(results.map(x => x.builds), maxBuildsToShow)\r\n      if (process.env.NODE_ENV === \"development\") console.log(\"Build Result\", builds)\r\n      buildSettingsDispatch({ builds: builds.map(build => build.artifactIds), buildDate: Date.now() })\r\n      const totalDuration = performance.now() - t1\r\n\r\n      setgenerationProgress(wrap.buildCount)\r\n      setgenerationSkipped(wrap.skippedCount)\r\n      setgenerationDuration(totalDuration)\r\n    }\r\n    setgeneratingBuilds(false)\r\n  }, [characterKey, database, totBuildNumber, mainStatAssumptionLevel, maxBuildsToShow, optimizationTarget, plotBase, setPerms, split, buildSettingsDispatch, setFilters, statFilters, maxWorkers])\r\n\r\n  const characterName = characterSheet?.name ?? \"Character Name\"\r\n\r\n  const setPlotBase = useCallback(plotBase => {\r\n    buildSettingsDispatch({ plotBase })\r\n    setchartData(undefined)\r\n  }, [buildSettingsDispatch])\r\n  const dataContext: dataContextObj | undefined = useMemo(() => {\r\n    return data && characterSheet && character && teamData && {\r\n      data,\r\n      characterSheet,\r\n      character,\r\n      mainStatAssumptionLevel,\r\n      teamData,\r\n      characterDispatch\r\n    }\r\n  }, [data, characterSheet, character, teamData, characterDispatch, mainStatAssumptionLevel])\r\n\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    {noArtifact && <Alert severity=\"warning\" variant=\"filled\"> Opps! It looks like you haven't added any artifacts to GO yet! You should go to the <Link component={RouterLink} to=\"/artifact\">Artifacts</Link> page and add some!</Alert>}\r\n    {/* Build Generator Editor */}\r\n    {dataContext && <DataContext.Provider value={dataContext}>\r\n\r\n      <Grid container spacing={1} >\r\n        {/* 1*/}\r\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          {/* character card */}\r\n          <Box><CharacterCard characterKey={characterKey} /></Box>\r\n        </Grid>\r\n\r\n        {/* 2 */}\r\n        <Grid item xs={12} sm={6} lg={3}>\r\n          <CardLight>\r\n            <CardContent  >\r\n              <Typography gutterBottom>Main Stat</Typography>\r\n              <BootstrapTooltip placement=\"top\" title={<Typography><strong>Level Assumption</strong> changes mainstat value to be at least a specific level. Does not change substats.</Typography>}>\r\n                <Box>\r\n                  <AssumeFullLevelToggle mainStatAssumptionLevel={mainStatAssumptionLevel} setmainStatAssumptionLevel={mainStatAssumptionLevel => buildSettingsDispatch({ mainStatAssumptionLevel })} disabled={generatingBuilds} />\r\n                </Box>\r\n              </BootstrapTooltip>\r\n            </CardContent>\r\n            {/* main stat selector */}\r\n            <MainStatSelectionCard\r\n              mainStatKeys={mainStatKeys}\r\n              onChangeMainStatKey={onChangeMainStatKey}\r\n              disabled={generatingBuilds}\r\n            />\r\n          </CardLight>\r\n        </Grid>\r\n\r\n        {/* 3 */}\r\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n\r\n          {/*Minimum Final Stat Filter */}\r\n          <StatFilterCard statFilters={statFilters} setStatFilters={sFs => buildSettingsDispatch({ statFilters: sFs })} disabled={generatingBuilds} />\r\n\r\n          <BonusStatsCard />\r\n\r\n          {/* use excluded */}\r\n          <UseExcluded disabled={generatingBuilds} useExcludedArts={useExcludedArts} buildSettingsDispatch={buildSettingsDispatch} artsDirty={artsDirty} />\r\n\r\n          {/* use equipped */}\r\n          <UseEquipped disabled={generatingBuilds} useEquippedArts={useEquippedArts} buildSettingsDispatch={buildSettingsDispatch} />\r\n\r\n          { /* Level Filter */}\r\n          <CardLight>\r\n            <CardContent sx={{ py: 1 }}>\r\n              Artifact Level Filter\r\n            </CardContent>\r\n            <ArtifactLevelSlider levelLow={levelLow} levelHigh={levelHigh}\r\n              setLow={levelLow => buildSettingsDispatch({ levelLow })}\r\n              setHigh={levelHigh => buildSettingsDispatch({ levelHigh })}\r\n              setBoth={(levelLow, levelHigh) => buildSettingsDispatch({ levelLow, levelHigh })}\r\n              disabled={generatingBuilds}\r\n            />\r\n          </CardLight>\r\n        </Grid>\r\n\r\n        {/* 4 */}\r\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          <ArtifactSetConditional disabled={generatingBuilds} />\r\n\r\n          {/* Artifact set pickers */}\r\n          {setFilters.map((setFilter, index) => (index <= setFilters.filter(s => s.key).length) && <ArtifactSetPicker key={index} index={index} setFilters={setFilters}\r\n            disabled={generatingBuilds} onChange={(index, key, num) => buildSettingsDispatch({ type: 'setFilter', index, key, num })} />)}\r\n        </Grid>\r\n\r\n      </Grid>\r\n      {/* Footer */}\r\n      <Grid container spacing={1}>\r\n        <Grid item flexGrow={1} >\r\n          <ButtonGroup>\r\n            <Button\r\n              disabled={!characterKey || generatingBuilds || !optimizationTarget || !totBuildNumber || !objPathValue(data?.getDisplay(), optimizationTarget)}\r\n              color={(characterKey && totBuildNumber <= warningBuildNumber) ? \"success\" : \"warning\"}\r\n              onClick={generateBuilds}\r\n              startIcon={<FontAwesomeIcon icon={faCalculator} />}\r\n            >Generate Builds</Button>\r\n            <DropdownButton disabled={generatingBuilds || !characterKey}\r\n              title={<span><b>{maxBuildsToShow}</b> {maxBuildsToShow === 1 ? \"Build\" : \"Builds\"}</span>}>\r\n              <MenuItem>\r\n                <Typography variant=\"caption\" color=\"info.main\">\r\n                  Decreasing the number of generated build will decrease build calculation time for large number of builds.\r\n                </Typography>\r\n              </MenuItem>\r\n              <Divider />\r\n              {maxBuildsToShowList.map(v => <MenuItem key={v}\r\n                onClick={() => buildSettingsDispatch({ maxBuildsToShow: v })}>{v} {v === 1 ? \"Build\" : \"Builds\"}</MenuItem>)}\r\n            </DropdownButton>\r\n            <DropdownButton disabled={generatingBuilds || !characterKey}\r\n              title={<span><b>{maxWorkers}</b> {maxWorkers === 1 ? \"Thread\" : \"Threads\"}</span>}>\r\n              <MenuItem>\r\n                <Typography variant=\"caption\" color=\"info.main\">\r\n                  Increasing the number of threads will speed up build time, but will use more CPU power.\r\n                </Typography>\r\n              </MenuItem>\r\n              <Divider />\r\n              {range(1, defThreads).reverse().map(v => <MenuItem key={v}\r\n                onClick={() => setMaxWorkers(v)}>{v} {v === 1 ? \"Thread\" : \"Threads\"}</MenuItem>)}\r\n            </DropdownButton>\r\n            <Button\r\n              disabled={!generatingBuilds}\r\n              color=\"error\"\r\n              onClick={() => cancelToken.current()}\r\n              startIcon={<Close />}\r\n            >Cancel</Button>\r\n          </ButtonGroup>\r\n        </Grid>\r\n        <Grid item>\r\n          <span>Optimization Target: </span>\r\n          {<OptimizationTargetSelector\r\n            optimizationTarget={optimizationTarget}\r\n            setTarget={target => buildSettingsDispatch({ optimizationTarget: target })}\r\n            disabled={!!generatingBuilds}\r\n          />}\r\n        </Grid>\r\n      </Grid>\r\n\r\n      {!!characterKey && <Box >\r\n        <BuildAlert {...{ totBuildNumber, generatingBuilds, generationSkipped, generationProgress, generationDuration, characterName, maxBuildsToShow }} />\r\n      </Box>}\r\n      {tcMode && <Box >\r\n        <ChartCard disabled={generatingBuilds} chartData={chartData} plotBase={plotBase} setPlotBase={setPlotBase} />\r\n      </Box>}\r\n      <CardLight>\r\n        <CardContent>\r\n          <Box display=\"flex\" alignItems=\"center\" gap={1} mb={1} >\r\n            <Typography sx={{ flexGrow: 1 }}>\r\n              {builds ? <span>Showing <strong>{builds.length}</strong> Builds generated for {characterName}. {!!buildDate && <span>Build generated on: <strong>{(new Date(buildDate)).toLocaleString()}</strong></span>}</span>\r\n                : <span>Select a character to generate builds.</span>}\r\n            </Typography>\r\n            <Button disabled={!builds.length} color=\"error\" onClick={() => buildSettingsDispatch({ builds: [], buildDate: 0 })} >Clear Builds</Button>\r\n          </Box>\r\n          <Grid container display=\"flex\" spacing={1}>\r\n            <Grid item><HitModeToggle size=\"small\" /></Grid>\r\n            <Grid item><ReactionToggle size=\"small\" /></Grid>\r\n            <Grid item flexGrow={1} />\r\n            <Grid item><SolidToggleButtonGroup exclusive value={compareData} onChange={(e, v) => characterDispatch({ compareData: v })} size=\"small\">\r\n              <ToggleButton value={false} disabled={!compareData}>\r\n                <small>Show New artifact Stats</small>\r\n              </ToggleButton>\r\n              <ToggleButton value={true} disabled={compareData}>\r\n                <small>Compare against equipped artifacts</small>\r\n              </ToggleButton>\r\n            </SolidToggleButtonGroup></Grid>\r\n          </Grid>\r\n        </CardContent>\r\n      </CardLight>\r\n      <BuildList {...{ buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled: !!generatingBuilds }} />\r\n    </DataContext.Provider>}\r\n  </Box>\r\n}\r\nfunction BuildList({ buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled }: {\r\n  buildsArts: ICachedArtifact[][],\r\n  character?: ICachedCharacter,\r\n  characterKey?: \"\" | CharacterKey,\r\n  characterSheet?: CharacterSheet,\r\n  data?: UIData,\r\n  compareData: boolean,\r\n  mainStatAssumptionLevel: number,\r\n  characterDispatch: (action: characterReducerAction) => void\r\n  disabled: boolean,\r\n}) {\r\n  // Memoize the build list because calculating/rendering the build list is actually very expensive, which will cause longer optimization times.\r\n  const list = useMemo(() => <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n    {buildsArts?.map((build, index) => character && characterKey && characterSheet && data && <DataContextWrapper\r\n      key={index + build.join()}\r\n      characterKey={characterKey}\r\n      character={character}\r\n      build={build}\r\n      characterSheet={characterSheet}\r\n      oldData={data}\r\n      mainStatAssumptionLevel={mainStatAssumptionLevel}\r\n      characterDispatch={characterDispatch} >\r\n      <BuildDisplayItem index={index} compareBuild={compareData} disabled={disabled} />\r\n    </DataContextWrapper>\r\n    )}\r\n  </Suspense>, [buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled])\r\n  return list\r\n}\r\n\r\ntype Prop = {\r\n  children: React.ReactNode\r\n  characterKey: CharacterKey,\r\n  character: ICachedCharacter,\r\n  build: ICachedArtifact[],\r\n  mainStatAssumptionLevel?: number, characterSheet: CharacterSheet, oldData: UIData,\r\n  characterDispatch: (action: characterReducerAction) => void\r\n}\r\nfunction DataContextWrapper({ children, characterKey, character, build, characterDispatch, mainStatAssumptionLevel = 0, characterSheet, oldData }: Prop) {\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build)\r\n  if (!teamData) return null\r\n  return <DataContext.Provider value={{ characterSheet, character, characterDispatch, mainStatAssumptionLevel, data: teamData[characterKey]!.target, teamData, oldData }}>\r\n    {children}\r\n  </DataContext.Provider>\r\n}\r\n","import { faEdit, faSave } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { Favorite, FavoriteBorder } from \"@mui/icons-material\";\r\nimport { Badge, Box, Button, CardActionArea, CardContent, Divider, Grid, IconButton, Typography } from \"@mui/material\";\r\nimport React, { useContext, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Assets from \"../../../Assets/Assets\";\r\nimport ArtifactCardNano from \"../../../Components/Artifact/ArtifactCardNano\";\r\nimport CardLight from \"../../../Components/Card/CardLight\";\r\nimport ColorText from \"../../../Components/ColoredText\";\r\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\r\nimport ImgIcon from \"../../../Components/Image/ImgIcon\";\r\nimport { Stars } from \"../../../Components/StarDisplay\";\r\nimport StatIcon from \"../../../Components/StatIcon\";\r\nimport WeaponCardNano from \"../../../Components/Weapon/WeaponCardNano\";\r\nimport CharacterSheet from \"../../../Data/Characters/CharacterSheet\";\r\nimport { DataContext } from \"../../../DataContext\";\r\nimport { uiInput as input } from \"../../../Formula\";\r\nimport { ReadNode } from \"../../../Formula/type\";\r\nimport KeyMap, { valueString } from \"../../../KeyMap\";\r\nimport { amplifyingReactions, transformativeReactions } from \"../../../KeyMap/StatConstants\";\r\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\r\nimport { TalentSheetElementKey } from \"../../../Types/character\";\r\nimport { allElementsWithPhy, allSlotKeys, ElementKey } from \"../../../Types/consts\";\r\nimport { range } from \"../../../Util/Util\";\r\nimport CharacterCardPico from \"../../../Components/Character/CharacterCardPico\";\r\nimport StatInput from \"../../../Components/StatInput\";\r\n\r\nexport default function TabOverview() {\r\n  const { data, characterSheet, character, character: { key: characterKey } } = useContext(DataContext)\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const navigate = useNavigate()\r\n  const { t } = useTranslation(\"page_character\")\r\n  const charEle = data.get(input.charEle).value as ElementKey\r\n  const weaponTypeKey = characterSheet.weaponTypeKey\r\n  const level = data.get(input.lvl).value\r\n  const ascension = data.get(input.asc).value\r\n  const constellation = data.get(input.constellation).value\r\n  const tlvl = {\r\n    auto: data.get(input.total.auto).value,\r\n    skill: data.get(input.total.skill).value,\r\n    burst: data.get(input.total.burst).value,\r\n  }\r\n  const tBoost = {\r\n    auto: data.get(input.bonus.auto).value,\r\n    skill: data.get(input.bonus.skill).value,\r\n    burst: data.get(input.bonus.burst).value,\r\n  }\r\n  return <Grid container spacing={1} sx={{ justifyContent: \"center\" }}>\r\n    <Grid item xs={8} sm={5} md={4} lg={2.5}  >\r\n      {/* Image card with star and name and level */}\r\n      <CardLight >\r\n        <Box src={characterSheet.cardImg} component=\"img\" width=\"100%\" height=\"auto\" />\r\n        <CardContent>\r\n          <Typography variant=\"h5\" >\r\n            {characterSheet.name}&nbsp;\r\n            <ImgIcon sx={{ pr: 0.5 }} src={Assets.weaponTypes?.[weaponTypeKey]} />\r\n            {StatIcon[charEle]}\r\n            <IconButton sx={{ p: 0.5, mt: -0.5 }} onClick={() => characterDispatch({ favorite: !character.favorite })}>\r\n              {character.favorite ? <Favorite /> : <FavoriteBorder />}\r\n            </IconButton>\r\n          </Typography>\r\n          <Typography variant=\"h6\"><Stars stars={characterSheet.rarity} colored /></Typography>\r\n          <Typography variant=\"h5\">Lvl. {CharacterSheet.getLevelString(level, ascension)}</Typography>\r\n          <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"talent\")}>\r\n            <Grid container spacing={1} mt={-1}>\r\n              {([\"auto\", \"skill\", \"burst\"] as TalentSheetElementKey[]).map(tKey =>\r\n                <Grid item xs={4} key={tKey}>\r\n                  <Badge badgeContent={tlvl[tKey]} color={tBoost[tKey] ? \"info\" : \"secondary\"}\r\n                    overlap=\"circular\"\r\n                    anchorOrigin={{\r\n                      vertical: 'bottom',\r\n                      horizontal: 'right',\r\n                    }}\r\n                    sx={{\r\n                      width: \"100%\",\r\n                      height: \"100%\",\r\n                      \"& > .MuiBadge-badge\": {\r\n                        fontSize: \"1.25em\",\r\n                        padding: \".25em .4em\",\r\n                        borderRadius: \".5em\",\r\n                        lineHeight: 1,\r\n                        height: \"1.25em\"\r\n                      }\r\n                    }}>\r\n                    <Box component=\"img\" src={characterSheet.getTalentOfKey(tKey, charEle)?.img} width=\"100%\" height=\"auto\" />\r\n                  </Badge>\r\n                </Grid>)}\r\n            </Grid>\r\n          </CardActionArea>\r\n          <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{characterSheet.constellationName}</Typography>\r\n          <Grid container spacing={1}>\r\n            {range(1, 6).map(i =>\r\n              <Grid item xs={4} key={i}>\r\n                <CardActionArea onClick={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}>\r\n                  <Box component=\"img\" src={characterSheet.getTalentOfKey(`constellation${i}` as TalentSheetElementKey, charEle)?.img}\r\n                    sx={{\r\n                      ...(constellation >= i ? {} : { filter: \"brightness(50%)\" })\r\n                    }}\r\n                    width=\"100%\" height=\"auto\" />\r\n                </CardActionArea>\r\n              </Grid>)}\r\n          </Grid>\r\n          <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{t(\"teammates\")}</Typography>\r\n          <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"teambuffs\")}>\r\n            <Grid container columns={3} spacing={1}>\r\n              {range(0, 2).map(i => <Grid key={i} item xs={1} height=\"100%\"><CharacterCardPico characterKey={character.team[i]} index={i} /></Grid>)}\r\n            </Grid>\r\n          </CardActionArea>\r\n        </CardContent>\r\n      </CardLight>\r\n    </Grid>\r\n    <Grid item xs={12} sm={7} md={8} lg={9.5} sx={{\r\n      display: \"flex\", flexDirection: \"column\", gap: 1\r\n    }} >\r\n      <Grid container spacing={1} columns={{ xs: 2, sm: 2, md: 3, lg: 4, xl: 6 }}>\r\n        <Grid item xs={1}>\r\n          <WeaponCardNano weaponId={character.equippedWeapon} BGComponent={CardLight} onClick={() => navigate(\"equip\")} />\r\n        </Grid>\r\n        {allSlotKeys.map(slotKey =>\r\n          <Grid item key={slotKey} xs={1} >\r\n            <ArtifactCardNano artifactId={data.get(input.art[slotKey].id).value} slotKey={slotKey} BGComponent={CardLight} onClick={() => navigate(\"equip\")} />\r\n          </Grid>)}\r\n      </Grid>\r\n      <MainStatsCards />\r\n    </Grid>\r\n  </Grid >\r\n}\r\nconst EDIT = \"Edit Stats\"\r\nconst EXIT = \"EXIT\"\r\n\r\nconst mainBaseKeys = [\"atk\", \"hp\", \"def\"] as const\r\nconst mainSubKeys = [\"eleMas\", \"critRate_\", \"critDMG_\", \"enerRech_\", \"heal_\"] as const\r\nconst mainReadNodes = [...mainBaseKeys, ...mainSubKeys].map(k => input.total[k])\r\nconst mainEditKeys = [\"atk_\", \"atk\", \"hp_\", \"hp\", \"def_\", \"def\", ...mainSubKeys] as const\r\n\r\nconst otherStatReadNodes = [\r\n  ...allElementsWithPhy.map(ele => input.total[`${ele}_dmg_`]),\r\n  ...allElementsWithPhy.map(ele => input.total[`${ele}_res_`]),\r\n  ...([\"stamina\", \"incHeal_\", \"shield_\", \"cdRed_\"] as const).map(x => input.total[x])\r\n]\r\nconst otherStatKeys = otherStatReadNodes.map(x => x.info!.key!)\r\n\r\nconst miscStatReadNodes = [\r\n  input.total.all_dmg_,\r\n  ...allElementsWithPhy.map(x => input.total[`${x}_enemyRes_`]),\r\n  input.total.normal_dmg_, input.total.normal_critRate_,\r\n  input.total.charged_dmg_, input.total.charged_critRate_,\r\n  input.total.plunging_dmg_, input.total.plunging_critRate_,\r\n  input.total.skill_dmg_, input.total.skill_critRate_,\r\n  input.total.burst_dmg_, input.total.burst_critRate_,\r\n  ...Object.keys(transformativeReactions).map(x => input.total[`${x}_dmg_`]),\r\n  ...Object.keys(amplifyingReactions).map(x => input.total[`${x}_dmg_`]),\r\n  ...([\"moveSPD_\", \"atkSPD_\", \"weakspotDMG_\"] as const).map(x => input.total[x]),\r\n  input.total.dmgRed_\r\n]\r\nconst miscStatkeys = miscStatReadNodes.map(x => x.info!.key!)\r\n\r\nconst statBreakpoint = {\r\n  xs: 12, sm: 12, md: 6, lg: 4,\r\n} as const\r\n\r\nfunction StatDisplayContent({ nodes, statBreakpoint, extra }: { nodes: ReadNode<number>[], statBreakpoint: object, extra?: Displayable }) {\r\n  const { data, oldData } = useContext(DataContext)\r\n  return <Grid container columnSpacing={{ xs: 2, lg: 3 }} rowSpacing={1}>\r\n    {nodes.map(rn => <Grid item key={rn.info?.key} {...statBreakpoint} >\r\n      {<NodeFieldDisplay node={data.get(rn)} oldValue={oldData?.get(rn)?.value} />}\r\n    </Grid>)}\r\n    {extra}\r\n  </Grid>\r\n}\r\n\r\nfunction MainStatsCards() {\r\n  const { data, character, character: { key: characterKey } } = useContext(DataContext)\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const specialNode = data.get(input.special)\r\n\r\n  return <>\r\n    <StatDisplayCard\r\n      title=\"Main Stats\"\r\n      content={<StatDisplayContent statBreakpoint={statBreakpoint} nodes={mainReadNodes}\r\n        extra={specialNode && <Grid item {...statBreakpoint} display=\"flex\" flexDirection=\"row\" justifyContent=\"space-between\">\r\n          <span><b>Special:</b> <ColorText color={specialNode.info.variant}>{specialNode.info.key && StatIcon[specialNode.info.key]} {specialNode.info.key && KeyMap.get(specialNode.info.key)}</ColorText></span>\r\n          <span >{valueString(specialNode.value, specialNode.unit)}</span>\r\n        </Grid>}\r\n      />}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {mainEditKeys.map(statKey => {\r\n          const statName = KeyMap.get(statKey)\r\n          return <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              name={<span>{StatIcon[statKey]} {statName}</span>}\r\n              placeholder={KeyMap.getStr(statKey)}\r\n              value={character.bonusStats[statKey] ?? 0}\r\n              percent={KeyMap.unit(statKey) === \"%\"}\r\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>}\r\n    />\r\n    <StatDisplayCard\r\n      title=\"Other Stats\"\r\n      content={<StatDisplayContent statBreakpoint={statBreakpoint} nodes={otherStatReadNodes} />}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {otherStatKeys.map(statKey => {\r\n          const statName = KeyMap.get(statKey)\r\n          return <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              name={<span>{StatIcon[statKey]} {statName}</span>}\r\n              placeholder={KeyMap.getStr(statKey)}\r\n              value={character.bonusStats[statKey] ?? 0}\r\n              percent={KeyMap.unit(statKey) === \"%\"}\r\n              defaultValue={undefined}\r\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>}\r\n    />\r\n    <StatDisplayCard\r\n      title=\"Misc Stats\"\r\n      content={<StatDisplayContent statBreakpoint={{\r\n        xs: 12, sm: 12, md: 6,\r\n      }} nodes={miscStatReadNodes} />}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {miscStatkeys.map(statKey => {\r\n          const statName = KeyMap.get(statKey)\r\n          return <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              name={<span>{StatIcon[statKey]} {statName}</span>}\r\n              placeholder={KeyMap.getStr(statKey)}\r\n              value={character.bonusStats[statKey] ?? 0}\r\n              percent={KeyMap.unit(statKey) === \"%\"}\r\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>}\r\n    />\r\n  </>\r\n}\r\nfunction StatDisplayCard({ title, content, editContent }) {\r\n  const [edit, setedit] = useState(false)\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Box display=\"flex\" justifyContent=\"space-between\">\r\n        <Typography variant=\"subtitle1\">{title}</Typography>\r\n        <Button size=\"small\" color={edit ? \"error\" : \"info\"} onClick={() => setedit(!edit)} >\r\n          <span><FontAwesomeIcon icon={edit ? faSave : faEdit} /> {edit ? EXIT : EDIT}</span>\r\n        </Button>\r\n      </Box>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      {edit ? editContent : content}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { Box, CardActionArea, CardContent, Divider, Grid, MenuItem, Typography, useMediaQuery } from \"@mui/material\";\r\nimport { useTheme } from \"@mui/system\";\r\nimport React, { useCallback, useContext, useMemo } from 'react';\r\nimport CardDark from \"../../../Components/Card/CardDark\";\r\nimport CardLight from \"../../../Components/Card/CardLight\";\r\nimport ConditionalWrapper from \"../../../Components/ConditionalWrapper\";\r\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\r\nimport DropdownButton from \"../../../Components/DropdownMenu/DropdownButton\";\r\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\r\nimport { DataContext } from '../../../DataContext';\r\nimport { uiInput as input } from \"../../../Formula\";\r\nimport { NumNode } from \"../../../Formula/type\";\r\nimport { NodeDisplay } from '../../../Formula/uiData';\r\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\r\nimport { TalentSheetElementKey } from \"../../../Types/character\";\r\nimport { ElementKey } from \"../../../Types/consts\";\r\nimport { DocumentSection } from \"../../../Types/sheet\";\r\nimport { range } from \"../../../Util/Util\";\r\n\r\nconst talentSpacing = {\r\n  xs: 12,\r\n  sm: 6,\r\n  md: 4\r\n}\r\n\r\nexport default function CharacterTalentPane() {\r\n  const { data, character, characterSheet } = useContext(DataContext)\r\n  const characterDispatch = useCharacterReducer(character.key)\r\n  const skillBurstList = [[\"auto\", \"Normal/Charged Attack\"], [\"skill\", \"Elemental Skill\"], [\"burst\", \"Elemental Burst\"]] as [TalentSheetElementKey, string][]\r\n  const passivesList: [tKey: TalentSheetElementKey, tText: string, asc: number][] = [[\"passive1\", \"Unlocked at Ascension 1\", 1], [\"passive2\", \"Unlocked at Ascension 4\", 4], [\"passive3\", \"Unlocked by Default\", 0]]\r\n  const charEle = data.get(input.charEle).value as ElementKey | undefined\r\n  const ascension = data.get(input.asc).value\r\n  const constellation = data.get(input.constellation).value\r\n\r\n  const theme = useTheme();\r\n  const grlg = useMediaQuery(theme.breakpoints.up('lg'));\r\n  const constellationCards = useMemo(() => range(1, 6).map(i =>\r\n    <SkillDisplayCard\r\n      talentKey={`constellation${i}` as TalentSheetElementKey}\r\n      subtitle={`Constellation Lv. ${i}`}\r\n      onClickTitle={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}\r\n    />), [constellation, characterDispatch])\r\n  return <>\r\n    <ReactionDisplay />\r\n    <Grid container spacing={1}>\r\n      {/* constellations for 4column */}\r\n      {grlg && <Grid item xs={12} md={12} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\r\n        <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\r\n        {constellationCards.map((c, i) => <Box key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} >{c}</Box>)}\r\n      </Grid>}\r\n      <Grid item xs={12} md={12} lg={9} container spacing={1} >\r\n        {/* auto, skill, burst */}\r\n        {skillBurstList.map(([tKey, tText]) =>\r\n          <Grid item key={tKey} {...talentSpacing} >\r\n            <SkillDisplayCard\r\n              talentKey={tKey}\r\n              subtitle={tText}\r\n            />\r\n          </Grid>)}\r\n        {!!characterSheet.getTalentOfKey(\"sprint\", charEle) && <Grid item {...talentSpacing} >\r\n          <SkillDisplayCard\r\n            talentKey=\"sprint\"\r\n            subtitle=\"Alternative Sprint\"\r\n          />\r\n        </Grid>}\r\n        {!!characterSheet.getTalentOfKey(\"passive\", charEle) && <Grid item {...talentSpacing} >\r\n          <SkillDisplayCard\r\n            talentKey=\"passive\"\r\n            subtitle=\"Passive\"\r\n          />\r\n        </Grid>}\r\n        {/* passives */}\r\n        {passivesList.map(([tKey, tText, asc]) => {\r\n          let enabled = ascension >= asc\r\n          if (!characterSheet.getTalentOfKey(tKey, charEle)) return null\r\n          return <Grid item key={tKey} style={{ opacity: enabled ? 1 : 0.5 }} {...talentSpacing} >\r\n            <SkillDisplayCard\r\n              talentKey={tKey}\r\n              subtitle={tText}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>\r\n      {/* constellations for < 4 columns */}\r\n      {!grlg && <Grid item xs={12} md={12} lg={3} container spacing={1} >\r\n        <Grid item xs={12}>\r\n          <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\r\n        </Grid>\r\n        {constellationCards.map((c, i) => <Grid item key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} {...talentSpacing} >{c}</Grid>)}\r\n      </Grid>}\r\n    </Grid>\r\n  </>\r\n}\r\nfunction ReactionDisplay() {\r\n  const { data } = useContext(DataContext)\r\n  const reaction = data.getDisplay().reaction as { [key: string]: NodeDisplay }\r\n  return <CardLight sx={{ mb: 1 }}>\r\n    <CardContent>\r\n      <Grid container spacing={1}>\r\n        {Object.entries(reaction).map(([key, node]) => {\r\n          return <Grid item key={key}>\r\n            <CardDark><CardContent sx={{ p: 1, \"&:last-child\": { pb: 1 } }}>\r\n              <NodeFieldDisplay node={node} />\r\n            </CardContent></CardDark>\r\n          </Grid>\r\n        })}\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n\r\nconst talentLimits = [1, 1, 2, 4, 6, 8, 10]\r\ntype SkillDisplayCardProps = {\r\n  talentKey: TalentSheetElementKey,\r\n  subtitle: string,\r\n  onClickTitle?: (any) => any\r\n}\r\nfunction SkillDisplayCard({ talentKey, subtitle, onClickTitle }: SkillDisplayCardProps) {\r\n  const { data, character: { talent }, characterSheet, characterDispatch } = useContext(DataContext)\r\n\r\n  const actionWrapeprFunc = useCallback(\r\n    children => <CardActionArea onClick={onClickTitle}>{children}</CardActionArea>,\r\n    [onClickTitle],\r\n  )\r\n\r\n  let header: Displayable | null = null\r\n\r\n  if (talentKey in talent) {\r\n    const levelBoost = data.get(input.bonus[talentKey] as NumNode).value\r\n    const level = data.get(input.total[talentKey]).value\r\n    const asc = data.get(input.asc).value\r\n    const setTalentLevel = (tKey, newTalentLevelKey) => {\r\n      talent[tKey] = newTalentLevelKey\r\n      characterDispatch({ talent })\r\n    }\r\n    header = <>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <DropdownButton fullWidth title={`Talent Lv. ${level}`} color={levelBoost ? \"info\" : \"primary\"}>\r\n          {range(1, talentLimits[asc]).map(i =>\r\n            <MenuItem key={i} selected={talent[talentKey] === (i)} disabled={talent[talentKey] === (i)} onClick={() => setTalentLevel(talentKey, i)}>Talent Lv. {i + levelBoost}</MenuItem>)}\r\n        </DropdownButton>\r\n      </CardContent>\r\n      <Divider />\r\n    </>\r\n  }\r\n  const talentSheet = characterSheet.getTalentOfKey(talentKey, data.get(input.charEle).value as ElementKey | undefined)\r\n\r\n  // Hide header if the header matches the current talent\r\n  const hideHeader = (section: DocumentSection): boolean => {\r\n    let headerAction = section.header?.action\r\n    if (headerAction && (typeof headerAction !== \"string\")) {\r\n      const key: string = headerAction.props.children.props.key18\r\n      return key.includes(talentKey)\r\n    }\r\n    return false\r\n  }\r\n\r\n  return <CardLight sx={{ height: \"100%\" }}>\r\n    {header}\r\n    <CardContent>\r\n      <ConditionalWrapper condition={!!onClickTitle} wrapper={actionWrapeprFunc} >\r\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\r\n          <Grid item>\r\n            <Box component=\"img\" src={talentSheet?.img} sx={{ width: 60, height: \"auto\" }} />\r\n          </Grid>\r\n          <Grid item flexGrow={1} sx={{ pl: 1 }}>\r\n            <Typography variant=\"h6\">{talentSheet?.name}</Typography>\r\n            <Typography variant=\"subtitle1\">{subtitle}</Typography>\r\n          </Grid>\r\n        </Grid>\r\n      </ConditionalWrapper>\r\n      {/* Display document sections */}\r\n      {talentSheet?.sections ? <DocumentDisplay sections={talentSheet.sections} hideDesc hideHeader={hideHeader} /> : null}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { PersonAdd } from \"@mui/icons-material\";\r\nimport { CardContent, CardHeader, Divider, Grid, Typography } from \"@mui/material\";\r\nimport { Box } from \"@mui/system\";\r\nimport React, { useContext, useMemo } from 'react';\r\nimport CardLight from \"../../../Components/Card/CardLight\";\r\nimport CharacterCard from \"../../../Components/Character/CharacterCard\";\r\nimport CharacterAutocomplete from \"../../../Components/Character/CharacterAutocomplete\";\r\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\r\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\r\nimport InfoTooltip from \"../../../Components/InfoTooltip\";\r\nimport { ArtifactSheet } from \"../../../Data/Artifacts/ArtifactSheet\";\r\nimport { resonanceSheets } from \"../../../Data/Resonance\";\r\nimport { DataContext, dataContextObj } from \"../../../DataContext\";\r\nimport { uiInput as input } from \"../../../Formula\";\r\nimport { NodeDisplay } from \"../../../Formula/uiData\";\r\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\r\nimport useCharSelectionCallback from \"../../../ReactHooks/useCharSelectionCallback\";\r\nimport usePromise from \"../../../ReactHooks/usePromise\";\r\nimport { ElementKey } from \"../../../Types/consts\";\r\nimport { objPathValue, range } from \"../../../Util/Util\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nexport default function TabTeambuffs() {\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1} alignItems=\"stretch\">\r\n    <Grid container spacing={1}>\r\n      <Grid item xs={12} md={6} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <TeamBuffDisplay />\r\n        <ResonanceDisplay />\r\n      </Grid>\r\n      {range(0, 2).map(i => <Grid item xs={12} md={6} lg={3} key={i}>\r\n        <TeammateDisplay index={i} />\r\n      </Grid>)}\r\n    </Grid>\r\n  </Box>\r\n}\r\nexport function TeamBuffDisplay() {\r\n  const { data, oldData } = useContext(DataContext)\r\n  const teamBuffs = data.getTeamBuff()\r\n  const nodes: Array<[string[], NodeDisplay<number>]> = []\r\n  Object.entries(teamBuffs.total ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"total\", key], node]))\r\n  Object.entries(teamBuffs.premod ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"premod\", key], node]))\r\n  Object.entries(teamBuffs.enemy ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"enemy\", key], node]))\r\n  if (!nodes.length) return null\r\n  return <CardLight>\r\n    <CardContent>\r\n      Team Buffs\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      <Grid container>\r\n        {nodes.map(([path, n], i) => n && <Grid item xs={12} key={n.info.key} >\r\n          <NodeFieldDisplay node={n} oldValue={objPathValue(oldData?.getTeamBuff(), path)?.value} />\r\n        </Grid>)}\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\nfunction ResonanceDisplay() {\r\n  const { data } = useContext(DataContext)\r\n  return <>\r\n    {resonanceSheets.map((res, i) => {\r\n      const icon = <InfoTooltip title={<Typography>{res.desc}</Typography>} />\r\n      const title = <span>{res.name} {icon}</span>\r\n      return <CardLight key={i} sx={{ opacity: res.canShow(data) ? 1 : 0.5, }}>\r\n        <CardHeader title={title} action={res.icon} titleTypographyProps={{ variant: \"subtitle2\" }} />\r\n        {res.canShow(data) && <Divider />}\r\n        {res.canShow(data) && <CardContent>\r\n          <DocumentDisplay sections={res.sections} teamBuffOnly hideDesc />\r\n        </CardContent>}\r\n      </CardLight>\r\n    })}\r\n  </>\r\n}\r\nfunction TeammateDisplay({ index }: { index: number }) {\r\n  const dataContext = useContext(DataContext)\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: active, teamData, characterDispatch: activeCharacterDispatch } = dataContext\r\n  const activeCharacterKey = active.key\r\n  const characterKey = active.team[index]\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const onClickHandler = useCharSelectionCallback()\r\n\r\n  const dataBundle = teamData[characterKey]\r\n  const teamMateDataContext: dataContextObj | undefined = dataBundle && {\r\n    character: dataBundle.character,\r\n    characterSheet: dataBundle.characterSheet,\r\n    data: dataBundle.target,\r\n    teamData: teamData,\r\n    mainStatAssumptionLevel: 0,\r\n    characterDispatch\r\n  }\r\n  return <CardLight>\r\n    <CardContent>\r\n      <CharacterAutocomplete fullWidth value={characterKey}\r\n        onChange={charKey => activeCharacterDispatch({ type: \"team\", index, charKey })}\r\n        disable={ck => ck === activeCharacterKey || active.team.includes(ck)}\r\n        labelText={t(\"teammate\", { count: index + 1 })}\r\n        defaultText={t(\"none\")}\r\n        defaultIcon={<PersonAdd />}\r\n        showDefault\r\n      />\r\n    </CardContent>\r\n    {teamMateDataContext && <DataContext.Provider value={teamMateDataContext}>\r\n      <CharacterCard characterKey={characterKey}\r\n        onClickHeader={onClickHandler}\r\n        artifactChildren={<CharArtifactCondDisplay />}\r\n        weaponChildren={<CharWeaponCondDisplay />}\r\n        characterChildren={<CharTalentCondDisplay />}\r\n        isTeammateCard\r\n      />\r\n    </DataContext.Provider>}\r\n  </CardLight>\r\n\r\n}\r\nfunction CharArtifactCondDisplay() {\r\n  const { data, } = useContext(DataContext)\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const sections = useMemo(() => artifactSheets &&\r\n    Object.entries(ArtifactSheet.setEffects(artifactSheets, data))\r\n      .flatMap(([setKey, setNums]) =>\r\n        setNums.flatMap(sn => artifactSheets[setKey]!.setEffectDocument(sn)!))\r\n    , [artifactSheets, data])\r\n  if (!sections) return null\r\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\r\n}\r\nfunction CharWeaponCondDisplay() {\r\n  const { teamData, character: { key: charKey } } = useContext(DataContext)\r\n  const weaponSheet = teamData[charKey]!.weaponSheet\r\n  if (!weaponSheet.document) return null\r\n  return <DocumentDisplay sections={weaponSheet.document} teamBuffOnly={true} />\r\n}\r\nfunction CharTalentCondDisplay() {\r\n  const { data, teamData, character: { key: charKey } } = useContext(DataContext)\r\n  const characterSheet = teamData[charKey]!.characterSheet\r\n  const talent = characterSheet.getTalent(data.get(input.charEle).value as ElementKey)!\r\n  const sections = Object.values(talent.sheets).flatMap(sts => sts.sections)\r\n  if (!sections) return null\r\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\r\n}\r\n","import { Calculate, Checkroom, ExpandMore, FactCheck, Groups, Person } from '@mui/icons-material';\r\nimport { Accordion, AccordionDetails, AccordionSummary, Box, Button, ButtonGroup, Card, CardContent, CardHeader, Collapse, Divider, Grid, MenuItem, Skeleton, Tab, Tabs, Typography } from '@mui/material';\r\nimport { Suspense, useCallback, useContext, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Link as RouterLink, Navigate, Route, Routes, useMatch, useNavigate, useParams } from 'react-router-dom';\r\nimport CardDark from '../../Components/Card/CardDark';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport { CharacterSelectionModal } from '../../Components/Character/CharacterSelectionModal';\r\nimport ThumbSide from '../../Components/Character/ThumbSide';\r\nimport CloseButton from '../../Components/CloseButton';\r\nimport ColorText from '../../Components/ColoredText';\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from '../../Components/CustomNumberInput';\r\nimport DropdownButton from '../../Components/DropdownMenu/DropdownButton';\r\nimport { EnemyExpandCard } from '../../Components/EnemyEditor';\r\nimport ExpandButton from '../../Components/ExpandButton';\r\nimport { HitModeToggle, InfusionAuraDropdown, ReactionToggle } from '../../Components/HitModeEditor';\r\nimport ImgIcon from '../../Components/Image/ImgIcon';\r\nimport { ambiguousLevel, ascensionMaxLevel, milestoneLevels } from '../../Data/LevelData';\r\nimport { sgt } from '../../Data/SheetUtil';\r\nimport { DataContext, dataContextObj, TeamData } from '../../DataContext';\r\nimport { getDisplayHeader, getDisplaySections } from '../../Formula/DisplayUtil';\r\nimport { DisplaySub } from '../../Formula/type';\r\nimport { NodeDisplay } from '../../Formula/uiData';\r\nimport KeyMap, { valueString } from '../../KeyMap';\r\nimport useCharacterReducer from '../../ReactHooks/useCharacterReducer';\r\nimport useCharSelectionCallback from '../../ReactHooks/useCharSelectionCallback';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport useTeamData from '../../ReactHooks/useTeamData';\r\nimport useTitle from '../../ReactHooks/useTitle';\r\nimport { allCharacterKeys, CharacterKey } from '../../Types/consts';\r\nimport { clamp } from '../../Util/Util';\r\nimport TabEquip from './Tabs/TabEquip';\r\nimport TabBuild from './Tabs/TabOptimize';\r\nimport TabOverview from './Tabs/TabOverview';\r\nimport TabTalent from './Tabs/TabTalent';\r\nimport TabTeambuffs from './Tabs/TabTeambuffs';\r\n\r\nexport default function CharacterDisplay() {\r\n  const navigate = useNavigate();\r\n  let { characterKey } = useParams<{ characterKey?: CharacterKey }>();\r\n  const invalidKey = !allCharacterKeys.includes(characterKey as any ?? \"\")\r\n  if (invalidKey)\r\n    return <Navigate to=\"/characters\" />\r\n  return <Box my={1} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    {characterKey && <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />}>\r\n      <CharacterDisplayCard characterKey={characterKey} onClose={() => navigate(\"/characters\")} />\r\n    </Suspense>}\r\n  </Box>\r\n}\r\n\r\ntype CharacterDisplayCardProps = {\r\n  characterKey: CharacterKey,\r\n  newteamData?: TeamData,\r\n  mainStatAssumptionLevel?: number,\r\n  onClose?: (any) => void,\r\n}\r\nfunction CharacterDisplayCard({ characterKey, newteamData, mainStatAssumptionLevel = 0, onClose }: CharacterDisplayCardProps) {\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\r\n  const { character, characterSheet, target: charUIData } = teamData?.[characterKey] ?? {}\r\n  let { params: { tab = \"overview\" } } = useMatch({ path: \"/characters/:charKey/:tab\", end: false }) ?? { params: { tab: \"overview\" } }\r\n  const { t } = useTranslation()\r\n  useTitle(`${t(`char_${characterKey}_gen:name`)} - ${t(`page_character:tabs.${tab}`)}`)\r\n  const characterDispatch = useCharacterReducer(character?.key ?? \"\")\r\n  const { compareData } = character ?? {}\r\n\r\n  const dataContextValue: dataContextObj | undefined = useMemo(() => {\r\n    if (!teamData || !character || !characterSheet || !charUIData) return undefined\r\n    return {\r\n      character,\r\n      characterSheet,\r\n      mainStatAssumptionLevel,\r\n      data: (newteamData ? newteamData[characterKey]!.target : charUIData),\r\n      teamData: (newteamData ? newteamData : teamData),\r\n      oldData: (compareData && newteamData) ? charUIData : undefined,\r\n      characterDispatch\r\n    }\r\n  }, [character, characterSheet, mainStatAssumptionLevel, newteamData, charUIData, teamData, characterDispatch, characterKey, compareData])\r\n\r\n  if (!teamData || !character || !characterSheet || !charUIData || !dataContextValue) return <></>\r\n\r\n  return <CardDark >\r\n    <DataContext.Provider value={dataContextValue}>\r\n      <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <Grid container spacing={1}>\r\n          <Grid item>\r\n            <CharSelectDropdown />\r\n          </Grid>\r\n          <Grid item flexGrow={1} />\r\n          {!!mainStatAssumptionLevel && <Grid item><Card sx={{ p: 1, bgcolor: t => t.palette.warning.dark }}><Typography><strong>Assume Main Stats are Level {mainStatAssumptionLevel}</strong></Typography></Card></Grid>}\r\n          {!!onClose && <Grid item>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>}\r\n        </Grid>\r\n        <CardLight>\r\n          <TabNav tab={tab} />\r\n        </CardLight>\r\n        <FormulaCalcCard />\r\n        <EnemyExpandCard />\r\n        <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={500} />}>\r\n          <Routes>\r\n            {/* Character Panel */}\r\n            <Route index element={<TabOverview />} />\r\n            <Route path=\"/talent\" element={<TabTalent />} />\r\n            <Route path=\"/equip\" element={<TabEquip />} />\r\n            <Route path=\"/teambuffs\" element={<TabTeambuffs />} />\r\n            <Route path=\"/optimize\" element={<TabBuild />} />\r\n          </Routes>\r\n        </Suspense>\r\n        <CardLight>\r\n          <TabNav tab={tab} />\r\n        </CardLight>\r\n      </CardContent>\r\n    </DataContext.Provider>\r\n  </CardDark>\r\n}\r\nfunction TabNav({ tab }: { tab: string }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  return <Tabs\r\n    value={tab}\r\n    variant=\"scrollable\"\r\n    allowScrollButtonsMobile\r\n    sx={{\r\n      \"& .MuiTab-root:hover\": {\r\n        transition: \"background-color 0.25s ease\",\r\n        backgroundColor: \"rgba(255,255,255,0.1)\"\r\n      },\r\n    }}\r\n  >\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"overview\" label={t(\"tabs.overview\")} icon={<Person />} component={RouterLink} to=\"\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"talent\" label={t(\"tabs.talent\")} icon={<FactCheck />} component={RouterLink} to=\"talent\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"equip\" label={t(\"tabs.equip\")} icon={<Checkroom />} component={RouterLink} to=\"equip\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"teambuffs\" label={t(\"tabs.teambuffs\")} icon={<Groups />} component={RouterLink} to=\"teambuffs\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"optimize\" label={t(\"tabs.optimize\")} icon={<Calculate />} component={RouterLink} to=\"optimize\" />\r\n  </Tabs>\r\n}\r\n\r\nfunction CharSelectDropdown() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character, characterSheet, characterDispatch } = useContext(DataContext)\r\n  const [showModal, setshowModal] = useState(false)\r\n  const setCharacter = useCharSelectionCallback()\r\n  const setLevel = useCallback((level) => {\r\n    level = clamp(level, 1, 90)\r\n    const ascension = ascensionMaxLevel.findIndex(ascenML => level <= ascenML)\r\n    characterDispatch({ level, ascension })\r\n  }, [characterDispatch])\r\n  const setAscension = useCallback(() => {\r\n    if (!character) return\r\n    const { level = 1, ascension = 0 } = character\r\n    const lowerAscension = ascensionMaxLevel.findIndex(ascenML => level !== 90 && level === ascenML)\r\n    if (ascension === lowerAscension) characterDispatch({ ascension: ascension + 1 })\r\n    else characterDispatch({ ascension: lowerAscension })\r\n  }, [characterDispatch, character])\r\n  const { elementKey = \"anemo\", level = 1, ascension = 0 } = character\r\n  return <>\r\n    <CharacterSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={setCharacter} />\r\n    <Grid container spacing={1}>\r\n      <Grid item>\r\n        <Button color=\"info\" onClick={() => setshowModal(true)} startIcon={<ThumbSide src={characterSheet?.thumbImgSide} />} >{characterSheet?.name ?? t(\"selectCharacter\")}</Button>\r\n      </Grid>\r\n      <Grid item>\r\n        <ButtonGroup sx={{ bgcolor: t => t.palette.contentDark.main }} >\r\n          {characterSheet?.sheet && \"talents\" in characterSheet?.sheet && <DropdownButton title={<strong><ColorText color={elementKey}>{sgt(`element.${elementKey}`)}</ColorText></strong>}>\r\n            {Object.keys(characterSheet.sheet.talents).map(eleKey =>\r\n              <MenuItem key={eleKey} selected={elementKey === eleKey} disabled={elementKey === eleKey} onClick={() => characterDispatch({ elementKey: eleKey })}>\r\n                <strong><ColorText color={eleKey}>{sgt(`element.${eleKey}`)}</ColorText></strong></MenuItem>)}\r\n          </DropdownButton>}\r\n          <CustomNumberInputButtonGroupWrapper >\r\n            <CustomNumberInput onChange={setLevel} value={level}\r\n              startAdornment=\"Lv. \"\r\n              inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\" } }}\r\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }}\r\n              disabled={!characterSheet} />\r\n          </CustomNumberInputButtonGroupWrapper>\r\n          <Button sx={{ pl: 1 }} disabled={!ambiguousLevel(level) || !characterSheet} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\r\n          <DropdownButton title={t(\"selectLevel\")} disabled={!characterSheet}>\r\n            {milestoneLevels.map(([lv, as]) => {\r\n              const sameLevel = lv === ascensionMaxLevel[as]\r\n              const lvlstr = sameLevel ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevel[as]}`\r\n              const selected = lv === level && as === ascension\r\n              return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => characterDispatch({ level: lv, ascension: as })}>{lvlstr}</MenuItem>\r\n            })}\r\n          </DropdownButton>\r\n        </ButtonGroup>\r\n      </Grid>\r\n    </Grid>\r\n  </>\r\n}\r\n\r\nfunction FormulaCalcCard() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const [expanded, setexpanded] = useState(false)\r\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\r\n  return <CardLight>\r\n    <CardContent sx={{ display: \"flex\", gap: 1 }}>\r\n      <Grid container spacing={1}>\r\n        <Grid item><HitModeToggle size=\"small\" /></Grid>\r\n        <Grid item><InfusionAuraDropdown /></Grid>\r\n        <Grid item><ReactionToggle size=\"small\" /></Grid>\r\n      </Grid>\r\n      <Box display=\"flex\" gap={1} >\r\n        <Box>\r\n          <Typography variant='subtitle2' >{t(\"formulas\")} {\"&\"}</Typography>\r\n          <Typography variant='subtitle2' >{t(\"calculations\")}</Typography>\r\n        </Box>\r\n        <ExpandButton\r\n          expand={expanded}\r\n          onClick={toggle}\r\n          aria-expanded={expanded}\r\n          aria-label=\"show more\"\r\n          size=\"small\"\r\n          sx={{ p: 0 }}\r\n        >\r\n          <ExpandMore />\r\n        </ExpandButton>\r\n      </Box>\r\n    </CardContent>\r\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <CalculationDisplay />\r\n      </CardContent>\r\n    </Collapse>\r\n  </CardLight>\r\n}\r\n\r\nfunction CalculationDisplay() {\r\n  const { data } = useContext(DataContext)\r\n  const sections = getDisplaySections(data)\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />} >\r\n    <Box sx={{ mr: -1, mb: -1 }}>\r\n      {sections.map(([key, Nodes]) =>\r\n        <FormulaCalc key={key} displayNs={Nodes} sectionKey={key} />)}\r\n    </Box>\r\n  </Suspense>\r\n}\r\nfunction FormulaCalc({ sectionKey, displayNs }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\r\n  const { data } = useContext(DataContext)\r\n  const header = usePromise(getDisplayHeader(data, sectionKey), [data, sectionKey])\r\n  if (!header) return null\r\n  if (Object.entries(displayNs).every(([_, node]) => node.isEmpty)) return null\r\n  const { title, icon, action } = header\r\n  return <CardDark sx={{ mb: 1 }}>\r\n    <CardHeader avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action} titleTypographyProps={{ variant: \"subtitle1\" }} />\r\n    <Divider />\r\n    <CardContent>\r\n      {Object.entries(displayNs).map(([key, node]) =>\r\n        !node.isEmpty && <Accordion sx={{ bgcolor: \"contentLight.main\" }} key={key}>\r\n          <AccordionSummary expandIcon={<ExpandMore />}>\r\n            <Typography><ColorText color={node.info.variant}>{KeyMap.get(node.info.key ?? \"\")}</ColorText> <strong>{valueString(node.value, node.unit)}</strong></Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n            {node.formulas.map((subform, i) => <Typography key={i}>{subform}</Typography>)}\r\n          </AccordionDetails>\r\n        </Accordion>)}\r\n    </CardContent>\r\n  </CardDark>\r\n}\r\n","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { BusinessCenter, Lock, LockOpen } from \"@mui/icons-material\"\r\nimport { Box, Button, ButtonGroup, CardActionArea, CardContent, IconButton, Skeleton, Tooltip, Typography } from \"@mui/material\"\r\nimport { Suspense, useCallback, useContext, useMemo } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../Assets/Assets\"\r\nimport CardLight from \"../Components/Card/CardLight\"\r\nimport CharacterAutocomplete from '../Components/Character/CharacterAutocomplete'\r\nimport LocationName from \"../Components/Character/LocationName\"\r\nimport ConditionalWrapper from \"../Components/ConditionalWrapper\"\r\nimport ImgIcon from \"../Components/Image/ImgIcon\"\r\nimport { Stars } from \"../Components/StarDisplay\"\r\nimport StatIcon from \"../Components/StatIcon\"\r\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\"\r\nimport { ascensionMaxLevel } from \"../Data/LevelData\"\r\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\"\r\nimport { DatabaseContext } from \"../Database/Database\"\r\nimport { uiInput as input } from \"../Formula\"\r\nimport { computeUIData, dataObjForWeapon } from \"../Formula/api\"\r\nimport KeyMap, { valueString } from \"../KeyMap\"\r\nimport usePromise from \"../ReactHooks/usePromise\"\r\nimport useWeapon from \"../ReactHooks/useWeapon\"\r\nimport { CharacterKey } from \"../Types/consts\"\r\n\r\ntype WeaponCardProps = { weaponId: string, onClick?: (weaponId: string) => void, onEdit?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, canEquip?: boolean, extraButtons?: JSX.Element }\r\nexport default function WeaponCard({ weaponId, onClick, onEdit, onDelete, canEquip = false, extraButtons }: WeaponCardProps) {\r\n  const { t } = useTranslation([\"page_weapon\", \"ui\"]);\r\n  const { database } = useContext(DatabaseContext)\r\n  const databaseWeapon = useWeapon(weaponId)\r\n  const weapon = databaseWeapon\r\n  const weaponSheet = usePromise(weapon?.key ? WeaponSheet.get(weapon.key) : undefined, [weapon?.key])\r\n\r\n  const filter = useCallback(\r\n    (cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType,\r\n    [weaponSheet],\r\n  )\r\n\r\n  const wrapperFunc = useCallback(children => <CardActionArea onClick={() => onClick?.(weaponId)} >{children}</CardActionArea>, [onClick, weaponId],)\r\n  const falseWrapperFunc = useCallback(children => <Box >{children}</Box>, [])\r\n\r\n  const equipOnChar = useCallback((charKey: CharacterKey | \"\") => database.setWeaponLocation(weaponId, charKey), [database, weaponId],)\r\n\r\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\r\n\r\n  if (!weapon || !weaponSheet || !UIData) return null;\r\n  const { level, ascension, refinement, id, location = \"\", lock } = weapon\r\n  const weaponTypeKey = UIData.get(input.weapon.type).value!\r\n  const stats = [input.weapon.main, input.weapon.sub, input.weapon.sub2].map(x => UIData.get(x))\r\n  const img = ascension < 2 ? weaponSheet?.img : weaponSheet?.imgAwaken\r\n\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 300 }} />}>\r\n    <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\", justifyContent: \"space-between\" }}>\r\n      <ConditionalWrapper condition={!!onClick} wrapper={wrapperFunc} falseWrapper={falseWrapperFunc}>\r\n        <Box className={`grad-${weaponSheet.rarity}star`} sx={{ position: \"relative\", pt: 2, px: 2, }}>\r\n          {!onClick && <IconButton color=\"primary\" onClick={() => database.updateWeapon({ lock: !lock }, id)} sx={{ position: \"absolute\", right: 0, bottom: 0, zIndex: 2 }}>\r\n            {lock ? <Lock /> : <LockOpen />}\r\n          </IconButton>}\r\n          <Box sx={{ position: \"relative\", zIndex: 1 }}>\r\n            <Box component=\"div\" sx={{ display: \"flex\", alignItems: \"center\", gap: 1, mb: 1 }}>\r\n              <ImgIcon sx={{ fontSize: \"1.5em\" }} src={Assets.weaponTypes?.[weaponTypeKey]} />\r\n              <Typography noWrap sx={{ textAlign: \"center\", backgroundColor: \"rgba(100,100,100,0.35)\", borderRadius: \"1em\", px: 1 }}><strong>{weaponSheet.name}</strong></Typography>\r\n            </Box>\r\n            <Typography component=\"span\" variant=\"h5\">Lv. {level}</Typography>\r\n            <Typography component=\"span\" variant=\"h5\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\r\n            <Typography variant=\"h6\">Refinement <strong>{refinement}</strong></Typography>\r\n            <Typography><Stars stars={weaponSheet.rarity} colored /></Typography>\r\n          </Box>\r\n          <Box sx={{ height: \"100%\", position: \"absolute\", right: 0, top: 0 }}>\r\n            <Box\r\n              component=\"img\"\r\n              src={img ?? \"\"}\r\n              width=\"auto\"\r\n              height=\"100%\"\r\n              sx={{ float: \"right\" }}\r\n            />\r\n          </Box>\r\n        </Box>\r\n        <CardContent>\r\n          {stats.map(node => {\r\n            if (!node.info.key) return null\r\n            const displayVal = valueString(node.value, node.unit, !node.unit ? 0 : undefined)\r\n            return <Box key={node.info.key} sx={{ display: \"flex\" }}>\r\n              <Typography flexGrow={1}>{StatIcon[node.info.key!]} {KeyMap.get(node.info.key)}</Typography>\r\n              <Typography>{displayVal}</Typography>\r\n            </Box>\r\n          })}\r\n        </CardContent>\r\n      </ConditionalWrapper>\r\n      <Box sx={{ p: 1, display: \"flex\", gap: 1, justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n        {canEquip\r\n          ? <CharacterAutocomplete size=\"small\" sx={{ flexGrow: 1 }}\r\n            showDefault defaultIcon={<BusinessCenter />} defaultText={t(\"inventory\")}\r\n            value={location} onChange={equipOnChar} filter={filter} />\r\n          : <LocationName location={location} />}\r\n        <ButtonGroup>\r\n          {!!onEdit && <Tooltip title={<Typography>{t`page_weapon:edit`}</Typography>} placement=\"top\" arrow>\r\n            <Button color=\"info\" onClick={() => onEdit(id)} >\r\n              <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\r\n            </Button>\r\n          </Tooltip>}\r\n          {!!onDelete && <Button color=\"error\" onClick={() => onDelete(id)} disabled={!!location || lock} >\r\n            <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\r\n          </Button>}\r\n          {extraButtons}\r\n        </ButtonGroup>\r\n      </Box>\r\n    </CardLight>\r\n  </Suspense>\r\n}\r\n","import { useContext, useEffect, useState } from \"react\";\r\nimport { DatabaseContext } from \"../Database/Database\";\r\n\r\nexport default function useWeapon(weaponID: string | undefined = \"\") {\r\n  const { database } = useContext(DatabaseContext)\r\n  const [weapon, setWeapon] = useState(database._getWeapon(weaponID))\r\n  useEffect(() => setWeapon(database._getWeapon(weaponID)), [database, weaponID])\r\n  useEffect(() =>\r\n    weaponID ? database.followWeapon(weaponID, setWeapon) : undefined,\r\n    [weaponID, setWeapon, database])\r\n  return weapon\r\n}\r\n","import { strPadLeft } from \"./Util\"\r\n\r\nexport const SECOND_MS = 1000\r\nexport const MINUTE_MS = 60 * SECOND_MS\r\nexport const HOUR_MS = 60 * MINUTE_MS\r\nexport const DAY_MS = 24 * HOUR_MS\r\n\r\nexport function msToUnits(ms: number) {\r\n  let milliseconds = ms % 1000\r\n  let seconds = Math.floor((ms / 1000) % 60)\r\n  let minutes = Math.floor((ms / (1000 * 60)) % 60)\r\n  let hours = Math.floor((ms / (1000 * 60 * 60)))\r\n  return { hours, minutes, seconds, milliseconds }\r\n}\r\nexport function timeString(ms: number) {\r\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\r\n  let { hours, minutes, seconds } = msToUnits(ms)\r\n  let timeText = \"Minutes\"\r\n  if (hours) timeText = \"Hours\"\r\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)} ${timeText}`;\r\n}\r\nexport function timeStringMs(ms: number) {\r\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\r\n  let { hours, minutes, seconds, milliseconds } = msToUnits(ms)\r\n  let timeText = \"Minutes\"\r\n  if (hours) timeText = \"Hours\"\r\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)}.${strPadLeft(milliseconds, '0', 3)} ${timeText}`;\r\n}\r\n","import { WeaponKey } from \"../Types/consts\";\r\nimport { ICachedWeapon } from \"../Types/weapon\";\r\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\";\r\nimport { FilterConfigs, SortConfigs } from \"./SortByFilters\";\r\nexport const weaponSortKeys = [\"level\", \"rarity\"]\r\nexport type WeaponSortKey = typeof weaponSortKeys[number]\r\n\r\nexport function weaponSortConfigs(weaponSheets: Record<WeaponKey, WeaponSheet>): SortConfigs<WeaponSortKey, ICachedWeapon> {\r\n  return {\r\n    level: {\r\n      getValue: wp => wp.level ?? 0,\r\n      tieBreaker: \"rarity\"\r\n    },\r\n    rarity: {\r\n      getValue: wp => weaponSheets?.[wp.key]?.rarity,\r\n      tieBreaker: \"level\"\r\n    }\r\n  }\r\n}\r\nexport function weaponFilterConfigs(weaponSheets: Record<WeaponKey, WeaponSheet>): FilterConfigs<\"rarity\" | \"weaponType\", ICachedWeapon> {\r\n  return {\r\n    rarity: (wp, filter) => filter.includes(weaponSheets?.[wp.key]?.rarity),\r\n    weaponType: (wp, filter) => !filter || (filter === weaponSheets?.[wp.key]?.weaponType),\r\n  }\r\n}\r\n"],"names":["ArtifactMultiAutocomplete","allArtifactKeys","selectedArtifactKeys","setArtifactKeys","getName","getImage","label","props","theme","useTheme","options","useMemo","map","key","autoHighlight","multiple","value","onChange","_","v","getOptionLabel","option","isOptionEqualToValue","renderInput","params","variant","InputLabelProps","style","color","palette","text","primary","length","type","renderOption","image","isSelected","includes","renderTags","selected","getTagProps","index","element","allElementsWithPhy","ele","undefined","icon","ArtifactSetMultiAutocomplete","artSetKeys","setArtSetKeys","artifactSheets","usePromise","ArtifactSheet","t","useTranslation","allArtifactSets","nameRaw","defIcon","ArtifactMainStatMultiAutocomplete","mainStatKeys","setMainStatKeys","allMainStatKeys","KeyMap","StatIcon","ArtifactSubstatMultiAutocomplete","substatKeys","setSubstatKeys","allSubstatKeys","ArtifactSingleAutocomplete","selectedArtifactKey","setArtifactKey","disable","showDefault","defaultText","defaultIcon","flattenCorners","concat","newValue","getOptionDisabled","startAdornment","hasValue","ArtifactSetSingleAutocomplete","allArtSetKeys","artSetKey","setArtSetKey","ArtifactLevelSlider","levelLow","levelHigh","setLow","setHigh","setBoth","dark","disabled","showLevelText","useState","sliderLow","setsliderLow","sliderHigh","setsliderHigh","setSlider","useCallback","e","TypeError","l","h","useEffect","sx","width","display","alignItems","bgcolor","val","clamp","px","pl","inputProps","textAlign","flexGrow","mx","getAriaLabel","onChangeCommitted","valueLabelDisplay","min","max","step","marks","ConditionalSelector","conditional","Object","keys","states","SimpleConditionalSelector","ExclusiveConditionalSelector","MultipleConditionalSelector","useContext","DataContext","character","characterDispatch","data","setConditional","conditionalValues","deepClone","layeredAssignment","path","deletePropPath","conditionalValue","get","entries","stateKey","badge","getStateBadge","name","condName","getCondName","Button","fullWidth","size","borderRadius","onClick","startIcon","CheckBox","CheckBoxOutlineBlank","state","SqBadge","DropdownButton","title","MenuItem","Divider","st","ButtonGroup","orientation","disableElevation","isElement","disp","stateName","badgeColor","badgeText","children","ml","key18","ns","values","Translate","useBadge","ConditionalDisplay","fields","hideHeader","hideDesc","condVal","flatMap","CardDark","evalIfFunc","HeaderDisplay","header","CardContent","p","pb","DocumentDisplay","sections","teamBuffOnly","sectionDisplays","s","i","canShow","teamBuff","SectionDisplay","section","filter","Box","flexDirection","gap","FieldsSectionDisplay","TextSectionDisplay","hideDivider","action","description","displayTitle","InfoTooltip","Typography","CardHeader","avatar","titleTypographyProps","ExpandButton","styled","expand","other","transform","marginLeft","transition","transitions","create","duration","shortest","DisabledButton","backgroundColor","secondary","TextButton","charCurves","objectMap","_charCurves","commonBasic","objectKeyMap","input","infusionNode","stringPrio","inferredHitEle","lookup","sword","claymore","polearm","catalyst","getTalentType","move","customDmgNode","base","additional","mergeData","hit","constant","customShieldNode","shieldNode","prod","sum","unit","customHealNode","healNode","dmgNode","lvlMultiplier","talentType","subscript","percent","flat","shieldNodeTalent","baseMultiplier","talentIndex","shieldElement","infoMut","healNodeTalent","dataObjForCharacterSheet","region","gen","curve","lvlCurve","basic","foundSpecial","charKey","weaponType","weaponTypeKey","premod","charEle","tally","reaction","reactions","physical_dmg_","stat","list","curves","push","ascensions","some","x","NaN","result","prefix","asConst","endsWith","info","slice","Error","special","inferInfoMut","crystallizeMulti1","crystallizeElemas","frac","crystallizeHit","transMulti1","transMulti2","trans","transformativeReactions","multi","variants","swirl","anemo","electroSwirl","electro","pyroSwirl","pyro","cryoSwirl","cryo","hydroSwirl","hydro","shattered","geo","crystallize","fromEntries","absorbableEle","overloaded","electrocharged","superconduct","FlexButtonGroup","StatInput","placeholder","defaultValue","onValueChange","onReset","restProps","whiteSpace","CustomNumberInput","flexBasis","float","endAdornment","Replay","EnemyExpandCard","expanded","setexpanded","toggle","eLvlNode","eDefRed","eDefIgn","CardLight","Grid","container","item","spacing","Chip","EnemyResText","valueString","ExpandMore","Collapse","in","timeout","unmountOnExit","pt","EnemyEditor","node","content","isFinite","uncoloredEleIcons","bsProps","xs","md","enemyOverride","eLvl","enemyLevel","enemyDefIgn_","enemyDefRed_","height","component","href","target","rel","contentLight","main","statKey","eleKey","elementImmunity","Number","MAX_VALUE","Infinity","faCheckSquare","faSquare","className","infusionVals","InfusionAuraDropdown","characterSheet","infusionAura","isMelee","sqBadgeStyle","fontSize","ReactionToggle","reactionMode","charEleKey","infusion","SolidToggleButtonGroup","exclusive","baseColor","ToggleButton","HitModeToggle","hitMode","errHeader","talentMap","normal","charged","plunging","skill","burst","passive","passive1","passive2","passive3","range","getDisplayHeader","sectionKey","split","namespace","sheet","defIconSrc","WeaponSheet","asc","img","imgAwaken","cKey","cEle","CharacterSheet","talentKey","talent","getTalentOfKey","actionText","getDisplaySections","getDisplay","nodes","every","isEmpty","weapon","startsWith","artifact","rest","k","SetEffectDisplay","setKey","setNumKey","conditionalsOnly","document","setEffectDocument","StatDisplayComponent","mr","mb","Masonry","columns","sm","xl","Nodes","Section","displayNs","oldData","displayNsReads","n","nodeKey","customRead","ImgIcon","m","src","oldValue","useBoolState","initial","bool","setBool","onTrue","onFalse","ArtifactCardNano","artifactId","pSlotKey","slotKey","mainStatAssumptionLevel","showLocation","BGComponent","art","useArtifact","actionWrapperFunc","CardActionArea","justifyContent","Assets","opacity","rarity","level","mainStatKey","substats","location","mainStatLevel","Math","mainStatUnit","levelVariant","floor","alpha","ConditionalWrapper","condition","wrapper","position","ArtifactSetSlotTooltip","slotIcons","maxHeight","maxWidth","pointerEvents","LocationIcon","overflow","bottom","zIndex","BootstrapTooltip","placement","disableInteractive","cacheValueString","Artifact","SubstatDisplay","numRolls","rolls","rollColor","alignContent","thumbImgSide","marginTop","BusinessCenter","WeaponCardNano","weaponId","useWeapon","weaponSheet","UIData","computeUIData","dataObjForWeapon","Skeleton","refinement","WeaponNameTooltip","hasRefinement","WeaponStat","BuildDisplayItem","compareBuild","extraButtons","database","DatabaseContext","dataContext","newOld","setNewOld","close","equipBuild","window","confirm","newBuild","allSlotKeys","id","equipArtifacts","setWeaponLocation","currentlyEquipped","statProviderContext","setToSlots","set","Suspense","fallback","CompareArtifactModal","onClose","flexWrap","sort","slotarr1","slotarr","artifactSlotIcon","lg","oldId","equippedArtifacts","newId","ModalWrapper","open","containerProps","ArtifactCard","disableEditSetSlot","canExclude","canEquip","ChevronRight","CompareBuildButton","artId","show","onShow","onHide","characterKey","build","newArt","_getArt","artmap","slot","teamData","useTeamData","_getWeapon","Close","Tooltip","arrow","Difference","numToShowMap","ArtifactFilterDisplay","lazy","ArtifactSwapModal","onChangeId","clickHandler","filterOptionReducer","slotKeys","useReducer","initialFilterOption","filterOption","filterOptionDispatch","useForceUpdate","dbDirty","forceUpdate","followAnyArt","brPt","useMediaQueryUp","filterConfigs","artifactFilterConfigs","artIdList","filterFunc","filterFunction","_getArts","py","CloseButton","mt","WeaponSwapModal","followAnyWeapon","weaponSheets","weaponFilterConfigs","sortConfigs","weaponSortConfigs","setRarity","weaponIdList","_getWeapons","sortFunction","newVal","allRarities","star","stars","WeaponCard","WeaponEditor","equippedWeapon","setweaponId","showWeapon","hideWeapon","updateArt","hasEquipped","unequipArts","setEffects","grxl","useMediaQuery","breakpoints","up","artifactFields","setNumKeyArr","weaponDoc","footer","LargeWeaponSwapButton","onEdit","WeaponSwapButton","ArtifactSwapButton","editor","ArtSwapCard","onOpen","minHeight","setArtLocation","SwapHoriz","Worker_fn","Worker","pruneAll","minimum","arts","numTop","keepArtifacts","forced","should","deps","pruneNodeRange","reaffine","pruneOrder","pruneArtRange","count","newArts","newNodes","forceRename","affineNodes","Set","topLevelAffine","visit","isAffine","add","operands","forEach","_op","op","has","dynKeys","forEachNodes","f","operation","accu","nonConst","assertUnreachable","current","nextDynKey","affine","affineMap","Map","reaffineArt","constantFold","dyn","mapFormulas","offsets","baseValue","progress","newList","greaterEqual","greater","baseRange","wrap","artRanges","computeArtRange","otherArtRanges","addArtRange","a","read","newRange","computeNodeRange","nodeRange","operandRanges","threshold","pass","fail","newOperands","op1","op2","j","ranges","reads","_f","computeMinMax","allOperations","reduce","c","minMaxes","filterArts","filters","kind","ids","sets","mergeBuilds","builds","maxNum","b","mergePlot","plots","scale","round","plot","countBuilds","_count","ArtifactSetConditional","setOpen","artifactCondCount","ArtConditionalModal","resetArtConds","artSetKeyList","reverse","currentContext","entry","d","artSet","doc","parseInt","large","ArtifactSetPicker","setFilters","setNum","num","artifactSets","setsNumArr","artsAccountedOther","cur","ind","artsAccounted","setFilter","setNKey","setNkey","levels","AssumeFullLevelToggle","setmainStatAssumptionLevel","lvl","BonusStatsCard","bonusStatsKeys","bonusStats","warningBuildNumber","Monospace","fontFamily","BorderLinearProgress","LinearProgress","BuildAlert","totBuildNumber","generatingBuilds","generationSkipped","generationProgress","generationDuration","characterName","maxBuildsToShow","totalBuildNumberString","toLocaleString","totalUnskipped","generationProgressString","generationSkippedString","totalUnskippedString","generationSkippedText","subtitle","timeStringMs","Alert","severity","toFixed","ChartCard","chartData","plotBase","setPlotBase","showDownload","setshowDownload","showMin","setshowMin","statKeys","displayData","downloadData","increasingX","y","minimumData","point","last","pop","allData","sKey","Info","Download","DataDisplay","Chart","plotNode","valueNode","TextArea","resize","readOnly","JSON","stringify","selectionStart","selectionEnd","plotBaseUnit","valueUnit","ResponsiveContainer","ComposedChart","CartesianGrid","strokeDasharray","XAxis","dataKey","domain","tick","fill","tickFormatter","YAxis","allowDecimals","ZAxis","Legend","Scatter","line","lineType","isAnimationActive","Line","stroke","connectNulls","strokeWidth","artifactsSlotsToSelectMainStats","MainStatSelectionCard","onChangeMainStatKey","numSel","cursor","WhiteButton","OptimizationTargetSelector","optimizationTarget","setTarget","setTargetHandler","TargetDisplayText","SelectorSection","MenuList","TargetSelectorMenuItem","NoTarget","displayHeader","objPathValue","textOverflow","defThreads","navigator","hardwareConcurrency","initialTabOptimizeDBState","equipmentPriority","threads","useOptimizeDBState","useDBState","UseEquipped","useEquippedArts","buildSettingsDispatch","tempEquipmentPriority","setOptimizeDBState","ck","_getChar","setPrio","setPrioRank","fromIndex","toIndex","arr","splice","removePrio","addPrio","resetPrio","numAbove","indexOf","numUseEquippedChar","_getCharKeys","numUnlisted","Trans","i18nKey","gutterBottom","SelectItem","rank","maxRank","setRank","onRemove","NewItem","onAdd","flexShrink","Settings","useCharacter","KeyboardDoubleArrowUp","KeyboardArrowUp","KeyboardArrowDown","KeyboardDoubleArrowDown","CharacterCardPico","WeaponCardPico","aId","ArtifactCardPico","artifactObj","char","CharacterSelectionModal","onSelect","Add","UseExcluded","useExcludedArts","artsDirty","numExcludedArt","exclude","artSetPerm","splitFiltersBySet","splitFilterByIds","dynamic","setReadNodeKeys","dynamicData","_filters","cleanFilters","check","remainingSlots","fs","relevantSets","newFilters","obj","noFilter","allFilters","_arts","limit","candidates","numChunks","ceil","boundedNumChunks","chunk","Array","TabBuild","initGlobalSettings","tcMode","setgeneratingBuilds","setgenerationProgress","setgenerationDuration","setgenerationSkipped","setchartData","setArtsDirty","maxWorkers","setMaxWorkers","useCharacterReducer","buildSettings","initialBuildSettings","statFilters","buildDate","buildsArts","compareData","noArtifact","buildSettingsReducer","cantTakeList","flower","plume","goblet","circlet","sands","mainStatVal","substat","accurateValue","compactArtifacts","mainStats","setPerms","perm","cancelToken","useRef","generateBuilds","fetchWork","setPerm","next","done","command","buildValues","getTeamData","workerData","uiDataForTeam","assign","optimizationTargetNode","targetNode","valueFilter","t1","performance","now","cancelled","Promise","r","origCount","optimize","plotBaseNode","buildCount","failedCount","skippedCount","Symbol","iterator","finalizedList","worker","setup","maxBuilds","postMessage","finalize","finalized","onmessage","work","finalizeCommand","terminate","console","log","then","buildTimer","setInterval","any","all","results","clearInterval","plotData","artifactIds","Date","totalDuration","Link","RouterLink","to","CharacterCard","StatFilterCard","setStatFilters","sFs","faCalculator","maxBuildsToShowList","BuildList","DataContextWrapper","join","TabOverview","navigate","useNavigate","ascension","constellation","tlvl","auto","tBoost","cardImg","pr","IconButton","favorite","Favorite","FavoriteBorder","colored","tKey","Badge","badgeContent","overlap","anchorOrigin","vertical","horizontal","padding","lineHeight","constellationName","team","MainStatsCards","mainSubKeys","mainReadNodes","mainEditKeys","otherStatReadNodes","otherStatKeys","miscStatReadNodes","amplifyingReactions","miscStatkeys","statBreakpoint","StatDisplayContent","extra","columnSpacing","rowSpacing","rn","specialNode","StatDisplayCard","editContent","statName","edit","setedit","faSave","faEdit","talentSpacing","CharacterTalentPane","grlg","constellationCards","SkillDisplayCard","onClickTitle","ReactionDisplay","tText","enabled","talentLimits","actionWrapeprFunc","levelBoost","newTalentLevelKey","talentSheet","headerAction","TabTeambuffs","TeamBuffDisplay","ResonanceDisplay","TeammateDisplay","teamBuffs","getTeamBuff","total","enemy","resonanceSheets","res","desc","active","activeCharacterDispatch","activeCharacterKey","onClickHandler","useCharSelectionCallback","dataBundle","teamMateDataContext","CharacterAutocomplete","labelText","PersonAdd","onClickHeader","artifactChildren","CharArtifactCondDisplay","weaponChildren","CharWeaponCondDisplay","characterChildren","CharTalentCondDisplay","isTeammateCard","sn","getTalent","sheets","sts","CharacterDisplay","useParams","allCharacterKeys","my","CharacterDisplayCard","newteamData","charUIData","useMatch","end","tab","useTitle","dataContextValue","CharSelectDropdown","Card","warning","TabNav","FormulaCalcCard","Tabs","allowScrollButtonsMobile","Tab","minWidth","Person","FactCheck","Checkroom","Groups","Calculate","showModal","setshowModal","setCharacter","setLevel","ascensionMaxLevel","ascenML","setAscension","lowerAscension","elementKey","ThumbSide","contentDark","sgt","talents","ambiguousLevel","milestoneLevels","lv","as","lvlstr","CalculationDisplay","FormulaCalc","Accordion","AccordionSummary","expandIcon","AccordionDetails","formulas","subform","onDelete","cs","wrapperFunc","falseWrapperFunc","equipOnChar","lock","stats","falseWrapper","updateWeapon","right","noWrap","top","displayVal","faTrashAlt","weaponID","setWeapon","followWeapon","SECOND_MS","MINUTE_MS","HOUR_MS","DAY_MS","msToUnits","ms","milliseconds","seconds","minutes","hours","timeString","timeText","strPadLeft","weaponSortKeys","getValue","wp","tieBreaker"],"sourceRoot":""}
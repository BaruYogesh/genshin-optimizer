{"version":3,"sources":["Assets/icon_bow.png","Assets/Assets.ts","Assets/icon_catalyst.png","Assets/icon_claymore.png","Assets/icon_polearm.png","Assets/icon_sword.png","Assets/Item_Fragile_Resin.png","Assets/Item_Condensed_Resin.png","Assets/Item_Wanderer's_Advice.png","Assets/Item_Hero's_Wit.png","Assets/Item_Adventurer's_Experience.png","Components/Character/LocationName.tsx","Components/ToggleButton/WeaponToggle.tsx","Components/SortByButton.tsx","Artifact/ArtifactCard.tsx","Artifact/PercentBadge.tsx","Util/SortByFilters.ts","Components/Weapon/WeaponSelectionModal.tsx","Weapon/WeaponCard.tsx","Components/ToggleButton/ElementToggle.tsx","Util/CharacterSort.ts","Components/Character/CharacterSelectionModal.tsx","Weapon/WeaponStatsCard.tsx","Weapon/WeaponDisplayCard.tsx","Components/FormulaCalcCard.tsx","Character/CharacterDisplay/CharacterArtifactPane.tsx","Character/CharacterDisplay/CharacterOverviewPane.tsx","Character/CharacterDisplay/CharacterTalentPane.tsx","Character/CharacterDisplayCard.tsx"],"names":["Assets","weaponTypes","bow","catalyst","claymore","polearm","sword","resin","fragile","condensed","exp_books","advice","wit","experience","LocationName","location","t","useTranslation","characterSheet","usePromise","CharacterSheet","get","component","name","nameWIthIcon","WeaponToggle","value","onChange","props","cb","useCallback","e","newVal","exclusive","allWeaponTypeKeys","map","wt","src","size","SortByButton","sortKeys","ascending","onChangeAsc","title","i18nKey","key","selected","disabled","onClick","startIcon","icon","faSortAmountDownAlt","faSortAmountUp","className","allSubstatFilter","Set","allSubstats","ArtifactCard","artifactId","artifactObj","onEdit","onDelete","mainStatAssumptionLevel","effFilter","database","useContext","DatabaseContext","useState","undefined","databaseArtifact","updateDatabaseArtifact","useEffect","followArt","sheet","ArtifactSheet","_getArt","setKey","editable","localDatabase","art","id","lock","slotKey","rarity","level","mainStatKey","substats","exclude","mainStatLevel","Math","max","min","levelVariant","floor","mainStatVal","color","valueStringWithUnit","Artifact","mainStatValue","Stat","getStatUnit","getArtifactEfficiency","currentEfficiency","maxEfficiency","artifactValid","slotName","getSlotName","slotDesc","getSlotDesc","slotDescTooltip","placement","faInfoCircle","setEffects","setDescTooltip","Object","keys","setNumKey","variant","setNum","setEffectDesc","fallback","sx","width","height","minHeight","display","flexDirection","py","alignItems","label","pl","flexGrow","updateArt","container","flexWrap","item","getStatName","stars","colored","xs","md","image","slotIcons","pt","pb","stat","i","numRolls","rolls","length","rollColor","clamp","efficiency","effOpacity","statName","mr","opacity","has","my","valid","mb","flexShrink","inventory","charKey","setArtLocation","faEdit","arrow","faBan","faChartLine","faTrashAlt","PercentBadge","toFixed","badgeColor","text","SortByFilters","sortby","options","Sort","a","b","filterOption","aV","getValue","bV","localeCompare","diff","tieBreaker","WeaponSelectionModal","show","onHide","onSelect","filter","propWeaponFilter","weaponFilter","weaponSheets","WeaponSheet","getAll","setWeaponfilter","weaponIdList","allWeaponKeys","wKey","weaponType","sort","open","onClose","spacing","weaponKey","weaponSheet","lg","img","px","large","WeaponCard","weaponId","canEquip","databaseWeapon","updateDatabaseWeapon","followWeapon","weapon","cs","weaponTypeKey","actionWrapperFunc","children","equipOnChar","setWeaponLocation","ascension","refinement","weaponMainVal","getMainStatValue","fixedUnit","weaponSubKey","getSubStatKey","weaponSubVal","getSubStatValue","statMap","passiveName","push","condition","wrapper","avatar","fontSize","titleTypographyProps","action","updateWeapon","ascensionMaxLevel","alignContent","mt","statKey","statVal","unit","StatIcon","noUnselect","ElementToggle","allElements","ele","lineHeight","uncoloredEleIcons","characterSortOptions","characterSheets","new","ck","_getChar","star","defaultSortKeys","CharacterSelectionModal","newFirst","useMemo","sortBy","setsortBy","setascending","elementalFilter","setelementalFilter","setweaponFilter","sortOptions","characterKeyList","allCharacterKeys","cKey","elementKey","characterKey","CharacterBtn","character","equippedWeapon","_getWeapon","artifactSheets","stats","Character","calculateBuild","thumbImg","getLevelString","constellation","tlvl","auto","skillBoost","skill","burstBoost","burst","WeaponStatsCard","statsVals","s","fields","statsToFields","CardDark","CardContent","Typography","FieldDisplay","field","WeaponDisplayCard","propWeaponId","charData","footer","useForceUpdate","databaseToken","onDatabaseUpdate","buildContextObj","buildContext","weaponDispatch","newWeapon","setLevel","findIndex","ascenML","setAscension","lowerAscension","build","newBuild","equippedBuild","refineIndex","ws","initialWeaponFilter","showModal","setshowModal","CardLight","Grid","k","ButtonGroup","Button","DropdownButton","MenuItem","Divider","Array","bgcolor","palette","contentLight","main","CustomNumberInput","startAdornment","inputProps","textAlign","ambiguousLevel","milestoneLevels","lv","as","lvlstr","Lock","LockOpen","CloseButton","SwapBtn","onChangeId","substatKey","weaponDisplayMainVal","weaponDisplaySubVal","weaponPassiveName","weaponBonusStats","sections","document","sm","Box","borderRadius","description","process","SqBadge","gutterBottom","passiveDescription","Provider","compareBuild","setCompareBuild","atk","DocumentDisplay","CharacterDropdownButton","setShow","close","clickHandler","weapons","dbWeapon","SwapHoriz","ModalWrapper","ImgIcon","FormulaCalcCard","sheets","expanded","setexpanded","toggle","ExpandButton","expand","aria-expanded","aria-label","ExpandMore","Collapse","in","timeout","unmountOnExit","CalculationDisplay","displayStatKeys","getDisplayStatKeys","Skeleton","entries","sectionKey","header","getFormulaTargetsDisplayHeading","characterEle","fieldIndex","isArray","FormulaCalculationField","fieldKeys","subFormulaKeys","getPrintableFormulaStatKeyList","GetDependencies","modifiers","reverse","Boolean","Accordion","AccordionSummary","expandIcon","printStat","AccordionDetails","subKey","formula","Formula","formulaField","fieldText","getTalentFieldValue","fieldVariant","fieldFormulaText","fieldFixed","fieldUnit","fieldFormula","fieldFormulaDependency","fieldValue","CharacterArtifactPane","history","useHistory","statKeys","edit","artid","pathname","artToEditId","followAnyArt","equipArts","window","confirm","equippedArtifacts","equipArtifacts","unequipArts","objectFromKeyMap","allSlotKeys","StatDisplayComponent","statsDisplayKeys","SolidToggleButtonGroup","v","ToggleButton","Card","p","warning","dark","setToSlots","setNumKeyArr","SetEffectDisplay","CharacterOverviewPane","characterDispatch","useCharacterReducer","CardMedia","cardImg","tKey","Badge","badgeContent","overlap","anchorOrigin","vertical","horizontal","padding","getTalentOfKey","constellationName","cursor","MainStatsCards","additionalKeys","editStatKeys","otherStatKeys","forEach","miscStatkeys","specializedStatKey","getSpecializedStat","specializedStatVal","getSpecializedStatVal","specializedStatUnit","displayNewBuildProps","StatDisplayCard","content","columnSpacing","rowSpacing","StatDisplay","justifyContent","editContent","StatInput","getStatNameWithPercent","placeholder","getStatNameRaw","bonusStats","percent","onValueChange","type","defaultValue","setedit","faSave","CharacterTalentPane","ReactionDisplay","tText","SkillDisplayCard","talentKey","subtitle","asc","enabled","style","onClickTitle","ReactionComponents","superconduct_hit","sKey","electro","cryo","electrocharged_hit","hydro","overloaded_hit","pyro","pyro_swirl_hit","swirlEleToDisplay","setele","element","shattered_hit","information","BootstrapTooltip","faQuestionCircle","crystalize_hit","crystalizeEleToDisplay","charEleKey","eleInterArr","ElementToReactionKeys","includes","Ele","anemo","geo","talentLimits","talent","actionWrapeprFunc","CardActionArea","levelBoost","talentLvlKey","fullWidth","newTalentLevelKey","talentStats","getTalentStats","talentStatsFields","statsEle","talentSheet","ConditionalWrapper","TabPanel","current","other","role","hidden","aria-labelledby","CharacterDisplayCard","setCharacterKey","propNewBuild","tabName","initialCharacter","followChar","deepClone","tab","settab","onTab","CharSelectDropdown","Tabs","Tab","HeaderIconDisplay","contentDark","ElementalData","talents","eleKey"],"mappings":"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","file":"static/js/7.53c40c1e.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/icon_bow.7ceaa8e2.png\";","import bow from './icon_bow.png'\r\nimport catalyst from './icon_catalyst.png'\r\nimport claymore from './icon_claymore.png'\r\nimport polearm from './icon_polearm.png'\r\nimport sword from './icon_sword.png'\r\n\r\nimport fragile from './Item_Fragile_Resin.png'\r\nimport condensed from './Item_Condensed_Resin.png'\r\n\r\n//EXP BOOKS\r\nimport advice from './Item_Wanderer\\'s_Advice.png'\r\nimport wit from './Item_Hero\\'s_Wit.png'\r\nimport experience from './Item_Adventurer\\'s_Experience.png'\r\n\r\nconst Assets = {\r\n  weaponTypes: { bow, catalyst, claymore, polearm, sword },\r\n  resin: {\r\n    fragile,\r\n    condensed\r\n  },\r\n  exp_books: {\r\n    advice,\r\n    wit,\r\n    experience,\r\n  }\r\n};\r\nexport default Assets;","export default __webpack_public_path__ + \"static/media/icon_catalyst.db078b7b.png\";","export default __webpack_public_path__ + \"static/media/icon_claymore.63b1abb8.png\";","export default __webpack_public_path__ + \"static/media/icon_polearm.e5f4a2a1.png\";","export default __webpack_public_path__ + \"static/media/icon_sword.619c9c2d.png\";","export default __webpack_public_path__ + \"static/media/Item_Fragile_Resin.f9ec8223.png\";","export default __webpack_public_path__ + \"static/media/Item_Condensed_Resin.1cecf64a.png\";","export default __webpack_public_path__ + \"static/media/Item_Wanderer's_Advice.58c62cf7.png\";","export default __webpack_public_path__ + \"static/media/Item_Hero's_Wit.a79e36d0.png\";","export default __webpack_public_path__ + \"static/media/Item_Adventurer's_Experience.92b5d195.png\";","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { Typography } from \"@mui/material\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport CharacterSheet from \"../../Character/CharacterSheet\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\n\r\nexport default function LocationName({ location }) {\r\n  const { t } = useTranslation(\"ui\");\r\n  const characterSheet = usePromise(CharacterSheet.get(location ?? \"\"), [location])\r\n  return <Typography component=\"span\">\r\n    {characterSheet?.name ? characterSheet.nameWIthIcon : <span><BusinessCenter /> {t`inventory`}</span>}\r\n  </Typography>\r\n\r\n}","import { ToggleButton } from \"@mui/material\";\r\nimport { useCallback } from \"react\";\r\nimport Assets from \"../../Assets/Assets\";\r\nimport { allWeaponTypeKeys, WeaponTypeKey } from \"../../Types/consts\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport SolidToggleButtonGroup, { SolidToggleButtonGroupProps } from \"../SolidToggleButtonGroup\";\r\ntype WeaponToggleProps = Omit<SolidToggleButtonGroupProps, \"onChange\" | \"value\"> & {\r\n  onChange: (value: WeaponTypeKey | \"\") => void\r\n  value: WeaponTypeKey | \"\"\r\n}\r\nexport default function WeaponToggle({ value, onChange, ...props }: WeaponToggleProps) {\r\n  const cb = useCallback((e, newVal) => onChange(newVal || \"\"), [onChange])\r\n  return <SolidToggleButtonGroup exclusive onChange={cb} value={value || allWeaponTypeKeys} {...props}>\r\n    {allWeaponTypeKeys.map(wt => <ToggleButton key={wt} value={wt}>\r\n      <ImgIcon src={Assets.weaponTypes?.[wt]} size={2} />\r\n    </ToggleButton>)}\r\n  </SolidToggleButtonGroup>\r\n}","import { faSortAmountDownAlt, faSortAmountUp } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { Button, ButtonGroup, ButtonGroupProps, MenuItem } from \"@mui/material\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport DropdownButton from \"./DropdownMenu/DropdownButton\";\r\n\r\ntype SortByButtonProps = ButtonGroupProps & {\r\n  sortKeys: string[]\r\n  value: string\r\n  onChange: (value: string) => void\r\n  ascending: boolean\r\n  onChangeAsc: (value: boolean) => void\r\n}\r\n// Assumes that all the sortKeys has corresponding translations in ui.json sortMap\r\nexport default function SortByButton({ sortKeys, value, onChange, ascending, onChangeAsc, ...props }: SortByButtonProps) {\r\n  const { t } = useTranslation(\"ui\")\r\n  return <ButtonGroup {...props} >\r\n    <DropdownButton title={<Trans t={t} i18nKey=\"sortByFormat\" value={t(`sortMap.${value}`) as any}>Sort By: {{ value: t(`sortMap.${value}`) }}</Trans>}>\r\n      {sortKeys.map(key =>\r\n        <MenuItem key={key} selected={value === key} disabled={value === key} onClick={() => onChange(key)}>{t(`sortMap.${key}`) as any}</MenuItem>)}\r\n    </DropdownButton>\r\n    <Button onClick={() => onChangeAsc(!ascending)} startIcon={<FontAwesomeIcon icon={ascending ? faSortAmountDownAlt : faSortAmountUp} className=\"fa-fw\" />}>\r\n      {ascending ? <Trans t={t} i18nKey=\"ascending\" >Ascending</Trans> : <Trans t={t} i18nKey=\"descending\" >Descending</Trans>}\r\n    </Button>\r\n  </ButtonGroup>\r\n}","import { faBan, faChartLine, faEdit, faInfoCircle, faTrashAlt } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { Lock, LockOpen } from '@mui/icons-material';\r\nimport { Box, Button, ButtonGroup, CardActions, CardContent, CardMedia, Chip, Grid, IconButton, Skeleton, Tooltip, Typography } from '@mui/material';\r\nimport React, { Suspense, useContext, useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport BootstrapTooltip from '../Components/BootstrapTooltip';\r\nimport CardLight from '../Components/Card/CardLight';\r\nimport CharacterDropdownButton from '../Components/Character/CharacterDropdownButton';\r\nimport LocationName from '../Components/Character/LocationName';\r\nimport ColorText from '../Components/ColoredText';\r\nimport SqBadge from '../Components/SqBadge';\r\nimport { Stars } from '../Components/StarDisplay';\r\nimport { database as localDatabase, DatabaseContext } from '../Database/Database';\r\nimport usePromise from '../ReactHooks/usePromise';\r\nimport Stat from '../Stat';\r\nimport { allSubstats, ICachedArtifact, ICachedSubstat, SubstatKey } from '../Types/artifact';\r\nimport { CharacterKey } from '../Types/consts';\r\nimport { valueStringWithUnit } from '../Util/UIUtil';\r\nimport { clamp } from '../Util/Util';\r\nimport Artifact from './Artifact';\r\nimport { ArtifactSheet } from './ArtifactSheet';\r\nimport SlotNameWithIcon from './Component/SlotNameWIthIcon';\r\nimport PercentBadge from './PercentBadge';\r\n\r\ntype Data = { artifactId?: string, artifactObj?: ICachedArtifact, onEdit?: (string) => void, onDelete?: (string) => void, mainStatAssumptionLevel?: number, effFilter?: Set<SubstatKey> }\r\nconst allSubstatFilter = new Set(allSubstats)\r\n\r\nexport default function ArtifactCard({ artifactId, artifactObj, onEdit, onDelete, mainStatAssumptionLevel = 0, effFilter = allSubstatFilter }: Data): JSX.Element | null {\r\n  const { t } = useTranslation([\"artifact\"]);\r\n  const database = useContext(DatabaseContext)\r\n  const [databaseArtifact, updateDatabaseArtifact] = useState(undefined as ICachedArtifact | undefined)\r\n  useEffect(() =>\r\n    artifactId ? database.followArt(artifactId, updateDatabaseArtifact) : undefined,\r\n    [artifactId, updateDatabaseArtifact, database])\r\n  const sheet = usePromise(ArtifactSheet.get((artifactObj ?? (artifactId ? database._getArt(artifactId) : undefined))?.setKey), [artifactObj, artifactId])\r\n  const equipOnChar = (charKey: CharacterKey | \"\") => database.setArtLocation(artifactId!, charKey)\r\n\r\n  const editable = !artifactObj && database === localDatabase // dont allow edit for flex artifacts\r\n  const art = artifactObj ?? databaseArtifact\r\n  if (!art) return null\r\n\r\n  const { id, lock, slotKey, rarity, level, mainStatKey, substats, exclude, location = \"\" } = art\r\n  const mainStatLevel = Math.max(Math.min(mainStatAssumptionLevel, rarity * 4), level)\r\n  const levelVariant = \"roll\" + (Math.floor(Math.max(level, 0) / 4) + 1)\r\n  const mainStatVal = <ColorText color={mainStatLevel !== level ? \"warning\" : undefined}>{valueStringWithUnit(Artifact.mainStatValue(mainStatKey, rarity, mainStatLevel) ?? 0, Stat.getStatUnit(mainStatKey))}</ColorText>\r\n  const { currentEfficiency, maxEfficiency } = Artifact.getArtifactEfficiency(art, effFilter)\r\n  const artifactValid = maxEfficiency !== 0\r\n  const slotName = sheet?.getSlotName(slotKey) || \"Unknown Piece Name\"\r\n  const slotDesc = sheet?.getSlotDesc(slotKey)\r\n  const slotDescTooltip = slotDesc && <BootstrapTooltip placement=\"top\" title={<Typography>{slotDesc}</Typography>}>\r\n    <span><FontAwesomeIcon icon={faInfoCircle} /></span>\r\n  </BootstrapTooltip>\r\n  const setEffects = sheet?.setEffects\r\n  const setDescTooltip = sheet && setEffects && <BootstrapTooltip placement=\"top\" title={\r\n    <span>\r\n      {Object.keys(setEffects).map(setNumKey => <span key={setNumKey}>\r\n        <Typography variant=\"h6\"><SqBadge color=\"success\">{t(`setEffectNum`, { setNum: setNumKey })}</SqBadge></Typography>\r\n        <Typography>{sheet.setEffectDesc(setNumKey as any)}</Typography>\r\n      </span>)}\r\n    </span>\r\n  }>\r\n    <span><FontAwesomeIcon icon={faInfoCircle} /></span>\r\n  </BootstrapTooltip>\r\n\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 350 }} />}>\r\n    <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\r\n      <CardContent className={`grad-${rarity}star`} sx={{ py: 1 }}>\r\n        <Box component=\"div\" sx={{ display: \"flex\", alignItems: \"center\" }}>\r\n          <Chip label={<strong>{` +${level}`}</strong>} color={levelVariant as any} />\r\n          <Typography sx={{ pl: 1, flexGrow: 1 }}>{slotName} {slotDescTooltip}</Typography>\r\n          <IconButton color=\"secondary\" disabled={!editable} onClick={() => database.updateArt({ lock: !lock }, id)}>\r\n            {lock ? <Lock /> : <LockOpen />}\r\n          </IconButton>\r\n        </Box>\r\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\r\n          <Grid item flexGrow={1}>\r\n            <Typography color=\"text.secondary\" variant=\"body2\">\r\n              <SlotNameWithIcon slotKey={slotKey} />\r\n            </Typography>\r\n            <Typography variant=\"h6\">\r\n              {Stat.getStatName(mainStatKey)}\r\n            </Typography>\r\n            <Typography variant=\"h5\">\r\n              <strong>{mainStatVal}</strong>\r\n            </Typography>\r\n            <Stars stars={rarity} colored />\r\n            {/* {process.env.NODE_ENV === \"development\" && <Typography color=\"common.black\">{id || `\"\"`} </Typography>} */}\r\n          </Grid>\r\n          <Grid item xs={3} md={4}>\r\n            <CardMedia\r\n              component=\"img\"\r\n              image={sheet?.slotIcons[slotKey] ?? \"\"}\r\n              width=\"100%\"\r\n              height=\"auto\"\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n      <CardContent sx={{ flexGrow: 1, display: \"flex\", flexDirection: \"column\", pt: 1, pb: 0 }}>\r\n        {substats.map((stat: ICachedSubstat, i) => {\r\n          if (!stat.value) return null\r\n          const numRolls = stat.rolls?.length ?? 0\r\n          const rollColor = `roll${clamp(numRolls, 1, 6)}`\r\n          const efficiency = stat.efficiency ?? 0\r\n          const effOpacity = 0.3 + (efficiency / 100) * 0.7\r\n          const statName = Stat.getStatName(stat.key)\r\n          return (<Box key={i} sx={{ display: \"flex\" }}>\r\n            <Box sx={{ flexGrow: 1 }}>\r\n              <SqBadge color={(numRolls ? rollColor : \"error\") as any} sx={{ mr: 1 }}><strong>{numRolls ? numRolls : \"?\"}</strong></SqBadge>\r\n              <Typography color={(numRolls ? `${rollColor}.main` : \"error.main\") as any} component=\"span\">{statName}{`+${valueStringWithUnit(stat.value, Stat.getStatUnit(stat.key))}`}</Typography>\r\n            </Box>\r\n            <Typography sx={{ opacity: effOpacity }}>{stat.key && effFilter.has(stat.key) ? valueStringWithUnit(efficiency, \"eff\") : \"-\"}</Typography>\r\n          </Box>)\r\n        })}\r\n        <Box sx={{ display: \"flex\", my: 1 }}>\r\n          <Typography color=\"text.secondary\" component=\"span\" variant=\"caption\" sx={{ flexGrow: 1 }}>{t`editor.curSubEff`}</Typography>\r\n          <PercentBadge value={currentEfficiency} valid={artifactValid} />\r\n        </Box>\r\n        {currentEfficiency !== maxEfficiency && <Box sx={{ display: \"flex\", mb: 1 }}>\r\n          <Typography color=\"text.secondary\" component=\"span\" variant=\"caption\" sx={{ flexGrow: 1 }}>{t`editor.maxSubEff`}</Typography>\r\n          <PercentBadge value={maxEfficiency} valid={artifactValid} />\r\n        </Box>}\r\n        <Box flexGrow={1} />\r\n        <Typography color=\"success.main\">{sheet?.name ?? \"Artifact Set\"} {setDescTooltip}</Typography>\r\n      </CardContent>\r\n      <CardActions>\r\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\r\n          <Grid item xs=\"auto\" flexShrink={1}>\r\n            {editable ?\r\n              <CharacterDropdownButton size=\"small\" inventory value={location} onChange={equipOnChar} /> : <LocationName location={location} />}\r\n          </Grid>\r\n          <Grid item flexGrow={1} sx={{ mr: 1 }} />\r\n          {editable && <Grid item xs=\"auto\">\r\n            <ButtonGroup sx={{ height: \"100%\" }}>\r\n              {!!onEdit && <Button color=\"info\" onClick={() => onEdit(id)} size=\"small\">\r\n                <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\r\n              </Button>}\r\n              <Tooltip title={<Typography>{t`excludeArtifactTip`}</Typography>} placement=\"top\" arrow>\r\n                <Button onClick={() => database.updateArt({ exclude: !exclude }, id)} color={exclude ? \"error\" : \"success\"} size=\"small\">\r\n                  <FontAwesomeIcon icon={exclude ? faBan : faChartLine} className=\"fa-fw\" />\r\n                </Button>\r\n              </Tooltip>\r\n              {!!onDelete && <Button color=\"error\" size=\"small\" onClick={() => onDelete(id)} disabled={lock}>\r\n                <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\r\n              </Button>}\r\n            </ButtonGroup>\r\n          </Grid>}\r\n        </Grid>\r\n      </CardActions>\r\n    </CardLight >\r\n  </Suspense>\r\n}\r\n","import SqBadge from '../Components/SqBadge';\r\nimport { clamp } from '../Util/Util';\r\n\r\nexport default function PercentBadge({ value, valid }: Data) {\r\n  let [badgeColor, text] = typeof value === 'number' ?\r\n    [`roll${clamp(Math.floor(value * 0.05) + 1, 1, 6)}`, value.toFixed(2) + \"%\"] : [\"secondary\", value]\r\n  if (!valid) badgeColor = \"error\"\r\n  return <SqBadge color={badgeColor} >{text}</SqBadge>\r\n}\r\n\r\ntype Data = {\r\n  valid: boolean,\r\n  value: number | string,\r\n}\r\n","\r\ninterface SortOption {\r\n  getValue: (id: string) => number | string\r\n  tieBreaker?: string\r\n}\r\nexport interface SortOptions { [key: string]: SortOption }\r\n\r\n\r\nexport default function SortByFilters(sortby: string, ascending: boolean, options: SortOptions) {\r\n  function Sort(a: string, b: string, ascending: boolean, filterOption: SortOption,) {\r\n    const aV = filterOption.getValue(a)\r\n    const bV = filterOption.getValue(b)\r\n    let diff = 0\r\n    if (typeof aV === \"string\" && typeof aV === \"string\")\r\n      diff = a.localeCompare(b)\r\n    else\r\n      diff = ((bV as number) - aV)\r\n    return (ascending ? -1 : 1) * diff\r\n  }\r\n  return (a: string, b: string) => {\r\n    const filterOption = options[sortby]\r\n    let diff = Sort(a, b, ascending, filterOption)\r\n    if (!diff && filterOption.tieBreaker)\r\n      diff = Sort(a, b, ascending, options[filterOption.tieBreaker])\r\n    return diff\r\n  }\r\n}\r\n","import { Box, CardActionArea, CardContent, Divider, Grid, Typography } from \"@mui/material\"\r\nimport { useEffect, useState } from \"react\"\r\nimport Assets from \"../../Assets/Assets\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { allWeaponKeys, WeaponKey, WeaponTypeKey } from \"../../Types/consts\"\r\nimport WeaponSheet from \"../../Weapon/WeaponSheet\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport CardLight from \"../Card/CardLight\"\r\nimport CloseButton from \"../CloseButton\"\r\nimport ImgIcon from \"../Image/ImgIcon\"\r\nimport ModalWrapper from \"../ModalWrapper\"\r\nimport { Stars } from \"../StarDisplay\"\r\nimport WeaponToggle from \"../ToggleButton/WeaponToggle\"\r\n\r\ntype WeaponSelectionModalProps = {\r\n  show: boolean,\r\n  onHide: () => void,\r\n  onSelect: (wKey: WeaponKey) => void,\r\n  filter?: (sheet: WeaponSheet) => boolean,\r\n  weaponFilter?: WeaponTypeKey,\r\n}\r\n\r\nexport default function WeaponSelectionModal({ show, onHide, onSelect, filter = () => true, weaponFilter: propWeaponFilter }: WeaponSelectionModalProps) {\r\n  const weaponSheets = usePromise(WeaponSheet.getAll(), [])\r\n  const [weaponFilter, setWeaponfilter] = useState<WeaponTypeKey | \"\">(propWeaponFilter ?? \"\")\r\n\r\n  useEffect(() => propWeaponFilter && setWeaponfilter(propWeaponFilter), [propWeaponFilter])\r\n\r\n  const weaponIdList = !weaponSheets ? [] : [...new Set(allWeaponKeys)].filter(wKey => filter(weaponSheets[wKey]))\r\n    .filter(wKey => {\r\n      if (weaponFilter && weaponFilter !== weaponSheets?.[wKey]?.weaponType) return false\r\n      return true\r\n    })\r\n    .sort((a, b) => (weaponSheets?.[b]?.rarity ?? 0) - (weaponSheets?.[a]?.rarity ?? 0))\r\n\r\n  if (!weaponSheets) return null\r\n\r\n  return <ModalWrapper open={show} onClose={onHide}>\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Grid container>\r\n          <Grid item flexGrow={1}>\r\n            <WeaponToggle value={weaponFilter} onChange={setWeaponfilter} disabled={!!propWeaponFilter} size=\"small\" />\r\n          </Grid >\r\n          <Grid item>\r\n            <CloseButton onClick={onHide} />\r\n          </Grid >\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent><Grid container spacing={1}>\r\n        {weaponIdList.map(weaponKey => {\r\n          const weaponSheet = weaponSheets[weaponKey]\r\n          return <Grid item key={weaponKey} lg={3} md={4}>\r\n            <CardLight sx={{ height: \"100%\" }} >\r\n              <CardActionArea onClick={() => { onHide(); onSelect(weaponKey) }} sx={{ display: \"flex\" }}>\r\n                <Box component=\"img\" src={weaponSheet.img} sx={{ width: 100, height: \"auto\" }} className={` grad-${weaponSheet.rarity}star`} />\r\n                <Box sx={{ flexGrow: 1, px: 1 }}>\r\n                  <Typography variant=\"subtitle1\">{weaponSheet.name}</Typography>\r\n                  <Typography><ImgIcon src={Assets.weaponTypes?.[weaponSheet.weaponType]} /> <Stars stars={weaponSheet.rarity} colored /></Typography>\r\n                </Box>\r\n              </CardActionArea>\r\n            </CardLight>\r\n          </Grid>\r\n        })}\r\n      </Grid></CardContent>\r\n      <Divider />\r\n      <CardContent sx={{ py: 1 }}>\r\n        <CloseButton large onClick={onHide} />\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { Lock, LockOpen } from \"@mui/icons-material\"\r\nimport { Box, Button, ButtonGroup, CardActionArea, CardContent, CardHeader, Grid, IconButton, Skeleton, Typography } from \"@mui/material\"\r\nimport { Suspense, useCallback, useContext, useEffect, useState } from \"react\"\r\nimport Assets from \"../Assets/Assets\"\r\nimport CharacterSheet from \"../Character/CharacterSheet\"\r\nimport CardLight from \"../Components/Card/CardLight\"\r\nimport CharacterDropdownButton from '../Components/Character/CharacterDropdownButton'\r\nimport LocationName from \"../Components/Character/LocationName\"\r\nimport ConditionalWrapper from \"../Components/ConditionalWrapper\"\r\nimport ImgIcon from \"../Components/Image/ImgIcon\"\r\nimport { Stars } from \"../Components/StarDisplay\"\r\nimport StatIcon from \"../Components/StatIcon\"\r\nimport { ascensionMaxLevel } from \"../Data/LevelData\"\r\nimport { DatabaseContext } from \"../Database/Database\"\r\nimport usePromise from \"../ReactHooks/usePromise\"\r\nimport Stat from \"../Stat\"\r\nimport { CharacterKey } from \"../Types/consts\"\r\nimport { ICachedWeapon } from \"../Types/weapon\"\r\nimport WeaponSheet from \"./WeaponSheet\"\r\n\r\ntype WeaponCardProps = { weaponId: string, onClick?: (weaponId: string) => void, onEdit?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, canEquip?: boolean }\r\nexport default function WeaponCard({ weaponId, onClick, onEdit, onDelete, canEquip = false }: WeaponCardProps) {\r\n  const database = useContext(DatabaseContext)\r\n  const [databaseWeapon, updateDatabaseWeapon] = useState(undefined as ICachedWeapon | undefined)\r\n  useEffect(() =>\r\n    weaponId ? database.followWeapon(weaponId, updateDatabaseWeapon) : undefined,\r\n    [weaponId, updateDatabaseWeapon, database])\r\n  const weapon = databaseWeapon\r\n  const weaponSheet = usePromise(weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\r\n\r\n  const filter = useCallback(\r\n    (cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType,\r\n    [weaponSheet],\r\n  )\r\n\r\n  const actionWrapperFunc = useCallback(\r\n    children => <CardActionArea onClick={() => onClick?.(weaponId)} sx={{ height: \"100%\" }}>{children}</CardActionArea>,\r\n    [onClick, weaponId],\r\n  )\r\n\r\n  const equipOnChar = useCallback((charKey: CharacterKey | \"\") => database.setWeaponLocation(weaponId, charKey), [database, weaponId],)\r\n  if (!weapon || !weaponSheet) return null;\r\n  const { level, ascension, refinement, id, location = \"\", lock } = weapon\r\n\r\n\r\n  const weaponTypeKey = weaponSheet.weaponType\r\n  const weaponMainVal = weaponSheet.getMainStatValue(level, ascension).toFixed(Stat.fixedUnit(\"atk\"))\r\n  const weaponSubKey = weaponSheet.getSubStatKey()\r\n  const weaponSubVal = weaponSheet.getSubStatValue(level, ascension).toFixed(Stat.fixedUnit(weaponSubKey))\r\n  const weaponPassiveName = weaponSheet?.passiveName\r\n  const statMap = [[\"weaponATK\", weaponMainVal]]\r\n  weaponPassiveName && statMap.push([weaponSubKey, weaponSubVal])\r\n\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 300 }} />}>\r\n    <ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}>\r\n      <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\r\n        <div className={`grad-${weaponSheet.rarity}star`} >\r\n          <CardHeader title={weaponSheet.name} avatar={<ImgIcon sx={{ fontSize: \"2em\" }} src={Assets.weaponTypes?.[weaponTypeKey]} />} titleTypographyProps={{ variant: \"h6\" }}\r\n            action={!onClick && <IconButton color=\"secondary\" onClick={() => database.updateWeapon({ lock: !lock }, id)}>\r\n              {lock ? <Lock /> : <LockOpen />}\r\n            </IconButton>} />\r\n          <Box sx={{ px: 2 }}>\r\n            <Grid container sx={{ flexWrap: \"nowrap\" }}>\r\n              <Grid item flexGrow={1}>\r\n                <Typography component=\"span\" variant=\"h4\">Lv. {level}</Typography>\r\n                <Typography component=\"span\" variant=\"h4\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\r\n                <Typography variant=\"h5\">Refinement <strong>{refinement}</strong></Typography>\r\n                <Typography><Stars stars={weaponSheet.rarity} colored /></Typography>\r\n              </Grid>\r\n              {/* use flex-end here to align the image to the bottom. */}\r\n              <Grid item container xs={3} md={4} alignContent=\"flex-end\">\r\n                <Box\r\n                  component=\"img\"\r\n                  src={weaponSheet.img}\r\n                  width=\"100%\"\r\n                  height=\"auto\"\r\n                  sx={{ mt: \"auto\" }}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </Box>\r\n        </div>\r\n        <CardContent>\r\n          {statMap.map(([statKey, statVal]) => {\r\n            let unit = Stat.getStatUnit(statKey)\r\n            return <Box key={statKey} sx={{ display: \"flex\" }}>\r\n              <Typography flexGrow={1}>{StatIcon[statKey]} {Stat.getStatName(statKey)}</Typography>\r\n              <Typography>{statVal + unit}</Typography>\r\n            </Box>\r\n          })}\r\n        </CardContent>\r\n        {/* grow to fill the 100% heigh */}\r\n        <Box flexGrow={1} />\r\n        <Grid container sx={{ flexWrap: \"nowrap\", py: 1, px: 2 }} >\r\n          <Grid item xs=\"auto\" flexShrink={1}>\r\n            {canEquip ? <CharacterDropdownButton size=\"small\" noUnselect inventory value={location} onChange={equipOnChar} filter={filter} /> : <LocationName location={location} />}\r\n          </Grid>\r\n          <Grid item flexGrow={1} sx={{ mr: 1 }} />\r\n          <Grid item xs=\"auto\">\r\n            <ButtonGroup sx={{ height: \"100%\" }}>\r\n              {!!onEdit && <Button color=\"info\" size=\"small\" onClick={() => onEdit(id)} >\r\n                <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\r\n              </Button>}\r\n              {!!onDelete && <Button color=\"error\" size=\"small\" onClick={() => onDelete(id)} disabled={!!location || lock} >\r\n                <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\r\n              </Button>}\r\n            </ButtonGroup>\r\n          </Grid>\r\n        </Grid>\r\n      </CardLight>\r\n    </ConditionalWrapper>\r\n  </Suspense>\r\n}","import { Box, ToggleButton } from \"@mui/material\";\r\nimport { useCallback } from \"react\";\r\nimport { allElements, ElementKey } from \"../../Types/consts\";\r\nimport SolidToggleButtonGroup, { SolidToggleButtonGroupProps } from \"../SolidToggleButtonGroup\";\r\nimport { uncoloredEleIcons } from \"../StatIcon\";\r\ntype ElementToggleProps = Omit<SolidToggleButtonGroupProps, \"onChange\" | \"value\"> & {\r\n  onChange: (value: ElementKey | \"\") => void\r\n  value: ElementKey | \"\"\r\n}\r\nexport default function ElementToggle({ value, onChange, ...props }: ElementToggleProps) {\r\n  const cb = useCallback((e, newVal) => onChange(newVal || \"\"), [onChange])\r\n  return <SolidToggleButtonGroup exclusive onChange={cb} value={value || allElements} {...props}>\r\n    {allElements.map(ele => <ToggleButton key={ele} value={ele} >\r\n      <Box sx={{ fontSize: \"2em\", lineHeight: 1 }}>{uncoloredEleIcons[ele]}</Box>\r\n    </ToggleButton>)}\r\n  </SolidToggleButtonGroup>\r\n}\r\n","import CharacterSheet from \"../Character/CharacterSheet\";\r\nimport { ArtCharDatabase } from \"../Database/Database\";\r\nimport { CharacterKey } from \"../Types/consts\";\r\nimport { SortOptions } from \"./SortByFilters\";\r\nexport const sortKeys = [\"level\", \"rarity\", \"name\"]\r\nexport default function characterSortOptions(database: ArtCharDatabase, characterSheets: StrictDict<CharacterKey, CharacterSheet>): SortOptions {\r\n  return {\r\n    new: {\r\n      getValue: (ck) => database._getChar(ck as CharacterKey) ? 0 : 1,\r\n      tieBreaker: \"name\"\r\n    },\r\n    name: {\r\n      getValue: (ck) => ck,\r\n    },\r\n    level: {\r\n      getValue: (ck) => database._getChar(ck as CharacterKey)?.level ?? 0,\r\n      tieBreaker: \"rarity\"\r\n    },\r\n    rarity: {\r\n      getValue: (ck) => characterSheets?.[ck]?.star,\r\n      tieBreaker: \"level\"\r\n    }\r\n  }\r\n}","import { Box, CardActionArea, CardContent, Divider, Grid, Typography } from \"@mui/material\";\r\nimport { useContext, useMemo, useState } from \"react\";\r\nimport { ArtifactSheet } from \"../../Artifact/ArtifactSheet\";\r\nimport Assets from \"../../Assets/Assets\";\r\nimport Character from '../../Character/Character';\r\nimport CharacterSheet from \"../../Character/CharacterSheet\";\r\nimport { DatabaseContext } from \"../../Database/Database\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport { ICachedCharacter } from \"../../Types/character\";\r\nimport { allCharacterKeys, CharacterKey, ElementKey, WeaponTypeKey } from \"../../Types/consts\";\r\nimport characterSortOptions from \"../../Util/CharacterSort\";\r\nimport SortByFilters from \"../../Util/SortByFilters\";\r\nimport WeaponSheet from \"../../Weapon/WeaponSheet\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport CardLight from \"../Card/CardLight\";\r\nimport CloseButton from \"../CloseButton\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport ModalWrapper from \"../ModalWrapper\";\r\nimport SortByButton from \"../SortByButton\";\r\nimport SqBadge from \"../SqBadge\";\r\nimport { Stars } from \"../StarDisplay\";\r\nimport StatIcon from \"../StatIcon\";\r\nimport ElementToggle from \"../ToggleButton/ElementToggle\";\r\nimport WeaponToggle from \"../ToggleButton/WeaponToggle\";\r\n\r\nconst defaultSortKeys = [\"level\", \"rarity\", \"name\"]\r\n\r\ntype characterFilter = (character: ICachedCharacter | undefined, sheet: CharacterSheet) => boolean\r\n\r\ntype CharacterSelectionModalProps = {\r\n  show: boolean,\r\n  newFirst?: boolean\r\n  onHide: () => void,\r\n  onSelect?: (ckey: CharacterKey) => void,\r\n  filter?: characterFilter\r\n}\r\n\r\nexport function CharacterSelectionModal({ show, onHide, onSelect, filter = () => true, newFirst = false }: CharacterSelectionModalProps) {\r\n  const sortKeys = useMemo(() => newFirst ? [\"new\", ...defaultSortKeys] : defaultSortKeys, [newFirst])\r\n  const database = useContext(DatabaseContext)\r\n\r\n  const [sortBy, setsortBy] = useState(sortKeys[0])\r\n  const [ascending, setascending] = useState(false)\r\n  const [elementalFilter, setelementalFilter] = useState<ElementKey | \"\">(\"\")\r\n  const [weaponFilter, setweaponFilter] = useState<WeaponTypeKey | \"\">(\"\")\r\n\r\n  const characterSheets = usePromise(CharacterSheet.getAll(), [])\r\n\r\n  const sortOptions = useMemo(() => characterSheets && characterSortOptions(database, characterSheets), [database, characterSheets])\r\n  const characterKeyList = useMemo(() => characterSheets && sortOptions ? [...new Set(allCharacterKeys)].filter(cKey => filter(database._getChar(cKey), characterSheets[cKey])).filter(cKey => {\r\n    if (elementalFilter && elementalFilter !== characterSheets?.[cKey]?.elementKey) return false\r\n    if (weaponFilter && weaponFilter !== characterSheets?.[cKey]?.weaponTypeKey) return false\r\n    return true\r\n  }).sort(SortByFilters(sortBy, ascending, sortOptions) as (a: CharacterKey, b: CharacterKey) => number) : [],\r\n    [database, characterSheets, filter, elementalFilter, weaponFilter, sortBy, ascending, sortOptions])\r\n\r\n  if (!characterSheets) return null\r\n  return <ModalWrapper open={show} onClose={onHide} >\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Grid container spacing={1} >\r\n          <Grid item>\r\n            <WeaponToggle sx={{ height: \"100%\" }} onChange={setweaponFilter} value={weaponFilter} size=\"small\" />\r\n          </Grid>\r\n          <Grid item flexGrow={1}>\r\n            <ElementToggle sx={{ height: \"100%\" }} onChange={setelementalFilter} value={elementalFilter} size=\"small\" />\r\n          </Grid>\r\n\r\n          <Grid item flexGrow={1} />\r\n\r\n          <Grid item >\r\n            <SortByButton sx={{ height: \"100%\" }}\r\n              sortKeys={sortKeys} value={sortBy} onChange={setsortBy as any}\r\n              ascending={ascending} onChangeAsc={setascending} />\r\n          </Grid>\r\n          <Grid item>\r\n            <CloseButton onClick={onHide} />\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent><Grid container spacing={1}>\r\n        {characterKeyList.map(characterKey => <Grid item key={characterKey} xs={6} md={4} lg={3} >\r\n          <CharacterBtn key={characterKey} characterKey={characterKey} onClick={() => { onHide(); onSelect?.(characterKey) }} />\r\n        </Grid>)}\r\n      </Grid></CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n\r\nfunction CharacterBtn({ onClick, characterKey }) {\r\n  const database = useContext(DatabaseContext)\r\n  const character = database._getChar(characterKey)\r\n  const characterSheet = usePromise(CharacterSheet.get(characterKey), [characterKey])\r\n  const weapon = character?.equippedWeapon ? database._getWeapon(character.equippedWeapon) : undefined\r\n  const weaponSheet = usePromise(weapon ? WeaponSheet.get(weapon.key) : undefined, [weapon?.key])\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll(), [])\r\n  const stats = useMemo(() => character && characterSheet && weaponSheet && artifactSheets && Character.calculateBuild(character, database, characterSheet, weaponSheet, artifactSheets), [character, characterSheet, weaponSheet, artifactSheets, database])\r\n  if (!characterSheet) return null\r\n  const rarity = characterSheet.star\r\n  return <CardActionArea onClick={onClick} >\r\n    <CardLight sx={{ display: \"flex\", alignItems: \"center\" }}  >\r\n      <Box component=\"img\" src={characterSheet.thumbImg} sx={{ width: 130, height: \"auto\" }} className={`grad-${rarity}star`} />\r\n      <Box sx={{ pl: 1 }}>\r\n        <Typography><strong>{characterSheet.name}</strong></Typography>\r\n        {stats && character ? <>\r\n          <Typography variant=\"h6\"> {characterSheet.elementKey && StatIcon[characterSheet.elementKey]} <ImgIcon src={Assets.weaponTypes?.[characterSheet.weaponTypeKey]} />{` `}{Character.getLevelString(character)}</Typography>\r\n          <Typography >\r\n            <SqBadge color=\"success\">{`C${character.constellation}`}</SqBadge>{` `}\r\n            <SqBadge color=\"secondary\"><strong >{stats.tlvl.auto + 1}</strong></SqBadge>{` `}\r\n            <SqBadge color={stats.skillBoost ? \"info\" : \"secondary\"}><strong >{stats.tlvl.skill + 1}</strong></SqBadge>{` `}\r\n            <SqBadge color={stats.burstBoost ? \"info\" : \"secondary\"}><strong >{stats.tlvl.burst + 1}</strong></SqBadge>\r\n          </Typography>\r\n        </> : <>\r\n          <Typography variant=\"h6\"><SqBadge color=\"primary\">NEW</SqBadge></Typography>\r\n        </>}\r\n        <small><Stars stars={characterSheet.star} colored /></small>\r\n      </Box>\r\n    </CardLight>\r\n  </CardActionArea >\r\n}","import { CardContent, Typography } from \"@mui/material\"\r\nimport React from \"react\"\r\nimport CardDark from \"../Components/Card/CardDark\"\r\nimport FieldDisplay, { FieldDisplayList } from \"../Components/FieldDisplay\"\r\nimport { ICalculatedStats } from \"../Types/stats\"\r\nimport statsToFields from \"../Util/FieldUtil\"\r\nexport default function WeaponStatsCard({ title, statsVals = {}, stats }: { title: Displayable, statsVals?: object, stats: ICalculatedStats }) {\r\n  if ((Object.keys(statsVals) as string[]).filter(s => s !== \"modifiers\").length === 0) return null\r\n  const fields = statsToFields(statsVals, stats)\r\n  return <CardDark sx={{ mb: 1 }}>\r\n    <CardContent>\r\n      <Typography>{title}</Typography>\r\n    </CardContent>\r\n    <FieldDisplayList>\r\n      {fields.map((field, i) => <FieldDisplay key={i} field={field} />)}\r\n    </FieldDisplayList>\r\n  </CardDark>\r\n}","import { Lock, LockOpen, SwapHoriz } from \"@mui/icons-material\"\r\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, MenuItem, Typography } from \"@mui/material\"\r\nimport { useCallback, useContext, useEffect, useMemo, useState } from \"react\"\r\nimport Assets from \"../Assets/Assets\"\r\nimport { buildContext } from \"../Build/Build\"\r\nimport CharacterSheet from \"../Character/CharacterSheet\"\r\nimport CardDark from \"../Components/Card/CardDark\"\r\nimport CardLight from \"../Components/Card/CardLight\"\r\nimport CharacterDropdownButton from \"../Components/Character/CharacterDropdownButton\"\r\nimport CloseButton from \"../Components/CloseButton\"\r\nimport ColorText from \"../Components/ColoredText\"\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"../Components/CustomNumberInput\"\r\nimport DocumentDisplay from \"../Components/DocumentDisplay\"\r\nimport DropdownButton from \"../Components/DropdownMenu/DropdownButton\"\r\nimport ImgIcon from \"../Components/Image/ImgIcon\"\r\nimport ModalWrapper from \"../Components/ModalWrapper\"\r\nimport SqBadge from \"../Components/SqBadge\"\r\nimport { Stars } from \"../Components/StarDisplay\"\r\nimport WeaponSelectionModal from \"../Components/Weapon/WeaponSelectionModal\"\r\nimport { ambiguousLevel, ascensionMaxLevel, milestoneLevels } from \"../Data/LevelData\"\r\nimport { database as localDatabase, DatabaseContext } from \"../Database/Database\"\r\nimport useForceUpdate from \"../ReactHooks/useForceUpdate\"\r\nimport usePromise from \"../ReactHooks/usePromise\"\r\nimport { ICachedCharacter } from \"../Types/character\"\r\nimport { CharacterKey } from \"../Types/consts\"\r\nimport { ICalculatedStats } from \"../Types/stats\"\r\nimport { ICachedWeapon } from \"../Types/weapon\"\r\nimport { clamp } from \"../Util/Util\"\r\nimport WeaponCard from \"./WeaponCard\"\r\nimport WeaponSheet from \"./WeaponSheet\"\r\nimport WeaponStatsCard from \"./WeaponStatsCard\"\r\n\r\n\r\ntype WeaponStatsEditorCardProps = {\r\n  weaponId: string\r\n  charData?: {\r\n    character: ICachedCharacter,\r\n    characterSheet: CharacterSheet,\r\n    equippedBuild?: ICalculatedStats\r\n    newBuild?: ICalculatedStats\r\n    characterDispatch: (any) => void\r\n  }\r\n  footer?: boolean\r\n  onClose?: () => void\r\n}\r\nexport default function WeaponDisplayCard({\r\n  weaponId: propWeaponId,\r\n  charData,\r\n  footer = false,\r\n  onClose\r\n}: WeaponStatsEditorCardProps) {\r\n  const database = useContext(DatabaseContext)\r\n  // Use databaseToken anywhere `database._get*` is used\r\n  // Use onDatabaseUpdate when `following` database entries\r\n  const [databaseToken, onDatabaseUpdate] = useForceUpdate()\r\n\r\n  const buildContextObj = useContext(buildContext)\r\n  const weapon = useMemo(() =>\r\n    databaseToken && database._getWeapon(propWeaponId!)!,\r\n    [propWeaponId, databaseToken, database])\r\n  const { key, level, refinement, ascension, lock } = weapon\r\n  const { location = \"\", id } = weapon as Partial<ICachedWeapon>\r\n  const weaponSheet: WeaponSheet | undefined = usePromise(WeaponSheet.get(key), [key])\r\n  const weaponTypeKey = weaponSheet?.weaponType\r\n\r\n  useEffect(() =>\r\n    propWeaponId ? database.followWeapon(propWeaponId, onDatabaseUpdate) : undefined,\r\n    [propWeaponId, onDatabaseUpdate, database])\r\n\r\n  const weaponDispatch = useCallback((newWeapon: Partial<ICachedWeapon>) => {\r\n    database.updateWeapon(newWeapon, propWeaponId)\r\n  }, [propWeaponId, database])\r\n\r\n  const setLevel = useCallback(level => {\r\n    level = clamp(level, 1, 90)\r\n    const ascension = ascensionMaxLevel.findIndex(ascenML => level <= ascenML)\r\n    weaponDispatch({ level, ascension })\r\n  }, [weaponDispatch])\r\n\r\n  const setAscension = useCallback(() => {\r\n    const lowerAscension = ascensionMaxLevel.findIndex(ascenML => level !== 90 && level === ascenML)\r\n    if (ascension === lowerAscension) weaponDispatch({ ascension: ascension + 1 })\r\n    else weaponDispatch({ ascension: lowerAscension })\r\n  }, [weaponDispatch, ascension, level])\r\n\r\n  const build = { ...(charData ? (charData.newBuild ?? charData.equippedBuild) : { weapon: { refineIndex: refinement - 1, level, ascension } }) } as any\r\n\r\n  const characterSheet = usePromise(location ? CharacterSheet.get(location) : undefined, [location])\r\n  const weaponFilter = characterSheet ? (ws) => ws.weaponType === characterSheet.weaponTypeKey : undefined\r\n  const initialWeaponFilter = characterSheet && characterSheet.weaponTypeKey\r\n\r\n  const equipOnChar = useCallback((charKey: CharacterKey | \"\") => id && database.setWeaponLocation(id, charKey), [database, id])\r\n  const filter = useCallback(\r\n    (cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType,\r\n    [weaponSheet],\r\n  )\r\n  const [showModal, setshowModal] = useState(false)\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Grid container spacing={1}>\r\n        <Grid item flexGrow={1}>\r\n          <Grid container spacing={1}>\r\n            <Grid item >\r\n              <WeaponSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={k => weaponDispatch({ key: k })} filter={weaponFilter} weaponFilter={initialWeaponFilter} />\r\n              <ButtonGroup>\r\n                <Button onClick={() => setshowModal(true)} >{weaponSheet?.name ?? \"Select a Weapon\"}</Button>\r\n                <DropdownButton title={`Refinement ${refinement}`}>\r\n                  <MenuItem>Select Weapon Refinement</MenuItem>\r\n                  <Divider />\r\n                  {[...Array(5).keys()].map(key =>\r\n                    <MenuItem key={key} onClick={() => weaponDispatch({ refinement: key + 1 })} selected={refinement === (key + 1)} disabled={refinement === (key + 1)}>\r\n                      {`Refinement ${key + 1}`}\r\n                    </MenuItem>)}\r\n                </DropdownButton>\r\n              </ButtonGroup>\r\n            </Grid>\r\n            <Grid item >\r\n              <ButtonGroup sx={{ bgcolor: t => t.palette.contentLight.main }} >\r\n                <CustomNumberInputButtonGroupWrapper >\r\n                  <CustomNumberInput onChange={setLevel} value={level}\r\n                    startAdornment=\"Lvl. \"\r\n                    inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\" } }}\r\n                    sx={{ width: \"100%\", height: \"100%\", pl: 2 }}\r\n                  />\r\n                </CustomNumberInputButtonGroupWrapper>\r\n                <Button sx={{ pl: 1 }} disabled={!ambiguousLevel(level)} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\r\n                <DropdownButton title={\"Select Level\"} >\r\n                  {milestoneLevels.map(([lv, as]) => {\r\n                    const sameLevel = lv === ascensionMaxLevel[as]\r\n                    const lvlstr = sameLevel ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevel[as]}`\r\n                    const selected = lv === level && as === ascension\r\n                    return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => weaponDispatch({ level: lv, ascension: as })}>{lvlstr}</MenuItem>\r\n                  })}\r\n                </DropdownButton>\r\n              </ButtonGroup>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button color=\"error\" onClick={() => id && database.updateWeapon({ lock: !lock }, id)} startIcon={lock ? <Lock /> : <LockOpen />}>\r\n                {lock ? \"Locked\" : \"Unlocked\"}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n        {!!onClose && <Grid item  >\r\n          <CloseButton onClick={onClose} />\r\n        </Grid>}\r\n        {!!charData && database === localDatabase && <Grid item >\r\n          <SwapBtn weaponTypeKey={weaponTypeKey} onChangeId={id => database.setWeaponLocation(id, charData.character.key)} />\r\n        </Grid>}\r\n      </Grid>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent >\r\n      {(() => {\r\n        if (!weaponSheet) return null\r\n        const substatKey = weaponSheet.getSubStatKey()\r\n        const weaponDisplayMainVal = weaponSheet.getMainStatValue(level, ascension)\r\n        const weaponDisplaySubVal = weaponSheet.getSubStatValue(level, ascension)\r\n        const weaponPassiveName = weaponSheet.passiveName\r\n        const weaponBonusStats = weaponSheet.stats(build)\r\n        const sections = weaponSheet.document\r\n\r\n        return <Grid container spacing={1} >\r\n          <Grid item xs={12} sm={6} md={3} lg={4}>\r\n            <Box component=\"img\" src={weaponSheet.img} className={`grad-${weaponSheet.rarity}star`} sx={{ width: \"100%\", height: \"auto\", borderRadius: 1 }} />\r\n            <Typography><small>{weaponSheet.description}</small></Typography>\r\n          </Grid>\r\n          <Grid item sx={{ mb: -1 }} xs={12} sm={6} md={9} lg={8} >\r\n            <Typography variant=\"h6\" >{process.env.NODE_ENV === \"development\" && <ColorText color=\"warning\">{id || `\"\"`} </ColorText>}{weaponSheet.name} Lv. {WeaponSheet.getLevelString(weapon)} {weaponPassiveName && <SqBadge color=\"info\">Refinement {refinement}</SqBadge>}</Typography>\r\n            <Typography><Stars stars={weaponSheet.rarity} /></Typography>\r\n            <Typography variant=\"subtitle1\">{weaponPassiveName}</Typography>\r\n            <Typography gutterBottom>{weaponPassiveName && weaponSheet.passiveDescription(build)}</Typography>\r\n            {build && <buildContext.Provider value={charData ? buildContextObj : { equippedBuild: build, newBuild: undefined, compareBuild: false, setCompareBuild: undefined }}>\r\n              <WeaponStatsCard title={\"Main Stats\"} statsVals={{ atk: weaponDisplayMainVal, [substatKey]: substatKey ? weaponDisplaySubVal : undefined }} stats={build} />\r\n              <WeaponStatsCard title={\"Bonus Stats\"} statsVals={weaponBonusStats} stats={build} />\r\n            </buildContext.Provider>}\r\n            {charData && sections ? (() => {\r\n              const { equippedBuild, newBuild } = charData\r\n              const characterKey = (newBuild ? newBuild : equippedBuild)?.characterKey as CharacterKey | undefined\r\n              return !!characterKey && < DocumentDisplay  {...{ sections, equippedBuild, newBuild, characterKey }} />\r\n            })() : null}\r\n          </Grid>\r\n        </Grid>\r\n      })()}\r\n    </CardContent>\r\n    {footer && id && <CardContent sx={{ py: 1 }}>\r\n      <Grid container>\r\n        <Grid item flexGrow={1}>\r\n          <CharacterDropdownButton noUnselect inventory value={location} onChange={equipOnChar} filter={filter} />\r\n        </Grid>\r\n        {!!onClose && <Grid item><CloseButton large onClick={onClose} /></Grid>}\r\n      </Grid>\r\n    </CardContent>}\r\n  </CardLight>\r\n}\r\nfunction SwapBtn({ onChangeId, weaponTypeKey }) {\r\n  const database = useContext(DatabaseContext)\r\n  const [show, setShow] = useState(false)\r\n  const open = () => setShow(true)\r\n  const close = () => setShow(false)\r\n\r\n  const clickHandler = (id) => {\r\n    onChangeId(id)\r\n    close()\r\n  }\r\n\r\n  const weaponSheets = usePromise(WeaponSheet.getAll(), [])\r\n\r\n  const weaponIdList = database.weapons.keys.filter(wKey => {\r\n    const dbWeapon = database._getWeapon(wKey)\r\n    if (!dbWeapon) return false\r\n    if (weaponTypeKey && weaponTypeKey !== weaponSheets?.[dbWeapon.key]?.weaponType) return false\r\n    return true\r\n  })\r\n\r\n\r\n  return <>\r\n    <Button color=\"info\" onClick={open} startIcon={<SwapHoriz />} >SWAP WEAPON</Button>\r\n    <ModalWrapper open={show} onClose={close} >\r\n      <CardDark>\r\n        <CardContent sx={{ py: 1 }}>\r\n          <Grid container>\r\n            <Grid item flexGrow={1}>\r\n              <Typography variant=\"h6\">{weaponTypeKey ? <ImgIcon src={Assets.weaponTypes[weaponTypeKey]} /> : null} Swap Weapon</Typography>\r\n            </Grid>\r\n            <Grid item>\r\n              <CloseButton onClick={close} />\r\n            </Grid>\r\n          </Grid>\r\n        </CardContent>\r\n        <Divider />\r\n        <CardContent>\r\n          <Grid container spacing={1}>\r\n            {weaponIdList.map(weaponId =>\r\n              <Grid item key={weaponId} lg={4} md={6} >\r\n                <WeaponCard\r\n                  weaponId={weaponId}\r\n                  onClick={clickHandler}\r\n                />\r\n              </Grid>)}\r\n          </Grid>\r\n        </CardContent>\r\n      </CardDark>\r\n    </ModalWrapper>\r\n  </>\r\n}","import { ExpandMore } from \"@mui/icons-material\"\r\nimport { Accordion, AccordionDetails, AccordionSummary, Box, CardContent, Collapse, Divider, Grid, Skeleton, Typography } from \"@mui/material\"\r\nimport { Suspense, useCallback, useContext, useMemo, useState } from \"react\"\r\nimport { ArtifactSheet } from \"../Artifact/ArtifactSheet\"\r\nimport { buildContext } from \"../Build/Build\"\r\nimport Character from \"../Character/Character\"\r\nimport CharacterSheet from \"../Character/CharacterSheet\"\r\nimport { getFormulaTargetsDisplayHeading } from \"../Character/CharacterUtil\"\r\nimport Formula from \"../Formula\"\r\nimport usePromise from \"../ReactHooks/usePromise\"\r\nimport Stat, { FormulaDisplay } from \"../Stat\"\r\nimport { GetDependencies } from \"../StatDependency\"\r\nimport { ArtifactSetKey } from \"../Types/consts\"\r\nimport { IFieldDisplay } from \"../Types/IFieldDisplay\"\r\nimport { ICalculatedStats } from \"../Types/stats\"\r\nimport WeaponSheet from \"../Weapon/WeaponSheet\"\r\nimport CardDark from \"./Card/CardDark\"\r\nimport CardLight from \"./Card/CardLight\"\r\nimport ColorText from \"./ColoredText\"\r\nimport ExpandButton from \"./ExpandButton\"\r\n\r\nexport default function FormulaCalcCard({ sheets }: {\r\n  sheets: {\r\n    characterSheet: CharacterSheet\r\n    weaponSheet: WeaponSheet,\r\n    artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet>\r\n  }\r\n}) {\r\n  const [expanded, setexpanded] = useState(false)\r\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\r\n  const { newBuild, equippedBuild } = useContext(buildContext)\r\n  //choose which one to display stats for\r\n  const build = newBuild ? newBuild : equippedBuild!\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container>\r\n        <Grid item flexGrow={1}>\r\n          <Typography>Formulas {\"&\"} Calculations</Typography>\r\n          <Typography variant=\"caption\" color=\"text.secondary\">Expand to see every formula and all their calculations.</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <ExpandButton\r\n            expand={expanded}\r\n            onClick={toggle}\r\n            aria-expanded={expanded}\r\n            aria-label=\"show more\"\r\n          >\r\n            <ExpandMore />\r\n          </ExpandButton>\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <CalculationDisplay sheets={sheets} build={build} />\r\n      </CardContent>\r\n    </Collapse>\r\n  </CardLight>\r\n}\r\n\r\nfunction CalculationDisplay({ sheets, build }: {\r\n  sheets: {\r\n    characterSheet: CharacterSheet\r\n    weaponSheet: WeaponSheet,\r\n    artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet>\r\n  },\r\n  build: ICalculatedStats\r\n}) {\r\n  const displayStatKeys = useMemo(() => build && Character.getDisplayStatKeys(build, sheets), [build, sheets])\r\n  if (!build) return null\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />} >\r\n    {Object.entries(displayStatKeys).map(([sectionKey, fields]: [string, any]) => {\r\n      const header = getFormulaTargetsDisplayHeading(sectionKey, sheets, build.characterEle)\r\n      return <CardDark key={sectionKey} sx={{ mb: 1 }}>\r\n        <CardContent sx={{ pb: 1 }}>\r\n          <Typography variant=\"h6\">{header}</Typography>\r\n        </CardContent>\r\n        <Divider />\r\n        <CardContent>\r\n          {fields.map((field, fieldIndex) => {\r\n            if (Array.isArray(field))\r\n              return <FormulaCalculationField key={fieldIndex} fieldKeys={field} build={build} />\r\n            else if (typeof field === \"string\") {//simple statKey field\r\n              const subFormulaKeys: any[] = Stat.getPrintableFormulaStatKeyList(GetDependencies(build, build?.modifiers, [field]), build?.modifiers).reverse()\r\n              return Boolean(subFormulaKeys.length) && <Accordion sx={{ bgcolor: \"contentLight.main\" }} key={fieldIndex}>\r\n                <AccordionSummary expandIcon={<ExpandMore />}>\r\n                  <Typography>{Stat.printStat(field, build)}</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                  {subFormulaKeys.map(subKey =>\r\n                    <Typography key={subKey}>{Stat.printStat(subKey, build)} = <small><FormulaDisplay statKey={subKey} stats={build} modifiers={build.modifiers} expand={false} /></small></Typography>\r\n                  )}\r\n                </AccordionDetails>\r\n              </Accordion>\r\n            }\r\n            return null\r\n          })}\r\n        </CardContent>\r\n      </CardDark>\r\n    })}\r\n  </Suspense>\r\n}\r\n\r\nfunction FormulaCalculationField({ fieldKeys, build }: { fieldKeys: string[], build: ICalculatedStats }) {\r\n  const formula = usePromise(Formula.get(fieldKeys), [fieldKeys])\r\n  if (!formula) return null\r\n  const formulaField = (formula as any).field as IFieldDisplay\r\n  const fieldText = Character.getTalentFieldValue(formulaField, \"text\", build)\r\n  const fieldVariant = Character.getTalentFieldValue(formulaField, \"variant\", build)\r\n  const fieldFormulaText = Character.getTalentFieldValue(formulaField, \"formulaText\", build)\r\n  const fieldFixed = Character.getTalentFieldValue(formulaField, \"fixed\", build) ?? 0\r\n  const fieldUnit = Character.getTalentFieldValue(formulaField, \"unit\", build) ?? \"\"\r\n  const [fieldFormula, fieldFormulaDependency] = Character.getTalentFieldValue(formulaField, \"formula\", build, [] as any)\r\n  if (!fieldFormula || !fieldFormulaDependency) return null\r\n  const fieldValue = fieldFormula?.(build)?.toFixed?.(fieldFixed)\r\n  const subFormulaKeys = Stat.getPrintableFormulaStatKeyList(GetDependencies(build, build?.modifiers, fieldFormulaDependency), build?.modifiers).reverse()\r\n  return <Accordion sx={{ bgcolor: \"contentLight.main\" }}>\r\n    <AccordionSummary expandIcon={<ExpandMore />}>\r\n      <Typography><Box color={`${fieldVariant}.main`} component=\"strong\">{fieldText}</Box> <ColorText color=\"info\">{fieldValue}{fieldUnit}</ColorText></Typography>\r\n    </AccordionSummary>\r\n    <AccordionDetails>\r\n      <Typography><Box color={`${fieldVariant}.main`} component=\"strong\">{fieldText}</Box> <ColorText color=\"info\">{fieldValue}</ColorText> = <small>{fieldFormulaText}</small></Typography>\r\n      {subFormulaKeys.map(subKey =>\r\n        <Typography key={subKey}>{Stat.printStat(subKey, build)} = <small><FormulaDisplay statKey={subKey} stats={build} modifiers={build.modifiers} expand={false} /></small></Typography>\r\n      )}\r\n    </AccordionDetails>\r\n  </Accordion>\r\n}","import { Button, Card, CardContent, Divider, Grid, ToggleButton, Typography } from '@mui/material';\r\nimport { useCallback, useContext, useEffect, useMemo } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport ArtifactCard from '../../Artifact/ArtifactCard';\r\nimport { ArtifactSheet } from '../../Artifact/ArtifactSheet';\r\nimport SetEffectDisplay from '../../Artifact/Component/SetEffectDisplay';\r\nimport { buildContext } from '../../Build/Build';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport SolidToggleButtonGroup from '../../Components/SolidToggleButtonGroup';\r\nimport { database as localDatabase, DatabaseContext } from '../../Database/Database';\r\nimport useForceUpdate from '../../ReactHooks/useForceUpdate';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport { ICachedCharacter } from '../../Types/character';\r\nimport { allSlotKeys, ArtifactSetKey } from '../../Types/consts';\r\nimport { objectFromKeyMap } from '../../Util/Util';\r\nimport WeaponSheet from '../../Weapon/WeaponSheet';\r\nimport Character from \"../Character\";\r\nimport CharacterSheet from '../CharacterSheet';\r\nimport StatDisplayComponent from './StatDisplayComponent';\r\n\r\ntype CharacterArtifactPaneProps = {\r\n  sheets: {\r\n    characterSheet: CharacterSheet\r\n    weaponSheet: WeaponSheet,\r\n    artifactSheets: StrictDict<ArtifactSetKey, ArtifactSheet>\r\n  }\r\n  character: ICachedCharacter,\r\n}\r\nfunction CharacterArtifactPane({ sheets, character, character: { key: characterKey } }: CharacterArtifactPaneProps) {\r\n  const { newBuild, equippedBuild, compareBuild, setCompareBuild } = useContext(buildContext)\r\n  const database = useContext(DatabaseContext)\r\n  const history = useHistory()\r\n  //choose which one to display stats for\r\n  const stats = (newBuild ? newBuild : equippedBuild)\r\n  const mainStatAssumptionLevel = stats?.mainStatAssumptionLevel ?? 0\r\n  const statKeys = useMemo(() => stats && Character.getDisplayStatKeys(stats, sheets), [stats, sheets])\r\n  const edit = useCallback(\r\n    artid => history.push({\r\n      pathname: \"/artifact\",\r\n      artToEditId: artid\r\n    } as any), [history])\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll(), [])\r\n\r\n  // TODO: We can also listen only to equipped artifacts\r\n  const [, updateArt] = useForceUpdate()\r\n  useEffect(() => database.followAnyArt(updateArt))\r\n\r\n  const equipArts = useCallback(() => {\r\n    if (!window.confirm(\"Do you want to equip this artifact build to this character?\")) return\r\n    if (!newBuild) return\r\n    newBuild.equippedArtifacts && database.equipArtifacts(characterKey, newBuild.equippedArtifacts)\r\n  }, [characterKey, newBuild, database])\r\n\r\n  const unequipArts = useCallback(() => {\r\n    if (!window.confirm(\"Do you want to move all the artifacts equipped to inventory?\")) return\r\n    database.equipArtifacts(characterKey, objectFromKeyMap(allSlotKeys, () => \"\"))\r\n  }, [characterKey, database])\r\n  if (!stats) return null\r\n  return <>\r\n    <CardLight sx={{ mb: 1 }}>\r\n      <CardContent>\r\n        <StatDisplayComponent {...{ sheets, character, equippedBuild: (newBuild && !compareBuild) ? undefined : equippedBuild, newBuild, statsDisplayKeys: statKeys }} />\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Grid container spacing={1}>\r\n          <Grid item>\r\n            {newBuild ? <Button onClick={equipArts} className=\"mr-2\">Equip artifacts</Button> : (database === localDatabase && <Button color=\"error\" onClick={unequipArts}>Unequip all artifacts</Button>)}\r\n          </Grid>\r\n          <Grid item>\r\n            {/* Compare against new build toggle */}\r\n            {!!newBuild && <SolidToggleButtonGroup exclusive value={compareBuild} onChange={(e, v) => setCompareBuild?.(v)} size=\"small\">\r\n              <ToggleButton value={false} >\r\n                <small>Show New artifact Stats</small>\r\n              </ToggleButton>\r\n              <ToggleButton value={true} >\r\n                <small>Compare against equipped artifacts</small>\r\n              </ToggleButton>\r\n            </SolidToggleButtonGroup>}\r\n          </Grid>\r\n          <Grid item flexGrow={1}></Grid>\r\n          <Grid item>{!!mainStatAssumptionLevel && <Card sx={{ p: 1, bgcolor: t => t.palette.warning.dark }}><Typography><strong>Assume Main Stats are Level {mainStatAssumptionLevel}</strong></Typography></Card>}</Grid>\r\n        </Grid>\r\n      </CardContent>\r\n    </CardLight>\r\n    <Grid container spacing={1}>\r\n      <Grid item xs={6} md={4} >\r\n        <CardLight sx={{ height: \"100%\" }} ><CardContent sx={{ height: \"100%\" }}><Grid container spacing={2} flexDirection=\"column\" height=\"100%\" >\r\n          {artifactSheets && Object.entries(ArtifactSheet.setEffects(artifactSheets, stats.setToSlots)).map(([setKey, setNumKeyArr]) =>\r\n            <Grid item key={setKey}>\r\n              <Typography variant=\"subtitle1\" gutterBottom>{artifactSheets?.[setKey].name ?? \"\"}</Typography>\r\n              {(setNumKeyArr as any).map(setNumKey => <SetEffectDisplay key={setKey + setNumKey} {...{ setKey, setNumKey, equippedBuild, newBuild, characterKey }} />)}\r\n            </Grid>\r\n          )}\r\n        </Grid></CardContent></CardLight>\r\n      </Grid>\r\n      {allSlotKeys.map(slotKey =>\r\n        !!stats?.equippedArtifacts?.[slotKey] && <Grid item xs={6} md={4} key={stats?.equippedArtifacts?.[slotKey]} >\r\n          <ArtifactCard artifactId={stats?.equippedArtifacts?.[slotKey]} mainStatAssumptionLevel={mainStatAssumptionLevel} onEdit={() => edit(stats?.equippedArtifacts?.[slotKey])} />\r\n        </Grid>\r\n      )}\r\n    </Grid>\r\n  </>\r\n}\r\nexport default CharacterArtifactPane\r\n","import { faEdit, faSave } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { Badge, Box, Button, CardContent, CardMedia, Divider, Grid, Typography } from \"@mui/material\";\r\nimport React, { useContext, useState } from \"react\";\r\nimport Assets from \"../../Assets/Assets\";\r\nimport { buildContext } from \"../../Build/Build\";\r\nimport CardLight from \"../../Components/Card/CardLight\";\r\nimport ImgIcon from \"../../Components/Image/ImgIcon\";\r\nimport { Stars } from \"../../Components/StarDisplay\";\r\nimport StatDisplay from \"../../Components/StatDisplay\";\r\nimport StatIcon from \"../../Components/StatIcon\";\r\nimport useCharacterReducer from \"../../ReactHooks/useCharacterReducer\";\r\nimport Stat from \"../../Stat\";\r\nimport { ICachedCharacter } from \"../../Types/character\";\r\nimport { allElements } from \"../../Types/consts\";\r\nimport { ICalculatedStats } from \"../../Types/stats\";\r\nimport WeaponDisplayCard from \"../../Weapon/WeaponDisplayCard\";\r\nimport WeaponSheet from \"../../Weapon/WeaponSheet\";\r\nimport Character from \"../Character\";\r\nimport CharacterSheet from \"../CharacterSheet\";\r\nimport StatInput from \"../StatInput\";\r\ntype CharacterOverviewPaneProps = {\r\n  characterSheet: CharacterSheet;\r\n  weaponSheet: WeaponSheet\r\n  character: ICachedCharacter\r\n}\r\nexport default function CharacterOverviewPane({ characterSheet, weaponSheet, character, character: { constellation, key: characterKey } }: CharacterOverviewPaneProps) {\r\n  const { newBuild, equippedBuild } = useContext(buildContext)\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const build = newBuild ? newBuild : equippedBuild\r\n  if (!build) return null\r\n  const { tlvl } = build\r\n  const elementKey = build.characterEle\r\n  const weaponTypeKey = characterSheet.weaponTypeKey\r\n  return <Grid container spacing={1}>\r\n    <Grid item xs={12} md={3}  >\r\n      {/* Image card with star and name and level */}\r\n      <CardLight >\r\n        <CardMedia src={characterSheet.cardImg} component=\"img\" width=\"100%\" height=\"auto\" />\r\n        <CardContent>\r\n          <Typography variant=\"h5\" >{characterSheet.name} <ImgIcon src={Assets.weaponTypes?.[weaponTypeKey]} /> {StatIcon[elementKey]} </Typography>\r\n          <Typography><Stars stars={characterSheet.star} colored /></Typography>\r\n          <Typography variant=\"subtitle1\">Lvl. {Character.getLevelString(character)}</Typography>\r\n          <Grid container spacing={1}>\r\n            {[\"auto\", \"skill\", \"burst\"].map(tKey =>\r\n              <Grid item xs={4} key={tKey}>\r\n                <Badge badgeContent={tlvl[tKey] + 1} color={((tKey === \"skill\" && build.skillBoost) || (tKey === \"burst\" && build.burstBoost)) ? \"info\" : \"secondary\"}\r\n                  overlap=\"circular\"\r\n                  anchorOrigin={{\r\n                    vertical: 'bottom',\r\n                    horizontal: 'right',\r\n                  }}\r\n                  sx={{\r\n                    \"& > .MuiBadge-badge\": {\r\n                      fontSize: \"1.25em\",\r\n                      padding: \".25em .4em\",\r\n                      borderRadius: \".5em\",\r\n                      lineHeight: 1,\r\n                      height: \"1.25em\"\r\n                    }\r\n                  }}>\r\n                  <Box component=\"img\" src={characterSheet.getTalentOfKey(tKey, build.characterEle)?.img} width=\"100%\" height=\"auto\" />\r\n                </Badge>\r\n              </Grid>)}\r\n          </Grid>\r\n          <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{characterSheet.constellationName}</Typography>\r\n          <Grid container spacing={1}>\r\n            {[...Array(6).keys()].map(i =>\r\n              <Grid item xs={4} key={i}>\r\n                <Box component=\"img\" src={characterSheet.getTalentOfKey(`constellation${i + 1}`, build.characterEle)?.img}\r\n                  sx={{\r\n                    cursor: \"pointer\",\r\n                    ...(constellation > i ? {} : { filter: \"brightness(50%)\" })\r\n                  }}\r\n                  width=\"100%\" height=\"auto\"\r\n                  onClick={() => characterDispatch({ constellation: (i + 1) === constellation ? i : i + 1 })} />\r\n              </Grid>)}\r\n          </Grid>\r\n        </CardContent>\r\n      </CardLight>\r\n    </Grid>\r\n    <Grid item xs={12} md={9} sx={{\r\n      \"> div:not(:last-child)\": { mb: 1 }\r\n    }} >\r\n      <WeaponDisplayCard {...{ charData: { character, characterSheet, equippedBuild, newBuild, characterDispatch }, weaponId: character.equippedWeapon }} />\r\n      <MainStatsCards {...{ characterSheet, character, equippedBuild, newBuild }} />\r\n    </Grid>\r\n  </Grid >\r\n}\r\nconst EDIT = \"Edit Stats\"\r\nconst EXIT = \"EXIT\"\r\ntype MainStatsCardsProps = {\r\n  characterSheet: CharacterSheet,\r\n  character: ICachedCharacter,\r\n  equippedBuild?: ICalculatedStats,\r\n  newBuild?: ICalculatedStats\r\n}\r\nfunction MainStatsCards({ characterSheet, character, character: { key: characterKey }, equippedBuild, newBuild }: MainStatsCardsProps) {\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n\r\n  const additionalKeys = [\"eleMas\", \"critRate_\", \"critDMG_\", \"enerRech_\", \"heal_\"]\r\n  const displayStatKeys = [\"finalHP\", \"finalATK\", \"finalDEF\"]\r\n  displayStatKeys.push(...additionalKeys)\r\n  const editStatKeys = [\"hp\", \"hp_\", \"def\", \"def_\", \"atk\", \"atk_\"]\r\n  editStatKeys.push(...additionalKeys)\r\n  const otherStatKeys: any[] = [];\r\n\r\n  [\"physical\", ...allElements].forEach(ele => {\r\n    otherStatKeys.push(`${ele}_dmg_`)\r\n    otherStatKeys.push(`${ele}_res_`)\r\n  })\r\n  otherStatKeys.push(\"stamina\", \"incHeal_\", \"shield_\", \"cdRed_\")\r\n\r\n  const miscStatkeys = [\r\n    \"normal_dmg_\", \"normal_critRate_\",\r\n    \"charged_dmg_\", \"charged_critRate_\",\r\n    \"plunging_dmg_\", \"plunging_critRate_\",\r\n    \"skill_dmg_\", \"skill_critRate_\",\r\n    \"burst_dmg_\", \"burst_critRate_\",\r\n    \"dmg_\", \"electrocharged_dmg_\",\r\n    \"vaporize_dmg_\", \"swirl_dmg_\",\r\n    \"moveSPD_\", \"atkSPD_\",\r\n    \"weakspotDMG_\",\r\n  ]\r\n\r\n  const specializedStatKey = characterSheet.getSpecializedStat(character.ascension)\r\n  const specializedStatVal = characterSheet.getSpecializedStatVal(character.ascension)\r\n  const specializedStatUnit = Stat.getStatUnit(specializedStatKey)\r\n\r\n  const displayNewBuildProps = { character, equippedBuild, newBuild }\r\n  return <>\r\n    <StatDisplayCard\r\n      title=\"Main Base Stats\"\r\n      content={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {displayStatKeys.map(statKey => <Grid item key={statKey} xs={12} lg={6} >\r\n          <StatDisplay statKey={statKey} {...displayNewBuildProps} />\r\n        </Grid>)}\r\n        <Grid item xs={12} lg={6} display=\"flex\" flexDirection=\"row\" justifyContent=\"space-between\">\r\n          <span><b>Specialized:</b> <span>{specializedStatKey && StatIcon[specializedStatKey]} {Stat.getStatName(specializedStatKey)}</span></span>\r\n          <span >{`${specializedStatVal.toFixed(Stat.fixedUnit(specializedStatKey))}${specializedStatUnit}`}</span>\r\n        </Grid>\r\n      </Grid>}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {editStatKeys.map(statKey =>\r\n          <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              disabled={undefined}\r\n              name={<span>{StatIcon[statKey]} {Stat.getStatNameWithPercent(statKey)}</span>}\r\n              placeholder={Stat.getStatNameRaw(statKey)}\r\n              value={character.bonusStats[statKey] ?? 0}\r\n              percent={Stat.getStatUnit(statKey) === \"%\"}\r\n              onValueChange={value => characterDispatch({ type: \"bonusStats\", statKey, value })}\r\n            />\r\n          </Grid>)}\r\n      </Grid>}\r\n    />\r\n    <StatDisplayCard\r\n      title=\"Other Stats\"\r\n      content={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {otherStatKeys.map(statKey => <Grid item xs={12} lg={6} key={statKey} ><StatDisplay statKey={statKey} {...displayNewBuildProps} /></Grid>)}\r\n      </Grid>}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {otherStatKeys.map(statKey =>\r\n          <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              name={<span>{StatIcon[statKey]} {Stat.getStatName(statKey)}</span>}\r\n              placeholder={Stat.getStatNameRaw(statKey)}\r\n              value={character.bonusStats[statKey] ?? (statKey === \"stamina\" ? 100 : 0)}\r\n              percent={Stat.getStatUnit(statKey) === \"%\"}\r\n              defaultValue={statKey === \"stamina\" ? 100 : undefined}\r\n              onValueChange={value => characterDispatch({ type: \"bonusStats\", statKey, value })}\r\n            />\r\n          </Grid>)}\r\n      </Grid>}\r\n    />\r\n    <StatDisplayCard\r\n      title=\"Misc Stats\"\r\n      content={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {miscStatkeys.map(statKey => <Grid item xs={12} lg={6} key={statKey} ><StatDisplay statKey={statKey} {...displayNewBuildProps} /></Grid>)}\r\n      </Grid>}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {miscStatkeys.map(statKey =>\r\n          <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              name={<span>{StatIcon[statKey]} {Stat.getStatName(statKey)}</span>}\r\n              placeholder={Stat.getStatNameRaw(statKey)}\r\n              value={character.bonusStats[statKey] ?? 0}\r\n              percent={Stat.getStatUnit(statKey) === \"%\"}\r\n              onValueChange={value => characterDispatch({ type: \"bonusStats\", statKey, value })}\r\n            />\r\n          </Grid>)}\r\n      </Grid>}\r\n    />\r\n  </>\r\n}\r\nfunction StatDisplayCard({ title, content, editContent }) {\r\n  const [edit, setedit] = useState(false)\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container>\r\n        <Grid item flexGrow={1}>\r\n          <Typography variant=\"subtitle1\">{title}</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <Button size=\"small\" color={edit ? \"error\" : \"info\"} onClick={() => setedit(!edit)} >\r\n            <span><FontAwesomeIcon icon={edit ? faSave : faEdit} /> {edit ? EXIT : EDIT}</span>\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      {edit ? editContent : content}\r\n    </CardContent>\r\n  </CardLight>\r\n}","import { faQuestionCircle } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { Box, CardActionArea, CardContent, Divider, Grid, MenuItem, Typography } from \"@mui/material\";\r\nimport React, { useCallback, useContext, useState } from 'react';\r\nimport { buildContext } from \"../../Build/Build\";\r\nimport BootstrapTooltip from \"../../Components/BootstrapTooltip\";\r\nimport CardDark from \"../../Components/Card/CardDark\";\r\nimport CardLight from \"../../Components/Card/CardLight\";\r\nimport ColorText from \"../../Components/ColoredText\";\r\nimport ConditionalWrapper from \"../../Components/ConditionalWrapper\";\r\nimport DocumentDisplay from \"../../Components/DocumentDisplay\";\r\nimport DropdownButton from \"../../Components/DropdownMenu/DropdownButton\";\r\nimport FieldDisplay, { FieldDisplayList } from \"../../Components/FieldDisplay\";\r\nimport StatIcon from \"../../Components/StatIcon\";\r\nimport useCharacterReducer from \"../../ReactHooks/useCharacterReducer\";\r\nimport Stat from \"../../Stat\";\r\nimport { ElementToReactionKeys } from \"../../StatData\";\r\nimport { ICachedCharacter } from \"../../Types/character\";\r\nimport statsToFields from \"../../Util/FieldUtil\";\r\nimport CharacterSheet from \"../CharacterSheet\";\r\ntype CharacterTalentPaneProps = {\r\n  characterSheet: CharacterSheet,\r\n  character: ICachedCharacter,\r\n}\r\nexport default function CharacterTalentPane({ characterSheet, character, character: { ascension, constellation, key: characterKey } }: CharacterTalentPaneProps) {\r\n  const { newBuild, equippedBuild } = useContext(buildContext)\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const skillBurstList = [[\"auto\", \"Normal/Charged Attack\"], [\"skill\", \"Elemental Skill\"], [\"burst\", \"Elemental Burst\"]]\r\n  const passivesList: Array<[tKey: string, tText: string, asc: number]> = [[\"passive1\", \"Unlocked at Ascension 1\", 1], [\"passive2\", \"Unlocked at Ascension 4\", 4], [\"passive3\", \"Unlocked by Default\", 0]]\r\n  const build = newBuild ? newBuild : equippedBuild\r\n  return <>\r\n    <ReactionDisplay characterSheet={characterSheet} />\r\n    <Grid container spacing={1} sx={{ mb: 1 }}>\r\n      {/* auto, skill, burst */}\r\n      {skillBurstList.map(([tKey, tText]) =>\r\n        <Grid item key={tKey} xs={12} md={6} lg={4} >\r\n          <SkillDisplayCard\r\n            characterSheet={characterSheet}\r\n            character={character}\r\n            characterDispatch={characterDispatch}\r\n            talentKey={tKey}\r\n            subtitle={tText}\r\n          />\r\n        </Grid>)}\r\n      {!!characterSheet.getTalentOfKey(\"sprint\", build?.characterEle) && <Grid item xs={12} md={6} lg={4} >\r\n        <SkillDisplayCard\r\n          characterSheet={characterSheet}\r\n          character={character}\r\n          characterDispatch={characterDispatch}\r\n          talentKey=\"sprint\"\r\n          subtitle=\"Alternative Sprint\"\r\n        />\r\n      </Grid>}\r\n      {!!characterSheet.getTalentOfKey(\"passive\", build?.characterEle) && <Grid item xs={12} md={6} lg={4} >\r\n        <SkillDisplayCard\r\n          characterSheet={characterSheet}\r\n          character={character}\r\n          characterDispatch={characterDispatch}\r\n          talentKey=\"passive\"\r\n          subtitle=\"Passive\"\r\n        />\r\n      </Grid>}\r\n    </Grid>\r\n    <Grid container spacing={1}>\r\n      {/* passives */}\r\n      {passivesList.map(([tKey, tText, asc]) => {\r\n        let enabled = ascension >= asc\r\n        if (!characterSheet.getTalentOfKey(tKey, build?.characterEle)) return null\r\n        return <Grid item key={tKey} style={{ opacity: enabled ? 1 : 0.5 }} xs={12} md={4} >\r\n          <SkillDisplayCard\r\n            characterSheet={characterSheet}\r\n            character={character}\r\n            characterDispatch={characterDispatch}\r\n            talentKey={tKey}\r\n            subtitle={tText}\r\n          />\r\n        </Grid>\r\n      })}\r\n    </Grid>\r\n    <Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography>\r\n    <Grid container spacing={1}>\r\n      {/* constellations */}\r\n      {[...Array(6).keys()].map(i => {\r\n        let tKey = `constellation${i + 1}`\r\n        return <Grid item key={i} xs={12} md={4}\r\n          style={{ opacity: constellation > i ? 1 : 0.5 }}>\r\n          <SkillDisplayCard\r\n            characterSheet={characterSheet}\r\n            character={character}\r\n            characterDispatch={characterDispatch}\r\n            talentKey={tKey}\r\n            subtitle={`Contellation Lv. ${i + 1}`}\r\n            onClickTitle={() => characterDispatch({ constellation: (i + 1) === constellation ? i : i + 1 })}\r\n          />\r\n        </Grid>\r\n      })}\r\n    </Grid>\r\n  </>\r\n}\r\nconst ReactionComponents = {\r\n  superconduct_hit: SuperConductCard,\r\n  electrocharged_hit: ElectroChargedCard,\r\n  overloaded_hit: OverloadedCard,\r\n  pyro_swirl_hit: SwirlCard,\r\n  shattered_hit: ShatteredCard,\r\n  crystalize_hit: CrystalizeCard,\r\n}\r\nfunction ReactionDisplay({ characterSheet }: { characterSheet: CharacterSheet }) {\r\n  const { newBuild, equippedBuild } = useContext(buildContext)\r\n  const build = newBuild ? newBuild : equippedBuild\r\n  if (!build) return null\r\n  const charEleKey = build.characterEle\r\n  const eleInterArr = [...(ElementToReactionKeys[charEleKey] || [])]\r\n  if (!eleInterArr.includes(\"shattered_hit\") && characterSheet.weaponTypeKey === \"claymore\") eleInterArr.push(\"shattered_hit\")\r\n  return <CardLight sx={{ mb: 1 }}>\r\n    <CardContent>\r\n      <Grid container spacing={1}>\r\n        {eleInterArr.map(key => {\r\n          const Ele = ReactionComponents[key]\r\n          if (!Ele) return null\r\n          return <Grid item key={key}><Ele stats={build} /></Grid>\r\n        })}\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\nfunction SuperConductCard({ stats }) {\r\n  const sKey = \"superconduct_hit\"\r\n  return <CardDark><CardContent sx={{ p: 1 }}>\r\n    <Typography color=\"superconduct.main\">{Stat.getStatName(sKey)} {StatIcon.electro}+{StatIcon.cryo} <strong>{stats[sKey]?.toFixed(Stat.fixedUnit(sKey))}</strong></Typography>\r\n  </CardContent></CardDark>\r\n}\r\nfunction ElectroChargedCard({ stats }) {\r\n  const sKey = \"electrocharged_hit\"\r\n  return <CardDark><CardContent sx={{ p: 1 }}>\r\n    <Typography color=\"electrocharged.main\">{Stat.getStatName(sKey)} {StatIcon.electro}+{StatIcon.hydro} <strong>{stats[sKey]?.toFixed(Stat.fixedUnit(sKey))}</strong></Typography>\r\n  </CardContent></CardDark>\r\n}\r\nfunction OverloadedCard({ stats }) {\r\n  const sKey = \"overloaded_hit\"\r\n  return <CardDark><CardContent sx={{ p: 1 }}>\r\n    <Typography color=\"overloaded.main\" >{Stat.getStatName(sKey)} {StatIcon.electro}+{StatIcon.pyro} <strong>{stats[sKey]?.toFixed(Stat.fixedUnit(sKey))}</strong></Typography>\r\n  </CardContent></CardDark>\r\n}\r\n\r\nconst swirlEleToDisplay = {\r\n  \"pyro\": <span>{Stat.getStatName(\"pyro_swirl_hit\")} {StatIcon.pyro} + {StatIcon.anemo}</span>,\r\n  \"electro\": <span>{Stat.getStatName(\"electro_swirl_hit\")} {StatIcon.electro}+{StatIcon.anemo}</span>,\r\n  \"cryo\": <span>{Stat.getStatName(\"cryo_swirl_hit\")} {StatIcon.cryo} + {StatIcon.anemo}</span>,\r\n  \"hydro\": <span>{Stat.getStatName(\"hydro_swirl_hit\")} {StatIcon.hydro} + {StatIcon.anemo}</span>\r\n} as const\r\nfunction SwirlCard({ stats }) {\r\n  const [ele, setele] = useState(Object.keys(swirlEleToDisplay)[0])\r\n  const sKey = `${ele}_swirl_hit`\r\n  return <CardDark sx={{ display: \"flex\" }}>\r\n    <DropdownButton size=\"small\" title={swirlEleToDisplay[ele]} color=\"success\">\r\n      {Object.entries(swirlEleToDisplay).map(([key, element]) => <MenuItem key={key} selected={ele === key} disabled={ele === key} onClick={() => setele(key)}>{element}</MenuItem>)}\r\n    </DropdownButton>\r\n    <Box sx={{ color: `${ele}.main`, p: 1 }}><strong>{stats[sKey]?.toFixed(Stat.fixedUnit(sKey))}</strong></Box>\r\n  </CardDark>\r\n}\r\nfunction ShatteredCard({ stats }) {\r\n  const sKey = \"shattered_hit\"\r\n  const information = <BootstrapTooltip placement=\"top\" title={<Typography>Claymores, Plunging Attacks and <ColorText color=\"geo\">Geo DMG</ColorText></Typography>}>\r\n    <Box component=\"span\" sx={{ cursor: \"help\" }}><FontAwesomeIcon icon={faQuestionCircle} /></Box>\r\n  </BootstrapTooltip>\r\n\r\n  return <CardDark><CardContent sx={{ p: 1 }}>\r\n    <ColorText color=\"shattered\">{Stat.getStatName(sKey)} {StatIcon.hydro}+{StatIcon.cryo}+ <ColorText color=\"physical\"><small>Heavy Attack{information} </small></ColorText> <strong>{stats[sKey]?.toFixed(Stat.fixedUnit(sKey))}</strong></ColorText>\r\n  </CardContent></CardDark>\r\n}\r\nconst crystalizeEleToDisplay = {\r\n  \"default\": <ColorText color=\"crystalize\">{Stat.getStatName(\"crystalize_hit\")} {StatIcon.electro}/{StatIcon.hydro}/{StatIcon.pyro}/{StatIcon.cryo}+{StatIcon.geo}</ColorText>,\r\n  \"pyro\": <span>{Stat.getStatName(\"pyro_crystalize_hit\")} {StatIcon.pyro}+{StatIcon.geo}</span>,\r\n  \"electro\": <span>{Stat.getStatName(\"electro_crystalize_hit\")} {StatIcon.electro}+{StatIcon.geo}</span>,\r\n  \"cryo\": <span>{Stat.getStatName(\"cryo_crystalize_hit\")} {StatIcon.cryo}+{StatIcon.geo}</span>,\r\n  \"hydro\": <span>{Stat.getStatName(\"hydro_crystalize_hit\")} {StatIcon.hydro}+{StatIcon.geo}</span>\r\n} as const\r\nfunction CrystalizeCard({ stats }) {\r\n  const [ele, setele] = useState(Object.keys(crystalizeEleToDisplay)[0])\r\n  const sKey = ele === \"default\" ? \"crystalize_hit\" : `${ele}_crystalize_hit`\r\n  return <CardDark sx={{ display: \"flex\" }}>\r\n    <DropdownButton size=\"small\" title={crystalizeEleToDisplay[ele]} color=\"success\">\r\n      {Object.entries(crystalizeEleToDisplay).map(([key, element]) => <MenuItem key={key} selected={ele === key} disabled={ele === key} onClick={() => setele(key)}>{element}</MenuItem>)}\r\n    </DropdownButton>\r\n    <Box sx={{ color: `${ele}.main`, p: 1 }}><strong>{stats[sKey]?.toFixed(Stat.fixedUnit(sKey))}</strong></Box>\r\n  </CardDark>\r\n}\r\n\r\nconst talentLimits = [1, 1, 2, 4, 6, 8, 10]\r\ntype SkillDisplayCardProps = {\r\n  characterSheet: CharacterSheet\r\n  character: ICachedCharacter,\r\n  characterDispatch: (any) => void,\r\n  talentKey: string,\r\n  subtitle: string,\r\n  onClickTitle?: (any) => any\r\n}\r\nfunction SkillDisplayCard({ characterSheet, character: { talent, ascension, key: characterKey }, characterDispatch, talentKey, subtitle, onClickTitle }: SkillDisplayCardProps) {\r\n  const { newBuild, equippedBuild } = useContext(buildContext)\r\n  let build = newBuild ? newBuild : equippedBuild\r\n\r\n  const actionWrapeprFunc = useCallback(\r\n    children => <CardActionArea onClick={onClickTitle}>{children}</CardActionArea>,\r\n    [onClickTitle],\r\n  )\r\n\r\n  if (!build) return null\r\n  let header: Displayable | null = null\r\n\r\n  if (talentKey in talent) {\r\n    const levelBoost: number = build[`${talentKey}Boost`] ?? 0\r\n    const talentLvlKey = talent[talentKey] + levelBoost\r\n    const setTalentLevel = (tKey, newTalentLevelKey) => {\r\n      talent[tKey] = newTalentLevelKey\r\n      characterDispatch({ talent })\r\n    }\r\n    header = <>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <DropdownButton fullWidth title={`Talent Lv. ${talentLvlKey}`} color={levelBoost ? \"info\" : \"primary\"}>\r\n          {[...Array(talentLimits[ascension] + (talentKey === \"auto\" && !levelBoost ? 1 : 0)).keys()].map(i => //spcial consideration for Tartaglia\r\n            <MenuItem key={i} selected={talent[talentKey] === (i + 1)} disabled={talent[talentKey] === (i + 1)} onClick={() => setTalentLevel(talentKey, i + 1)}>Talent Lv. {i + levelBoost + 1}</MenuItem>)}\r\n        </DropdownButton>\r\n      </CardContent>\r\n      <Divider />\r\n    </>\r\n\r\n  }\r\n  const talentStats = characterSheet.getTalentStats(talentKey, build)\r\n  const talentStatsFields = talentStats && statsToFields(talentStats, build)\r\n  const statsEle = talentStatsFields && !!talentStatsFields.length &&\r\n    <FieldDisplayList >\r\n      {talentStatsFields.map((field, i) =>\r\n        <FieldDisplay key={i} field={field} />)}\r\n    </FieldDisplayList>\r\n\r\n  const talentSheet = characterSheet.getTalentOfKey(talentKey, build.characterEle)\r\n  const sections = talentSheet?.sections\r\n\r\n  return <CardLight sx={{ height: \"100%\" }}>\r\n    {header}\r\n    <CardContent>\r\n      <ConditionalWrapper condition={!!onClickTitle} wrapper={actionWrapeprFunc} >\r\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\r\n          <Grid item>\r\n            <Box component=\"img\" src={talentSheet?.img} sx={{ width: 60, height: \"auto\" }} />\r\n          </Grid>\r\n          <Grid item flexGrow={1} sx={{ pl: 1 }}>\r\n            <Typography variant=\"h6\">{talentSheet?.name}</Typography>\r\n            <Typography variant=\"subtitle1\">{subtitle}</Typography>\r\n          </Grid>\r\n        </Grid>\r\n      </ConditionalWrapper>\r\n      {/* Display document sections */}\r\n      {sections ? <DocumentDisplay {...{ sections, characterKey, equippedBuild, newBuild }} /> : null}\r\n      {statsEle}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { Button, ButtonGroup, Card, CardContent, Divider, Grid, MenuItem, Skeleton, Tab, Tabs, Typography } from '@mui/material';\r\nimport { Suspense, useCallback, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { ArtifactSheet } from '../Artifact/ArtifactSheet';\r\nimport { buildContext } from '../Build/Build';\r\nimport CardDark from '../Components/Card/CardDark';\r\nimport CardLight from '../Components/Card/CardLight';\r\nimport { CharacterSelectionModal } from '../Components/Character/CharacterSelectionModal';\r\nimport CloseButton from '../Components/CloseButton';\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from '../Components/CustomNumberInput';\r\nimport DropdownButton from '../Components/DropdownMenu/DropdownButton';\r\nimport { EnemyExpandCard } from '../Components/EnemyEditor';\r\nimport FormulaCalcCard from '../Components/FormulaCalcCard';\r\nimport { DamageOptionsCard } from '../Components/HitModeEditor';\r\nimport ImgIcon from '../Components/Image/ImgIcon';\r\nimport ElementalData from '../Data/ElementalData';\r\nimport { ambiguousLevel, ascensionMaxLevel, milestoneLevels } from '../Data/LevelData';\r\nimport { DatabaseContext } from '../Database/Database';\r\nimport useCharacterReducer from '../ReactHooks/useCharacterReducer';\r\nimport useForceUpdate from '../ReactHooks/useForceUpdate';\r\nimport usePromise from '../ReactHooks/usePromise';\r\nimport { ICachedCharacter } from '../Types/character';\r\nimport { CharacterKey } from '../Types/consts';\r\nimport { ICalculatedStats } from '../Types/stats';\r\nimport { clamp, deepClone } from '../Util/Util';\r\nimport WeaponSheet from '../Weapon/WeaponSheet';\r\nimport Character from './Character';\r\nimport CharacterArtifactPane from './CharacterDisplay/CharacterArtifactPane';\r\nimport CharacterOverviewPane from './CharacterDisplay/CharacterOverviewPane';\r\nimport CharacterTalentPane from './CharacterDisplay/CharacterTalentPane';\r\nimport CharacterSheet from './CharacterSheet';\r\nimport { initialCharacter } from './CharacterUtil';\r\n\r\ninterface TabPanelProps {\r\n  children?: React.ReactNode;\r\n  value: string;\r\n  current: string | boolean;\r\n}\r\n\r\nfunction TabPanel({ children, current, value, ...other }: TabPanelProps) {\r\n  if (value !== current) return null\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />}>\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== current}\r\n      id={`simple-tabpanel-${value}`}\r\n      aria-labelledby={`simple-tab-${value}`}\r\n      {...other}\r\n    >\r\n      {children}\r\n    </div>\r\n  </Suspense>\r\n}\r\n\r\ntype CharacterDisplayCardProps = {\r\n  characterKey: CharacterKey,\r\n  setCharacterKey?: (any: CharacterKey) => void\r\n  footer?: JSX.Element\r\n  newBuild?: ICalculatedStats,\r\n  onClose?: (any) => void,\r\n  tabName?: string\r\n}\r\nexport default function CharacterDisplayCard({ characterKey, setCharacterKey, footer, newBuild: propNewBuild, onClose, tabName }: CharacterDisplayCardProps) {\r\n  const database = useContext(DatabaseContext)\r\n  const [compareBuild, setCompareBuild] = useState(false)\r\n  // Use databaseToken anywhere `database._get*` is used\r\n  // Use onDatabaseUpdate when `following` database entries\r\n  const [databaseToken, onDatabaseUpdate] = useForceUpdate()\r\n\r\n  // TODO: We probably don't need to fetch all sheets,\r\n  // though this wouldn't affect the performance currently.\r\n  const weaponSheets = usePromise(WeaponSheet.getAll(), [])\r\n  const characterSheets = usePromise(CharacterSheet.getAll(), [])\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll(), [])\r\n\r\n  const character = useMemo(() =>\r\n    databaseToken && (database._getChar(characterKey) ?? initialCharacter(characterKey)),\r\n    [characterKey, databaseToken, database])\r\n  const weapon = useMemo(() =>\r\n    databaseToken && database._getWeapon(character.equippedWeapon),\r\n    [character.equippedWeapon, databaseToken, database])\r\n\r\n  const characterSheet = characterSheets?.[characterKey]\r\n  const weaponSheet = weapon ? weaponSheets?.[weapon.key] : undefined\r\n  const sheets = characterSheet && weaponSheet && artifactSheets && { characterSheet, weaponSheet, artifactSheets }\r\n\r\n  useEffect(() => {\r\n    return database.followChar(characterKey, onDatabaseUpdate)\r\n  }, [characterKey, onDatabaseUpdate, database])\r\n\r\n  useEffect(() => database.followWeapon(character.equippedWeapon, onDatabaseUpdate),\r\n    [character.equippedWeapon, onDatabaseUpdate, database])\r\n\r\n  const newBuild = useMemo(() => {\r\n    if (!propNewBuild) return undefined\r\n    return deepClone(propNewBuild)\r\n  }, [propNewBuild])\r\n\r\n  // set initial state to false, because it fails to check validity of the tab values on 1st load\r\n  const [tab, settab] = useState<string | boolean>(tabName ? tabName : (newBuild ? \"newartifacts\" : \"character\"))\r\n\r\n  const onTab = useCallback((e, v) => settab(v), [settab])\r\n\r\n  const mainStatAssumptionLevel = newBuild?.mainStatAssumptionLevel ?? 0\r\n  const equippedBuild = useMemo(() => databaseToken && characterSheet && weaponSheet && artifactSheets &&\r\n    Character.calculateBuild(character, database, characterSheet, weaponSheet, artifactSheets, mainStatAssumptionLevel),\r\n    [databaseToken, character, characterSheet, weaponSheet, artifactSheets, mainStatAssumptionLevel, database])\r\n\r\n  // main CharacterDisplayCard\r\n  return <CardDark >\r\n    <buildContext.Provider value={{ newBuild, equippedBuild, compareBuild, setCompareBuild }}>\r\n      <CardContent sx={{\r\n        \"> div:not(:last-child)\": { mb: 1 },\r\n      }}>\r\n        <Grid container spacing={1}>\r\n          <Grid item flexGrow={1}>\r\n            <CharSelectDropdown characterSheet={characterSheet} character={character} weaponSheet={weaponSheet} setCharacterKey={setCharacterKey} />\r\n          </Grid>\r\n          {!!mainStatAssumptionLevel && <Grid item><Card sx={{ p: 1, bgcolor: t => t.palette.warning.dark }}><Typography><strong>Assume Main Stats are Level {mainStatAssumptionLevel}</strong></Typography></Card></Grid>}\r\n          {!!onClose && <Grid item>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>}\r\n        </Grid>\r\n        <CardLight>\r\n          <Tabs\r\n            onChange={onTab}\r\n            value={tab}\r\n            variant=\"fullWidth\"\r\n          >\r\n            <Tab value=\"character\" label=\"Character\" />\r\n            {!!newBuild && <Tab value=\"newartifacts\" label=\"New Artifacts\" />}\r\n            <Tab value=\"artifacts\" label={newBuild ? \"Current Artifacts\" : \"Artifacts\"} />\r\n            <Tab value=\"talent\" label=\"Talents\" />\r\n          </Tabs>\r\n        </CardLight>\r\n        <DamageOptionsCard character={character} />\r\n        {!!sheets && <FormulaCalcCard sheets={sheets} />}\r\n        <EnemyExpandCard character={character} />\r\n\r\n        {/* Character Panel */}\r\n        {characterSheet && weaponSheet && <TabPanel value=\"character\" current={tab}>\r\n          <CharacterOverviewPane characterSheet={characterSheet} weaponSheet={weaponSheet} character={character} />\r\n        </TabPanel >}\r\n        {/* Artifacts Panel */}\r\n        {sheets && <buildContext.Provider value={{ newBuild: undefined, equippedBuild, compareBuild, setCompareBuild }}>\r\n          <TabPanel value=\"artifacts\" current={tab} >\r\n            <CharacterArtifactPane sheets={sheets} character={character} />\r\n          </TabPanel >\r\n        </buildContext.Provider>}\r\n        {/* new build panel */}\r\n        {newBuild && sheets && <TabPanel value=\"newartifacts\" current={tab} >\r\n          <CharacterArtifactPane sheets={sheets} character={character} />\r\n        </TabPanel >}\r\n        {/* talent panel */}\r\n        {characterSheet && <TabPanel value=\"talent\" current={tab}>\r\n          <CharacterTalentPane characterSheet={characterSheet} character={character} />\r\n        </TabPanel >}\r\n      </CardContent>\r\n      {!!footer && <Divider />}\r\n      {footer && <CardContent sx={{ py: 1 }}>\r\n        {footer}\r\n      </CardContent>}\r\n    </buildContext.Provider>\r\n  </CardDark>\r\n}\r\n\r\ntype CharSelectDropdownProps = {\r\n  characterSheet?: CharacterSheet,\r\n  weaponSheet?: WeaponSheet,\r\n  character: ICachedCharacter\r\n  disabled?: boolean\r\n  setCharacterKey?: (any: CharacterKey) => void\r\n}\r\nfunction CharSelectDropdown({ characterSheet, weaponSheet, character, character: { key: characterKey, elementKey = \"anemo\", level = 1, ascension = 0 }, disabled, setCharacterKey }: CharSelectDropdownProps) {\r\n  const [showModal, setshowModal] = useState(false)\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const HeaderIconDisplay = characterSheet ? <span >\r\n    <ImgIcon src={characterSheet.thumbImg} sx={{ mr: 1 }} />\r\n    {characterSheet.name}\r\n  </span> : <span>Select a Character</span>\r\n  const setLevel = useCallback((level) => {\r\n    level = clamp(level, 1, 90)\r\n    const ascension = ascensionMaxLevel.findIndex(ascenML => level <= ascenML)\r\n    characterDispatch({ level, ascension })\r\n  }, [characterDispatch])\r\n  const setAscension = useCallback(() => {\r\n    const lowerAscension = ascensionMaxLevel.findIndex(ascenML => level !== 90 && level === ascenML)\r\n    if (ascension === lowerAscension) characterDispatch({ ascension: ascension + 1 })\r\n    else characterDispatch({ ascension: lowerAscension })\r\n  }, [characterDispatch, ascension, level])\r\n  return <>{!disabled ? <>\r\n    <CharacterSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={setCharacterKey} />\r\n    <ButtonGroup sx={{ bgcolor: t => t.palette.contentDark.main }} >\r\n      <Button disabled={!setCharacterKey} onClick={() => setshowModal(true)} startIcon={<ImgIcon src={characterSheet?.thumbImg} />} >{characterSheet?.name ?? \"Select a Character\"}</Button>\r\n      {characterSheet?.sheet && \"talents\" in characterSheet?.sheet && <DropdownButton title={ElementalData[elementKey].name}>\r\n        {Object.keys(characterSheet.sheet.talents).map(eleKey =>\r\n          <MenuItem key={eleKey} selected={elementKey === eleKey} disabled={elementKey === eleKey} onClick={() => characterDispatch({ elementKey: eleKey })}>\r\n            <strong>{ElementalData[eleKey].name}</strong></MenuItem>)}\r\n      </DropdownButton>}\r\n      <CustomNumberInputButtonGroupWrapper >\r\n        <CustomNumberInput onChange={setLevel} value={level}\r\n          startAdornment=\"Lvl. \"\r\n          inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\" } }}\r\n          sx={{ width: \"100%\", height: \"100%\", pl: 2 }}\r\n          disabled={!characterSheet} />\r\n      </CustomNumberInputButtonGroupWrapper>\r\n      <Button sx={{ pl: 1 }} disabled={!ambiguousLevel(level) || !characterSheet} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\r\n      <DropdownButton title={\"Select Level\"} disabled={!characterSheet}>\r\n        {milestoneLevels.map(([lv, as]) => {\r\n          const sameLevel = lv === ascensionMaxLevel[as]\r\n          const lvlstr = sameLevel ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevel[as]}`\r\n          const selected = lv === level && as === ascension\r\n          return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => characterDispatch({ level: lv, ascension: as })}>{lvlstr}</MenuItem>\r\n        })}\r\n      </DropdownButton>\r\n    </ButtonGroup>\r\n  </> : <Typography variant=\"h6\">{HeaderIconDisplay} {characterSheet && weaponSheet && Character.getLevelString(character)}</Typography>}</>\r\n}"],"sourceRoot":""}
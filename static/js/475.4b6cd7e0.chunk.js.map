{"version":3,"file":"static/js/475.4b6cd7e0.chunk.js","mappings":"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","sources":["Components/Artifact/ArtifactLevelSlider.tsx","Components/Conditional/ConditionalSelector.tsx","Components/Conditional/ConditionalDisplay.tsx","Components/DocumentDisplay.tsx","Components/ExpandButton.tsx","Components/TextButton.tsx","Data/Characters/dataUtil.tsx","Formula/reaction.ts","Components/StatInput.tsx","Components/EnemyEditor.tsx","Components/HitModeEditor.tsx","Formula/DisplayUtil.tsx","Components/Artifact/SetEffectDisplay.tsx","Components/Character/StatDisplayComponent.tsx","ReactHooks/useBoolState.tsx","Components/Artifact/ArtifactCardNano.tsx","Components/Weapon/WeaponCardNano.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildDisplayItem.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/CompareBuildButton.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/ArtifactSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/WeaponSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabEquip/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/BackgroundWorker.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/common.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ArtifactSetConfig.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/AssumeFullLevelToggle.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BonusStatsCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildAlert.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ChartCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/MainStatSelectionCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/OptimizationTargetSelector.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/DBState.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseEquipped.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseExcluded.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/foreground.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview.tsx","PageCharacter/CharacterDisplay/Tabs/TabTalent.tsx","PageCharacter/CharacterDisplay/Tabs/TabTeambuffs.tsx","PageCharacter/CharacterDisplay/index.tsx","PageWeapon/WeaponCard.tsx","ReactHooks/useWeapon.tsx","Util/TimeUtil.ts","Util/WeaponSort.ts"],"sourcesContent":["import { Card, Slider } from \"@mui/material\"\r\nimport { useCallback, useEffect, useState } from \"react\"\r\nimport { clamp } from \"../../Util/Util\"\r\nimport CustomNumberInput from \"../CustomNumberInput\"\r\n\r\nexport default function ArtifactLevelSlider({ levelLow, levelHigh, setLow, setHigh, setBoth, dark = false, disabled = false, showLevelText = false }: {\r\n  levelLow: number,\r\n  levelHigh: number,\r\n  setLow: (low: number) => void,\r\n  setHigh: (high: number) => void,\r\n  setBoth: (low: number, high: number) => void,\r\n  dark?: boolean,\r\n  disabled?: boolean,\r\n  showLevelText?: boolean,\r\n}) {\r\n  const [sliderLow, setsliderLow] = useState(levelLow)\r\n  const [sliderHigh, setsliderHigh] = useState(levelHigh)\r\n  const setSlider = useCallback(\r\n    (e: unknown, value: number | number[]) => {\r\n      if (typeof value == \"number\") throw new TypeError()\r\n      const [l, h] = value\r\n      setsliderLow(l)\r\n      setsliderHigh(h)\r\n    },\r\n    [setsliderLow, setsliderHigh])\r\n  useEffect(() => setsliderLow(levelLow), [setsliderLow, levelLow])\r\n\r\n  useEffect(() => setsliderHigh(levelHigh), [setsliderHigh, levelHigh])\r\n  return <Card sx={{ width: \"100%\", display: \"flex\", alignItems: \"center\", bgcolor: dark ? \"contentDark.main\" : \"contentLight.main\" }}>\r\n    <CustomNumberInput\r\n      value={sliderLow}\r\n      onChange={val => setLow(clamp(val, 0, levelHigh))}\r\n      sx={{ px: 1, pl: showLevelText ? 2 : undefined, width: showLevelText ? 100 : 50, }}\r\n      inputProps={{ sx: { textAlign: \"center\" } }}\r\n      startAdornment={showLevelText ? \"Level: \" : undefined}\r\n      disabled={disabled}\r\n    />\r\n    <Slider sx={{ width: 100, flexGrow: 1, mx: 2 }}\r\n      getAriaLabel={() => 'Arifact Level Range'}\r\n      value={[sliderLow, sliderHigh]}\r\n      onChange={setSlider}\r\n      onChangeCommitted={(e, value) => setBoth(value[0], value[1])}\r\n      valueLabelDisplay=\"auto\"\r\n      min={0} max={20} step={1} marks\r\n      disabled={disabled}\r\n    />\r\n    <CustomNumberInput\r\n      value={sliderHigh}\r\n      onChange={val => setHigh(clamp(val, levelLow, 20))}\r\n      sx={{ px: 1, width: 50, }}\r\n      inputProps={{ sx: { textAlign: \"center\" } }}\r\n      disabled={disabled}\r\n    />\r\n  </Card>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank } from '@mui/icons-material';\r\nimport { Button, ButtonGroup, Divider, MenuItem } from '@mui/material';\r\nimport React, { useCallback, useContext } from 'react';\r\nimport { DataContext } from '../../DataContext';\r\nimport { DocumentConditional, IDocumentConditionalExclusive, IDocumentConditionalMultiple } from '../../Types/sheet';\r\nimport { deepClone, deletePropPath, layeredAssignment } from '../../Util/Util';\r\nimport DropdownButton from '../DropdownMenu/DropdownButton';\r\nimport SqBadge from '../SqBadge';\r\nimport { Translate } from '../Translate';\r\n\r\ninterface ConditionalSelectorProps {\r\n  conditional: DocumentConditional,\r\n  disabled?: boolean,\r\n}\r\nexport default function ConditionalSelector({ conditional, disabled = false, }: ConditionalSelectorProps) {\r\n  if (Object.keys(conditional.states).length === 1 && \"path\" in conditional) {\r\n    return <SimpleConditionalSelector conditional={conditional} disabled={disabled} />\r\n  } else if (\"path\" in conditional) {\r\n    return <ExclusiveConditionalSelector conditional={conditional} disabled={disabled} />\r\n  } else /*if (\"path\" in Object.entries(conditional.states)[0]) */ {\r\n    return <MultipleConditionalSelector conditional={conditional} disabled={disabled} />\r\n  }\r\n}\r\n\r\ninterface SimpleConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalExclusive\r\n}\r\nfunction SimpleConditionalSelector({ conditional, disabled }: SimpleConditionalSelectorProps) {\r\n  const { character, characterDispatch, data } = useContext(DataContext)\r\n  const setConditional = useCallback((v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, conditional.path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, conditional.path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [conditional, character, characterDispatch])\r\n\r\n  const conditionalValue = data.get(conditional.value).value\r\n  const [stateKey, st] = Object.entries(conditional.states)[0]\r\n  const badge = getStateBadge(st.name)\r\n  const condName = getCondName(conditional.name)\r\n\r\n  return <Button fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} onClick={() => setConditional(conditionalValue ? undefined : stateKey)} disabled={disabled} startIcon={conditionalValue ? <CheckBox /> : <CheckBoxOutlineBlank />}>\r\n    {condName} {badge}\r\n  </Button>\r\n}\r\n\r\ninterface ExclusiveConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalExclusive\r\n}\r\nfunction ExclusiveConditionalSelector({ conditional, disabled }: ExclusiveConditionalSelectorProps) {\r\n  const { character, characterDispatch, data } = useContext(DataContext)\r\n  const setConditional = useCallback((v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, conditional.path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, conditional.path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [conditional, character, characterDispatch])\r\n\r\n  const conditionalValue = data.get(conditional.value).value\r\n  const state = conditionalValue ? conditional.states[conditionalValue] : undefined\r\n  const badge = state ? getStateBadge(state.name) : <SqBadge color=\"secondary\">Not Active</SqBadge>\r\n  const condName = getCondName(conditional.name)\r\n\r\n  return <DropdownButton fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} title={<span>{condName} {badge}</span>} disabled={disabled}>\r\n    <MenuItem onClick={() => setConditional()} selected={!state} disabled={!state}>\r\n      <span>Not Active</span>\r\n    </MenuItem>\r\n    <Divider />\r\n    {Object.entries(conditional.states).map(([stateKey, st]) =>\r\n      <MenuItem key={stateKey} onClick={() => setConditional(stateKey)} selected={conditionalValue === stateKey} disabled={conditionalValue === stateKey} >{st.name}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n\r\ninterface MultipleConditionalSelectorProps extends ConditionalSelectorProps {\r\n  conditional: IDocumentConditionalMultiple\r\n}\r\nfunction MultipleConditionalSelector({ conditional, disabled }: MultipleConditionalSelectorProps) {\r\n  const { character, characterDispatch, data } = useContext(DataContext)\r\n  const setConditional = useCallback((path: readonly string[], v?: string) => {\r\n    const conditionalValues = deepClone(character.conditional)\r\n    if (v) {\r\n      layeredAssignment(conditionalValues, path, v)\r\n    } else {\r\n      deletePropPath(conditionalValues, path)\r\n    }\r\n    characterDispatch({ conditional: conditionalValues })\r\n  }, [character, characterDispatch])\r\n\r\n  return <ButtonGroup fullWidth orientation=\"vertical\" disableElevation color=\"secondary\" >\r\n    {Object.entries(conditional.states).map(([stateKey, st]) => {\r\n      const conditionalValue = data.get(st.value).value\r\n      const isSelected = conditionalValue === stateKey\r\n      return <Button\r\n        color={isSelected ? \"success\" : \"primary\"}\r\n        disabled={disabled}\r\n        fullWidth\r\n        key={stateKey}\r\n        onClick={() => setConditional(st.path, conditionalValue ? undefined : stateKey)}\r\n        size=\"small\"\r\n        startIcon={isSelected ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n        sx={{ borderRadius: 0 }}\r\n      >\r\n        {getCondName(st.name)}\r\n      </Button>\r\n    })}\r\n  </ButtonGroup>\r\n}\r\n\r\nfunction isElement(disp: Displayable): disp is JSX.Element {\r\n  return (typeof disp !== \"string\")\r\n}\r\n\r\n// Use colored badges instead of colored text inside these buttons\r\nfunction getStateBadge(stateName: Displayable | undefined): Displayable {\r\n  if (!stateName) return \"\"\r\n\r\n  let badgeColor = \"primary\"\r\n  let badgeText = stateName\r\n  if (stateName && isElement(stateName)) {\r\n    if (stateName.props.color) {\r\n      badgeColor = stateName.props.color\r\n      badgeText = <span>{stateName.props.children}</span>\r\n    }\r\n  }\r\n  return <SqBadge sx={{ ml: 0.5 }} color={badgeColor}>{badgeText}</SqBadge>\r\n}\r\n\r\n// Use colored badges instead of colored text inside these buttons\r\nfunction getCondName(condName: Displayable): Displayable {\r\n  if (isElement(condName)) {\r\n    const key = condName.props.key18\r\n    const ns = condName.props.ns\r\n    const values = condName.props.values\r\n    return <Translate ns={ns} key18={key} values={values} useBadge />\r\n  }\r\n  return condName\r\n}\r\n","import { CardContent } from \"@mui/material\"\r\nimport { useContext } from \"react\"\r\nimport { DataContext } from \"../../DataContext\"\r\nimport { DocumentConditional, DocumentSection } from \"../../Types/sheet\"\r\nimport { evalIfFunc } from \"../../Util/Util\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport { HeaderDisplay } from \"../DocumentDisplay\"\r\nimport FieldsDisplay from \"../FieldDisplay\"\r\nimport ConditionalSelector from \"./ConditionalSelector\"\r\n\r\ntype ConditionalDisplayProps = {\r\n  conditional: DocumentConditional,\r\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\r\n  hideDesc?: boolean,\r\n}\r\n\r\nexport default function ConditionalDisplay({ conditional, hideHeader = false, hideDesc = false }: ConditionalDisplayProps) {\r\n  const { data } = useContext(DataContext)\r\n  let fields\r\n  if (\"path\" in conditional) {\r\n    const condVal = data.get(conditional.value).value\r\n    fields = condVal && conditional.states[condVal]?.fields\r\n  } else /* if (\"path\" in Object.entries(conditional.states)[0]) */ {\r\n    fields = Object.values(conditional.states).flatMap(state => {\r\n      const stateVal = data.get(state.value).value\r\n      return stateVal ? state.fields : []\r\n    })\r\n  }\r\n  return <CardDark>\r\n    {!evalIfFunc(hideHeader, conditional) && <HeaderDisplay header={conditional.header} hideDesc={hideDesc} />}\r\n    <CardContent sx={{ p: 0, \"&:last-child\": { pb: 0 } }}>\r\n      <ConditionalSelector conditional={conditional} />\r\n    </CardContent>\r\n    {fields && <FieldsDisplay fields={fields} />}\r\n  </CardDark>\r\n}\r\n","import { Box, CardHeader, Divider, Typography } from \"@mui/material\"\r\nimport { useContext } from \"react\"\r\nimport { DataContext } from \"../DataContext\"\r\nimport { DocumentSection, IDocumentFields, IDocumentHeader, IDocumentText } from \"../Types/sheet\"\r\nimport { evalIfFunc } from \"../Util/Util\"\r\nimport CardDark from \"./Card/CardDark\"\r\nimport ConditionalDisplay from \"./Conditional/ConditionalDisplay\"\r\nimport FieldsDisplay from \"./FieldDisplay\"\r\nimport InfoTooltip from \"./InfoTooltip\"\r\n\r\ntype DocumentDisplayProps = {\r\n  sections: DocumentSection[],\r\n  teamBuffOnly?: boolean,\r\n  hideDesc?: boolean,\r\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\r\n}\r\n\r\nexport default function DocumentDisplay({ sections, teamBuffOnly, hideDesc = false, hideHeader = false }: DocumentDisplayProps) {\r\n  const { data } = useContext(DataContext)\r\n  if (!sections.length) return null\r\n  const sectionDisplays = sections.map((s, i) => {\r\n    // If we can't show this section, return null\r\n    if (s.canShow && !data.get(s.canShow).value ) return null\r\n    // If we are showing only teambuffs, and this section is not a teambuff, return null\r\n    if (teamBuffOnly && !s.teamBuff) return null\r\n    return <SectionDisplay section={s} key={i} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  }).filter(s => s)\r\n  if (!sectionDisplays.length) return null\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>{sectionDisplays}</Box>\r\n}\r\n\r\nfunction SectionDisplay({ section, hideDesc = false, hideHeader = false }: { section: DocumentSection, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  if (\"fields\" in section) {\r\n    return <FieldsSectionDisplay section={section} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  } else if (\"states\" in section) {\r\n    return <ConditionalDisplay conditional={section} hideDesc={hideDesc} hideHeader={hideHeader} />\r\n  } else /* if (\"text\" in section) */ {\r\n    return <TextSectionDisplay section={section} />\r\n  }\r\n}\r\n\r\nfunction FieldsSectionDisplay({ section, hideDesc, hideHeader }: { section: IDocumentFields, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  return <CardDark>\r\n    {!evalIfFunc(hideHeader, section) && section.header &&\r\n      <HeaderDisplay header={section.header} hideDesc={hideDesc} hideDivider={section.fields.length === 0} />\r\n    }\r\n    <FieldsDisplay fields={section.fields} />\r\n  </CardDark>\r\n}\r\n\r\nfunction TextSectionDisplay({ section }: { section: IDocumentText }) {\r\n  const { data } = useContext(DataContext)\r\n  return <div>\r\n    {evalIfFunc(section.text, data)}\r\n  </div>\r\n}\r\n\r\nexport function HeaderDisplay({ header, hideDesc, hideDivider }: { header: IDocumentHeader, hideDesc?: boolean, hideDivider?: boolean | ((section: DocumentSection) => boolean) }) {\r\n  const { data } = useContext(DataContext)\r\n  let { icon, title, action } = header\r\n  icon = evalIfFunc(icon, data)\r\n  const description = !hideDesc && evalIfFunc(header.description, data)\r\n  const displayTitle = hideDesc ? title : <span>{title} <InfoTooltip title={<Typography>{description}</Typography>} /></span>\r\n  return <>\r\n    <CardHeader avatar={icon} title={displayTitle} action={action} titleTypographyProps={{ variant: \"subtitle2\" }} />\r\n    {!hideDivider && <Divider />}\r\n  </>\r\n}\r\n","import { IconButton, IconButtonProps, styled } from \"@mui/material\";\r\n\r\ninterface ExpandMoreProps extends IconButtonProps {\r\n  expand: boolean;\r\n}\r\nconst ExpandButton = styled((props: ExpandMoreProps) => {\r\n  const { expand, ...other } = props;\r\n  return <IconButton {...other} />;\r\n})(({ theme, expand }) => ({\r\n  transform: !expand ? 'rotate(0deg)' : 'rotate(180deg)',\r\n  marginLeft: 'auto',\r\n  transition: (theme as any).transitions.create('transform', {\r\n    duration: (theme as any).transitions.duration.shortest,\r\n  }),\r\n}));\r\n\r\nexport default ExpandButton","import { Button, ButtonProps, styled } from \"@mui/material\";\r\n\r\nconst DisabledButton = styled(Button)(({ theme }) => ({\r\n  \"&.Mui-disabled\": {\r\n    backgroundColor: theme.palette.primary.dark,\r\n    color: theme.palette.text.secondary,\r\n  }\r\n}))\r\n\r\nexport default function TextButton({ children, disabled, ...props }: ButtonProps) {\r\n  return <DisabledButton {...props} disabled  >\r\n    {children}\r\n  </DisabledButton>\r\n}\r\n","import { SubstatKey } from \"pipeline\";\r\nimport { input } from \"../../Formula\";\r\nimport { inferInfoMut, mergeData } from \"../../Formula/api\";\r\nimport { reactions } from \"../../Formula/reaction\";\r\nimport { Data, DisplaySub, NumNode } from \"../../Formula/type\";\r\nimport { constant, data, infoMut, lookup, percent, prod, stringPrio, subscript, sum, one } from \"../../Formula/utils\";\r\nimport { allMainStatKeys, MainStatKey } from \"../../Types/artifact\";\r\nimport { CharacterKey, ElementKey, Region } from \"../../Types/consts\";\r\nimport { layeredAssignment, objectKeyMap, objectMap } from \"../../Util/Util\";\r\nimport _charCurves from \"./expCurve_gen.json\";\r\n\r\n// TODO: Remove this conversion after changing the file format\r\nconst charCurves = objectMap(_charCurves, value => [0, ...Object.values(value)])\r\n\r\nconst commonBasic = objectKeyMap([\"hp\", \"atk\", \"def\", \"eleMas\", \"enerRech_\", \"critRate_\", \"critDMG_\", \"heal_\"], key => input.total[key])\r\n\r\nexport const infusionNode = stringPrio(\r\n  input.infusion.nonOverridableSelf,\r\n  input.infusion.team,\r\n  input.infusion.overridableSelf)\r\nconst inferredHitEle = stringPrio(\r\n  lookup(input.hit.move, {\r\n    \"skill\": input.charEle, \"burst\": input.charEle,\r\n  }, undefined),\r\n  lookup(input.weaponType, {\r\n    sword: infusionNode, claymore: infusionNode, polearm: infusionNode,\r\n    catalyst: input.charEle,\r\n  }, undefined),\r\n  \"physical\"\r\n)\r\n\r\nfunction getTalentType(move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\") {\r\n  switch (move) {\r\n    case \"normal\": case \"charged\": case \"plunging\": return \"auto\";\r\n    case \"skill\": return \"skill\";\r\n    case \"burst\": return \"burst\";\r\n  }\r\n}\r\n\r\n/** Note: `additional` applies only to this formula */\r\nexport function customDmgNode(base: NumNode, move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\" | \"elemental\", additional: Data = {}): NumNode {\r\n  return data(input.hit.dmg, mergeData([{\r\n    hit: { base, move: constant(move), ele: additional?.hit?.ele ? undefined : inferredHitEle },\r\n  }, additional]))\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function customShieldNode(base: NumNode, additional?: Data): NumNode {\r\n  const shieldNode = prod(base, sum(one, input.total.shield_))\r\n  return additional ? data(shieldNode, additional) : shieldNode\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function customHealNode(base: NumNode, additional?: Data): NumNode {\r\n  const healInc = input.total.healInc\r\n  const healNode = prod(sum(base, healInc), sum(one, input.total.heal_, input.total.incHeal_))\r\n\r\n  return additional ? data(healNode, additional) : healNode\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function dmgNode(base: MainStatKey | SubstatKey, lvlMultiplier: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional: Data = {}): NumNode {\r\n  const talentType = getTalentType(move)\r\n  return customDmgNode(prod(subscript(input.total[`${talentType}Index`], lvlMultiplier, { key: '_' }), input.total[base]), move, additional)\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function shieldNode(base: MainStatKey | SubstatKey, percent: NumNode | number, flat: NumNode | number, additional?: Data): NumNode {\r\n  return customShieldNode(sum(prod(percent, input.total[base]), flat), additional)\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function healNode(base: MainStatKey | SubstatKey, percent: NumNode | number, flat: NumNode | number, additional?: Data): NumNode {\r\n  return customHealNode(sum(prod(percent, input.total[base]), flat), additional)\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function shieldNodeTalent(base: MainStatKey | SubstatKey, baseMultiplier: number[], flat: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional?: Data): NumNode {\r\n  const talentType = getTalentType(move)\r\n  const talentIndex = input.total[`${talentType}Index`]\r\n  return customShieldNode(sum(\r\n    prod(subscript(talentIndex, baseMultiplier, { key: '_' }), input.total[base]),\r\n    subscript(talentIndex, flat)\r\n  ), additional)\r\n}\r\nexport function shieldElement(element: \"electro\" | \"cryo\" | \"hydro\" | \"pyro\" | \"geo\", shieldNode: NumNode) {\r\n  return infoMut(prod(percent(element === \"geo\" ? 1.5 : 2.5), shieldNode), { variant: element })\r\n}\r\n/** Note: `additional` applies only to this formula */\r\nexport function healNodeTalent(base: MainStatKey | SubstatKey, baseMultiplier: number[], flat: number[], move: \"normal\" | \"charged\" | \"plunging\" | \"skill\" | \"burst\", additional?: Data): NumNode {\r\n  const talentType = getTalentType(move)\r\n  const talentIndex = input.total[`${talentType}Index`]\r\n  return customHealNode(sum(\r\n    prod(subscript(talentIndex, baseMultiplier, { key: '_' }), input.total[base]),\r\n    subscript(talentIndex, flat)\r\n  ), additional)\r\n}\r\nexport function dataObjForCharacterSheet(\r\n  key: CharacterKey,\r\n  element: ElementKey | undefined,\r\n  region: Region | undefined,\r\n  gen: {\r\n    weaponTypeKey: string,\r\n    base: { hp: number, atk: number, def: number },\r\n    curves: { [key in string]?: string },\r\n    ascensions: { props: { [key in string]?: number } }[]\r\n  },\r\n  display: { [key: string]: DisplaySub },\r\n  additional: Data = {},\r\n): Data {\r\n  function curve(base: number, lvlCurve: string): NumNode {\r\n    return prod(base, subscript(input.lvl, charCurves[lvlCurve]))\r\n  }\r\n  display.basic = { ...commonBasic }\r\n  const data: Data = {\r\n    charKey: constant(key),\r\n    base: {},\r\n    weaponType: constant(gen.weaponTypeKey),\r\n    premod: {},\r\n    display,\r\n  }\r\n  if (element) {\r\n    data.charEle = constant(element)\r\n    data.teamBuff = { tally: { [element]: constant(1) } }\r\n    data.display!.basic[`${element}_dmg_`] = input.total[`${element}_dmg_`]\r\n    data.display!.reaction = reactions[element]\r\n  }\r\n  if (region)\r\n    layeredAssignment(data, [\"teamBuff\", \"tally\", region], constant(1))\r\n  if (gen.weaponTypeKey !== \"catalyst\") {\r\n    if (!data.display!.basic) data.display!.basic = {}\r\n    data.display!.basic!.physical_dmg_ = input.total.physical_dmg_\r\n  }\r\n\r\n  let foundSpecial: boolean | undefined\r\n  for (const stat of [...allMainStatKeys, \"def\" as const]) {\r\n    const list: NumNode[] = []\r\n    if (gen.curves[stat])\r\n      list.push(curve(gen.base[stat], gen.curves[stat]!))\r\n    const asc = gen.ascensions.some(x => x.props[stat])\r\n    if (asc)\r\n      list.push(subscript(input.asc, gen.ascensions.map(x => x.props[stat] ?? NaN)))\r\n\r\n    if (!list.length) continue\r\n\r\n    const result = infoMut(list.length === 1 ? list[0] : sum(...list), { key: stat, prefix: \"char\", asConst: true })\r\n    if (stat.endsWith(\"_dmg_\")) result.info!.variant = stat.slice(0, -5) as any\r\n    if (stat === \"atk\" || stat === \"def\" || stat === \"hp\")\r\n      data.base![stat] = result\r\n    else {\r\n      if (foundSpecial) throw new Error(\"Duplicated Char Special\")\r\n      foundSpecial = true\r\n      data.special = result\r\n      data.premod![stat] = input.special\r\n    }\r\n  }\r\n\r\n  return mergeData([data, inferInfoMut(additional)])\r\n}\r\n","import { transformativeReactions } from \"../KeyMap/StatConstants\";\r\nimport { absorbableEle } from \"../Types/consts\";\r\nimport { objectKeyMap } from \"../Util/Util\";\r\nimport { input } from \"./index\";\r\nimport { frac, infoMut, percent, prod, subscript, sum, one } from \"./utils\";\r\n\r\n// https://github.com/Dimbreath/GenshinData/blob/72c9112a7c5e8e5014f61009a1a2764e266aeab7/ExcelBinOutput/ElementCoeffExcelConfigData.json\r\n//   or if the permalink is dead,\r\n// https://github.com/Dimbreath/GenshinData/blob/master/ExcelBinOutput/ElementCoeffExcelConfigData.json\r\n//\r\n// PlayerElementLevelCo\r\nexport const transformativeReactionLevelMultipliers = [-1.0, // lvl 0\r\n  17.165606, 18.535048, 19.904854, 21.274902, 22.6454, 24.649612, 26.640642, 28.868587, 31.36768, 34.143345, 37.201, 40.66, 44.446667, 48.56352, 53.74848, 59.081898, 64.420044, 69.72446, 75.12314, 80.58478, 86.11203, 91.70374, 97.24463, 102.812645, 108.40956, 113.20169, 118.102905, 122.97932, 129.72733, 136.29291, 142.67085, 149.02902, 155.41699, 161.8255, 169.10631, 176.51808, 184.07274, 191.70952, 199.55692, 207.38205, 215.3989, 224.16566, 233.50217, 243.35057, 256.06308, 268.5435, 281.52606, 295.01364, 309.0672, 323.6016, 336.75754, 350.5303, 364.4827, 378.61917, 398.6004, 416.39825, 434.387, 452.95105, 472.60623, 492.8849, 513.56854, 539.1032, 565.51056, 592.53876, 624.4434, 651.47015, 679.4968, 707.79407, 736.67145, 765.64026, 794.7734, 824.67737, 851.1578, 877.74207, 914.2291, 946.74677, 979.4114, 1011.223, 1044.7917, 1077.4437, 1109.9976, 1142.9766, 1176.3695, 1210.1844, 1253.8357, 1288.9528, 1325.4841, 1363.4569, 1405.0974, 1446.8535]\r\n// PlayerShieldLevelCo\r\nexport const crystallizeLevelMultipliers = [-1.0, // lvl 0\r\n  91.1791, 98.707664, 106.23622, 113.76477, 121.29332, 128.82188, 136.35042, 143.87898, 151.40752, 158.93608, 169.99149, 181.07625, 192.19037, 204.0482, 215.939, 227.86275, 247.68594, 267.5421, 287.4312, 303.82642, 320.22522, 336.62762, 352.31927, 368.01093, 383.70255, 394.43237, 405.18146, 415.94992, 426.73764, 437.5447, 450.6, 463.7003, 476.84558, 491.1275, 502.55457, 514.0121, 531.4096, 549.9796, 568.5849, 584.9965, 605.67035, 626.3862, 646.0523, 665.7556, 685.4961, 700.8394, 723.3331, 745.8653, 768.4357, 786.79193, 809.5388, 832.32904, 855.16266, 878.0396, 899.4848, 919.362, 946.0396, 974.7642, 1003.5786, 1030.077, 1056.635, 1085.2463, 1113.9244, 1149.2587, 1178.0648, 1200.2238, 1227.6603, 1257.243, 1284.9174, 1314.7529, 1342.6652, 1372.7524, 1396.321, 1427.3124, 1458.3745, 1482.3358, 1511.9109, 1541.5493, 1569.1537, 1596.8143, 1622.4197, 1648.074, 1666.3761, 1684.6782, 1702.9803, 1726.1047, 1754.6715, 1785.8666, 1817.1375, 1851.0603]\r\n\r\n\r\nconst asConst = true as const\r\n\r\nconst crystallizeMulti1 = subscript(input.lvl, crystallizeLevelMultipliers)\r\nconst crystallizeElemas = prod(40 / 9, frac(input.total.eleMas, 1400))\r\nconst crystallizeHit = infoMut(prod(sum(one, /** + Crystallize bonus */ crystallizeElemas), crystallizeMulti1), { key: \"crystallize\", variant: \"geo\" })\r\n\r\nconst transMulti1 = subscript(input.lvl, transformativeReactionLevelMultipliers)\r\nconst transMulti2 = prod(16, frac(input.total.eleMas, 2000))\r\nconst trans = {\r\n  ...objectKeyMap([\"overloaded\", \"electrocharged\", \"superconduct\", \"shattered\"] as const, reaction => {\r\n    const { multi, variants: [ele] } = transformativeReactions[reaction]\r\n    return infoMut(prod(\r\n      infoMut(prod(multi, transMulti1), { asConst }),\r\n      sum(one, transMulti2, input.total[`${reaction}_dmg_`]),\r\n      input.enemy[`${ele}_resMulti`]),\r\n      { key: `${reaction}_hit`, variant: reaction })\r\n  }),\r\n  swirl: objectKeyMap(transformativeReactions.swirl.variants, ele => infoMut(\r\n    prod(\r\n      infoMut(prod(transformativeReactions.swirl.multi, transMulti1), { asConst }),\r\n      sum(one, transMulti2, input.total.swirl_dmg_),\r\n      input.enemy[`${ele}_resMulti`]),\r\n    { key: `${ele}_swirl_hit`, variant: ele }))\r\n}\r\nexport const reactions = {\r\n  anemo: {\r\n    electroSwirl: trans.swirl.electro,\r\n    pyroSwirl: trans.swirl.pyro,\r\n    cryoSwirl: trans.swirl.cryo,\r\n    hydroSwirl: trans.swirl.hydro,\r\n    shattered: trans.shattered,\r\n  },\r\n  geo: {\r\n    crystallize: crystallizeHit,\r\n    ...Object.fromEntries(absorbableEle.map(e => [`${e}Crystallize`,\r\n    infoMut(prod(percent(2.5), crystallizeHit), { key: `${e}_crystallize`, variant: e })])),\r\n    shattered: trans.shattered,\r\n  },\r\n  electro: {\r\n    overloaded: trans.overloaded,\r\n    electrocharged: trans.electrocharged,\r\n    superconduct: trans.superconduct,\r\n    shattered: trans.shattered,\r\n  },\r\n  hydro: {\r\n    electrocharged: trans.electrocharged,\r\n    shattered: trans.shattered,\r\n  },\r\n  pyro: {\r\n    overloaded: trans.overloaded,\r\n    shattered: trans.shattered,\r\n  },\r\n  cryo: {\r\n    superconduct: trans.superconduct,\r\n    shattered: trans.shattered,\r\n  },\r\n}\r\n","import { Replay } from \"@mui/icons-material\"\r\nimport { Button, ButtonGroup, ButtonGroupProps, styled } from \"@mui/material\"\r\nimport { ReactNode } from \"react\"\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"./CustomNumberInput\"\r\nimport TextButton from \"./TextButton\"\r\n\r\ntype StatInputInput = ButtonGroupProps & {\r\n  name: Displayable,\r\n  children?: ReactNode,\r\n  value: number,\r\n  placeholder?: string,\r\n  defaultValue?: number,\r\n  onValueChange: (newValue: number | undefined) => void,\r\n  percent?: boolean,\r\n  disabled?: boolean,\r\n  onReset?: () => void\r\n}\r\nconst FlexButtonGroup = styled(ButtonGroup)({\r\n  display: \"flex\"\r\n})\r\n\r\nexport default function StatInput({ name, children, value, placeholder, defaultValue = 0, onValueChange, percent = false, disabled = false, onReset, ...restProps }: StatInputInput) {\r\n\r\n  return <FlexButtonGroup {...restProps} >\r\n    {children}\r\n    <TextButton sx={{ whiteSpace: \"nowrap\" }} >\r\n      {name}\r\n    </TextButton>\r\n    <CustomNumberInputButtonGroupWrapper sx={{ flexBasis: 30, flexGrow: 1 }} >\r\n      <CustomNumberInput\r\n        sx={{ px: 1 }}\r\n        inputProps={{\r\n          sx: { textAlign: \"right\" }\r\n        }}\r\n        float={percent}\r\n        placeholder={placeholder}\r\n        value={value}\r\n        onChange={onValueChange}\r\n        disabled={disabled}\r\n        endAdornment={percent ? \"%\" : undefined}\r\n      />\r\n    </CustomNumberInputButtonGroupWrapper>\r\n    <Button onClick={() => onReset ? onReset() : onValueChange(defaultValue)} disabled={disabled || value === defaultValue} >\r\n      <Replay />\r\n    </Button>\r\n  </FlexButtonGroup>\r\n}\r\n","import { faCheckSquare, faSquare } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { ExpandMore } from \"@mui/icons-material\";\r\nimport { Button, CardContent, Chip, Collapse, Grid, Typography } from \"@mui/material\";\r\nimport { useCallback, useContext, useState } from 'react';\r\nimport StatInput from \"./StatInput\";\r\nimport { DataContext } from \"../DataContext\";\r\nimport { uiInput as input } from \"../Formula\";\r\nimport KeyMap, { valueString } from '../KeyMap';\r\nimport { allElementsWithPhy, ElementKeyWithPhy } from \"../Types/consts\";\r\nimport CardLight from \"./Card/CardLight\";\r\nimport ColorText from \"./ColoredText\";\r\nimport ExpandButton from \"./ExpandButton\";\r\nimport { uncoloredEleIcons } from \"./StatIcon\";\r\n\r\nexport function EnemyExpandCard() {\r\n  const { data } = useContext(DataContext)\r\n  const [expanded, setexpanded] = useState(false)\r\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\r\n  const eLvlNode = data.get(input.enemy.level)\r\n  const eDefRed = data.get(input.enemy.defRed)\r\n  const eDefIgn = data.get(input.enemy.defIgn)\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container>\r\n        <Grid item flexGrow={1} alignItems=\"center\">\r\n          <Grid container spacing={1}>\r\n            <Grid item>\r\n              <Chip size=\"small\" color=\"success\" label={<span>{KeyMap.get(eLvlNode.info.key)} <strong>{eLvlNode.value}</strong></span>} />\r\n            </Grid>\r\n            {allElementsWithPhy.map(element => <Grid item key={element}>\r\n              <Typography key={element} ><EnemyResText element={element} /></Typography>\r\n            </Grid>)}\r\n            <Grid item>\r\n              <Typography>DEF Reduction {valueString(eDefRed.value, eDefRed.unit)}</Typography>\r\n            </Grid>\r\n            <Grid item>\r\n              <Typography>DEF Ignore {valueString(eDefIgn.value, eDefIgn.unit)}</Typography>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid item>\r\n          <ExpandButton\r\n            expand={expanded}\r\n            onClick={toggle}\r\n            aria-expanded={expanded}\r\n            aria-label=\"show more\"\r\n            size=\"small\"\r\n            sx={{ p: 0 }}\r\n          >\r\n            <ExpandMore />\r\n          </ExpandButton>\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent>\r\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <EnemyEditor />\r\n      </CardContent>\r\n    </Collapse>\r\n  </CardLight>\r\n}\r\n\r\nexport function EnemyResText({ element }: { element: ElementKeyWithPhy }) {\r\n  const { data } = useContext(DataContext)\r\n  const node = data.get(input.enemy[`${element}_res_`])\r\n  const immune = !isFinite(node.value)\r\n  const content = immune ? <span >{uncoloredEleIcons[element]} IMMUNE</span> :\r\n    <span >{uncoloredEleIcons[element]}RES <strong>{valueString(node.value, node.unit)}</strong></span>\r\n  return <ColorText color={element}>{content}</ColorText>\r\n}\r\n\r\nexport function EnemyEditor({ bsProps = { xs: 12, md: 6 } }: { bsProps?: object }) {\r\n  const { data, character: { enemyOverride }, characterDispatch } = useContext(DataContext)\r\n  const defaultVal = 10\r\n\r\n  const eLvl = enemyOverride.enemyLevel ?? data.get(input.lvl).value\r\n  const eDefRed = enemyOverride.enemyDefIgn_ ?? 0\r\n  const eDefIgn = enemyOverride.enemyDefRed_ ?? 0\r\n  return <Grid container spacing={1}>\r\n    <Grid item {...bsProps}>\r\n      <Button fullWidth sx={{ height: \"100%\" }} size=\"small\" component=\"a\" color=\"warning\" href=\"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances\" target=\"_blank\" rel=\"noreferrer\">\r\n        To get the specific resistance values of enemies, please visit the wiki.\r\n      </Button>\r\n    </Grid>\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyLevel\")}</b>}\r\n        value={eLvl}\r\n        placeholder={KeyMap.getStr(\"enemyLevel\")}\r\n        defaultValue={data.get(input.lvl).value}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value })}\r\n        onReset={() => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value: undefined })}\r\n      />\r\n    </Grid>\r\n    {allElementsWithPhy.map(eleKey => {\r\n      const statKey = `${eleKey}_enemyRes_`\r\n      const val = enemyOverride[statKey]\r\n      const elementImmunity = val === Number.MAX_VALUE\r\n      return <Grid item key={eleKey} {...bsProps}>\r\n        <StatInput\r\n          sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n          name={<ColorText color={eleKey}><b>{KeyMap.get(statKey)}</b></ColorText>}\r\n          value={val ? (elementImmunity ? Infinity : val) : 10}\r\n          placeholder={elementImmunity ? \"Immune \" : KeyMap.getStr(statKey)}\r\n          defaultValue={defaultVal}\r\n          onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey, value })}\r\n          disabled={elementImmunity}\r\n          percent\r\n        >\r\n          <Button color={eleKey} onClick={() => characterDispatch({ type: \"enemyOverride\", statKey, value: elementImmunity ? defaultVal : Number.MAX_VALUE })} >\r\n            <FontAwesomeIcon icon={elementImmunity ? faCheckSquare : faSquare} className=\"fa-fw\" /> Immunity\r\n          </Button>\r\n        </StatInput>\r\n      </Grid>\r\n    })}\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyDefIgn_\")}</b>}\r\n        value={eDefRed}\r\n        placeholder={KeyMap.getStr(\"enemyDefIgn_\")}\r\n        defaultValue={0}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefIgn_\", value })}\r\n        percent\r\n      />\r\n    </Grid>\r\n    <Grid item {...bsProps}>\r\n      <StatInput\r\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\r\n        name={<b>{KeyMap.get(\"enemyDefRed_\")}</b>}\r\n        value={eDefIgn}\r\n        placeholder={KeyMap.getStr(\"enemyDefRed_\")}\r\n        defaultValue={0}\r\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefRed_\", value })}\r\n        percent\r\n      />\r\n    </Grid>\r\n    <Grid item xs={12}>\r\n      <small>Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and GO will do the rest. (e.g. 10% - 20% = -10%)</small>\r\n    </Grid>\r\n  </Grid>\r\n}\r\n","import { Box, MenuItem, ToggleButton, ToggleButtonGroupProps } from \"@mui/material\";\r\nimport { useContext } from 'react';\r\nimport { infusionNode } from \"../Data/Characters/dataUtil\";\r\nimport { DataContext } from \"../DataContext\";\r\nimport { uiInput as input } from \"../Formula\";\r\nimport { ElementKey } from \"../Types/consts\";\r\nimport ColorText from \"./ColoredText\";\r\nimport DropdownButton, { DropdownButtonProps } from \"./DropdownMenu/DropdownButton\";\r\nimport SolidToggleButtonGroup from \"./SolidToggleButtonGroup\";\r\nimport SqBadge from \"./SqBadge\";\r\nimport { uncoloredEleIcons } from \"./StatIcon\";\r\nconst infusionVals = {\r\n  \"\": <span>No Team Melee Infusion</span>,\r\n  \"pyro\": <span >{uncoloredEleIcons.pyro} <SqBadge>Bennett C6</SqBadge> Fire Ventures with Me</span>,\r\n  \"cryo\": <span >{uncoloredEleIcons.cryo} <SqBadge>Chongyun Skill</SqBadge> Spirit Blade: Chonghua's Layered Frost</span>,\r\n}\r\ntype InfusionAuraDropdownProps = Omit<DropdownButtonProps, \"title\" | \"onChange\" | \"children\">\r\nexport function InfusionAuraDropdown(props: InfusionAuraDropdownProps) {\r\n  const { characterSheet, character: { infusionAura }, characterDispatch } = useContext(DataContext)\r\n  if (!characterSheet?.isMelee()) return null\r\n  return <DropdownButton title={infusionVals[infusionAura]} color={infusionAura || \"secondary\"} disableElevation {...props}>\r\n    {Object.entries(infusionVals).map(([key, text]) =>\r\n      <MenuItem key={key} sx={key ? { color: `${key}.main` } : undefined}\r\n        selected={key === infusionAura} disabled={key === infusionAura}\r\n        onClick={() => characterDispatch({ infusionAura: key })}>{text}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n\r\ntype ReactionToggleProps = Omit<ToggleButtonGroupProps, \"color\">\r\nconst sqBadgeStyle = { mx: 0.25, px: 0.25, fontSize: \"1em\" }\r\nexport function ReactionToggle(props: ReactionToggleProps) {\r\n  const { data, character: { reactionMode }, characterDispatch } = useContext(DataContext)\r\n  const charEleKey = data.get(input.charEle).value as ElementKey\r\n  const infusion = data.get(infusionNode).value as ElementKey\r\n  if (![\"pyro\", \"hydro\", \"cryo\"].includes(charEleKey) && ![\"pyro\", \"hydro\", \"cryo\"].includes(infusion)) return null\r\n  return <SolidToggleButtonGroup exclusive baseColor=\"secondary\"\r\n    value={reactionMode} onChange={(_, reactionMode) => characterDispatch({ reactionMode })} {...props}>\r\n    <ToggleButton value=\"\" disabled={reactionMode === \"\"} >No Reactions</ToggleButton >\r\n    {(charEleKey === \"pyro\" || infusion === \"pyro\") && <ToggleButton value=\"pyro_vaporize\" disabled={reactionMode === \"pyro_vaporize\"}>\r\n      <ColorText color=\"vaporize\">\r\n        Vaporize(Pyro)\r\n      </ColorText>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <SqBadge sx={sqBadgeStyle} color=\"hydro\">{uncoloredEleIcons.hydro}</SqBadge>\r\n        +\r\n        <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\r\n      </Box>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"pyro\" || infusion === \"pyro\") && <ToggleButton value={\"pyro_melt\"} disabled={reactionMode === \"pyro_melt\"}>\r\n      <ColorText color=\"melt\">\r\n        Melt(Pyro)\r\n      </ColorText>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <SqBadge sx={sqBadgeStyle} color=\"cryo\">{uncoloredEleIcons.cryo}</SqBadge>\r\n        +\r\n        <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\r\n      </Box>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"hydro\" || infusion === \"hydro\") && <ToggleButton value={\"hydro_vaporize\"} disabled={reactionMode === \"hydro_vaporize\"}>\r\n      <ColorText color=\"vaporize\">\r\n        Vaporize(Hydro)\r\n      </ColorText>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\r\n        +\r\n        <SqBadge sx={sqBadgeStyle} color=\"hydro\">{uncoloredEleIcons.hydro}</SqBadge>\r\n      </Box>\r\n    </ToggleButton >}\r\n    {(charEleKey === \"cryo\" || infusion === \"cryo\") && <ToggleButton value={\"cryo_melt\"} disabled={reactionMode === \"cryo_melt\"}>\r\n      <ColorText color=\"melt\">\r\n        Melt(Cryo)\r\n      </ColorText>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <SqBadge sx={sqBadgeStyle} color=\"pyro\">{uncoloredEleIcons.pyro}</SqBadge>\r\n        +\r\n        <SqBadge sx={sqBadgeStyle} color=\"cryo\">{uncoloredEleIcons.cryo}</SqBadge>\r\n      </Box>\r\n    </ToggleButton >}\r\n  </SolidToggleButtonGroup>\r\n}\r\ntype HitModeToggleProps = Omit<ToggleButtonGroupProps, \"color\">\r\nexport function HitModeToggle(props: HitModeToggleProps) {\r\n  const { character: { hitMode }, characterDispatch } = useContext(DataContext)\r\n  return <SolidToggleButtonGroup exclusive baseColor=\"secondary\"\r\n    value={hitMode} onChange={(_, hitMode) => characterDispatch({ hitMode })} {...props} >\r\n    <ToggleButton value=\"avgHit\" disabled={hitMode === \"avgHit\"}>Avg. DMG</ToggleButton>\r\n    <ToggleButton value=\"hit\" disabled={hitMode === \"hit\"}>Non Crit DMG</ToggleButton>\r\n    <ToggleButton value=\"critHit\" disabled={hitMode === \"critHit\"}>Crit Hit DMG</ToggleButton>\r\n  </SolidToggleButtonGroup>\r\n}\r\n","import { Typography } from \"@mui/material\";\r\nimport { input } from \".\";\r\nimport { ArtifactSheet } from \"../Data/Artifacts/ArtifactSheet\";\r\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\";\r\nimport ColorText from \"../Components/ColoredText\";\r\nimport SqBadge from \"../Components/SqBadge\";\r\nimport { ArtifactSetKey, CharacterKey, ElementKey, WeaponKey } from \"../Types/consts\";\r\nimport { range } from \"../Util/Util\";\r\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\";\r\nimport { DisplaySub } from \"./type\";\r\nimport { NodeDisplay, UIData } from \"./uiData\";\r\n\r\nconst errHeader = {\r\n  title: <ColorText color=\"warning\">ERROR</ColorText>\r\n}\r\n\r\nconst talentMap = {\r\n  normal: \"Normal Atk.\",\r\n  charged: \"Charged Atk.\",\r\n  plunging: \"Plunging Atk.\",\r\n  skill: \"Ele. Skill\",\r\n  burst: \"Ele. Burst\",\r\n  passive: \"Passive\",\r\n  passive1: \"1st Asc. Pass.\",\r\n  passive2: \"4th Asc. Pass.\",\r\n  passive3: \"Util. Pass.\",\r\n  ...Object.fromEntries(range(1, 6).map(i => [`constellation${i}`, `Const. ${i}`]))\r\n}\r\nexport async function getDisplayHeader(data: UIData, sectionKey: string): Promise<{\r\n  title: Displayable,\r\n  icon?: string,\r\n  action?: Displayable\r\n}> {\r\n  if (!sectionKey) return errHeader\r\n  if (sectionKey === \"basic\") return { title: \"Basic Stats\" }\r\n  else if (sectionKey === \"reaction\") return { title: \"Transformative Reactions\" }\r\n  else if (sectionKey.includes(\":\")) {\r\n    const [namespace, key] = sectionKey.split(\":\")\r\n    if (namespace === \"artifact\") {\r\n      const sheet = await ArtifactSheet.get(key as ArtifactSetKey)\r\n      if (!sheet) return errHeader\r\n      return {\r\n        title: sheet.name,\r\n        icon: sheet.defIconSrc\r\n      }\r\n    } else if (namespace === \"weapon\") {\r\n      const sheet = await WeaponSheet.get(key as WeaponKey)\r\n      if (!sheet) return errHeader\r\n      const asc = data.get(input.weapon.asc).value\r\n      return {\r\n        title: sheet.name,\r\n        icon: asc < 2 ? sheet.img : sheet.imgAwaken\r\n      }\r\n    }\r\n  } else {\r\n    const cKey = data.get(input.charKey).value\r\n    const cEle = data.get(input.charEle).value\r\n    if (!cKey || !cEle) return errHeader\r\n    const sheet = await CharacterSheet.get(cKey as CharacterKey)\r\n    const talentKey = [\"normal\", \"charged\", \"plunging\"].includes(sectionKey) ? \"auto\" : sectionKey\r\n    const talent = sheet?.getTalentOfKey(talentKey as any, cEle as ElementKey)\r\n    if (!talent) return errHeader\r\n    const actionText = talentMap[sectionKey]\r\n    return {\r\n      icon: talent.img,\r\n      title: talent.name,\r\n      action: actionText ? <SqBadge ><Typography variant=\"subtitle2\">{actionText}</Typography></SqBadge> : undefined\r\n    }\r\n  }\r\n  return errHeader\r\n}\r\n/**\r\n * Use this function to reorganize the sections to have basic stats at the beginning, and reation at the end.\r\n * @param data\r\n * @returns\r\n */\r\nexport function getDisplaySections(data: UIData,): [string, DisplaySub<NodeDisplay>][] {\r\n  const display = data.getDisplay()\r\n  const sections = Object.entries(display).filter(([key, nodes]) => !Object.values(nodes).every(x => x.isEmpty))\r\n  const basic = sections.filter(([k]) => k === \"basic\")\r\n  const reaction = sections.filter(([k]) => k === \"reaction\")\r\n  const weapon = sections.filter(([k]) => k.startsWith(\"weapon\"))\r\n  const artifact = sections.filter(([k]) => k.startsWith(\"artifact\"))\r\n  const rest = sections.filter(([k]) => k !== \"basic\" && k !== \"reaction\" && !k.startsWith(\"weapon\") && !k.startsWith(\"artifact\"))\r\n\r\n  return [\r\n    ...basic,\r\n    ...rest,\r\n    ...weapon,\r\n    ...artifact,\r\n    ...reaction\r\n  ]\r\n}\r\n","import { Box } from \"@mui/material\"\r\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { ArtifactSetKey, SetNum } from \"../../Types/consts\"\r\nimport DocumentDisplay from \"../DocumentDisplay\"\r\n\r\ntype Data = {\r\n  setKey: ArtifactSetKey,\r\n  setNumKey: SetNum,\r\n  hideHeader?: boolean,\r\n  conditionalsOnly?: boolean\r\n}\r\n\r\nexport default function SetEffectDisplay({ setKey, setNumKey, hideHeader = false, conditionalsOnly = false }: Data) {\r\n  const sheet = usePromise(ArtifactSheet.get(setKey), [setKey])\r\n  if (!sheet) return null\r\n\r\n  const document = conditionalsOnly ? sheet.setEffectDocument(setNumKey)?.filter(section => \"states\" in section) : sheet.setEffectDocument(setNumKey)\r\n  return <Box display=\"flex\" flexDirection=\"column\">\r\n    {document ? <DocumentDisplay sections={document} hideHeader={hideHeader} /> : null}\r\n  </Box>\r\n}\r\n","import { Masonry } from \"@mui/lab\"\r\nimport { CardContent, CardHeader, Divider, ListItem } from \"@mui/material\"\r\nimport { Box } from \"@mui/system\"\r\nimport { useContext, useMemo } from \"react\"\r\nimport CardDark from \"../Card/CardDark\"\r\nimport { FieldDisplayList, NodeFieldDisplay } from \"../FieldDisplay\"\r\nimport ImgIcon from \"../Image/ImgIcon\"\r\nimport { DataContext } from \"../../DataContext\"\r\nimport { getDisplayHeader, getDisplaySections } from \"../../Formula/DisplayUtil\"\r\nimport { DisplaySub } from \"../../Formula/type\"\r\nimport { NodeDisplay } from \"../../Formula/uiData\"\r\nimport { customRead } from \"../../Formula/utils\"\r\nimport usePromise from \"../../ReactHooks/usePromise\"\r\nimport { objectMap } from \"../../Util/Util\"\r\n\r\nexport default function StatDisplayComponent() {\r\n  const { data } = useContext(DataContext)\r\n  const sections = getDisplaySections(data)\r\n  return <Box sx={{ mr: -1, mb: -1 }}>\r\n    <Masonry columns={{ xs: 1, sm: 2, md: 3, xl: 4 }} spacing={1}>\r\n      {sections.map(([key, Nodes]) =>\r\n        <Section key={key} displayNs={Nodes} sectionKey={key} />)}\r\n    </Masonry >\r\n  </Box>\r\n}\r\n\r\nfunction Section({ displayNs, sectionKey }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\r\n  const { data, oldData } = useContext(DataContext)\r\n  const header = usePromise(getDisplayHeader(data, sectionKey), [data, sectionKey])\r\n  const displayNsReads = useMemo(() => objectMap(displayNs, (n, nodeKey) => customRead([\"display\", sectionKey, nodeKey])), [displayNs, sectionKey]);\r\n  if (!header) return <CardDark></CardDark>\r\n\r\n  const { title, icon, action } = header\r\n  return <CardDark >\r\n    <CardHeader avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action} titleTypographyProps={{ variant: \"subtitle1\" }} />\r\n    <Divider />\r\n    <CardContent sx={{ p: 0, \"&:last-child\": { pb: 0 } }}>\r\n      <FieldDisplayList sx={{ m: 0 }}>\r\n        {Object.entries(displayNs).map(([nodeKey, n]) => <NodeFieldDisplay key={nodeKey} node={n} oldValue={oldData ? oldData.get(displayNsReads[nodeKey]!).value : undefined} component={ListItem} />)}\r\n      </FieldDisplayList>\r\n    </CardContent>\r\n  </CardDark>\r\n}\r\n","import { useCallback, useState } from \"react\"\r\n\r\nexport default function useBoolState(initial: boolean = false) {\r\n  const [bool, setBool] = useState(initial)\r\n  const onTrue = useCallback(() => setBool(true), [setBool],)\r\n  const onFalse = useCallback(() => setBool(false), [setBool],)\r\n  return [bool, onTrue, onFalse] as [boolean, () => void, () => void]\r\n}\r\n","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { alpha, Box, CardActionArea, Chip, Typography, useTheme } from \"@mui/material\";\r\nimport { useCallback } from \"react\";\r\nimport Assets from \"../../Assets/Assets\";\r\nimport Artifact from \"../../Data/Artifacts/Artifact\";\r\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\";\r\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\r\nimport KeyMap, { cacheValueString } from \"../../KeyMap\";\r\nimport useArtifact from \"../../ReactHooks/useArtifact\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport { ICachedSubstat } from \"../../Types/artifact\";\r\nimport { allElementsWithPhy, SlotKey } from \"../../Types/consts\";\r\nimport { clamp } from \"../../Util/Util\";\r\nimport BootstrapTooltip from \"../BootstrapTooltip\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport ColorText from \"../ColoredText\";\r\nimport ConditionalWrapper from \"../ConditionalWrapper\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport StatIcon, { uncoloredEleIcons } from \"../StatIcon\";\r\nimport ArtifactSetSlotTooltip from \"./ArtifactSetSlotTooltip\";\r\n\r\ntype Data = {\r\n  artifactId?: string,\r\n  slotKey: SlotKey,\r\n  mainStatAssumptionLevel?: number,\r\n  onClick?: () => void,\r\n  showLocation?: boolean,\r\n  BGComponent?: React.ElementType\r\n}\r\n\r\nexport default function ArtifactCardNano({ artifactId, slotKey: pSlotKey, mainStatAssumptionLevel = 0, showLocation = false, onClick, BGComponent = CardDark }: Data) {\r\n  const art = useArtifact(artifactId)\r\n  const sheet = usePromise(ArtifactSheet.get(art?.setKey), [art])\r\n  const actionWrapperFunc = useCallback(children => <CardActionArea onClick={onClick} sx={{ height: \"100%\" }}>{children}</CardActionArea>, [onClick],)\r\n  const theme = useTheme()\r\n  if (!art) return <BGComponent sx={{ display: \"flex\", height: \"100%\", alignItems: \"center\", justifyContent: \"center\" }}>\r\n    <Box component=\"img\" src={Assets.slot[pSlotKey]} sx={{ width: \"25%\", height: \"auto\", opacity: 0.7 }} />\r\n  </BGComponent>\r\n\r\n  const { slotKey, rarity, level, mainStatKey, substats, location } = art\r\n  const mainStatLevel = Math.max(Math.min(mainStatAssumptionLevel, rarity * 4), level)\r\n  const mainStatUnit = KeyMap.unit(mainStatKey)\r\n  const levelVariant = \"roll\" + (Math.floor(Math.max(level, 0) / 4) + 1)\r\n  const element = allElementsWithPhy.find(ele => art.mainStatKey.includes(ele))\r\n  const color = element ? alpha(theme.palette[element].main, 0.6) : alpha(theme.palette.secondary.main, 0.6)\r\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\r\n    <Box display=\"flex\" height=\"100%\">\r\n      <Box className={`grad-${rarity}star`} sx={{ position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"center\" }} >\r\n        <ArtifactSetSlotTooltip slotKey={slotKey} sheet={sheet}>\r\n          <Box\r\n            component=\"img\"\r\n            src={sheet?.slotIcons[slotKey] ?? \"\"}\r\n            sx={{ m: -1, maxHeight: \"110%\", maxWidth: \"110%\" }}\r\n          />\r\n        </ArtifactSetSlotTooltip>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\r\n          <Chip size=\"small\" label={<strong>{` +${level}`}</strong>} color={levelVariant as any} />\r\n          {showLocation && <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\r\n            overflow: \"visible\", \".MuiChip-label\": {\r\n              overflow: \"visible\"\r\n            }\r\n          }} />}\r\n        </Box>\r\n        {/* mainstats */}\r\n        <Chip size=\"small\" sx={{ position: \"absolute\", bottom: 0, mb: 1, backgroundColor: color }}\r\n          label={<Typography variant=\"h6\" sx={{ display: \"flex\", gap: 1, px: 1, zIndex: 1 }}>\r\n            <BootstrapTooltip placement=\"top\" title={<Typography>{KeyMap.getArtStr(mainStatKey)}</Typography>} disableInteractive>\r\n              <span>{element ? uncoloredEleIcons[element] : StatIcon[mainStatKey]}</span>\r\n            </BootstrapTooltip>\r\n            <ColorText color={mainStatLevel !== level ? \"warning\" : undefined}>{cacheValueString(Artifact.mainStatValue(mainStatKey, rarity, mainStatLevel) ?? 0, KeyMap.unit(mainStatKey))}{mainStatUnit}</ColorText>\r\n          </Typography>} />\r\n      </Box>\r\n      {/* substats */}\r\n      <Box display=\"flex\" flexDirection=\"column\" justifyContent=\"space-between\" sx={{ p: 1, }}>\r\n        {substats.map((stat: ICachedSubstat, i: number) => <SubstatDisplay key={i + stat.key} stat={stat} />)}\r\n      </Box>\r\n    </Box>\r\n  </ConditionalWrapper></BGComponent >\r\n}\r\nfunction SubstatDisplay({ stat }: { stat: ICachedSubstat }) {\r\n  if (!stat.value) return null\r\n  const numRolls = stat.rolls?.length ?? 0\r\n  const rollColor = `roll${clamp(numRolls, 1, 6)}`\r\n  const unit = KeyMap.unit(stat.key)\r\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\r\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} color={(numRolls ? `${rollColor}.main` : \"error.main\") as any} component=\"span\">\r\n      <BootstrapTooltip placement=\"top\" title={<Typography>{stat.key && KeyMap.getArtStr(stat.key)}</Typography>} disableInteractive>\r\n        <span>{StatIcon[stat.key]}</span>\r\n      </BootstrapTooltip>\r\n      <span>{`${cacheValueString(stat.value, KeyMap.unit(stat.key))}${unit}`}</span>\r\n    </Typography>\r\n  </Box>)\r\n}\r\nfunction LocationIcon({ location }) {\r\n  const characterSheet = usePromise(CharacterSheet.get(location ?? \"\"), [location])\r\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\r\n}\r\n","import { BusinessCenter } from \"@mui/icons-material\";\r\nimport { Box, CardActionArea, Chip, Skeleton, Typography } from \"@mui/material\";\r\nimport { useCallback, useMemo } from \"react\";\r\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\r\nimport WeaponSheet from \"../../Data/Weapons/WeaponSheet\";\r\nimport { input } from \"../../Formula\";\r\nimport { computeUIData, dataObjForWeapon } from \"../../Formula/api\";\r\nimport { NodeDisplay } from '../../Formula/uiData';\r\nimport KeyMap, { valueString } from \"../../KeyMap\";\r\nimport usePromise from \"../../ReactHooks/usePromise\";\r\nimport useWeapon from \"../../ReactHooks/useWeapon\";\r\nimport { MainStatKey, SubstatKey } from \"../../Types/artifact\";\r\nimport BootstrapTooltip from \"../BootstrapTooltip\";\r\nimport CardDark from \"../Card/CardDark\";\r\nimport ConditionalWrapper from \"../ConditionalWrapper\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport StatIcon from \"../StatIcon\";\r\nimport WeaponNameTooltip from \"./WeaponNameTooltip\";\r\n\r\ntype Data = {\r\n  weaponId?: string,\r\n  onClick?: () => void,\r\n  showLocation?: boolean,\r\n  BGComponent?: React.ElementType,\r\n}\r\n\r\nexport default function WeaponCardNano({ weaponId, showLocation = false, onClick, BGComponent = CardDark, }: Data) {\r\n  const weapon = useWeapon(weaponId)\r\n  const weaponSheet = usePromise(weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\r\n  const actionWrapperFunc = useCallback(children => <CardActionArea sx={{ height: \"100%\" }} onClick={onClick}>{children}</CardActionArea>, [onClick],)\r\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\r\n  if (!weapon || !weaponSheet || !UIData) return <BGComponent sx={{ height: \"100%\" }}><Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\" }} /></BGComponent>;\r\n  const { refinement, location } = weapon\r\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\r\n    <Box display=\"flex\" height=\"100%\" alignItems=\"stretch\" >\r\n      <Box className={`grad-${weaponSheet.rarity}star`} sx={{ height: \"100%\", position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"flex-end\" }} >\r\n        <WeaponNameTooltip sheet={weaponSheet}>\r\n          <Box\r\n            component=\"img\"\r\n            src={weaponSheet.img}\r\n            sx={{ mx: -1, maxHeight: \"100%\", maxWidth: \"100%\" }}\r\n          />\r\n        </WeaponNameTooltip>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\r\n          <Chip size=\"small\" label={<strong>{WeaponSheet.getLevelString(weapon)}</strong>} color=\"primary\" />\r\n          {showLocation && <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\r\n            overflow: \"visible\", \".MuiChip-label\": {\r\n              overflow: \"visible\"\r\n            }\r\n          }} />}\r\n        </Box>\r\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"flex-end\", alignItems: \"flex-end\" }} >\r\n          {weaponSheet.hasRefinement && <Chip size=\"small\" color=\"info\" label={<strong>R{refinement}</strong>} />}\r\n        </Box>\r\n      </Box>\r\n      <Box display=\"flex\" flexDirection=\"column\" sx={{ p: 1, }}>\r\n        <WeaponStat node={UIData.get(input.weapon.main)} />\r\n        <WeaponStat node={UIData.get(input.weapon.sub)} />\r\n      </Box>\r\n    </Box>\r\n  </ConditionalWrapper></BGComponent >\r\n}\r\nfunction WeaponStat({ node }: { node: NodeDisplay }) {\r\n  if (!node.info.key) return null\r\n  const val = valueString(node.value, node.unit, !node.unit ? 0 : undefined)\r\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\r\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} component=\"span\">\r\n      <BootstrapTooltip placement=\"top\" title={<Typography>{node.info.key && KeyMap.getArtStr(node.info.key as MainStatKey | SubstatKey)}</Typography>} disableInteractive>\r\n        <span>{StatIcon[node.info.key]}</span>\r\n      </BootstrapTooltip>\r\n      <span>{val}</span>\r\n    </Typography>\r\n  </Box>)\r\n}\r\nfunction LocationIcon({ location }) {\r\n  const characterSheet = usePromise(CharacterSheet.get(location ?? \"\"), [location])\r\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\r\n}\r\n","import { ChevronRight } from '@mui/icons-material';\r\nimport { Button, CardContent, Grid, Skeleton, Typography } from '@mui/material';\r\nimport { Box } from '@mui/system';\r\nimport React, { Suspense, useCallback, useContext, useState } from 'react';\r\nimport ArtifactCardNano from '../../../../../Components/Artifact/ArtifactCardNano';\r\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport StatDisplayComponent from '../../../../../Components/Character/StatDisplayComponent';\r\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport WeaponCardNano from '../../../../../Components/Weapon/WeaponCardNano';\r\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../../../../Database/Database';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport { uiInput as input } from '../../../../../Formula';\r\nimport ArtifactCard from '../../../../../PageArtifact/ArtifactCard';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from '../../../../../Types/consts';\r\n\r\ntype NewOld = {\r\n  newId: string,\r\n  oldId?: string\r\n}\r\n\r\ntype BuildDisplayItemProps = {\r\n  index?: number,\r\n  compareBuild: boolean,\r\n  disabled?: boolean,\r\n  extraButtons?: JSX.Element\r\n}\r\n//for displaying each artifact build\r\nexport default function BuildDisplayItem({ index, compareBuild, extraButtons, disabled }: BuildDisplayItemProps) {\r\n  const { database } = useContext(DatabaseContext)\r\n  const dataContext = useContext(DataContext)\r\n\r\n  const { character, data, oldData, mainStatAssumptionLevel } = dataContext\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const [newOld, setNewOld] = useState(undefined as NewOld | undefined)\r\n  const close = useCallback(() => setNewOld(undefined), [setNewOld],)\r\n\r\n  const equipBuild = useCallback(() => {\r\n    if (!window.confirm(\"Do you want to equip this build to this character?\")) return\r\n    const newBuild = Object.fromEntries(allSlotKeys.map(s => [s, data.get(input.art[s].id).value])) as Record<SlotKey, string>\r\n    database.equipArtifacts(character.key, newBuild)\r\n    database.setWeaponLocation(data.get(input.weapon.id).value!, character.key)\r\n  }, [character, data, database])\r\n  if (!character || !artifactSheets || !oldData) return null\r\n  const currentlyEquipped = allSlotKeys.every(slotKey => data.get(input.art[slotKey].id).value === oldData.get(input.art[slotKey].id).value) && data.get(input.weapon.id).value === oldData.get(input.weapon.id).value\r\n  const statProviderContext = { ...dataContext }\r\n  if (!compareBuild) statProviderContext.oldData = undefined\r\n  const setToSlots: Partial<Record<ArtifactSetKey, SlotKey[]>> = {}\r\n  allSlotKeys.forEach(slotKey => {\r\n    const set = data.get(input.art[slotKey].set).value as ArtifactSetKey | undefined\r\n    if (!set) return\r\n    if (setToSlots[set]) setToSlots[set]!.push(slotKey)\r\n    else setToSlots[set] = [slotKey]\r\n  })\r\n\r\n  return <CardLight>\r\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n      {newOld && <CompareArtifactModal newOld={newOld} mainStatAssumptionLevel={mainStatAssumptionLevel} onClose={close} />}\r\n      <CardContent>\r\n        <Box display=\"flex\" gap={1} sx={{ pb: 1 }} flexWrap=\"wrap\">\r\n          {index !== undefined && <SqBadge color=\"info\"><Typography><strong>#{index + 1}{currentlyEquipped ? \" (Equipped)\" : \"\"}</strong></Typography></SqBadge>}\r\n          {(Object.entries(setToSlots) as [ArtifactSetKey, SlotKey[]][]).sort(([k1, slotarr1], [k2, slotarr2]) => slotarr2.length - slotarr1.length).map(([key, slotarr]) =>\r\n            <Box key={key}><SqBadge color={currentlyEquipped ? \"success\" : \"primary\"} ><Typography >\r\n              {slotarr.map(slotKey => artifactSlotIcon(slotKey))} {artifactSheets?.[key].name ?? \"\"}\r\n            </Typography></SqBadge></Box>\r\n          )}\r\n          <Box sx={{ flexGrow: 1, display: \"flex\", justifyContent: \"flex-end\" }}>\r\n          </Box>\r\n          <Button size='small' color=\"success\" onClick={equipBuild} disabled={disabled || currentlyEquipped}>Equip Build</Button>\r\n          {extraButtons}\r\n        </Box>\r\n        <Grid container spacing={1} sx={{ pb: 1 }}>\r\n          <Grid item xs={6} sm={4} md={3} lg={2}>\r\n            <WeaponCardNano showLocation weaponId={data.get(input.weapon.id).value} />\r\n          </Grid>\r\n          {allSlotKeys.map(slotKey =>\r\n            <Grid item xs={6} sm={4} md={3} lg={2} key={slotKey} >\r\n              <ArtifactCardNano showLocation slotKey={slotKey} artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel} onClick={() => {\r\n                const oldId = character.equippedArtifacts[slotKey]\r\n                const newId = data.get(input.art[slotKey].id).value!\r\n                setNewOld({ oldId: oldId !== newId ? oldId : undefined, newId })\r\n              }} />\r\n            </Grid>)}\r\n        </Grid>\r\n        <DataContext.Provider value={statProviderContext}>\r\n          <StatDisplayComponent />\r\n        </DataContext.Provider>\r\n      </CardContent>\r\n    </Suspense>\r\n  </CardLight>\r\n}\r\n\r\nfunction CompareArtifactModal({ newOld: { newId, oldId }, mainStatAssumptionLevel, onClose }: { newOld: NewOld, mainStatAssumptionLevel: number, onClose: () => void }) {\r\n  return <ModalWrapper open={!!newId} onClose={onClose} containerProps={{ maxWidth: oldId ? \"md\" : \"xs\" }}>\r\n    <CardDark>\r\n      <CardContent sx={{ display: \"flex\", justifyContent: \"center\", alignItems: \"stretch\", gap: 2, height: \"100%\" }}>\r\n        {oldId && <Box><ArtifactCard artifactId={oldId} mainStatAssumptionLevel={mainStatAssumptionLevel} disableEditSetSlot canExclude canEquip /></Box>}\r\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\r\n        {oldId && <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\"><CardLight sx={{ display: \"flex\" }}><ChevronRight sx={{ fontSize: 40 }} /></CardLight></Box>}\r\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\r\n        <Box><ArtifactCard artifactId={newId} mainStatAssumptionLevel={mainStatAssumptionLevel} disableEditSetSlot canExclude canEquip /></Box>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { Close, Difference } from \"@mui/icons-material\"\r\nimport { Button, Skeleton, Tooltip, Typography } from \"@mui/material\"\r\nimport { Suspense, useContext, useMemo } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { HitModeToggle, ReactionToggle } from \"../../../../Components/HitModeEditor\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport { DataContext } from \"../../../../DataContext\"\r\nimport useBoolState from \"../../../../ReactHooks/useBoolState\"\r\nimport useTeamData from \"../../../../ReactHooks/useTeamData\"\r\nimport { objectMap } from \"../../../../Util/Util\"\r\nimport BuildDisplayItem from \"../TabOptimize/Components/BuildDisplayItem\"\r\n\r\nexport default function CompareBuildButton({ artId, weaponId }: { artId?: string, weaponId?: string }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const [show, onShow, onHide] = useBoolState(false)\r\n  const { database } = useContext(DatabaseContext)\r\n  const { character, character: { key: characterKey, equippedArtifacts }, characterSheet, data: oldData, mainStatAssumptionLevel, characterDispatch } = useContext(DataContext)\r\n  const build = useMemo(() => {\r\n    const newArt = database._getArt(artId ?? \"\")\r\n    const artmap = objectMap(equippedArtifacts, (id, slot) => slot === newArt?.slotKey ? newArt : database._getArt(id))\r\n    return Object.values(artmap)\r\n  }, [database, equippedArtifacts, artId])\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build, weaponId ? database._getWeapon(weaponId) : undefined)\r\n  if (!teamData) return null\r\n  return <>\r\n    <ModalWrapper open={show} onClose={onHide} containerProps={{ maxWidth: \"xl\" }}>\r\n      <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n        <DataContext.Provider value={{ characterSheet, character, characterDispatch, mainStatAssumptionLevel, data: teamData[characterKey]!.target, teamData, oldData }}>\r\n          <BuildDisplayItem compareBuild={true} extraButtons={<><HitModeToggle size=\"small\" /><ReactionToggle size=\"small\" /><Button size='small' color=\"error\" onClick={onHide} ><Close /></Button></>} />\r\n        </DataContext.Provider>\r\n      </Suspense>\r\n    </ModalWrapper>\r\n    <Tooltip title={<Typography>{t`tabEquip.compare`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onShow} ><Difference /></Button>\r\n    </Tooltip>\r\n  </>\r\n}\r\n","import { Box, CardContent, Divider, Grid, Skeleton, Typography } from \"@mui/material\"\r\nimport { lazy, Suspense, useCallback, useContext, useEffect, useMemo, useReducer } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../../../../Assets/Assets\"\r\nimport CardDark from \"../../../../Components/Card/CardDark\"\r\nimport CloseButton from \"../../../../Components/CloseButton\"\r\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport ArtifactCard from \"../../../../PageArtifact/ArtifactCard\"\r\nimport { artifactFilterConfigs, FilterOption, initialFilterOption } from \"../../../../PageArtifact/ArtifactSort\"\r\nimport useForceUpdate from \"../../../../ReactHooks/useForceUpdate\"\r\nimport useMediaQueryUp from \"../../../../ReactHooks/useMediaQueryUp\"\r\nimport { SlotKey } from \"../../../../Types/consts\"\r\nimport { filterFunction } from \"../../../../Util/SortByFilters\"\r\nimport CompareBuildButton from \"./CompareBuildButton\"\r\nconst numToShowMap = { xs: 6, sm: 6, md: 9, lg: 12, xl: 12 }\r\n\r\nconst ArtifactFilterDisplay = lazy(() => import('../../../../Components/Artifact/ArtifactFilterDisplay'))\r\n\r\nexport default function ArtifactSwapModal({ onChangeId, slotKey, show, onClose }:\r\n  { onChangeId: (id: string) => void, slotKey: SlotKey, show: boolean, onClose: () => void }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const clickHandler = useCallback((id) => {\r\n    onChangeId(id)\r\n    onClose()\r\n  }, [onChangeId, onClose])\r\n  const filterOptionReducer = useCallback((state, action) => ({ ...state, ...action, slotKeys: [slotKey] }), [slotKey],)\r\n\r\n  const [filterOption, filterOptionDispatch]: [FilterOption, (action: any) => void] = useReducer(filterOptionReducer, { ...initialFilterOption(), slotKeys: [slotKey] })\r\n\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  useEffect(() => { return database.followAnyArt(forceUpdate) }, [database, forceUpdate])\r\n\r\n  const brPt = useMediaQueryUp()\r\n\r\n  const filterConfigs = useMemo(() => artifactFilterConfigs(), [])\r\n  const artIdList = useMemo(() => {\r\n    const filterFunc = filterFunction(filterOption, filterConfigs)\r\n    return dbDirty && database._getArts().filter(filterFunc).map(art => art.id).slice(0, numToShowMap[brPt])\r\n  }, [dbDirty, database, filterConfigs, filterOption, brPt])\r\n\r\n  return <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"xl\" }} >\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1, display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n        <Typography variant=\"h6\">{slotKey ? <ImgIcon src={Assets.slot[slotKey]} /> : null} {t`tabEquip.swapArt`}</Typography>\r\n        <CloseButton onClick={onClose} />\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={200} />}>\r\n          <ArtifactFilterDisplay filterOption={filterOption} filterOptionDispatch={filterOptionDispatch} />\r\n        </Suspense>\r\n        <Box mt={1}>\r\n          <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={300} />}>\r\n            <Grid container spacing={1} columns={{ xs: 2, md: 3, lg: 4 }}>\r\n              {artIdList.map(id =>\r\n                <Grid item key={id} xs={1} >\r\n                  <ArtifactCard\r\n                    artifactId={id}\r\n                    extraButtons={<CompareBuildButton artId={id} />}\r\n                    onClick={clickHandler}\r\n                  />\r\n                </Grid>)}\r\n            </Grid>\r\n          </Suspense>\r\n        </Box>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { Box, CardContent, Divider, Grid, ToggleButton, Typography } from \"@mui/material\"\r\nimport { useCallback, useContext, useEffect, useMemo, useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../../../../Assets/Assets\"\r\nimport CardDark from \"../../../../Components/Card/CardDark\"\r\nimport CloseButton from \"../../../../Components/CloseButton\"\r\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\r\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\r\nimport SolidToggleButtonGroup from \"../../../../Components/SolidToggleButtonGroup\"\r\nimport { Stars } from \"../../../../Components/StarDisplay\"\r\nimport WeaponSheet from \"../../../../Data/Weapons/WeaponSheet\"\r\nimport { DatabaseContext } from \"../../../../Database/Database\"\r\nimport WeaponCard from \"../../../../PageWeapon/WeaponCard\"\r\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate'\r\nimport usePromise from \"../../../../ReactHooks/usePromise\"\r\nimport { allRarities, Rarity, WeaponTypeKey } from \"../../../../Types/consts\"\r\nimport { handleMultiSelect } from \"../../../../Util/MultiSelect\"\r\nimport { filterFunction, sortFunction } from '../../../../Util/SortByFilters'\r\nimport { weaponFilterConfigs, weaponSortConfigs } from '../../../../Util/WeaponSort'\r\nimport CompareBuildButton from \"./CompareBuildButton\"\r\n\r\nconst rarityHandler = handleMultiSelect([...allRarities])\r\n\r\nexport default function WeaponSwapModal({ onChangeId, weaponTypeKey, show, onClose }: { onChangeId: (id: string) => void, weaponTypeKey: WeaponTypeKey, show: boolean, onClose: () => void }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const clickHandler = useCallback((id) => {\r\n    onChangeId(id)\r\n    onClose()\r\n  }, [onChangeId, onClose])\r\n\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  useEffect(() => database.followAnyWeapon(forceUpdate), [forceUpdate, database])\r\n\r\n  const weaponSheets = usePromise(WeaponSheet.getAll, [])\r\n\r\n  const filterConfigs = useMemo(() => weaponSheets && weaponFilterConfigs(weaponSheets), [weaponSheets])\r\n  const sortConfigs = useMemo(() => weaponSheets && weaponSortConfigs(weaponSheets), [weaponSheets])\r\n\r\n  const [rarity, setRarity] = useState<Rarity[]>([5, 4, 3])\r\n\r\n  const weaponIdList = useMemo(() => (filterConfigs && sortConfigs && dbDirty && database._getWeapons()\r\n    .filter(filterFunction({ weaponType: weaponTypeKey, rarity }, filterConfigs))\r\n    .sort(sortFunction(\"level\", false, sortConfigs))\r\n    .map(weapon => weapon.id)) ?? []\r\n    , [dbDirty, database, filterConfigs, sortConfigs, rarity, weaponTypeKey])\r\n\r\n  return <ModalWrapper open={show} onClose={onClose} >\r\n    <CardDark>\r\n      <CardContent sx={{ py: 1 }}>\r\n        <Grid container>\r\n          <Grid item flexGrow={1}>\r\n            <Typography variant=\"h6\">{weaponTypeKey ? <ImgIcon src={Assets.weaponTypes[weaponTypeKey]} /> : null} {t`tabEquip.swapWeapon`}</Typography>\r\n          </Grid>\r\n          <Grid item>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <Box mb={1}>\r\n          <SolidToggleButtonGroup sx={{ height: \"100%\" }} value={rarity} size=\"small\">\r\n            {allRarities.map(star => <ToggleButton key={star} value={star} onClick={() => setRarity(rarityHandler(rarity, star))}>\r\n              <Box display=\"flex\" gap={1}><strong>{star}</strong><Stars stars={1} /></Box>\r\n            </ToggleButton>)}\r\n          </SolidToggleButtonGroup>\r\n        </Box>\r\n        <Grid container spacing={1}>\r\n          {weaponIdList.map(weaponId =>\r\n            <Grid item key={weaponId} xs={6} sm={6} md={4} lg={3} >\r\n              <WeaponCard\r\n                weaponId={weaponId}\r\n                onClick={clickHandler}\r\n                extraButtons={<CompareBuildButton weaponId={weaponId} />}\r\n              />\r\n            </Grid>)}\r\n        </Grid>\r\n      </CardContent>\r\n    </CardDark>\r\n  </ModalWrapper>\r\n}\r\n","import { SwapHoriz } from '@mui/icons-material';\r\nimport { Box, Button, CardContent, Divider, Grid, Tooltip, Typography, useMediaQuery } from '@mui/material';\r\nimport { useTheme } from \"@mui/system\";\r\nimport { lazy, Suspense, useCallback, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport SetEffectDisplay from '../../../../Components/Artifact/SetEffectDisplay';\r\nimport SlotNameWithIcon from '../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport CardLight from '../../../../Components/Card/CardLight';\r\nimport StatDisplayComponent from '../../../../Components/Character/StatDisplayComponent';\r\nimport DocumentDisplay from \"../../../../Components/DocumentDisplay\";\r\nimport { ArtifactSheet } from '../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../../../Database/Database';\r\nimport { DataContext } from '../../../../DataContext';\r\nimport { uiInput as input } from '../../../../Formula';\r\nimport ArtifactCard from '../../../../PageArtifact/ArtifactCard';\r\nimport WeaponCard from '../../../../PageWeapon/WeaponCard';\r\nimport useBoolState from '../../../../ReactHooks/useBoolState';\r\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate';\r\nimport usePromise from '../../../../ReactHooks/usePromise';\r\nimport { allSlotKeys, SlotKey, WeaponTypeKey } from '../../../../Types/consts';\r\nimport { objectKeyMap } from '../../../../Util/Util';\r\nimport ArtifactSwapModal from './ArtifactSwapModal';\r\nimport WeaponSwapModal from './WeaponSwapModal';\r\n\r\nconst WeaponEditor = lazy(() => import('../../../../PageWeapon/WeaponEditor'))\r\n\r\nfunction TabEquip() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { teamData, data, character, character: { equippedWeapon, key: characterKey, equippedArtifacts }, characterSheet, mainStatAssumptionLevel } = useContext(DataContext)\r\n  const { weaponSheet } = teamData[characterKey]!\r\n  const [weaponId, setweaponId] = useState(\"\")\r\n  const showWeapon = useCallback(() => setweaponId(equippedWeapon), [equippedWeapon],)\r\n  const hideWeapon = useCallback(() => setweaponId(\"\"), [])\r\n\r\n  //triggers when character swap weapons\r\n  useEffect(() => {\r\n    if (weaponId && weaponId !== equippedWeapon)\r\n      setweaponId(equippedWeapon)\r\n  }, [weaponId, equippedWeapon])\r\n\r\n  const { database } = useContext(DatabaseContext)\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n\r\n  // TODO: We can also listen only to equipped artifacts\r\n  const [, updateArt] = useForceUpdate()\r\n  useEffect(() => database.followAnyArt(updateArt))\r\n\r\n  const hasEquipped = useMemo(() => !!Object.values(equippedArtifacts).filter(i => i).length, [equippedArtifacts])\r\n  const unequipArts = useCallback(() => {\r\n    if (!character) return\r\n    if (!window.confirm(\"Do you want to move all currently equipped artifacts to inventory?\")) return\r\n    database.equipArtifacts(character.key, objectKeyMap(allSlotKeys, _ => \"\"))\r\n  }, [character, database])\r\n  const setEffects = useMemo(() => artifactSheets && ArtifactSheet.setEffects(artifactSheets, data), [artifactSheets, data])\r\n\r\n  const theme = useTheme();\r\n  const grxl = useMediaQuery(theme.breakpoints.up('xl'));\r\n  const artifactFields = useMemo(() => artifactSheets && setEffects && Object.entries(setEffects).map(([setKey, setNumKeyArr]) =>\r\n    <CardLight key={setKey} sx={{ flexGrow: 1, }} >\r\n      <CardContent >\r\n        <Grid container spacing={1} flexDirection=\"column\" height=\"100%\" >\r\n          <Grid item display=\"flex\" flexDirection=\"column\" gap={2}>\r\n            {setNumKeyArr.map(setNumKey => <SetEffectDisplay key={setKey + setNumKey} setKey={setKey} setNumKey={setNumKey} />)}\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n    </CardLight>), [artifactSheets, setEffects])\r\n  const weaponDoc = useMemo(() => weaponSheet.document.length > 0 && <CardLight><CardContent><DocumentDisplay sections={weaponSheet.document} /></CardContent></CardLight>, [weaponSheet])\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    <Suspense fallback={false}>\r\n      <WeaponEditor\r\n        weaponId={weaponId}\r\n        footer\r\n        onClose={hideWeapon}\r\n        extraButtons={<LargeWeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />}\r\n      />\r\n    </Suspense>\r\n    <CardLight >\r\n      <CardContent>\r\n        <StatDisplayComponent />\r\n      </CardContent>\r\n    </CardLight>\r\n    <Grid container spacing={1}>\r\n      {grxl && <Grid item xs={12} md={12} xl={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\r\n        {weaponDoc}\r\n        {hasEquipped && <Button color=\"error\" onClick={unequipArts} fullWidth>{t`tabEquip.unequipArts`}</Button>}\r\n        {artifactFields}\r\n      </Grid>}\r\n      <Grid item xs={12} md={12} xl={9} container spacing={1}>\r\n        <Grid item xs={12} sm={6} md={4} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          <WeaponCard weaponId={equippedWeapon} onEdit={showWeapon} canEquip extraButtons={<WeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />} />\r\n        </Grid>\r\n        {allSlotKeys.map(slotKey => <Grid item xs={12} sm={6} md={4} key={slotKey} >\r\n          {!!data.get(input.art[slotKey].id).value ?\r\n            <ArtifactCard artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel}\r\n              extraButtons={<ArtifactSwapButton slotKey={slotKey} />} editor canExclude canEquip /> :\r\n            <ArtSwapCard slotKey={slotKey} />}\r\n        </Grid>)}\r\n      </Grid>\r\n      {!grxl && <Grid item xs={12} md={12} xl={3} container spacing={1} >\r\n        <Grid item xs={12} md={6} lg={4}>{weaponDoc}</Grid>\r\n        <Grid item xs={12} md={6} lg={4}>{artifactFields}</Grid>\r\n      </Grid>}\r\n    </Grid>\r\n  </Box>\r\n}\r\nexport default TabEquip\r\nfunction ArtSwapCard({ slotKey }: { slotKey: SlotKey }) {\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <CardLight sx={{ height: \"100%\", width: \"100%\", minHeight: 300, display: \"flex\", flexDirection: \"column\" }}>\r\n    <CardContent>\r\n      <Typography><SlotNameWithIcon slotKey={slotKey} /></Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <Box sx={{\r\n      flexGrow: 1,\r\n      display: \"flex\",\r\n      justifyContent: \"center\",\r\n      alignItems: \"center\"\r\n    }}\r\n    >\r\n      <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.setArtLocation(id, characterKey)} />\r\n      <Button onClick={onOpen} color=\"info\" sx={{ borderRadius: \"1em\", }}>\r\n        <SwapHoriz sx={{ height: 100, width: 100 }} />\r\n      </Button>\r\n    </Box>\r\n  </CardLight>\r\n}\r\nfunction WeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Tooltip title={<Typography>{t`tabEquip.swapWeapon`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\r\n    </Tooltip>\r\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.setWeaponLocation(id, characterKey)} show={show} onClose={onClose} />\r\n  </>\r\n}\r\nfunction LargeWeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Button color=\"info\" onClick={onOpen} startIcon={<SwapHoriz />} >{t`tabEquip.swapWeapon`}</Button>\r\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.setWeaponLocation(id, characterKey)} show={show} onClose={onClose} />\r\n  </>\r\n}\r\nfunction ArtifactSwapButton({ slotKey }: { slotKey: SlotKey }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState()\r\n  return <>\r\n    <Tooltip title={<Typography>{t`tabEquip.swapArt`}</Typography>} placement=\"top\" arrow>\r\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\r\n    </Tooltip>\r\n    <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.setArtLocation(id, characterKey)} />\r\n  </>\r\n}\r\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/BackgroundWorker.fd9bf060.worker.js\");\n}\n","import { forEachNodes, mapFormulas } from \"../../../../Formula/internal\";\r\nimport { allOperations, constantFold } from \"../../../../Formula/optimization\";\r\nimport { ConstantNode, NumNode } from \"../../../../Formula/type\";\r\nimport { constant, customRead, max, min } from \"../../../../Formula/utils\";\r\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from \"../../../../Types/consts\";\r\nimport { assertUnreachable, objectKeyMap, objectMap, range } from \"../../../../Util/Util\";\r\nimport type { ArtSetExclusion } from \"./BuildSetting\";\r\n\r\ntype DynMinMax = { [key in string]: MinMax }\r\ntype MinMax = { min: number, max: number }\r\n\r\ntype MicropassOperation = \"reaffine\" | \"pruneArtRange\" | \"pruneNodeRange\" | \"pruneOrder\"\r\nexport function pruneAll(nodes: NumNode[], minimum: number[], arts: ArtifactsBySlot, numTop: number, exclusion: ArtSetExclusion, forced: Dict<MicropassOperation, boolean>): { nodes: NumNode[], arts: ArtifactsBySlot } {\r\n  let should = forced\r\n  /** If `key` makes progress, all operations in `value` should be performed */\r\n  const deps: StrictDict<MicropassOperation, Dict<MicropassOperation, true>> = {\r\n    pruneOrder: { pruneNodeRange: true },\r\n    pruneArtRange: { pruneNodeRange: true },\r\n    pruneNodeRange: { reaffine: true },\r\n    reaffine: { pruneOrder: true, pruneArtRange: true, pruneNodeRange: true }\r\n  }\r\n  let count = 0\r\n  while (Object.values(should).some(x => x) && count++ < 20) {\r\n    if (should.pruneOrder) {\r\n      delete should.pruneOrder\r\n      const newArts = pruneOrder(arts, numTop, exclusion)\r\n      if (arts !== newArts) {\r\n        arts = newArts\r\n        should = { ...should, ...deps.pruneOrder }\r\n      }\r\n    }\r\n    if (should.pruneArtRange) {\r\n      delete should.pruneArtRange\r\n      const newArts = pruneArtRange(nodes, arts, minimum)\r\n      if (arts !== newArts) {\r\n        arts = newArts\r\n        should = { ...should, ...deps.pruneArtRange }\r\n      }\r\n    }\r\n    if (should.pruneNodeRange) {\r\n      delete should.pruneNodeRange\r\n      const newNodes = pruneNodeRange(nodes, arts)\r\n      if (nodes !== newNodes) {\r\n        nodes = newNodes\r\n        should = { ...should, ...deps.pruneNodeRange }\r\n      }\r\n    }\r\n    if (should.reaffine) {\r\n      delete should.reaffine\r\n      const { nodes: newNodes, arts: newArts } = reaffine(nodes, arts)\r\n      if (nodes !== newNodes || arts !== newArts) {\r\n        nodes = newNodes\r\n        arts = newArts\r\n        should = { ...should, ...deps.reaffine }\r\n      }\r\n    }\r\n  }\r\n  return { nodes, arts }\r\n}\r\n\r\nfunction reaffine(nodes: NumNode[], arts: ArtifactsBySlot, forceRename: boolean = false): { nodes: NumNode[], arts: ArtifactsBySlot } {\r\n  const affineNodes = new Set<NumNode>(), topLevelAffine = new Set<NumNode>()\r\n\r\n  function visit(node: NumNode, isAffine: boolean) {\r\n    if (isAffine) affineNodes.add(node)\r\n    else node.operands.forEach(_op => {\r\n      const op = _op as NumNode\r\n      affineNodes.has(op) && topLevelAffine.add(op)\r\n    })\r\n  }\r\n\r\n  const dynKeys = new Set<string>()\r\n\r\n  forEachNodes(nodes, _ => { }, f => {\r\n    const operation = f.operation\r\n    switch (operation) {\r\n      case \"read\":\r\n        if (f.type !== \"number\" || f.path[0] !== \"dyn\" || f.accu !== \"add\")\r\n          throw new Error(`Found unsupported ${operation} node at path ${f.path} when computing affine nodes`)\r\n        dynKeys.add(f.path[1])\r\n        visit(f, true)\r\n        break\r\n      case \"add\": visit(f, f.operands.every(op => affineNodes.has(op))); break\r\n      case \"mul\": {\r\n        const nonConst = f.operands.filter(op => op.operation !== \"const\")\r\n        visit(f, nonConst.length === 0 || (nonConst.length === 1 && affineNodes.has(nonConst[0])))\r\n        break\r\n      }\r\n      case \"const\":\r\n        if (typeof f.value === \"string\" || f.value === undefined)\r\n          throw new Error(`Found constant ${f.value} while compacting`)\r\n        visit(f as NumNode, true); break\r\n      case \"res\": case \"threshold\": case \"sum_frac\":\r\n      case \"max\": case \"min\": visit(f, false); break\r\n      case \"data\": case \"subscript\": case \"lookup\": case \"match\": case \"prio\": case \"small\":\r\n        throw new Error(`Found unsupported ${operation} node when computing affine nodes`)\r\n      default: assertUnreachable(operation)\r\n    }\r\n  })\r\n\r\n  if ([...topLevelAffine].every(({ operation }) => operation === \"read\" || operation === \"const\") &&\r\n    Object.keys(arts.base).length === dynKeys.size)\r\n    return { nodes, arts }\r\n\r\n  let current = -1\r\n  function nextDynKey(): string {\r\n    while (dynKeys.has(`${++current}`));\r\n    return `${current}`\r\n  }\r\n\r\n  nodes.forEach(node => affineNodes.has(node) && topLevelAffine.add(node))\r\n  const affine = [...topLevelAffine].filter(f => f.operation !== \"const\")\r\n  const affineMap = new Map(affine.map(node => [node,\r\n    !forceRename && node.operation === \"read\" && node.path[0] === \"dyn\"\r\n      ? node\r\n      : { ...customRead([\"dyn\", `${nextDynKey()}`]), accu: \"add\" as const }]))\r\n  nodes = mapFormulas(nodes, f => affineMap.get(f as NumNode) ?? f, f => f)\r\n\r\n  function reaffineArt(stat: DynStat): DynStat {\r\n    const values = constantFold([...affineMap.keys()], {\r\n      dyn: objectMap(stat, (value) => constant(value))\r\n    } as any, _ => true)\r\n    return Object.fromEntries([...affineMap.values()].map((v, i) => [v.path[1], (values[i] as ConstantNode<number>).value]))\r\n  }\r\n  const result = {\r\n    nodes, arts: {\r\n      base: reaffineArt(arts.base),\r\n      values: objectKeyMap(allSlotKeys, slot =>\r\n        arts.values[slot].map(({ id, set, values }) => ({ id, set, values: reaffineArt(values) })))\r\n    }\r\n  }\r\n  const offsets = Object.entries(reaffineArt({}))\r\n  for (const arts of Object.values(result.arts.values))\r\n    for (const { values } of arts)\r\n      for (const [key, baseValue] of offsets)\r\n        values[key] -= baseValue\r\n  return result\r\n}\r\n/** Remove artifacts that cannot be in top `numTop` builds */\r\nexport function pruneOrder(arts: ArtifactsBySlot, numTop: number, exclusion: ArtSetExclusion): ArtifactsBySlot {\r\n  let progress = false\r\n  const noRainbow = !exclusion.rainbow?.length\r\n  const noSwitchIn = new Set(Object.entries(exclusion).filter(([_, v]) => v.length).map(([k]) => k) as ArtifactSetKey[])\r\n  const noSwitchOut = new Set(Object.entries(exclusion).filter(([_, v]) => v.includes(2) && !v.includes(4)).map(([k]) => k) as ArtifactSetKey[])\r\n  const values = objectKeyMap(allSlotKeys, slot => {\r\n    const list = arts.values[slot]\r\n    const newList = list.filter(art => {\r\n      let count = 0\r\n      return list.every(other => {\r\n        const greaterEqual = Object.entries(other.values).every(([k, o]) => o >= art.values[k])\r\n        const greater = Object.entries(other.values).some(([k, o]) => o > art.values[k])\r\n        if (greaterEqual && (greater || other.id > art.id) &&\r\n          ((noRainbow && !noSwitchIn.has(other.set!) && !noSwitchOut.has(art.set!)) || art.set === other.set))\r\n          count++\r\n        return count < numTop\r\n      })\r\n    })\r\n    if (newList.length !== list.length) progress = true\r\n    return newList\r\n  })\r\n  return progress ? { base: arts.base, values } : arts\r\n}\r\n/** Remove artifacts that cannot reach `minimum` in any build */\r\nfunction pruneArtRange(nodes: NumNode[], arts: ArtifactsBySlot, minimum: number[]): ArtifactsBySlot {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  const wrap = { arts }\r\n  while (true) {\r\n    const artRanges = objectKeyMap(allSlotKeys, slot => computeArtRange(wrap.arts.values[slot]))\r\n    const otherArtRanges = objectKeyMap(allSlotKeys, key =>\r\n      addArtRange(Object.entries(artRanges).map(a => a[0] === key ? baseRange : a[1]).filter(x => x)))\r\n\r\n    let progress = false\r\n    const values = objectKeyMap(allSlotKeys, slot => {\r\n      const result = wrap.arts.values[slot].filter(art => {\r\n        const read = addArtRange([computeArtRange([art]), otherArtRanges[slot]])\r\n        const newRange = computeNodeRange(nodes, read)\r\n        return nodes.every((node, i) => newRange.get(node)!.max >= (minimum[i] ?? -Infinity))\r\n      })\r\n      if (result.length !== wrap.arts.values[slot].length)\r\n        progress = true\r\n      return result\r\n    })\r\n    if (!progress) break\r\n    wrap.arts = { base: wrap.arts.base, values }\r\n  }\r\n  return wrap.arts\r\n}\r\nfunction pruneNodeRange(nodes: NumNode[], arts: ArtifactsBySlot): NumNode[] {\r\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\r\n  const reads = addArtRange([baseRange, ...Object.values(arts.values).map(values => computeArtRange(values))])\r\n  const nodeRange = computeNodeRange(nodes, reads)\r\n\r\n  return mapFormulas(nodes, f => {\r\n    const { operation } = f\r\n    const operandRanges = f.operands.map(x => nodeRange.get(x)!)\r\n    switch (operation) {\r\n      case \"threshold\": {\r\n        const [value, threshold, pass, fail] = operandRanges\r\n        if (value.min >= threshold.max) return f.operands[2]\r\n        else if (value.max < threshold.min) return constant(0)\r\n        if (pass.max === pass.min &&\r\n          fail.max === fail.min &&\r\n          pass.min === fail.min && isFinite(pass.min))\r\n          return constant(pass.max)\r\n        break\r\n      }\r\n      case \"min\": {\r\n        const newOperands = f.operands.filter((_, i) => {\r\n          const op1 = operandRanges[i]\r\n          return operandRanges.every((op2, j) => op1.min <= op2.max)\r\n        })\r\n        if (newOperands.length < operandRanges.length) return min(...newOperands)\r\n        break\r\n      }\r\n      case \"max\": {\r\n        const newOperands = f.operands.filter((_, i) => {\r\n          const op1 = operandRanges[i]\r\n          return operandRanges.every(op2 => op1.max >= op2.min)\r\n        })\r\n        if (newOperands.length < operandRanges.length) return max(...newOperands)\r\n        break\r\n      }\r\n    }\r\n    return f\r\n  }, f => f)\r\n}\r\nfunction addArtRange(ranges: DynMinMax[]): DynMinMax {\r\n  const result: DynMinMax = {}\r\n  ranges.forEach(range => {\r\n    Object.entries(range).forEach(([key, value]) => {\r\n      if (result[key]) {\r\n        result[key].min += value.min\r\n        result[key].max += value.max\r\n      } else result[key] = { ...value }\r\n    })\r\n  })\r\n  return result\r\n}\r\nfunction computeArtRange(arts: ArtifactBuildData[]): DynMinMax {\r\n  const result: DynMinMax = {}\r\n  if (arts.length) {\r\n    Object.keys(arts[0].values)\r\n      .filter(key => arts.every(art => art.values[key]))\r\n      .forEach(key => result[key] = { min: arts[0].values[key], max: arts[0].values[key] })\r\n    arts.forEach(({ values }) => {\r\n      for (const [key, value] of Object.entries(values)) {\r\n        if (!result[key]) result[key] = { min: 0, max: value }\r\n        else {\r\n          if (result[key].max < value) result[key].max = value\r\n          if (result[key].min > value) result[key].min = value\r\n        }\r\n      }\r\n    })\r\n  }\r\n  return result\r\n}\r\nfunction computeNodeRange(nodes: NumNode[], reads: DynMinMax): Map<NumNode, MinMax> {\r\n  const range = new Map<NumNode, MinMax>()\r\n\r\n  forEachNodes(nodes, _ => { }, _f => {\r\n    const f = _f as NumNode\r\n    const { operation } = f\r\n    const operands = f.operands.map(op => range.get(op)!)\r\n    let current: MinMax\r\n    switch (operation) {\r\n      case \"read\":\r\n        if (f.path[0] !== \"dyn\")\r\n          throw new Error(`Found non-dyn path ${f.path} while computing range`)\r\n        current = reads[f.path[1]] ?? { min: 0, max: 0 }\r\n        break\r\n      case \"const\": current = computeMinMax([f.value]); break\r\n      case \"subscript\": current = computeMinMax(f.list); break\r\n      case \"add\": case \"min\": case \"max\":\r\n        current = {\r\n          min: allOperations[operation](operands.map(x => x.min)),\r\n          max: allOperations[operation](operands.map(x => x.max)),\r\n        }; break\r\n      case \"res\": current = {\r\n        min: allOperations[operation]([operands[0].max]),\r\n        max: allOperations[operation]([operands[0].min]),\r\n      }; break\r\n      case \"mul\": current = operands.reduce((accu, current) => computeMinMax([\r\n        accu.min * current.min, accu.min * current.max,\r\n        accu.max * current.min, accu.max * current.max,\r\n      ])); break\r\n      case \"threshold\":\r\n        if (operands[0].min >= operands[1].max) current = operands[2]\r\n        else if (operands[0].max < operands[1].min) current = computeMinMax([0])\r\n        else current = computeMinMax([0], [operands[2]])\r\n        break\r\n      case \"sum_frac\": {\r\n        const [x, c] = operands, sum = { min: x.min + c.min, max: x.max + c.max }\r\n        if (sum.min <= 0 && sum.max >= 0)\r\n          current = (x.min <= 0 && x.max >= 0) ? { min: NaN, max: NaN } : { min: -Infinity, max: Infinity }\r\n        else\r\n          // TODO: Check this\r\n          current = computeMinMax([\r\n            x.min / sum.min, x.min / sum.max,\r\n            x.max / sum.min, x.max / sum.max\r\n          ])\r\n        break\r\n      }\r\n      case \"data\": case \"lookup\": case \"match\":\r\n        throw new Error(`Unsupported ${operation} node`)\r\n      default: assertUnreachable(operation)\r\n    }\r\n    range.set(f, current)\r\n  })\r\n  return range\r\n}\r\nfunction computeMinMax(values: readonly number[], minMaxes: readonly MinMax[] = []): MinMax {\r\n  const max = Math.max(...values, ...minMaxes.map(x => x.max))\r\n  const min = Math.min(...values, ...minMaxes.map(x => x.min))\r\n  return { min, max }\r\n}\r\n\r\nexport function filterArts(arts: ArtifactsBySlot, filters: RequestFilter): ArtifactsBySlot {\r\n  return {\r\n    base: arts.base,\r\n    values: objectKeyMap(allSlotKeys, slot => {\r\n      const filter = filters[slot]\r\n      switch (filter.kind) {\r\n        case \"id\": return arts.values[slot].filter(art => filter.ids.has(art.id))\r\n        case \"exclude\": return arts.values[slot].filter(art => !filter.sets.has(art.set!))\r\n        case \"required\": return arts.values[slot].filter(art => filter.sets.has(art.set!))\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nexport function mergeBuilds(builds: Build[][], maxNum: number): Build[] {\r\n  return builds.flatMap(x => x).sort((a, b) => b.value - a.value).slice(0, maxNum)\r\n}\r\nexport function mergePlot(plots: PlotData[]): PlotData {\r\n  let scale = 0.01, reductionScaling = 2, maxCount = 1500\r\n  let keys = new Set(plots.flatMap(x => Object.values(x).map(v => Math.round(v.plot! / scale))))\r\n  while (keys.size > maxCount) {\r\n    scale *= reductionScaling\r\n    keys = new Set([...keys].map(key => Math.round(key / reductionScaling)))\r\n  }\r\n  const result: PlotData = {}\r\n  for (const plot of plots)\r\n    for (const build of Object.values(plot)) {\r\n      const x = Math.round(build.plot! / scale) * scale\r\n      if (!result[x] || result[x]!.value < build.value)\r\n        result[x] = build\r\n    }\r\n  return result\r\n}\r\n\r\nexport function countBuilds(arts: ArtifactsBySlot): number {\r\n  return allSlotKeys.reduce((_count, slot) => _count * arts.values[slot].length, 1)\r\n}\r\n\r\n\r\nexport function* filterFeasiblePerm(filters: Iterable<RequestFilter>, _artSets: ArtifactsBySlot): Iterable<RequestFilter> {\r\n  const artSets = objectMap(_artSets.values, values => new Set(values.map(v => v.set)))\r\n  filter_loop: for (const filter of filters) {\r\n    for (const [slot, f] of Object.entries(filter)) {\r\n      const available = artSets[slot]!\r\n      switch (f.kind) {\r\n        case \"required\": if ([...f.sets].every(s => !available.has(s))) continue filter_loop; break\r\n        case \"exclude\": if ([...available].every(s => f.sets.has(s!))) continue filter_loop; break\r\n        case \"id\": break\r\n      }\r\n    }\r\n    yield filter\r\n  }\r\n}\r\nexport function exclusionToAllowed(exclusion: number[] | undefined): Set<number> {\r\n  return new Set(exclusion?.includes(2)\r\n    ? exclusion.includes(4) ? [0, 1] : [0, 1, 4, 5]\r\n    : exclusion?.includes(4) ? [0, 1, 2, 3] : [0, 1, 2, 3, 4, 5])\r\n}\r\n/** A *disjoint* set of `RequestFilter` satisfying the exclusion rules */\r\nexport function* artSetPerm(exclusion: ArtSetExclusion, _artSets: ArtifactSetKey[]): Iterable<RequestFilter> {\r\n  /**\r\n   * This generation algorithm is separated into two parts:\r\n   * - \"Shape\" generation\r\n   *   - It first generates all build \"shapes\", e.g., AABBC, ABBCD\r\n   *   - It then filters the generated shapes according to the rainbow exclusion, e.g., removes ABBCD if excluding 3 rainbows\r\n   *   - It then merges the remaining shapes into wildcards, e.g. AABAA + AABAB + AABAC => AABA*\r\n   * - Shape filling\r\n   *   - From the given shapes, it tries to fill in all non-rainbow slots, e.g., slots A and B of AABBC, with actual artifacts\r\n   *   - It then fills the rainbow slots, e.g., slot C of AABBC while ensuring the exclusion rule of each sets\r\n   */\r\n  const artSets = [...new Set(_artSets)], allowedRainbows = exclusionToAllowed(exclusion.rainbow)\r\n  let shapes: number[][] = []\r\n  function populateShapes(current: number[], list: Set<number>, rainbows: number[]) {\r\n    if (current.length === 5) {\r\n      if (allowedRainbows.has(rainbows.length))\r\n        shapes.push(current)\r\n      return\r\n    }\r\n    for (const i of list) populateShapes([...current, i], list, rainbows.filter(j => j !== i))\r\n    populateShapes([...current, current.length], new Set([...list, current.length]), [...rainbows, current.length])\r\n  }\r\n  populateShapes([0], new Set([0]), [0])\r\n  function indexOfShape(shape: number[], replacing: number) {\r\n    if (range(replacing + 1, 4).some(i => shape[i] !== 5))\r\n      return undefined\r\n    shape = [...shape]\r\n    shape[replacing] = 5\r\n    return shape.reduce((a, b) => a * 6 + b, 0)\r\n  }\r\n  for (let replacing = 4; replacing >= 0; replacing--) {\r\n    const required: Map<number, number> = new Map()\r\n    for (const shape of shapes) {\r\n      const id = indexOfShape(shape, replacing)\r\n      if (id === undefined) continue\r\n      required.set(id, (required.get(id) ?? new Set(shape.slice(0, replacing)).size + 1) - 1)\r\n    }\r\n    for (const [id, remaining] of required.entries()) {\r\n      if (remaining === 0) {\r\n        const shape = [...shapes.find(shape => indexOfShape(shape, replacing) === id)!]\r\n        shape[replacing] = 5\r\n        shapes = shapes.filter(shape => indexOfShape(shape, replacing) !== id)\r\n        shapes.push(shape)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Shapes are now calculated and merged, proceed to fill in the sets\r\n\r\n  const noFilter = { kind: \"exclude\" as const, sets: new Set<ArtifactSetKey>() }\r\n  const result: RequestFilter = objectKeyMap(allSlotKeys, _ => noFilter)\r\n\r\n  const counts = { ...objectMap(exclusion, _ => 0), ...objectKeyMap(artSets, _ => 0) }\r\n  const allowedCounts = objectMap(exclusion, exclusionToAllowed)\r\n\r\n  function* check(shape: number[]) {\r\n    const used: Set<ArtifactSetKey> = new Set()\r\n    let groupped: number[][] = [], rainbows: number[] = []\r\n    for (const i of shape) {\r\n      groupped.push([])\r\n      if (i === 5) rainbows.push(groupped.length - 1)\r\n      else groupped[i].push(groupped.length - 1)\r\n    }\r\n    groupped = groupped.filter(v => v.length).sort((a, b) => b.length - a.length)\r\n    let usableRainbows = rainbows.length\r\n\r\n    // Inception.. because js doesn't like functions inside a for-loop\r\n    function* check(i: number) {\r\n      if (i === groupped.length)\r\n        return yield* check_free(0)\r\n\r\n      for (const set of artSets) {\r\n        if (used.has(set)) continue\r\n        const length = groupped[i].length, allowedSet = allowedCounts[set]\r\n        let requiredRainbows = 0\r\n\r\n        if (allowedSet && !allowedSet.has(length)) {\r\n          // Look ahead and see if we have enough rainbows to fill to the next `allowedSet` if we use the current set\r\n          requiredRainbows = (range(length + 1, 5).find(l => allowedSet.has(l)) ?? 6) - length\r\n          if (requiredRainbows > usableRainbows) continue // Not enough rainbows. Next..\r\n        }\r\n\r\n        used.add(set)\r\n        counts[set] = groupped[i].length\r\n        groupped[i].forEach(j => result[allSlotKeys[j]] = { kind: \"required\", sets: new Set([set]) })\r\n        usableRainbows -= requiredRainbows\r\n\r\n        yield* check(i + 1)\r\n\r\n        usableRainbows += requiredRainbows\r\n        counts[set] = 0\r\n        used.delete(set)\r\n      }\r\n    }\r\n    // We separate filling rainbow slots from groupped slots because it has an entirely\r\n    // different set of rules regarding what can be filled and what states to be kept.\r\n    function* check_free(i: number) {\r\n      const remaining = rainbows.length - i, isolated: ArtifactSetKey[] = [], missing: ArtifactSetKey[] = [], rejected: ArtifactSetKey[] = []\r\n      let required = 0\r\n      for (const set of artSets) {\r\n        const allowedSet = allowedCounts[set], count = counts[set]\r\n        if (!allowedSet) continue\r\n        if (range(1, remaining).every(j => !allowedSet.has(count + j))) rejected.push(set)\r\n        else if (!allowedSet.has(count)) {\r\n          required += [...allowedSet].find(x => x > count)! - count\r\n          missing.push(set)\r\n        }\r\n        else if (range(0, remaining).some(j => !allowedSet.has(count + j))) isolated.push(set)\r\n      }\r\n      if (required > remaining) return\r\n      if (i === rainbows.length) {\r\n        yield { ...result }\r\n        return\r\n      }\r\n      if (required === remaining) {\r\n        for (const set of missing) {\r\n          counts[set]++\r\n          result[allSlotKeys[rainbows[i]]] = { kind: \"required\", sets: new Set([set]) }\r\n          yield* check_free(i + 1)\r\n          counts[set]--\r\n        }\r\n        return\r\n      }\r\n      for (const set of [...isolated, ...missing]) {\r\n        counts[set]++\r\n        result[allSlotKeys[rainbows[i]]] = { kind: \"required\", sets: new Set([set]) }\r\n        yield* check_free(i + 1)\r\n        counts[set]--\r\n      }\r\n      result[allSlotKeys[rainbows[i]]] = { kind: \"exclude\", sets: new Set([...missing, ...rejected, ...isolated]) }\r\n      yield* check_free(i + 1)\r\n    }\r\n    yield* check(0)\r\n  }\r\n  for (const shape of shapes) yield* check(shape)\r\n}\r\n\r\nexport type RequestFilter = StrictDict<SlotKey,\r\n  { kind: \"required\", sets: Set<ArtifactSetKey> } |\r\n  { kind: \"exclude\", sets: Set<ArtifactSetKey> } |\r\n  { kind: \"id\", ids: Set<string> }\r\n>\r\n\r\nexport type DynStat = { [key in string]: number }\r\nexport type ArtifactBuildData = {\r\n  id: string\r\n  set?: ArtifactSetKey\r\n  values: DynStat\r\n}\r\nexport type ArtifactsBySlot = { base: DynStat, values: StrictDict<SlotKey, ArtifactBuildData[]> }\r\n\r\nexport type PlotData = Dict<number, Build>\r\nexport interface Build {\r\n  value: number\r\n  plot?: number\r\n  artifactIds: string[]\r\n}\r\n","import { faBan, faChartLine } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { CheckBoxOutlineBlank, CheckBox, Replay, Settings } from '@mui/icons-material';\r\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Typography } from '@mui/material';\r\nimport React, { useCallback, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { Trans, useTranslation } from 'react-i18next';\r\nimport SetEffectDisplay from '../../../../../Components/Artifact/SetEffectDisplay';\r\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport CloseButton from '../../../../../Components/CloseButton';\r\nimport ColorText from '../../../../../Components/ColoredText';\r\nimport InfoTooltip from '../../../../../Components/InfoTooltip';\r\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport { Stars } from '../../../../../Components/StarDisplay';\r\nimport { Translate } from '../../../../../Components/Translate';\r\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\r\nimport { DatabaseContext } from '../../../../../Database/Database';\r\nimport { DataContext, dataContextObj } from '../../../../../DataContext';\r\nimport { UIData } from '../../../../../Formula/uiData';\r\nimport { constant } from '../../../../../Formula/utils';\r\nimport useForceUpdate from '../../../../../ReactHooks/useForceUpdate';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { allArtifactSets, allSlotKeys, ArtifactSetKey, SetNum, SlotKey } from '../../../../../Types/consts';\r\nimport { deepClone, objectKeyMap } from '../../../../../Util/Util';\r\nimport useBuildSetting from '../BuildSetting';\r\n\r\nexport default function ArtifactSetConfig({ disabled }: { disabled?: boolean, }) {\r\n  const { t } = useTranslation([\"page_character\", \"sheet\"])\r\n  const dataContext = useContext(DataContext)\r\n  const { database } = useContext(DatabaseContext)\r\n  const { character: { key: characterKey, conditional }, characterDispatch } = dataContext\r\n  const { buildSetting: { artSetExclusion }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const [open, setOpen] = useState(false)\r\n  const onOpen = useCallback(() => setOpen(true), [setOpen])\r\n  const onClose = useCallback(() => setOpen(false), [setOpen])\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const artSetKeyList = useMemo(() => artifactSheets ? Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets)).reverse().flatMap(([, sets]) => sets).filter(key => !key.includes(\"Prayers\")) : [], [artifactSheets])\r\n\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  useEffect(() => database.followAnyArt(forceUpdate), [database, forceUpdate])\r\n\r\n  const artSlotCount = useMemo(() => {\r\n    const artSlotCount: Dict<ArtifactSetKey, Record<SlotKey, number>> = Object.fromEntries(artSetKeyList.map(k => [k, Object.fromEntries(allSlotKeys.map(sk => [sk, 0]))]))\r\n    database._getArts().map(art => artSlotCount[art.setKey] && artSlotCount[art.setKey]![art.slotKey]++)\r\n    return dbDirty && artSlotCount\r\n  }, [dbDirty, database, artSetKeyList])\r\n  const allowRainbow2 = !artSetExclusion.rainbow?.includes(2)\r\n  const allowRainbow4 = !artSetExclusion.rainbow?.includes(4)\r\n\r\n  const { allow2, allow4, exclude2, exclude4 } = useMemo(() => ({\r\n    allow2: artSetKeyList.filter(k => !artSetExclusion[k]?.includes(2)).length,\r\n    allow4: artSetKeyList.filter(k => !artSetExclusion[k]?.includes(4)).length,\r\n    exclude2: artSetKeyList.filter(k => artSetExclusion[k]?.includes(2)).length,\r\n    exclude4: artSetKeyList.filter(k => artSetExclusion[k]?.includes(4)).length,\r\n  }), [artSetKeyList, artSetExclusion])\r\n  const artifactCondCount = useMemo(() =>\r\n    (Object.keys(conditional)).filter(k =>\r\n      allArtifactSets.includes(k as ArtifactSetKey) && Object.keys(conditional[k]).length !== 0).length\r\n    , [conditional])\r\n  const fakeDataContextObj = useMemo(() => fakeData(dataContext), [dataContext])\r\n  const resetArtConds = useCallback(() => {\r\n    const tconditional = Object.fromEntries(Object.entries(conditional).filter(([k, v]) => !allArtifactSets.includes(k as any)))\r\n    characterDispatch({ conditional: tconditional })\r\n  }, [conditional, characterDispatch]);\r\n  const setAllExclusion = useCallback(\r\n    (setnum: number, exclude = true) => {\r\n      const artSetExclusion_ = deepClone(artSetExclusion)\r\n      artSetKeyList.forEach(k => {\r\n        if (exclude) artSetExclusion_[k] = [...(artSetExclusion_[k] ?? []), setnum];\r\n        else if (artSetExclusion_[k]) artSetExclusion_[k] = artSetExclusion_[k].filter(n => n !== setnum);\r\n      })\r\n      buildSettingDispatch({ artSetExclusion: artSetExclusion_ })\r\n    },\r\n    [artSetKeyList, artSetExclusion, buildSettingDispatch],\r\n  )\r\n\r\n  return <>\r\n    <CardLight sx={{ display: \"flex\" }}>\r\n      <CardContent sx={{ flexGrow: 1 }} >\r\n        <Typography>\r\n          <strong>{t`tabOptimize.artSetConfig.title`}</strong>\r\n        </Typography>\r\n        <Typography>{t`tabOptimize.artSetConfig.setEffCond`} <SqBadge color={artifactCondCount ? \"success\" : \"secondary\"}>{artifactCondCount} {t<string>(\"tabOptimize.artSetConfig.enabled\")}</SqBadge></Typography>\r\n        <Typography>{t`sheet:2set`} <SqBadge color=\"success\">{allow2} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.allowed\")}</SqBadge>{!!exclude2 && \" / \"}{!!exclude2 && <SqBadge color=\"secondary\">{exclude2} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.excluded\")}</SqBadge>}</Typography>\r\n        <Typography>{t`sheet:4set`} <SqBadge color=\"success\">{allow4} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.allowed\")}</SqBadge>{!!exclude4 && \" / \"}{!!exclude4 && <SqBadge color=\"secondary\">{exclude4} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.excluded\")}</SqBadge>}</Typography>\r\n        <Typography>{t`tabOptimize.artSetConfig.2rainbow`} <SqBadge color={allowRainbow2 ? \"success\" : \"secondary\"}><FontAwesomeIcon icon={allowRainbow2 ? faChartLine : faBan} className=\"fa-fw\" /> {allowRainbow2 ? t<string>(\"tabOptimize.artSetConfig.allowed\") : \"Excluded\"}</SqBadge></Typography>\r\n        <Typography>{t`tabOptimize.artSetConfig.4rainbow`} <SqBadge color={allowRainbow4 ? \"success\" : \"secondary\"}><FontAwesomeIcon icon={allowRainbow4 ? faChartLine : faBan} className=\"fa-fw\" /> {allowRainbow4 ? t<string>(\"tabOptimize.artSetConfig.allowed\") : \"Excluded\"}</SqBadge></Typography>\r\n      </CardContent>\r\n      <Button onClick={onOpen} disabled={disabled} color=\"info\" sx={{ borderRadius: 0 }}>\r\n        <Settings />\r\n      </Button>\r\n    </CardLight>\r\n    {artifactSheets && <ModalWrapper open={open} onClose={onClose} ><CardDark>\r\n      <CardContent sx={{ display: \"flex\", gap: 1, justifyContent: \"space-between\" }}>\r\n        <Typography variant=\"h6\" >{t`tabOptimize.artSetConfig.title`}</Typography>\r\n        <CloseButton onClick={onClose} />\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent >\r\n        <CardLight sx={{ mb: 1 }}><CardContent>\r\n          <Box display=\"flex\" gap={1}>\r\n            <Typography><strong>{t`tabOptimize.artSetConfig.modal.setCond.title`}</strong></Typography>\r\n            <Typography sx={{ flexGrow: 1 }}><SqBadge color={artifactCondCount ? \"success\" : \"secondary\"}>{artifactCondCount} {t<string>(\"tabOptimize.artSetConfig.selected\")}</SqBadge></Typography>\r\n            <Button size='small' onClick={resetArtConds} color=\"error\" startIcon={<Replay />}>{t`tabOptimize.artSetConfig.modal.setCond.reset`}</Button>\r\n          </Box>\r\n          <Typography>{t`tabOptimize.artSetConfig.modal.setCond.text`}</Typography>\r\n        </CardContent></CardLight>\r\n        <CardLight sx={{ mb: 1 }}><CardContent>\r\n          <Typography sx={{ flexGrow: 1 }}><strong>\r\n            <Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.title\" >Artifact Sets <ColorText color='success'>Allowed<FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /></ColorText> / <ColorText color='secondary' variant='light'>Excluded<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /></ColorText></Trans>\r\n          </strong></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.intro\">You can allow/exclude which sets you want the builder to consider. In the following examples, <strong>A</strong> is on-set, and <strong>R</strong> is rainbow(off-set)</Trans></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.2set\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 2-Set</ColorText></strong> would exclude 2-Set builds: <strong><ColorText color='secondary' variant='light'>AA</ColorText>RRR</strong> and <strong><ColorText color='secondary' variant='light'>AAA</ColorText>RR</strong>.</Trans></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.4set\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 4-Set</ColorText></strong> would exclude 4-Set builds: <strong><ColorText color='secondary' variant='light'>AAAA</ColorText>R</strong> and <strong><ColorText color='secondary' variant='light'>AAAAA</ColorText></strong>.</Trans></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.2rain\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 3-Rainbow</ColorText></strong> would exclude 2-Set + 3-Rainbow builds: <strong>AA<ColorText color='secondary' variant='light'>RRR</ColorText></strong> and <strong>AAA<ColorText color='secondary' variant='light'>RR</ColorText></strong>.</Trans></Typography>\r\n          <Typography><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.modal.ArtSetFilter.4rain\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 5-Rainbow</ColorText></strong> would exclude full 5-Rainbow builds: <strong><ColorText color='secondary' variant='light'>RRRRR</ColorText></strong>.</Trans></Typography>\r\n        </CardContent></CardLight>\r\n        <Grid container columns={{ xs: 2, lg: 3 }} sx={{ mb: 1 }} spacing={1}>\r\n          <Grid item xs={1}>\r\n            <AllSetAllowExcludeCard setNum={2} numAllow={allow2} numExclude={exclude2} setAllExclusion={setAllExclusion} />\r\n          </Grid>\r\n          <Grid item xs={1}>\r\n            <AllSetAllowExcludeCard setNum={4} numAllow={allow4} numExclude={exclude4} setAllExclusion={setAllExclusion} />\r\n          </Grid>\r\n          <Grid item xs={1}>\r\n            <CardLight>\r\n              <CardContent>\r\n                <Typography gutterBottom><strong><Trans t={t} i18nKey=\"tabOptimize.artSetConfig.alExRainbow\"><ColorText color='success'>Allow <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /></ColorText> / <ColorText color='secondary' variant='light'>Exclude <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /></ColorText> Rainbow Builds</Trans></strong></Typography>\r\n                <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n                  <Button fullWidth onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey: \"rainbow\", num: 2 })} color={allowRainbow2 ? \"success\" : \"secondary\"} startIcon={!allowRainbow2 ? <CheckBoxOutlineBlank /> : <CheckBox />} endIcon={<FontAwesomeIcon icon={allowRainbow2 ? faChartLine : faBan} className=\"fa-fw\" />}>{t`tabOptimize.artSetConfig.2rainbow`}</Button>\r\n                  <Button fullWidth onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey: \"rainbow\", num: 4 })} color={allowRainbow4 ? \"success\" : \"secondary\"} startIcon={!allowRainbow4 ? <CheckBoxOutlineBlank /> : <CheckBox />} endIcon={<FontAwesomeIcon icon={allowRainbow4 ? faChartLine : faBan} className=\"fa-fw\" />}>{t`tabOptimize.artSetConfig.4rainbow`}</Button>\r\n                </Box>\r\n              </CardContent>\r\n            </CardLight>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid container spacing={1} columns={{ xs: 2, lg: 3 }}>\r\n          {artSetKeyList.map(setKey => {\r\n            return <ArtifactSetCard key={setKey} setKey={setKey} sheet={artifactSheets[setKey]} fakeDataContextObj={fakeDataContextObj} slotCount={artSlotCount[setKey]!} />\r\n          })}\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent sx={{ py: 1 }}>\r\n        <CloseButton large onClick={onClose} />\r\n      </CardContent>\r\n    </CardDark></ModalWrapper >}\r\n  </>\r\n}\r\nfunction AllSetAllowExcludeCard({ numAllow, numExclude, setNum, setAllExclusion }: { numAllow: number, numExclude: number, setNum: 2 | 4, setAllExclusion: (setNum: 2 | 4, exclude?: boolean) => void }) {\r\n  const { t } = useTranslation([\"page_character\", \"sheet\"])\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Typography gutterBottom><strong>{t(`sheet:${setNum}set`)}</strong> <SqBadge color=\"success\">{numAllow} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.allowed\")}</SqBadge>{!!numExclude && \" / \"}{!!numExclude && <SqBadge color=\"secondary\">{numExclude} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"tabOptimize.artSetConfig.excluded\")}</SqBadge>}</Typography>\r\n      <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <Button fullWidth disabled={!numExclude} onClick={() => setAllExclusion(setNum, false)} color='success' startIcon={<FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" />}>{t(`tabOptimize.artSetConfig.allowAll${setNum}set`)}</Button>\r\n        <Button fullWidth disabled={!numAllow} onClick={() => setAllExclusion(setNum, true)} color='secondary' startIcon={<FontAwesomeIcon icon={faBan} className=\"fa-fw\" />}>{t(`tabOptimize.artSetConfig.excludeAll${setNum}set`)}</Button>\r\n      </Box>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\nfunction ArtifactSetCard({ sheet, setKey, fakeDataContextObj, slotCount }: { setKey: ArtifactSetKey, sheet: ArtifactSheet, fakeDataContextObj: dataContextObj, slotCount: Record<SlotKey, number> }) {\r\n  const { t } = useTranslation(\"sheet\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const setExclusionSet = buildSetting?.artSetExclusion?.[setKey] ?? []\r\n  const allow4 = !setExclusionSet.includes(4)\r\n  const slots = useMemo(() => Object.values(slotCount).reduce((tot, v) => tot + (v ? 1 : 0), 0), [slotCount])\r\n\r\n  /* Assumes that all conditionals are from 4-Set. needs to change if there are 2-Set conditionals */\r\n  const set4CondNums = useMemo(() => {\r\n    if (!allow4) return []\r\n    return Object.keys(sheet.setEffects).filter(setNumKey => sheet.setEffects[setNumKey]?.document.some(doc => \"states\" in doc))\r\n  }, [sheet.setEffects, allow4])\r\n  const exclude2 = setExclusionSet.includes(2)\r\n  const exclude4 = setExclusionSet.includes(4)\r\n  if (slots < 2) return null\r\n  return <Grid item key={setKey} xs={1}>\r\n    <CardLight sx={{ height: \"100%\" }}>\r\n      <Box className={`grad-${sheet.rarity[0]}star`} width=\"100%\" sx={{ display: \"flex\" }} >\r\n        <Box component=\"img\" src={sheet.defIconSrc} sx={{ height: 100, width: \"auto\" }} />\r\n        <Box sx={{ flexGrow: 1, px: 1, display: \"flex\", flexDirection: \"column\", justifyContent: \"center\" }}>\r\n          <Typography variant=\"h6\">{sheet.name ?? \"\"}</Typography>\r\n          <Box display=\"flex\" gap={1}>\r\n            <Typography variant=\"subtitle1\">{sheet.rarity.map((ns, i) => <span key={ns}>{ns} <Stars stars={1} /> {i < (sheet.rarity.length - 1) ? \"/ \" : null}</span>)}</Typography>\r\n            {/* If there is ever a 2-Set conditional, we will need to change this */}\r\n            <InfoTooltip title={<Box>\r\n              <Typography><SqBadge color=\"success\">{t`2set`}</SqBadge></Typography>\r\n              <Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.2\"} /></Typography>\r\n              <Box paddingTop={1} sx={{ opacity: setExclusionSet.includes(4) ? 0.6 : 1 }} >\r\n                <Typography><SqBadge color=\"success\">{t`4set`}</SqBadge></Typography>\r\n                <Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.4\"} /></Typography>\r\n              </Box>\r\n            </Box>} />\r\n          </Box>\r\n          <Box sx={{ display: \"flex\", gap: 1 }}>{Object.entries(slotCount).map(([slotKey, count]) => <Typography key={slotKey} sx={{ flexGrow: 1 }} variant=\"subtitle1\" ><SqBadge sx={{ width: \"100%\" }} color={count ? \"primary\" : \"secondary\"}>{artifactSlotIcon(slotKey)} {count}</SqBadge></Typography>)}</Box>\r\n        </Box>\r\n      </Box>\r\n      <ButtonGroup sx={{ \".MuiButton-root\": { borderRadius: 0 } }} fullWidth>\r\n        {slots >= 2 && <Button startIcon={exclude2 ? <CheckBoxOutlineBlank /> : <CheckBox />} onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey, num: 2 })} color={exclude2 ? 'secondary' : 'success'} endIcon={<FontAwesomeIcon icon={exclude2 ? faBan : faChartLine} className=\"fa-fw\" />}>{t`2set`}</Button>}\r\n        {slots >= 4 && <Button startIcon={exclude4 ? <CheckBoxOutlineBlank /> : <CheckBox />} onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey, num: 4 })} color={exclude4 ? 'secondary' : 'success'} endIcon={<FontAwesomeIcon icon={exclude4 ? faBan : faChartLine} className=\"fa-fw\" />}>{t`4set`}</Button>}\r\n      </ButtonGroup>\r\n\r\n      {!!set4CondNums.length && <DataContext.Provider value={fakeDataContextObj}>\r\n        <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\r\n          {set4CondNums.map(setNumKey =>\r\n            <SetEffectDisplay key={setNumKey} setKey={setKey} setNumKey={parseInt(setNumKey) as SetNum} hideHeader conditionalsOnly />\r\n          )}\r\n        </CardContent>\r\n      </DataContext.Provider>}\r\n    </CardLight>\r\n  </Grid >\r\n}\r\nfunction fakeData(currentContext: dataContextObj): dataContextObj {\r\n  return {\r\n    ...currentContext,\r\n    data: new UIData({ ...currentContext.data.data[0], artSet: objectKeyMap(allArtifactSets, _ => constant(4)) }, undefined)\r\n  }\r\n}\r\n","import { MenuItem } from \"@mui/material\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport DropdownButton from \"../../../../../Components/DropdownMenu/DropdownButton\"\r\n\r\nconst levels = [0, 4, 8, 12, 16, 20] as const\r\nexport default function AssumeFullLevelToggle({ mainStatAssumptionLevel = 0, setmainStatAssumptionLevel, disabled }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  return <DropdownButton fullWidth color={mainStatAssumptionLevel ? \"success\" : \"primary\"} disabled={disabled}\r\n    title={mainStatAssumptionLevel ? t(\"tabOptimize.assumptionLvl.lvl\", { lvl: mainStatAssumptionLevel }) : t(\"tabOptimize.assumptionLvl.no\")}>\r\n    {levels.map((lvl) => <MenuItem key={lvl} onClick={() => setmainStatAssumptionLevel(lvl)}>{lvl ? t(\"tabOptimize.assumptionLvl.lvl\", { lvl }) : t(\"tabOptimize.assumptionLvl.no\")}</MenuItem>)}\r\n  </DropdownButton>\r\n}\r\n","import { CardContent, Divider, Typography } from '@mui/material';\r\nimport { useContext } from 'react';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport { NodeFieldDisplay } from '../../../../../Components/FieldDisplay';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport { uiInput as input } from '../../../../../Formula';\r\nimport { NumNode } from '../../../../../Formula/type';\r\nexport default function BonusStatsCard() {\r\n  const { data, character } = useContext(DataContext)\r\n  const bonusStatsKeys = Object.keys(character?.bonusStats)\r\n  if (!bonusStatsKeys.length) return null\r\n  const nodes = bonusStatsKeys.map(k => data.get(input.customBonus[k] as NumNode))\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Typography>Bonus Stats</Typography>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      {nodes.map(n => <NodeFieldDisplay key={n.info.key} node={n} />)}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { Alert, Grid, LinearProgress, styled, Typography } from '@mui/material';\r\nimport { ReactNode } from 'react';\r\nimport { timeStringMs } from '../../../../../Util/TimeUtil';\r\n\r\nexport const warningBuildNumber = 10000000\r\nexport type BuildStatus = {\r\n  type: \"active\" | \"inactive\"\r\n  tested: number      // tested, including `failed`\r\n  failed: number      // tested but fail the filter criteria, e.g., not enough EM\r\n  skipped: number\r\n  total: number\r\n  startTime?: number\r\n  finishTime?: number\r\n}\r\n\r\nconst Monospace = styled(\"strong\")({\r\n  fontFamily: \"monospace\"\r\n})\r\n\r\nconst BorderLinearProgress = styled(LinearProgress)(({ theme }) => ({\r\n  height: 10,\r\n  borderRadius: 5,\r\n}));\r\nexport default function BuildAlert({ status: { type, tested, failed, skipped, total, startTime, finishTime }, characterName }: { status: BuildStatus, characterName: Displayable }) {\r\n  const hasTotal = isFinite(total)\r\n\r\n  const generatingBuilds = type !== \"inactive\"\r\n  const unskipped = total - skipped\r\n\r\n  const testedString = <Monospace>{tested.toLocaleString()}</Monospace>\r\n  const unskippedString = <Monospace>{unskipped.toLocaleString()}</Monospace>\r\n  const skippedText = !!skipped && <span>(<b>{<Monospace>{skipped.toLocaleString()}</Monospace>}</b> skipped)</span>\r\n\r\n  const durationString = <Monospace>{timeStringMs(Math.round((finishTime ?? performance.now()) - (startTime ?? NaN)))}</Monospace>\r\n\r\n  let color = \"success\" as \"success\" | \"warning\" | \"error\"\r\n  let title = \"\" as ReactNode\r\n  let subtitle = \"\" as ReactNode\r\n  let progress = undefined as undefined | number\r\n\r\n  if (generatingBuilds) {\r\n    progress = tested * 100 / (unskipped)\r\n    title = <Typography>Generating and testing {testedString}{hasTotal ? <>/{unskippedString}</> : undefined} build configurations against the criteria for <b>{characterName}</b>. {skippedText}</Typography>\r\n    subtitle = <Typography>Time elapsed: {durationString}</Typography>\r\n  } else if (tested + skipped) {\r\n    progress = 100\r\n    title = <Typography>Generated and tested {testedString} Build configurations against the criteria for <b>{characterName}</b>. {skippedText}</Typography>\r\n    subtitle = <Typography>Total duration: {durationString}</Typography>\r\n  } else {\r\n    return null\r\n  }\r\n\r\n  return <Alert severity={color} variant=\"filled\" sx={{\r\n    \"& .MuiAlert-message\": {\r\n      flexGrow: 1\r\n    }\r\n  }}>\r\n    {title}\r\n    {subtitle}\r\n    {progress !== undefined && <Grid container spacing={1} alignItems=\"center\">\r\n      {hasTotal && <Grid item>\r\n        <Typography>{`${progress.toFixed(1)}%`}</Typography>\r\n      </Grid>}\r\n      <Grid item flexGrow={1} >\r\n        <BorderLinearProgress variant={hasTotal ? \"determinate\" : \"indeterminate\"} value={progress} color=\"primary\" />\r\n      </Grid>\r\n    </Grid>}\r\n  </Alert>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank, Download, Info } from '@mui/icons-material';\r\nimport { Button, CardContent, Collapse, Divider, Grid, MenuItem, styled, Tooltip, Typography } from '@mui/material';\r\nimport { useContext, useMemo, useState } from 'react';\r\nimport { CartesianGrid, ComposedChart, Legend, Line, ResponsiveContainer, Scatter, XAxis, YAxis, ZAxis } from 'recharts';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport DropdownButton from '../../../../../Components/DropdownMenu/DropdownButton';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport { uiInput as input } from '../../../../../Formula';\r\nimport { NumNode } from '../../../../../Formula/type';\r\nimport KeyMap from '../../../../../KeyMap';\r\nimport { MainStatKey, SubstatKey } from '../../../../../Types/artifact';\r\nimport { Build } from '../common';\r\n\r\nexport type ChartData = {\r\n  valueNode: NumNode,\r\n  plotNode: NumNode,\r\n  data: Build[]\r\n}\r\ntype ChartCardProps = {\r\n  chartData?: ChartData\r\n  plotBase: MainStatKey | SubstatKey | \"\",\r\n  setPlotBase: (key: MainStatKey | SubstatKey | \"\") => void\r\n  disabled?: boolean\r\n}\r\ntype Point = { x: number, y: number, min?: number }\r\nexport default function ChartCard({ chartData, plotBase, setPlotBase, disabled = false }: ChartCardProps) {\r\n  const [showDownload, setshowDownload] = useState(false)\r\n  const [showMin, setshowMin] = useState(true)\r\n  const { data } = useContext(DataContext)\r\n  const statKeys = [\"atk\", \"hp\", \"def\", \"eleMas\", \"critRate_\", \"critDMG_\", \"heal_\", \"enerRech_\"]\r\n  if (data.get(input.weaponType).value !== \"catalyst\") statKeys.push(\"physical_dmg_\")\r\n  statKeys.push(`${data.get(input.charEle).value}_dmg_`)\r\n\r\n  const { displayData, downloadData } = useMemo(() => {\r\n    if (!chartData) return { displayData: null, downloadData: null }\r\n    const points = chartData.data.map(({ value: y, plot: x }) => ({ x, y })) as Point[]\r\n    const increasingX: Point[] = points.sort((a, b) => a.x - b.x)\r\n    const minimumData: Point[] = []\r\n    for (const point of increasingX) {\r\n      let last: Point | undefined\r\n      while ((last = minimumData.pop())) {\r\n        if (last.y > point.y) {\r\n          minimumData.push(last)\r\n          break\r\n        }\r\n      }\r\n      minimumData.push(point)\r\n    }\r\n\r\n    // Note:\r\n    // We can also just use `minimumData` if the plotter supports multiple data sources.\r\n    // It could be faster too since there're no empty entries in `minimumData`.\r\n    if (minimumData[0]?.x !== increasingX[0]?.x)\r\n      increasingX[0].min = minimumData[0].y\r\n    minimumData.forEach(x => { x.min = x.y })\r\n\r\n    const downloadData = {\r\n      minimum: minimumData.map(({ x, y }) => [x, y]),\r\n      allData: increasingX.map(({ x, y }) => [x, y]),\r\n    }\r\n    return { displayData: increasingX, downloadData }\r\n  }, [chartData])\r\n\r\n  return <CardLight>\r\n    <CardContent>\r\n      <Grid container spacing={1} alignItems=\"center\">\r\n        <Grid item>\r\n          <Typography variant=\"h6\" >Optimization Target vs</Typography>\r\n        </Grid>\r\n        <Grid item>\r\n          <DropdownButton title={plotBase ? KeyMap.get(plotBase) : \"Not Selected\"}\r\n            color={plotBase ? \"success\" : \"primary\"}\r\n            disabled={disabled}\r\n          >\r\n            <MenuItem onClick={() => { setPlotBase(\"\") }}>Unselect</MenuItem>\r\n            <Divider />\r\n            {statKeys.map(sKey => <MenuItem key={sKey} onClick={() => { setPlotBase(sKey as any) }}>{KeyMap.get(sKey)}</MenuItem>)}\r\n          </DropdownButton>\r\n        </Grid>\r\n        <Grid item flexGrow={1}>\r\n          <Tooltip placement=\"top\" title=\"Using data from the builder, this will generate a graph to visualize Optimization Target vs. a selected stat. The graph will show the maximum Optimization Target value per 0.01 of the selected stat.\">\r\n            <Info />\r\n          </Tooltip>\r\n        </Grid>\r\n        {!!downloadData && <Grid item>\r\n          <Button startIcon={showMin ? <CheckBox /> : <CheckBoxOutlineBlank />}\r\n            color={showMin ? \"success\" : \"secondary\"}\r\n            onClick={() => setshowMin(!showMin)}>Show Min Stat Threshold</Button>\r\n        </Grid>}\r\n        {!!downloadData && <Grid item>\r\n          <Button color=\"info\" startIcon={<Download />} onClick={() => setshowDownload(!showDownload)}>Download Data</Button>\r\n        </Grid>}\r\n      </Grid>\r\n    </CardContent>\r\n    {!!displayData && <Divider />}\r\n    {chartData && !!displayData && <CardContent>\r\n      <Collapse in={!!downloadData && showDownload}>\r\n        <CardDark sx={{ mb: 2 }}>\r\n          <CardContent>\r\n            <Typography>Min Data</Typography>\r\n            <DataDisplay data={downloadData?.minimum} />\r\n            <Typography>All Data</Typography>\r\n            <DataDisplay data={downloadData?.allData} />\r\n          </CardContent>\r\n        </CardDark>\r\n      </Collapse>\r\n      <Chart displayData={displayData} plotNode={chartData.plotNode} valueNode={chartData.valueNode} showMin={showMin} />\r\n    </CardContent>}\r\n  </CardLight >\r\n}\r\nconst TextArea = styled(\"textarea\")({\r\n  width: \"100%\",\r\n  fontFamily: \"monospace\",\r\n  resize: \"vertical\",\r\n  minHeight: \"5em\"\r\n})\r\nfunction DataDisplay({ data, }: { data?: object }) {\r\n  return <TextArea readOnly value={JSON.stringify(data)} onClick={e => {\r\n    const target = e.target as HTMLTextAreaElement;\r\n    target.selectionStart = 0;\r\n    target.selectionEnd = target.value.length;\r\n  }} />\r\n}\r\nfunction Chart({ displayData, plotNode, valueNode, showMin }: {\r\n  displayData: Point[],\r\n  plotNode: NumNode,\r\n  valueNode: NumNode,\r\n  showMin: boolean\r\n}) {\r\n  const plotBaseUnit = KeyMap.unit(plotNode.info?.key)\r\n  const valueUnit = KeyMap.unit(valueNode.info?.key)\r\n  return <ResponsiveContainer width=\"100%\" height={600}>\r\n    <ComposedChart data={displayData}>\r\n      <CartesianGrid strokeDasharray=\"3 3\" />\r\n      <XAxis dataKey=\"x\" scale=\"linear\" unit={plotBaseUnit} domain={[\"auto\", \"auto\"]} tick={{ fill: 'white' }} type=\"number\" tickFormatter={n => n > 10000 ? n.toFixed() : n.toFixed(1)} />\r\n      <YAxis name=\"DMG\" domain={[\"auto\", \"auto\"]} unit={valueUnit} allowDecimals={false} tick={{ fill: 'white' }} type=\"number\" />\r\n      <ZAxis dataKey=\"y\" range={[3, 25]} />\r\n      <Legend />\r\n      <Scatter name=\"Optimization Target\" dataKey=\"y\" fill=\"#8884d8\" line lineType=\"fitting\" isAnimationActive={false} />\r\n      {showMin && <Line name=\"Minimum Stat Requirement Threshold\" dataKey=\"min\" stroke=\"#ff7300\" type=\"stepBefore\" connectNulls strokeWidth={2} isAnimationActive={false} />}\r\n    </ComposedChart>\r\n  </ResponsiveContainer>\r\n}\r\n","import { Replay } from '@mui/icons-material';\r\nimport { Button, CardContent, Divider, Grid, Typography } from '@mui/material';\r\nimport { Box } from '@mui/system';\r\nimport React, { useContext } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\r\nimport BootstrapTooltip from '../../../../../Components/BootstrapTooltip';\r\nimport SqBadge from '../../../../../Components/SqBadge';\r\nimport StatIcon, { uncoloredEleIcons } from '../../../../../Components/StatIcon';\r\nimport Artifact from '../../../../../Data/Artifacts/Artifact';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport KeyMap from '../../../../../KeyMap';\r\nimport { allElementsWithPhy } from '../../../../../Types/consts';\r\nimport useBuildSetting from '../BuildSetting';\r\n\r\nexport const artifactsSlotsToSelectMainStats = [\"sands\", \"goblet\", \"circlet\"] as const\r\n\r\nexport default function MainStatSelectionCard({ disabled = false, }: {\r\n  disabled?: boolean\r\n}) {\r\n  const { t } = useTranslation(\"artifact\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { buildSetting: { mainStatKeys }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    {artifactsSlotsToSelectMainStats.map(slotKey => {\r\n      const numSel = mainStatKeys[slotKey].length\r\n      return <Box key={slotKey}>\r\n        <Divider />\r\n        <CardContent sx={{ pt: 1 }}>\r\n          <Box sx={{ display: \"flex\", gap: 1, alignItems: \"center\", pb: 1 }}>\r\n            <BootstrapTooltip placement=\"top\" title={<Typography>{t(`slotName.${slotKey}`)}</Typography>}>\r\n              <span>{artifactSlotIcon(slotKey)}</span>\r\n            </BootstrapTooltip>\r\n            <Box flexGrow={1}>\r\n              <SqBadge color=\"info\">{numSel ? `${numSel} Selected` : `Any`}</SqBadge>\r\n            </Box>\r\n            <Button color=\"error\" size=\"small\" disabled={!mainStatKeys[slotKey].length || disabled} sx={{ mt: -1, mb: -1 }}\r\n              onClick={() => buildSettingDispatch({ type: \"mainStatKey\", slotKey })}>\r\n              <Replay />\r\n            </Button>\r\n          </Box>\r\n          <Grid container spacing={1}>\r\n            {Artifact.slotMainStats(slotKey).map((mainStatKey, i) => {\r\n              const element = allElementsWithPhy.find(ele => mainStatKey.includes(ele))\r\n              const color = mainStatKeys[slotKey].includes(mainStatKey)\r\n                ? element ?? \"success\"\r\n                : \"secondary\"\r\n              return <Grid item key={mainStatKey} flexGrow={1} xs={i < 3 ? 4 : undefined} >\r\n                <BootstrapTooltip placement=\"top\" title={<Typography><strong>{KeyMap.getArtStr(mainStatKey)}</strong></Typography>} disableInteractive>\r\n                  <Button fullWidth size=\"small\" color={color} sx={{ fontSize: \"1.2em\", height: \"100%\", pointerEvents: disabled ? \"none\" : undefined, cursor: disabled ? \"none\" : undefined }}\r\n                    onClick={() => buildSettingDispatch({ type: \"mainStatKey\", slotKey, mainStatKey })}>\r\n                    {element ? uncoloredEleIcons[element] : StatIcon[mainStatKey]}\r\n                  </Button>\r\n                </BootstrapTooltip>\r\n              </Grid>\r\n            })}\r\n          </Grid>\r\n        </CardContent>\r\n      </Box>\r\n    })}\r\n  </Box >\r\n}\r\n","import { Masonry } from '@mui/lab';\r\nimport { Button, CardContent, CardHeader, Divider, MenuItem, MenuList, styled } from '@mui/material';\r\nimport React, { useCallback, useContext, useState } from 'react';\r\nimport CardDark from '../../../../../Components/Card/CardDark';\r\nimport CardLight from '../../../../../Components/Card/CardLight';\r\nimport ColorText from '../../../../../Components/ColoredText';\r\nimport ImgIcon from '../../../../../Components/Image/ImgIcon';\r\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\r\nimport { DataContext } from '../../../../../DataContext';\r\nimport { getDisplayHeader, getDisplaySections } from '../../../../../Formula/DisplayUtil';\r\nimport { DisplaySub } from '../../../../../Formula/type';\r\nimport { NodeDisplay } from '../../../../../Formula/uiData';\r\nimport KeyMap from '../../../../../KeyMap';\r\nimport usePromise from '../../../../../ReactHooks/usePromise';\r\nimport { objPathValue } from '../../../../../Util/Util';\r\n\r\nconst WhiteButton = styled(Button)({\r\n  color: \"black\",\r\n  backgroundColor: \"white\",\r\n  \"&:hover\": {\r\n    backgroundColor: \"#e1e1e1\",\r\n  }\r\n})\r\nexport default function OptimizationTargetSelector({ optimizationTarget, setTarget, disabled = false }: {\r\n  optimizationTarget?: string[], setTarget: (target: string[]) => void, disabled\r\n}) {\r\n  const [open, setOpen] = useState(false)\r\n  const onOpen = useCallback(() => !disabled && setOpen(true), [setOpen, disabled])\r\n  const onClose = useCallback(() => setOpen(false), [setOpen])\r\n\r\n  const setTargetHandler = useCallback(\r\n    (target: string[]) => {\r\n      onClose()\r\n      setTarget(target)\r\n    },\r\n    [onClose, setTarget],\r\n  )\r\n  const { data } = useContext(DataContext)\r\n  const sections = getDisplaySections(data)\r\n  return <>\r\n    <WhiteButton onClick={onOpen} disabled={disabled} >\r\n      <TargetDisplayText optimizationTarget={optimizationTarget} />\r\n    </WhiteButton>\r\n    <ModalWrapper open={open} onClose={onClose}>\r\n      <CardDark >\r\n        <CardContent>\r\n          <Masonry columns={{ xs: 1, sm: 2, md: 3 }} spacing={1}>\r\n            {sections.map(([key, Nodes]) =>\r\n              <SelectorSection key={key} displayNs={Nodes} sectionKey={key} setTarget={setTargetHandler} />)}\r\n          </Masonry >\r\n        </CardContent>\r\n      </CardDark>\r\n    </ModalWrapper>\r\n  </>\r\n}\r\nfunction SelectorSection({ displayNs, sectionKey, setTarget }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string, setTarget: (target: string[]) => void }) {\r\n  const { data } = useContext(DataContext)\r\n  const header = usePromise(getDisplayHeader(data, sectionKey), [data, sectionKey])\r\n  return <CardLight key={sectionKey as string}>\r\n    {header && <CardHeader avatar={header.icon && <ImgIcon size={2} sx={{ m: -1 }} src={header.icon} />} title={header.title} action={header.action} titleTypographyProps={{ variant: \"subtitle1\" }} />}\r\n    <Divider />\r\n    <MenuList>\r\n      {Object.entries(displayNs).map(([key, n]) =>\r\n        <TargetSelectorMenuItem key={key} node={n} onClick={() => setTarget([sectionKey, key])} />)}\r\n    </MenuList>\r\n  </CardLight>\r\n}\r\nfunction NoTarget() {\r\n  return <b>Select an Optimization Target</b>\r\n}\r\nfunction TargetDisplayText({ optimizationTarget }: { optimizationTarget?: string[] }) {\r\n  const { data } = useContext(DataContext)\r\n  const displayHeader = usePromise(optimizationTarget && getDisplayHeader(data, optimizationTarget[0]), [data, optimizationTarget])\r\n\r\n  if (!optimizationTarget || !displayHeader) return <NoTarget />\r\n  const node: NodeDisplay | undefined = objPathValue(data.getDisplay(), optimizationTarget) as any\r\n  if (!node) return <NoTarget />\r\n\r\n  return <b>{displayHeader.title} : {<ColorText color={node.info.variant}>{KeyMap.get(node.info.key)}</ColorText>}</b>\r\n}\r\nfunction TargetSelectorMenuItem({ node, onClick }: { node: NodeDisplay, onClick: () => void }) {\r\n  if (node.isEmpty) return null\r\n  return <MenuItem onClick={onClick} style={{ overflow: \"hidden\", textOverflow: \"ellipsis\" }}>\r\n    <ColorText color={node.info.variant} >{KeyMap.get(node.info.key)}</ColorText>\r\n  </MenuItem>\r\n}\r\n","import useDBState from \"../../../../ReactHooks/useDBState\";\r\nimport { CharacterKey } from \"../../../../Types/consts\";\r\n\r\nexport const defThreads = navigator.hardwareConcurrency || 4\r\n\r\nexport function initialTabOptimizeDBState(): {\r\n  equipmentPriority: CharacterKey[],\r\n  threads: number,\r\n} {\r\n  return {\r\n    equipmentPriority: [],\r\n    threads: defThreads\r\n  }\r\n}\r\n\r\nexport function useOptimizeDBState() {\r\n  return useDBState(\"TabOptimize\", initialTabOptimizeDBState)\r\n}\r\n","import { Add, CheckBox, CheckBoxOutlineBlank, Close, KeyboardArrowDown, KeyboardArrowUp, KeyboardDoubleArrowDown, KeyboardDoubleArrowUp, Replay, Settings } from \"@mui/icons-material\";\r\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Typography } from \"@mui/material\";\r\nimport { useCallback, useContext, useMemo } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport ArtifactCardPico from \"../../../../../Components/Artifact/ArtifactCardPico\";\r\nimport CardDark from \"../../../../../Components/Card/CardDark\";\r\nimport CardLight from \"../../../../../Components/Card/CardLight\";\r\nimport CharacterCardPico from \"../../../../../Components/Character/CharacterCardPico\";\r\nimport { CharacterSelectionModal } from \"../../../../../Components/Character/CharacterSelectionModal\";\r\nimport CloseButton from \"../../../../../Components/CloseButton\";\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"../../../../../Components/CustomNumberInput\";\r\nimport ModalWrapper from \"../../../../../Components/ModalWrapper\";\r\nimport SqBadge from \"../../../../../Components/SqBadge\";\r\nimport WeaponCardPico from \"../../../../../Components/Weapon/WeaponCardPico\";\r\nimport { DatabaseContext } from \"../../../../../Database/Database\";\r\nimport { DataContext } from \"../../../../../DataContext\";\r\nimport useBoolState from \"../../../../../ReactHooks/useBoolState\";\r\nimport useCharacter from \"../../../../../ReactHooks/useCharacter\";\r\nimport useCharSelectionCallback from \"../../../../../ReactHooks/useCharSelectionCallback\";\r\nimport { ICachedCharacter } from \"../../../../../Types/character\";\r\nimport { CharacterKey } from \"../../../../../Types/consts\";\r\nimport useBuildSetting from \"../BuildSetting\";\r\nimport { useOptimizeDBState } from \"../DBState\";\r\n\r\nexport default function UseEquipped({ disabled = false }: { disabled?: boolean }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { buildSetting: { useEquippedArts }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const { database } = useContext(DatabaseContext)\r\n  const [show, onOpen, onClose] = useBoolState(false)\r\n  const [{ equipmentPriority: tempEquipmentPriority }, setOptimizeDBState] = useOptimizeDBState()\r\n  //Basic validate for the equipmentPrio list to remove dups and characters that doesnt exist.\r\n  const equipmentPriority = useMemo(() => [...new Set(tempEquipmentPriority)].filter(ck => database._getChar(ck)), [database, tempEquipmentPriority])\r\n  const setPrio = useCallback((equipmentPriority: CharacterKey[]) => setOptimizeDBState({ equipmentPriority }), [setOptimizeDBState])\r\n\r\n  const setPrioRank = useCallback((fromIndex, toIndex) => {\r\n    const arr = [...equipmentPriority]\r\n    var element = arr[fromIndex];\r\n    arr.splice(fromIndex, 1);\r\n    arr.splice(toIndex, 0, element);\r\n    setPrio(arr)\r\n  }, [equipmentPriority, setPrio])\r\n  const removePrio = useCallback((fromIndex) => {\r\n    const arr = [...equipmentPriority]\r\n    arr.splice(fromIndex, 1)\r\n    setPrio(arr)\r\n  }, [equipmentPriority, setPrio])\r\n  const addPrio = useCallback((ck: CharacterKey) => setPrio([...equipmentPriority, ck]), [equipmentPriority, setPrio])\r\n  const resetPrio = useCallback(() => setPrio([]), [setPrio])\r\n\r\n  const numAbove = useMemo(() => {\r\n    let numAbove = equipmentPriority.length\r\n    const index = equipmentPriority.indexOf(characterKey)\r\n    if (index >= 0) numAbove = index\r\n    return numAbove\r\n  }, [characterKey, equipmentPriority])\r\n  const numUseEquippedChar = useMemo(() => {\r\n    return database._getCharKeys().length - 1 - numAbove\r\n  }, [numAbove, database])\r\n  const numUnlisted = useMemo(() => {\r\n    return database._getCharKeys().length - equipmentPriority.length\r\n  }, [equipmentPriority, database])\r\n\r\n  return <Box display=\"flex\" gap={1}>\r\n    <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"sm\" }}><CardDark>\r\n      <CardContent>\r\n        <Grid container spacing={1}>\r\n          <Grid item flexGrow={1}>\r\n            <Typography variant=\"h6\"><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.title\">Character Priority for Equipped Artifacts</Trans></Typography>\r\n          </Grid>\r\n          <Grid item sx={{ mb: -1 }}>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>\r\n        </Grid>\r\n      </CardContent>\r\n      <Divider />\r\n      <CardContent>\r\n        <CardLight sx={{ mb: 1 }}>\r\n          <CardContent>\r\n            <Typography gutterBottom><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.desc1\">When generating a build, the Optimizer will only consider equipped artifacts from characters below the current character or those not on the list.</Trans></Typography>\r\n            <Typography gutterBottom><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.desc2\">If the current character is not on the list, the Optimizer will only consider equipped artifacts from others characters that are not on the list.</Trans></Typography>\r\n          </CardContent>\r\n        </CardLight>\r\n        <Box display=\"flex\" flexDirection=\"column\" gap={2}>\r\n          {equipmentPriority.map((ck, i) =>\r\n            <SelectItem key={ck} characterKey={ck} rank={i + 1} maxRank={equipmentPriority.length} setRank={(num) => num && setPrioRank(i, num - 1)} onRemove={() => removePrio(i)} numAbove={numAbove} />)}\r\n          <Box sx={{ display: \"flex\", gap: 1 }}>\r\n            <NewItem onAdd={addPrio} list={equipmentPriority} />\r\n            <Button color=\"error\" onClick={resetPrio} startIcon={<Replay />}><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.clearList\">Clear List</Trans></Button>\r\n          </Box>\r\n          {!!numUseEquippedChar && <SqBadge color=\"success\"><Typography><Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.usingNum\" count={numUnlisted}>Using artifacts from <strong>{{ count: numUnlisted }}</strong> unlisted characters</Trans></Typography></SqBadge>}\r\n        </Box>\r\n      </CardContent>\r\n    </CardDark ></ModalWrapper>\r\n    <ButtonGroup sx={{ display: \"flex\", width: \"100%\" }}>\r\n      <Button sx={{ flexGrow: 1 }} onClick={() => buildSettingDispatch({ useEquippedArts: !useEquippedArts })} disabled={disabled} startIcon={useEquippedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useEquippedArts ? \"success\" : \"secondary\"}>\r\n        <Box>\r\n          <span><Trans t={t} i18nKey=\"tabOptimize.useEquipped.title\">Use Equipped Artifacts</Trans></span>\r\n          {useEquippedArts && <SqBadge><Trans t={t} i18nKey=\"tabOptimize.useEquipped.usingNum\" count={numUseEquippedChar}>Using from <strong>{{ count: numUseEquippedChar }}</strong> characters</Trans></SqBadge>}\r\n        </Box>\r\n      </Button>\r\n      {useEquippedArts && <Button sx={{ flexShrink: 1 }} color=\"info\" onClick={onOpen} disabled={disabled}><Settings /></Button>}\r\n    </ButtonGroup>\r\n  </Box>\r\n}\r\n\r\nconst itemSize = 60\r\nfunction SelectItem({ characterKey, rank, maxRank, setRank, onRemove, numAbove }: {\r\n  characterKey: CharacterKey,\r\n  rank: number,\r\n  maxRank: number,\r\n  setRank: (r: number | undefined) => void,\r\n  onRemove: () => void,\r\n  numAbove: number,\r\n}) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { database } = useContext(DatabaseContext)\r\n  const character = useCharacter(characterKey)\r\n  const onClick = useCharSelectionCallback()\r\n  if (!character) return null\r\n  const { equippedWeapon, equippedArtifacts } = character\r\n  return <CardLight sx={{ p: 1 }}  >\r\n    <Box sx={{ pb: 1, display: \"flex\", justifyContent: \"space-between\", gap: 1 }}>\r\n      <SqBadge color=\"info\">\r\n        <Typography>#{rank}</Typography>\r\n      </SqBadge>\r\n      <SqBadge sx={{ flexGrow: 1 }} color={numAbove === (rank - 1) ? \"warning\" : (rank - 1) < numAbove ? \"error\" : \"success\"}>\r\n        <Typography>{numAbove === (rank - 1) ? <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.curr\">Current character</Trans>\r\n          : (rank - 1) < numAbove ? <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.dont\">Don't Use artifacts</Trans> :\r\n            <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.status.use\">Use artifacts</Trans>}</Typography>\r\n      </SqBadge>\r\n      <Box>\r\n        <ButtonGroup sx={{ flexGrow: 1 }} size=\"small\">\r\n          <CustomNumberInputButtonGroupWrapper >\r\n            <CustomNumberInput onChange={setRank} value={rank}\r\n              // startAdornment=\"Rank:\"\r\n              inputProps={{ min: 1, max: maxRank, sx: { textAlign: \"center\" } }}\r\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }} />\r\n          </CustomNumberInputButtonGroupWrapper>\r\n          <Button disabled={rank === 1} onClick={() => setRank(1)} >\r\n            <KeyboardDoubleArrowUp />\r\n          </Button>\r\n          <Button disabled={rank === 1} onClick={() => setRank(rank - 1)}  >\r\n            <KeyboardArrowUp />\r\n          </Button>\r\n          <Button disabled={rank === maxRank} onClick={() => setRank(rank + 1)}  >\r\n            <KeyboardArrowDown />\r\n          </Button>\r\n          <Button disabled={rank === maxRank} onClick={() => setRank(maxRank)}  >\r\n            <KeyboardDoubleArrowDown />\r\n          </Button>\r\n          <Button color=\"error\" onClick={onRemove}>\r\n            <Close />\r\n          </Button>\r\n        </ButtonGroup>\r\n      </Box>\r\n    </Box>\r\n    <Grid container columns={7} spacing={1}>\r\n      <Grid item xs={1} >\r\n        <CharacterCardPico characterKey={characterKey} onClick={onClick} />\r\n      </Grid>\r\n      <Grid item xs={1}><WeaponCardPico weaponId={equippedWeapon} /></Grid>\r\n      {Object.entries(equippedArtifacts).map(([slotKey, aId]) => <Grid item xs={1} key={slotKey} ><ArtifactCardPico slotKey={slotKey} artifactObj={database._getArt(aId)} /></Grid>)}\r\n    </Grid>\r\n\r\n  </CardLight>\r\n}\r\nfunction NewItem({ onAdd, list }: { onAdd: (ck: CharacterKey) => void, list: CharacterKey[] }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const [show, onOpen, onClose] = useBoolState(false)\r\n  const filter = useCallback((char?: ICachedCharacter) => {\r\n    if (!char) return false\r\n    return !list.includes(char.key)\r\n  }, [list])\r\n  return <>\r\n    <CharacterSelectionModal show={show} onHide={onClose} onSelect={onAdd} filter={filter} />\r\n    <Button fullWidth sx={{ height: itemSize }} color=\"info\" onClick={onOpen} startIcon={<Add />} >\r\n      <Trans t={t} i18nKey=\"tabOptimize.useEquipped.modal.add\">Add character to list</Trans>\r\n    </Button>\r\n  </>\r\n}\r\n","import { CheckBox, CheckBoxOutlineBlank } from \"@mui/icons-material\";\r\nimport { Box, Button } from \"@mui/material\";\r\nimport { useContext, useMemo } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport SqBadge from \"../../../../../Components/SqBadge\";\r\nimport { DatabaseContext } from \"../../../../../Database/Database\";\r\nimport { DataContext } from \"../../../../../DataContext\";\r\nimport useBuildSetting from \"../BuildSetting\";\r\n\r\nexport default function UseExcluded({ disabled = false, artsDirty }: { disabled?: boolean, artsDirty: object }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: { key: characterKey } } = useContext(DataContext)\r\n  const { buildSetting: { useExcludedArts }, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const { database } = useContext(DatabaseContext)\r\n  const numExcludedArt = useMemo(() => artsDirty && database._getArts().reduce((a, art) => a + (art.exclude ? 1 : 0), 0), [database, artsDirty])\r\n  return <Button fullWidth onClick={() => buildSettingDispatch({ useExcludedArts: !useExcludedArts })} disabled={!numExcludedArt || disabled} startIcon={useExcludedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useExcludedArts ? \"success\" : \"secondary\"}>\r\n    <Box>\r\n      <span><Trans t={t} i18nKey=\"tabOptimize.useExcluded.title\" count={numExcludedArt}>Use Excluded Artifacts</Trans></span>\r\n      {useExcludedArts && <SqBadge><Trans t={t} i18nKey=\"tabOptimize.useExcluded.usingNum\" count={numExcludedArt}>Using <strong>{{ count: numExcludedArt }}</strong> excluded artifacts</Trans></SqBadge>}\r\n    </Box>\r\n  </Button>\r\n}\r\n","import Artifact from \"../../../../Data/Artifacts/Artifact\";\r\nimport { input } from \"../../../../Formula\";\r\nimport { computeUIData } from \"../../../../Formula/api\";\r\nimport { formulaString } from \"../../../../Formula/debug\";\r\nimport { Data, NumNode } from \"../../../../Formula/type\";\r\nimport { constant, setReadNodeKeys } from \"../../../../Formula/utils\";\r\nimport { allMainStatKeys, allSubstatKeys, ICachedArtifact } from \"../../../../Types/artifact\";\r\nimport { deepClone, objectKeyMap, objectMap } from \"../../../../Util/Util\";\r\nimport type { ArtifactBuildData, ArtifactsBySlot, DynStat } from \"./common\";\r\n\r\nconst dynamic = setReadNodeKeys(deepClone({ dyn: { ...input.art, ...input.artSet } }))\r\nexport const dynamicData = {\r\n  art: objectKeyMap([...allMainStatKeys, ...allSubstatKeys], key => dynamic.dyn[key]),\r\n  artSet: objectMap(input.artSet, (_, key) => dynamic.dyn[key]),\r\n}\r\n\r\nexport function compactArtifacts(arts: ICachedArtifact[], mainStatAssumptionLevel: number, allowPartial: boolean): ArtifactsBySlot {\r\n  const result: ArtifactsBySlot = {\r\n    base: {},\r\n    values: { flower: [], plume: [], goblet: [], circlet: [], sands: [] }\r\n  }\r\n  const keys = new Set<string>()\r\n\r\n  for (const art of arts) {\r\n    const mainStatVal = Artifact.mainStatValue(art.mainStatKey, art.rarity, Math.max(Math.min(mainStatAssumptionLevel, art.rarity * 4), art.level))\r\n\r\n    const data: ArtifactBuildData = {\r\n      id: art.id, set: art.setKey,\r\n      values: {\r\n        [art.setKey]: 1,\r\n        [art.mainStatKey]: art.mainStatKey.endsWith('_') ? mainStatVal / 100 : mainStatVal,\r\n        ...Object.fromEntries(art.substats.map(substat =>\r\n          [substat.key, substat.key.endsWith('_') ? substat.accurateValue / 100 : substat.accurateValue]))\r\n      },\r\n    }\r\n    delete data.values[\"\"]\r\n    result.values[art.slotKey].push(data)\r\n    Object.keys(data.values).forEach(x => keys.add(x))\r\n  }\r\n  result.base = objectKeyMap([...keys], _ => 0)\r\n  if (allowPartial)\r\n    for (const value of Object.values(result.values))\r\n      value.push({ id: \"\", values: {} })\r\n  return result\r\n}\r\n\r\nexport function debugCompute(nodes: NumNode[], base: DynStat, arts: ArtifactBuildData[]) {\r\n  const stats = { ...base }\r\n  for (const art of arts) {\r\n    for (const [key, value] of Object.entries(art.values)) {\r\n      stats[key] = (stats[key] ?? 0) + value\r\n    }\r\n  }\r\n  const data = { dyn: Object.fromEntries(Object.entries(stats).map(([key, value]) => [key, constant(value)])) } as Data\r\n  const uiData = computeUIData([data])\r\n  return {\r\n    base, arts, stats,\r\n    data, uiData,\r\n    nodes: nodes.map(formulaString),\r\n    results: nodes.map(node => uiData.get(node)),\r\n  }\r\n}\r\n","import { faCalculator } from '@fortawesome/free-solid-svg-icons';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { CheckBox, CheckBoxOutlineBlank, Close } from '@mui/icons-material';\r\nimport { Alert, Box, Button, ButtonGroup, CardContent, Divider, Grid, Link, MenuItem, Skeleton, ToggleButton, Typography } from '@mui/material';\r\nimport React, { Suspense, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\n// eslint-disable-next-line\r\nimport Worker from \"worker-loader!./BackgroundWorker\";\r\nimport ArtifactLevelSlider from '../../../../Components/Artifact/ArtifactLevelSlider';\r\nimport BootstrapTooltip from '../../../../Components/BootstrapTooltip';\r\nimport CardLight from '../../../../Components/Card/CardLight';\r\nimport CharacterCard from '../../../../Components/Character/CharacterCard';\r\nimport DropdownButton from '../../../../Components/DropdownMenu/DropdownButton';\r\nimport { HitModeToggle, ReactionToggle } from '../../../../Components/HitModeEditor';\r\nimport SolidToggleButtonGroup from '../../../../Components/SolidToggleButtonGroup';\r\nimport StatFilterCard from '../../../../Components/StatFilterCard';\r\nimport CharacterSheet from '../../../../Data/Characters/CharacterSheet';\r\nimport { DatabaseContext } from '../../../../Database/Database';\r\nimport { DataContext, dataContextObj } from '../../../../DataContext';\r\nimport { mergeData, uiDataForTeam } from '../../../../Formula/api';\r\nimport { uiInput as input } from '../../../../Formula/index';\r\nimport { optimize } from '../../../../Formula/optimization';\r\nimport { NumNode } from '../../../../Formula/type';\r\nimport { UIData } from '../../../../Formula/uiData';\r\nimport { initGlobalSettings } from '../../../../GlobalSettings';\r\nimport KeyMap from '../../../../KeyMap';\r\nimport useCharacterReducer, { characterReducerAction } from '../../../../ReactHooks/useCharacterReducer';\r\nimport useCharSelectionCallback from '../../../../ReactHooks/useCharSelectionCallback';\r\nimport useDBState from '../../../../ReactHooks/useDBState';\r\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate';\r\nimport useTeamData, { getTeamData } from '../../../../ReactHooks/useTeamData';\r\nimport { ICachedArtifact } from '../../../../Types/artifact';\r\nimport { ICachedCharacter } from '../../../../Types/character';\r\nimport { CharacterKey } from '../../../../Types/consts';\r\nimport { objPathValue, range } from '../../../../Util/Util';\r\nimport { FinalizeResult, Setup, WorkerCommand, WorkerResult } from './BackgroundWorker';\r\nimport { maxBuildsToShowList } from './Build';\r\nimport useBuildSetting from './BuildSetting';\r\nimport { artSetPerm, Build, filterFeasiblePerm, mergeBuilds, mergePlot, pruneAll, RequestFilter } from './common';\r\nimport ArtifactSetConfig from './Components/ArtifactSetConfig';\r\nimport AssumeFullLevelToggle from './Components/AssumeFullLevelToggle';\r\nimport BonusStatsCard from './Components/BonusStatsCard';\r\nimport BuildAlert, { BuildStatus } from './Components/BuildAlert';\r\nimport BuildDisplayItem from './Components/BuildDisplayItem';\r\nimport ChartCard, { ChartData } from './Components/ChartCard';\r\nimport MainStatSelectionCard from './Components/MainStatSelectionCard';\r\nimport OptimizationTargetSelector from './Components/OptimizationTargetSelector';\r\nimport UseEquipped from './Components/UseEquipped';\r\nimport UseExcluded from './Components/UseExcluded';\r\nimport { defThreads, useOptimizeDBState } from './DBState';\r\nimport { compactArtifacts, dynamicData } from './foreground';\r\n\r\nexport default function TabBuild() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character, character: { key: characterKey } } = useContext(DataContext)\r\n  const [{ tcMode }] = useDBState(\"GlobalSettings\", initGlobalSettings)\r\n  const { database } = useContext(DatabaseContext)\r\n\r\n  const [buildStatus, setBuildStatus] = useState({ type: \"inactive\", tested: 0, failed: 0, skipped: 0, total: 0 } as BuildStatus)\r\n  const generatingBuilds = buildStatus.type !== \"inactive\"\r\n\r\n  const [chartData, setchartData] = useState(undefined as ChartData | undefined)\r\n\r\n  const [artsDirty, setArtsDirty] = useForceUpdate()\r\n\r\n  const [{ equipmentPriority, threads = defThreads }, setOptimizeDBState] = useOptimizeDBState()\r\n  const maxWorkers = threads > defThreads ? defThreads : threads\r\n  const setMaxWorkers = useCallback(threads => setOptimizeDBState({ threads }), [setOptimizeDBState],)\r\n\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const onClickTeammate = useCharSelectionCallback()\r\n  const compareData = character?.compareData ?? false\r\n\r\n  const noArtifact = useMemo(() => !database._getArts().length, [database])\r\n\r\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\r\n  const { plotBase, optimizationTarget, mainStatAssumptionLevel, allowPartial, builds, buildDate, maxBuildsToShow, levelLow, levelHigh } = buildSetting\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\r\n  const { characterSheet, target: data } = teamData?.[characterKey as CharacterKey] ?? {}\r\n  const buildsArts = useMemo(() => builds.map(build => build.map(i => database._getArt(i)!)), [builds, database])\r\n\r\n  //register changes in artifact database\r\n  useEffect(() =>\r\n    database.followAnyArt(setArtsDirty),\r\n    [setArtsDirty, database])\r\n\r\n  // Provides a function to cancel the work\r\n  const cancelToken = useRef(() => { })\r\n  //terminate worker when component unmounts\r\n  useEffect(() => () => cancelToken.current(), [])\r\n  const generateBuilds = useCallback(async () => {\r\n    const { artSetExclusion, plotBase, statFilters, mainStatKeys, optimizationTarget, mainStatAssumptionLevel, useExcludedArts, useEquippedArts, allowPartial, maxBuildsToShow, levelLow, levelHigh } = buildSetting\r\n    if (!characterKey || !optimizationTarget) return\r\n\r\n    let cantTakeList: CharacterKey[] = []\r\n    if (useEquippedArts) {\r\n      const index = equipmentPriority.indexOf(characterKey)\r\n      if (index < 0) cantTakeList = [...equipmentPriority]\r\n      else cantTakeList = equipmentPriority.slice(0, index)\r\n    }\r\n    const filteredArts = database._getArts().filter(art => {\r\n      if (art.level < levelLow) return false\r\n      if (art.level > levelHigh) return false\r\n      const mainStats = mainStatKeys[art.slotKey]\r\n      if (mainStats?.length && !mainStats.includes(art.mainStatKey)) return false\r\n\r\n      // If its equipped on the selected character, bypass the check\r\n      if (art.location === characterKey) return true\r\n\r\n      if (art.exclude && !useExcludedArts) return false\r\n      if (art.location && !useEquippedArts) return false\r\n      if (art.location && useEquippedArts && cantTakeList.includes(art.location)) return false\r\n      return true\r\n    })\r\n    const split = compactArtifacts(filteredArts, mainStatAssumptionLevel, allowPartial)\r\n\r\n    const teamData = await getTeamData(database, characterKey, mainStatAssumptionLevel, [])\r\n    if (!teamData) return\r\n    const workerData = uiDataForTeam(teamData.teamData, characterKey)[characterKey as CharacterKey]?.target.data![0]\r\n    if (!workerData) return\r\n    Object.assign(workerData, mergeData([workerData, dynamicData])) // Mark art fields as dynamic\r\n    let optimizationTargetNode = objPathValue(workerData.display ?? {}, optimizationTarget) as NumNode | undefined\r\n    if (!optimizationTargetNode) return\r\n    const targetNode = optimizationTargetNode\r\n    const valueFilter: { value: NumNode, minimum: number }[] = Object.entries(statFilters).map(([key, value]) => {\r\n      if (key.endsWith(\"_\")) value = value / 100 // TODO: Conversion\r\n      return { value: input.total[key], minimum: value }\r\n    }).filter(x => x.value && x.minimum > -Infinity)\r\n\r\n    setchartData(undefined)\r\n\r\n    const cancelled = new Promise<void>(r => cancelToken.current = r)\r\n\r\n    let nodes = [...valueFilter.map(x => x.value), optimizationTargetNode], arts = split!\r\n    const setPerms = filterFeasiblePerm(artSetPerm(artSetExclusion, Object.values(split.values).flatMap(x => x.map(x => x.set!))), split)\r\n\r\n    const minimum = [...valueFilter.map(x => x.minimum), -Infinity]\r\n    const status: Omit<BuildStatus, \"type\"> = { tested: 0, failed: 0, skipped: 0, total: NaN, startTime: performance.now() }\r\n    if (plotBase) {\r\n      nodes.push(input.total[plotBase])\r\n      minimum.push(-Infinity)\r\n    }\r\n\r\n    const prepruneArts = arts\r\n    nodes = optimize(nodes, workerData, ({ path: [p] }) => p !== \"dyn\");\r\n    ({ nodes, arts } = pruneAll(nodes, minimum, arts, maxBuildsToShow, artSetExclusion, {\r\n      reaffine: true, pruneArtRange: true, pruneNodeRange: true, pruneOrder: true\r\n    }))\r\n\r\n    const plotBaseNode = plotBase ? nodes.pop() : undefined\r\n    optimizationTargetNode = nodes.pop()!\r\n\r\n    const wrap = {\r\n      buildValues: Array(maxBuildsToShow).fill(0).map(_ => -Infinity),\r\n      finalizing: false\r\n    }\r\n\r\n    const minFilterCount = maxWorkers === 1 ? Infinity : 8_000_000 // Don't split for single worker\r\n    const maxRequestFilterInFlight = maxWorkers * 4\r\n    const unprunedFilters = setPerms[Symbol.iterator](), requestFilters: RequestFilter[] = []\r\n    const idleWorkers: { id: number, worker: Worker }[] = []\r\n    const pruningID = new Set<number>()\r\n\r\n    function fetchContinueWork(): WorkerCommand {\r\n      return { command: \"split\", filter: undefined, minCount: minFilterCount, threshold: wrap.buildValues[maxBuildsToShow - 1] }\r\n    }\r\n    function fetchPruningWork(): WorkerCommand | undefined {\r\n      const { done, value } = unprunedFilters.next()\r\n      return done ? undefined : {\r\n        command: \"split\", minCount: minFilterCount,\r\n        threshold: wrap.buildValues[maxBuildsToShow - 1], filter: value,\r\n      }\r\n    }\r\n    function fetchRequestWork(): WorkerCommand | undefined {\r\n      const filter = requestFilters.pop()\r\n      return !filter ? undefined : {\r\n        command: \"iterate\",\r\n        threshold: wrap.buildValues[maxBuildsToShow - 1], filter\r\n      }\r\n    }\r\n\r\n    const filters = nodes\r\n      .map((value, i) => ({ value, min: minimum[i] }))\r\n      .filter(x => x.min > -Infinity)\r\n\r\n    const finalizedList: Promise<FinalizeResult>[] = []\r\n    for (let i = 0; i < maxWorkers; i++) {\r\n      const worker = new Worker()\r\n\r\n      const setup: Setup = {\r\n        command: \"setup\",\r\n        id: i, arts,\r\n        optimizationTarget: optimizationTargetNode,\r\n        plotBase: plotBaseNode,\r\n        maxBuilds: maxBuildsToShow,\r\n        filters\r\n      }\r\n      worker.postMessage(setup, undefined)\r\n      if (i === 0) {\r\n        const countCommand: WorkerCommand = { command: \"count\", exclusion: artSetExclusion, arts: [arts, prepruneArts] }\r\n        worker.postMessage(countCommand, undefined)\r\n      }\r\n      let finalize: (_: FinalizeResult) => void\r\n      const finalized = new Promise<FinalizeResult>(r => finalize = r)\r\n      worker.onmessage = async ({ data }: { data: { id: number } & WorkerResult }) => {\r\n        switch (data.command) {\r\n          case \"count\":\r\n            const [pruned, prepruned] = data.counts\r\n            status.total = prepruned\r\n            status.skipped += prepruned - pruned\r\n            return\r\n          case \"interim\":\r\n            status.tested += data.tested\r\n            status.failed += data.failed\r\n            status.skipped += data.skipped\r\n            if (data.buildValues) {\r\n              wrap.buildValues.push(...data.buildValues)\r\n              wrap.buildValues.sort((a, b) => b - a).splice(maxBuildsToShow)\r\n            }\r\n            break\r\n          case \"split\":\r\n            if (data.filter) {\r\n              requestFilters.push(data.filter)\r\n              pruningID.add(data.id)\r\n            } else pruningID.delete(data.id)\r\n            idleWorkers.push({ id: data.id, worker })\r\n            break\r\n          case \"iterate\":\r\n            idleWorkers.push({ id: data.id, worker })\r\n            break\r\n          case \"finalize\":\r\n            worker.terminate()\r\n            finalize(data);\r\n            break\r\n          default: console.log(\"DEBUG\", data)\r\n        }\r\n        while (idleWorkers.length) {\r\n          const { id, worker } = idleWorkers.pop()!\r\n          let work: WorkerCommand | undefined\r\n          if (wrap.finalizing) work = { command: \"finalize\" }\r\n          else if (requestFilters.length >= maxRequestFilterInFlight) work = fetchRequestWork()\r\n          else if (pruningID.has(id)) work = fetchContinueWork()\r\n          else if (!(id % 2)) work = fetchPruningWork()\r\n          if (!work) work = fetchRequestWork()\r\n\r\n          if (work) worker.postMessage(work)\r\n          else {\r\n            idleWorkers.push({ id, worker })\r\n            if (idleWorkers.length === maxWorkers) {\r\n              wrap.finalizing = true\r\n              continue\r\n            }\r\n            break\r\n          }\r\n        }\r\n      }\r\n\r\n      cancelled.then(() => worker.terminate())\r\n      finalizedList.push(finalized)\r\n    }\r\n\r\n    const buildTimer = setInterval(() => setBuildStatus({ type: \"active\", ...status }), 100)\r\n    const results = await Promise.any([Promise.all(finalizedList), cancelled])\r\n    clearInterval(buildTimer)\r\n    cancelToken.current = () => { }\r\n\r\n    if (!results) {\r\n      status.tested = 0\r\n      status.failed = 0\r\n      status.skipped = 0\r\n      status.total = 0\r\n    } else {\r\n      if (plotBase) {\r\n        const plotData = mergePlot(results.map(x => x.plotData!))\r\n        const plotBaseNode = input.total[plotBase] as NumNode\r\n        let data = Object.values(plotData)\r\n        if (KeyMap.unit(targetNode.info?.key) === \"%\")\r\n          data = data.map(({ value, plot }) => ({ value: value * 100, plot })) as Build[]\r\n        if (KeyMap.unit(plotBaseNode!.info?.key) === \"%\")\r\n          data = data.map(({ value, plot }) => ({ value, plot: (plot ?? 0) * 100 })) as Build[]\r\n        setchartData({\r\n          valueNode: targetNode,\r\n          plotNode: plotBaseNode,\r\n          data\r\n        })\r\n      }\r\n      const builds = mergeBuilds(results.map(x => x.builds), maxBuildsToShow)\r\n      if (process.env.NODE_ENV === \"development\") console.log(\"Build Result\", builds)\r\n      buildSettingDispatch({ builds: builds.map(build => build.artifactIds), buildDate: Date.now() })\r\n    }\r\n    setBuildStatus({ ...status, type: \"inactive\", finishTime: performance.now() })\r\n  }, [characterKey, database, buildSettingDispatch, maxWorkers, buildSetting, equipmentPriority])\r\n\r\n  const characterName = characterSheet?.name ?? \"Character Name\"\r\n\r\n  const setPlotBase = useCallback(plotBase => {\r\n    buildSettingDispatch({ plotBase })\r\n    setchartData(undefined)\r\n  }, [buildSettingDispatch])\r\n  const dataContext: dataContextObj | undefined = useMemo(() => {\r\n    return data && characterSheet && character && teamData && {\r\n      data,\r\n      characterSheet,\r\n      character,\r\n      mainStatAssumptionLevel,\r\n      teamData,\r\n      characterDispatch\r\n    }\r\n  }, [data, characterSheet, character, teamData, characterDispatch, mainStatAssumptionLevel])\r\n\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    {noArtifact && <Alert severity=\"warning\" variant=\"filled\"> Opps! It looks like you haven't added any artifacts to GO yet! You should go to the <Link component={RouterLink} to=\"/artifact\">Artifacts</Link> page and add some!</Alert>}\r\n    {/* Build Generator Editor */}\r\n    {dataContext && <DataContext.Provider value={dataContext}>\r\n\r\n      <Grid container spacing={1} >\r\n        {/* 1*/}\r\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          {/* character card */}\r\n          <Box><CharacterCard characterKey={characterKey} onClickTeammate={onClickTeammate} /></Box>\r\n        </Grid>\r\n\r\n        {/* 2 */}\r\n        <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          <CardLight>\r\n            <CardContent  >\r\n              <Typography gutterBottom>Main Stat</Typography>\r\n              <BootstrapTooltip placement=\"top\" title={<Typography><strong>Level Assumption</strong> changes mainstat value to be at least a specific level. Does not change substats.</Typography>}>\r\n                <Box>\r\n                  <AssumeFullLevelToggle mainStatAssumptionLevel={mainStatAssumptionLevel} setmainStatAssumptionLevel={mainStatAssumptionLevel => buildSettingDispatch({ mainStatAssumptionLevel })} disabled={generatingBuilds} />\r\n                </Box>\r\n              </BootstrapTooltip>\r\n            </CardContent>\r\n            {/* main stat selector */}\r\n            <MainStatSelectionCard disabled={generatingBuilds} />\r\n          </CardLight>\r\n          <BonusStatsCard />\r\n        </Grid>\r\n\r\n        {/* 3 */}\r\n        <Grid item xs={12} sm={6} lg={6} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n          <ArtifactSetConfig disabled={generatingBuilds} />\r\n\r\n          {/* use excluded */}\r\n          <UseExcluded disabled={generatingBuilds} artsDirty={artsDirty} />\r\n\r\n          {/* use equipped */}\r\n          <UseEquipped disabled={generatingBuilds} />\r\n\r\n          <Button fullWidth startIcon={allowPartial ? <CheckBox /> : <CheckBoxOutlineBlank />} color={allowPartial ? \"success\" : \"secondary\"} onClick={() => buildSettingDispatch({ allowPartial: !allowPartial })}>{t`tabOptimize.allowPartial`}</Button>\r\n          { /* Level Filter */}\r\n          <CardLight>\r\n            <CardContent sx={{ py: 1 }}>\r\n              Artifact Level Filter\r\n            </CardContent>\r\n            <ArtifactLevelSlider levelLow={levelLow} levelHigh={levelHigh}\r\n              setLow={levelLow => buildSettingDispatch({ levelLow })}\r\n              setHigh={levelHigh => buildSettingDispatch({ levelHigh })}\r\n              setBoth={(levelLow, levelHigh) => buildSettingDispatch({ levelLow, levelHigh })}\r\n              disabled={generatingBuilds}\r\n            />\r\n          </CardLight>\r\n\r\n          {/*Minimum Final Stat Filter */}\r\n          <StatFilterCard disabled={generatingBuilds} />\r\n\r\n        </Grid>\r\n      </Grid>\r\n      {/* Footer */}\r\n      <Grid container spacing={1}>\r\n        <Grid item flexGrow={1} >\r\n          <ButtonGroup>\r\n            <Button\r\n              disabled={!characterKey || generatingBuilds || !optimizationTarget || !objPathValue(data?.getDisplay(), optimizationTarget)}\r\n              color={characterKey ? \"success\" : \"warning\"}\r\n              onClick={generateBuilds}\r\n              startIcon={<FontAwesomeIcon icon={faCalculator} />}\r\n            >Generate Builds</Button>\r\n            <DropdownButton disabled={generatingBuilds || !characterKey}\r\n              title={<span><b>{maxBuildsToShow}</b> {maxBuildsToShow === 1 ? \"Build\" : \"Builds\"}</span>}>\r\n              <MenuItem>\r\n                <Typography variant=\"caption\" color=\"info.main\">\r\n                  Decreasing the number of generated build will decrease build calculation time for large number of builds.\r\n                </Typography>\r\n              </MenuItem>\r\n              <Divider />\r\n              {maxBuildsToShowList.map(v => <MenuItem key={v}\r\n                onClick={() => buildSettingDispatch({ maxBuildsToShow: v })}>{v} {v === 1 ? \"Build\" : \"Builds\"}</MenuItem>)}\r\n            </DropdownButton>\r\n            <DropdownButton disabled={generatingBuilds || !characterKey}\r\n              title={<span><b>{maxWorkers}</b> {maxWorkers === 1 ? \"Thread\" : \"Threads\"}</span>}>\r\n              <MenuItem>\r\n                <Typography variant=\"caption\" color=\"info.main\">\r\n                  Increasing the number of threads will speed up build time, but will use more CPU power.\r\n                </Typography>\r\n              </MenuItem>\r\n              <Divider />\r\n              {range(1, defThreads).reverse().map(v => <MenuItem key={v}\r\n                onClick={() => setMaxWorkers(v)}>{v} {v === 1 ? \"Thread\" : \"Threads\"}</MenuItem>)}\r\n            </DropdownButton>\r\n            <Button\r\n              disabled={!generatingBuilds}\r\n              color=\"error\"\r\n              onClick={() => cancelToken.current()}\r\n              startIcon={<Close />}\r\n            >Cancel</Button>\r\n          </ButtonGroup>\r\n        </Grid>\r\n        <Grid item>\r\n          <span>Optimization Target: </span>\r\n          {<OptimizationTargetSelector\r\n            optimizationTarget={optimizationTarget}\r\n            setTarget={target => buildSettingDispatch({ optimizationTarget: target })}\r\n            disabled={!!generatingBuilds}\r\n          />}\r\n        </Grid>\r\n      </Grid>\r\n\r\n      {!!characterKey && <BuildAlert {...{ status: buildStatus, characterName, maxBuildsToShow }} />}\r\n      {tcMode && <Box >\r\n        <ChartCard disabled={generatingBuilds} chartData={chartData} plotBase={plotBase} setPlotBase={setPlotBase} />\r\n      </Box>}\r\n      <CardLight>\r\n        <CardContent>\r\n          <Box display=\"flex\" alignItems=\"center\" gap={1} mb={1} >\r\n            <Typography sx={{ flexGrow: 1 }}>\r\n              {builds ? <span>Showing <strong>{builds.length}</strong> Builds generated for {characterName}. {!!buildDate && <span>Build generated on: <strong>{(new Date(buildDate)).toLocaleString()}</strong></span>}</span>\r\n                : <span>Select a character to generate builds.</span>}\r\n            </Typography>\r\n            <Button disabled={!builds.length} color=\"error\" onClick={() => buildSettingDispatch({ builds: [], buildDate: 0 })} >Clear Builds</Button>\r\n          </Box>\r\n          <Grid container display=\"flex\" spacing={1}>\r\n            <Grid item><HitModeToggle size=\"small\" /></Grid>\r\n            <Grid item><ReactionToggle size=\"small\" /></Grid>\r\n            <Grid item flexGrow={1} />\r\n            <Grid item><SolidToggleButtonGroup exclusive value={compareData} onChange={(e, v) => characterDispatch({ compareData: v })} size=\"small\">\r\n              <ToggleButton value={false} disabled={!compareData}>\r\n                <small>Show New artifact Stats</small>\r\n              </ToggleButton>\r\n              <ToggleButton value={true} disabled={compareData}>\r\n                <small>Compare against equipped artifacts</small>\r\n              </ToggleButton>\r\n            </SolidToggleButtonGroup></Grid>\r\n          </Grid>\r\n        </CardContent>\r\n      </CardLight>\r\n      <BuildList {...{ buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled: !!generatingBuilds }} />\r\n    </DataContext.Provider>}\r\n  </Box>\r\n}\r\nfunction BuildList({ buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled }: {\r\n  buildsArts: ICachedArtifact[][],\r\n  character?: ICachedCharacter,\r\n  characterKey?: \"\" | CharacterKey,\r\n  characterSheet?: CharacterSheet,\r\n  data?: UIData,\r\n  compareData: boolean,\r\n  mainStatAssumptionLevel: number,\r\n  characterDispatch: (action: characterReducerAction) => void\r\n  disabled: boolean,\r\n}) {\r\n  // Memoize the build list because calculating/rendering the build list is actually very expensive, which will cause longer optimization times.\r\n  const list = useMemo(() => <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\r\n    {buildsArts?.map((build, index) => character && characterKey && characterSheet && data && <DataContextWrapper\r\n      key={index + build.join()}\r\n      characterKey={characterKey}\r\n      character={character}\r\n      build={build}\r\n      characterSheet={characterSheet}\r\n      oldData={data}\r\n      mainStatAssumptionLevel={mainStatAssumptionLevel}\r\n      characterDispatch={characterDispatch} >\r\n      <BuildDisplayItem index={index} compareBuild={compareData} disabled={disabled} />\r\n    </DataContextWrapper>\r\n    )}\r\n  </Suspense>, [buildsArts, character, characterKey, characterSheet, data, compareData, mainStatAssumptionLevel, characterDispatch, disabled])\r\n  return list\r\n}\r\n\r\ntype Prop = {\r\n  children: React.ReactNode\r\n  characterKey: CharacterKey,\r\n  character: ICachedCharacter,\r\n  build: ICachedArtifact[],\r\n  mainStatAssumptionLevel?: number, characterSheet: CharacterSheet, oldData: UIData,\r\n  characterDispatch: (action: characterReducerAction) => void\r\n}\r\nfunction DataContextWrapper({ children, characterKey, character, build, characterDispatch, mainStatAssumptionLevel = 0, characterSheet, oldData }: Prop) {\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build)\r\n  if (!teamData) return null\r\n  return <DataContext.Provider value={{ characterSheet, character, characterDispatch, mainStatAssumptionLevel, data: teamData[characterKey]!.target, teamData, oldData }}>\r\n    {children}\r\n  </DataContext.Provider>\r\n}\r\n","import { faEdit, faSave } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { Favorite, FavoriteBorder } from \"@mui/icons-material\";\r\nimport { Badge, Box, Button, CardActionArea, CardContent, Divider, Grid, IconButton, Typography } from \"@mui/material\";\r\nimport React, { useContext, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Assets from \"../../../Assets/Assets\";\r\nimport ArtifactCardNano from \"../../../Components/Artifact/ArtifactCardNano\";\r\nimport CardLight from \"../../../Components/Card/CardLight\";\r\nimport ColorText from \"../../../Components/ColoredText\";\r\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\r\nimport ImgIcon from \"../../../Components/Image/ImgIcon\";\r\nimport { Stars } from \"../../../Components/StarDisplay\";\r\nimport StatIcon from \"../../../Components/StatIcon\";\r\nimport WeaponCardNano from \"../../../Components/Weapon/WeaponCardNano\";\r\nimport CharacterSheet from \"../../../Data/Characters/CharacterSheet\";\r\nimport { DataContext } from \"../../../DataContext\";\r\nimport { uiInput as input } from \"../../../Formula\";\r\nimport { ReadNode } from \"../../../Formula/type\";\r\nimport KeyMap, { valueString } from \"../../../KeyMap\";\r\nimport { amplifyingReactions, transformativeReactions } from \"../../../KeyMap/StatConstants\";\r\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\r\nimport { TalentSheetElementKey } from \"../../../Types/character\";\r\nimport { allElementsWithPhy, allSlotKeys, ElementKey } from \"../../../Types/consts\";\r\nimport { range } from \"../../../Util/Util\";\r\nimport CharacterCardPico from \"../../../Components/Character/CharacterCardPico\";\r\nimport StatInput from \"../../../Components/StatInput\";\r\n\r\nexport default function TabOverview() {\r\n  const { data, characterSheet, character, character: { key: characterKey } } = useContext(DataContext)\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const navigate = useNavigate()\r\n  const { t } = useTranslation(\"page_character\")\r\n  const charEle = data.get(input.charEle).value as ElementKey\r\n  const weaponTypeKey = characterSheet.weaponTypeKey\r\n  const level = data.get(input.lvl).value\r\n  const ascension = data.get(input.asc).value\r\n  const constellation = data.get(input.constellation).value\r\n  const tlvl = {\r\n    auto: data.get(input.total.auto).value,\r\n    skill: data.get(input.total.skill).value,\r\n    burst: data.get(input.total.burst).value,\r\n  }\r\n  const tBoost = {\r\n    auto: data.get(input.bonus.auto).value,\r\n    skill: data.get(input.bonus.skill).value,\r\n    burst: data.get(input.bonus.burst).value,\r\n  }\r\n  return <Grid container spacing={1} sx={{ justifyContent: \"center\" }}>\r\n    <Grid item xs={8} sm={5} md={4} lg={2.5}  >\r\n      {/* Image card with star and name and level */}\r\n      <CardLight >\r\n        <Box src={characterSheet.cardImg} component=\"img\" width=\"100%\" height=\"auto\" />\r\n        <CardContent>\r\n          <Typography variant=\"h5\" >\r\n            {characterSheet.name}&nbsp;\r\n            <ImgIcon sx={{ pr: 0.5 }} src={Assets.weaponTypes?.[weaponTypeKey]} />\r\n            {StatIcon[charEle]}\r\n            <IconButton sx={{ p: 0.5, mt: -0.5 }} onClick={() => characterDispatch({ favorite: !character.favorite })}>\r\n              {character.favorite ? <Favorite /> : <FavoriteBorder />}\r\n            </IconButton>\r\n          </Typography>\r\n          <Typography variant=\"h6\"><Stars stars={characterSheet.rarity} colored /></Typography>\r\n          <Typography variant=\"h5\">Lvl. {CharacterSheet.getLevelString(level, ascension)}</Typography>\r\n          <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"talent\")}>\r\n            <Grid container spacing={1} mt={-1}>\r\n              {([\"auto\", \"skill\", \"burst\"] as TalentSheetElementKey[]).map(tKey =>\r\n                <Grid item xs={4} key={tKey}>\r\n                  <Badge badgeContent={tlvl[tKey]} color={tBoost[tKey] ? \"info\" : \"secondary\"}\r\n                    overlap=\"circular\"\r\n                    anchorOrigin={{\r\n                      vertical: 'bottom',\r\n                      horizontal: 'right',\r\n                    }}\r\n                    sx={{\r\n                      width: \"100%\",\r\n                      height: \"100%\",\r\n                      \"& > .MuiBadge-badge\": {\r\n                        fontSize: \"1.25em\",\r\n                        padding: \".25em .4em\",\r\n                        borderRadius: \".5em\",\r\n                        lineHeight: 1,\r\n                        height: \"1.25em\"\r\n                      }\r\n                    }}>\r\n                    <Box component=\"img\" src={characterSheet.getTalentOfKey(tKey, charEle)?.img} width=\"100%\" height=\"auto\" />\r\n                  </Badge>\r\n                </Grid>)}\r\n            </Grid>\r\n          </CardActionArea>\r\n          <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{characterSheet.constellationName}</Typography>\r\n          <Grid container spacing={1}>\r\n            {range(1, 6).map(i =>\r\n              <Grid item xs={4} key={i}>\r\n                <CardActionArea onClick={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}>\r\n                  <Box component=\"img\" src={characterSheet.getTalentOfKey(`constellation${i}` as TalentSheetElementKey, charEle)?.img}\r\n                    sx={{\r\n                      ...(constellation >= i ? {} : { filter: \"brightness(50%)\" })\r\n                    }}\r\n                    width=\"100%\" height=\"auto\" />\r\n                </CardActionArea>\r\n              </Grid>)}\r\n          </Grid>\r\n          <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{t(\"teammates\")}</Typography>\r\n          <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"teambuffs\")}>\r\n            <Grid container columns={3} spacing={1}>\r\n              {range(0, 2).map(i => <Grid key={i} item xs={1} height=\"100%\"><CharacterCardPico characterKey={character.team[i]} index={i} /></Grid>)}\r\n            </Grid>\r\n          </CardActionArea>\r\n        </CardContent>\r\n      </CardLight>\r\n    </Grid>\r\n    <Grid item xs={12} sm={7} md={8} lg={9.5} sx={{\r\n      display: \"flex\", flexDirection: \"column\", gap: 1\r\n    }} >\r\n      <Grid container spacing={1} columns={{ xs: 2, sm: 2, md: 3, lg: 4, xl: 6 }}>\r\n        <Grid item xs={1}>\r\n          <WeaponCardNano weaponId={character.equippedWeapon} BGComponent={CardLight} onClick={() => navigate(\"equip\")} />\r\n        </Grid>\r\n        {allSlotKeys.map(slotKey =>\r\n          <Grid item key={slotKey} xs={1} >\r\n            <ArtifactCardNano artifactId={data.get(input.art[slotKey].id).value} slotKey={slotKey} BGComponent={CardLight} onClick={() => navigate(\"equip\")} />\r\n          </Grid>)}\r\n      </Grid>\r\n      <MainStatsCards />\r\n    </Grid>\r\n  </Grid >\r\n}\r\nconst EDIT = \"Edit Stats\"\r\nconst EXIT = \"EXIT\"\r\n\r\nconst mainBaseKeys = [\"atk\", \"hp\", \"def\"] as const\r\nconst mainSubKeys = [\"eleMas\", \"critRate_\", \"critDMG_\", \"enerRech_\", \"heal_\"] as const\r\nconst mainReadNodes = [...mainBaseKeys, ...mainSubKeys].map(k => input.total[k])\r\nconst mainEditKeys = [\"atk_\", \"atk\", \"hp_\", \"hp\", \"def_\", \"def\", ...mainSubKeys] as const\r\n\r\nconst otherStatReadNodes = [\r\n  ...allElementsWithPhy.map(ele => input.total[`${ele}_dmg_`]),\r\n  ...allElementsWithPhy.map(ele => input.total[`${ele}_res_`]),\r\n  ...([\"stamina\", \"incHeal_\", \"shield_\", \"cdRed_\"] as const).map(x => input.total[x])\r\n]\r\nconst otherStatKeys = otherStatReadNodes.map(x => x.info!.key!)\r\n\r\nconst miscStatReadNodes = [\r\n  input.total.all_dmg_,\r\n  ...allElementsWithPhy.map(x => input.total[`${x}_enemyRes_`]),\r\n  input.total.normal_dmg_, input.total.normal_critRate_,\r\n  input.total.charged_dmg_, input.total.charged_critRate_,\r\n  input.total.plunging_dmg_, input.total.plunging_critRate_,\r\n  input.total.skill_dmg_, input.total.skill_critRate_,\r\n  input.total.burst_dmg_, input.total.burst_critRate_,\r\n  ...Object.keys(transformativeReactions).map(x => input.total[`${x}_dmg_`]),\r\n  ...Object.keys(amplifyingReactions).map(x => input.total[`${x}_dmg_`]),\r\n  ...([\"moveSPD_\", \"atkSPD_\", \"weakspotDMG_\"] as const).map(x => input.total[x]),\r\n  input.total.dmgRed_\r\n]\r\nconst miscStatkeys = miscStatReadNodes.map(x => x.info!.key!)\r\n\r\nconst statBreakpoint = {\r\n  xs: 12, sm: 12, md: 6, lg: 4,\r\n} as const\r\n\r\nfunction StatDisplayContent({ nodes, statBreakpoint, extra }: { nodes: ReadNode<number>[], statBreakpoint: object, extra?: Displayable }) {\r\n  const { data, oldData } = useContext(DataContext)\r\n  return <Grid container columnSpacing={{ xs: 2, lg: 3 }} rowSpacing={1}>\r\n    {nodes.map(rn => <Grid item key={rn.info?.key} {...statBreakpoint} >\r\n      {<NodeFieldDisplay node={data.get(rn)} oldValue={oldData?.get(rn)?.value} />}\r\n    </Grid>)}\r\n    {extra}\r\n  </Grid>\r\n}\r\n\r\nfunction MainStatsCards() {\r\n  const { data, character, character: { key: characterKey } } = useContext(DataContext)\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const specialNode = data.get(input.special)\r\n\r\n  return <>\r\n    <StatDisplayCard\r\n      title=\"Main Stats\"\r\n      content={<StatDisplayContent statBreakpoint={statBreakpoint} nodes={mainReadNodes}\r\n        extra={specialNode && <Grid item {...statBreakpoint} display=\"flex\" flexDirection=\"row\" justifyContent=\"space-between\">\r\n          <span><b>Special:</b> <ColorText color={specialNode.info.variant}>{specialNode.info.key && StatIcon[specialNode.info.key]} {specialNode.info.key && KeyMap.get(specialNode.info.key)}</ColorText></span>\r\n          <span >{valueString(specialNode.value, specialNode.unit)}</span>\r\n        </Grid>}\r\n      />}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {mainEditKeys.map(statKey => {\r\n          const statName = KeyMap.get(statKey)\r\n          return <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              name={<span>{StatIcon[statKey]} {statName}</span>}\r\n              placeholder={KeyMap.getStr(statKey)}\r\n              value={character.bonusStats[statKey] ?? 0}\r\n              percent={KeyMap.unit(statKey) === \"%\"}\r\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>}\r\n    />\r\n    <StatDisplayCard\r\n      title=\"Other Stats\"\r\n      content={<StatDisplayContent statBreakpoint={statBreakpoint} nodes={otherStatReadNodes} />}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {otherStatKeys.map(statKey => {\r\n          const statName = KeyMap.get(statKey)\r\n          return <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              name={<span>{StatIcon[statKey]} {statName}</span>}\r\n              placeholder={KeyMap.getStr(statKey)}\r\n              value={character.bonusStats[statKey] ?? 0}\r\n              percent={KeyMap.unit(statKey) === \"%\"}\r\n              defaultValue={undefined}\r\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>}\r\n    />\r\n    <StatDisplayCard\r\n      title=\"Misc Stats\"\r\n      content={<StatDisplayContent statBreakpoint={{\r\n        xs: 12, sm: 12, md: 6,\r\n      }} nodes={miscStatReadNodes} />}\r\n      editContent={<Grid container columnSpacing={2} rowSpacing={1}>\r\n        {miscStatkeys.map(statKey => {\r\n          const statName = KeyMap.get(statKey)\r\n          return <Grid item xs={12} lg={6} key={statKey}>\r\n            <StatInput\r\n              name={<span>{StatIcon[statKey]} {statName}</span>}\r\n              placeholder={KeyMap.getStr(statKey)}\r\n              value={character.bonusStats[statKey] ?? 0}\r\n              percent={KeyMap.unit(statKey) === \"%\"}\r\n              onValueChange={value => characterDispatch({ type: \"editStats\", statKey, value })}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>}\r\n    />\r\n  </>\r\n}\r\nfunction StatDisplayCard({ title, content, editContent }) {\r\n  const [edit, setedit] = useState(false)\r\n  return <CardLight>\r\n    <CardContent sx={{ py: 1 }}>\r\n      <Box display=\"flex\" justifyContent=\"space-between\">\r\n        <Typography variant=\"subtitle1\">{title}</Typography>\r\n        <Button size=\"small\" color={edit ? \"error\" : \"info\"} onClick={() => setedit(!edit)} >\r\n          <span><FontAwesomeIcon icon={edit ? faSave : faEdit} /> {edit ? EXIT : EDIT}</span>\r\n        </Button>\r\n      </Box>\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      {edit ? editContent : content}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { Box, CardActionArea, CardContent, Grid, MenuItem, Typography, useMediaQuery } from \"@mui/material\";\r\nimport { useTheme } from \"@mui/system\";\r\nimport React, { useCallback, useContext, useMemo } from 'react';\r\nimport CardDark from \"../../../Components/Card/CardDark\";\r\nimport CardLight from \"../../../Components/Card/CardLight\";\r\nimport ConditionalWrapper from \"../../../Components/ConditionalWrapper\";\r\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\r\nimport DropdownButton from \"../../../Components/DropdownMenu/DropdownButton\";\r\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\r\nimport { DataContext } from '../../../DataContext';\r\nimport { uiInput as input } from \"../../../Formula\";\r\nimport { NumNode } from \"../../../Formula/type\";\r\nimport { NodeDisplay } from '../../../Formula/uiData';\r\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\r\nimport { TalentSheetElementKey } from \"../../../Types/character\";\r\nimport { ElementKey } from \"../../../Types/consts\";\r\nimport { DocumentSection } from \"../../../Types/sheet\";\r\nimport { range } from \"../../../Util/Util\";\r\n\r\nconst talentSpacing = {\r\n  xs: 12,\r\n  sm: 6,\r\n  md: 4\r\n}\r\n\r\nexport default function CharacterTalentPane() {\r\n  const { data, character, characterSheet } = useContext(DataContext)\r\n  const characterDispatch = useCharacterReducer(character.key)\r\n  const skillBurstList = [[\"auto\", \"Normal/Charged Attack\"], [\"skill\", \"Elemental Skill\"], [\"burst\", \"Elemental Burst\"]] as [TalentSheetElementKey, string][]\r\n  const passivesList: [tKey: TalentSheetElementKey, tText: string, asc: number][] = [[\"passive1\", \"Unlocked at Ascension 1\", 1], [\"passive2\", \"Unlocked at Ascension 4\", 4], [\"passive3\", \"Unlocked by Default\", 0]]\r\n  const charEle = data.get(input.charEle).value as ElementKey | undefined\r\n  const ascension = data.get(input.asc).value\r\n  const constellation = data.get(input.constellation).value\r\n\r\n  const theme = useTheme();\r\n  const grlg = useMediaQuery(theme.breakpoints.up('lg'));\r\n  const constellationCards = useMemo(() => range(1, 6).map(i =>\r\n    <SkillDisplayCard\r\n      talentKey={`constellation${i}` as TalentSheetElementKey}\r\n      subtitle={`Constellation Lv. ${i}`}\r\n      onClickTitle={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}\r\n    />), [constellation, characterDispatch])\r\n  return <>\r\n    <ReactionDisplay />\r\n    <Grid container spacing={1}>\r\n      {/* constellations for 4column */}\r\n      {grlg && <Grid item xs={12} md={12} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\r\n        <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\r\n        {constellationCards.map((c, i) => <Box key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} >{c}</Box>)}\r\n      </Grid>}\r\n      <Grid item xs={12} md={12} lg={9} container spacing={1} >\r\n        {/* auto, skill, burst */}\r\n        {skillBurstList.map(([tKey, tText]) =>\r\n          <Grid item key={tKey} {...talentSpacing} >\r\n            <SkillDisplayCard\r\n              talentKey={tKey}\r\n              subtitle={tText}\r\n            />\r\n          </Grid>)}\r\n        {!!characterSheet.getTalentOfKey(\"sprint\", charEle) && <Grid item {...talentSpacing} >\r\n          <SkillDisplayCard\r\n            talentKey=\"sprint\"\r\n            subtitle=\"Alternative Sprint\"\r\n          />\r\n        </Grid>}\r\n        {!!characterSheet.getTalentOfKey(\"passive\", charEle) && <Grid item {...talentSpacing} >\r\n          <SkillDisplayCard\r\n            talentKey=\"passive\"\r\n            subtitle=\"Passive\"\r\n          />\r\n        </Grid>}\r\n        {/* passives */}\r\n        {passivesList.map(([tKey, tText, asc]) => {\r\n          let enabled = ascension >= asc\r\n          if (!characterSheet.getTalentOfKey(tKey, charEle)) return null\r\n          return <Grid item key={tKey} style={{ opacity: enabled ? 1 : 0.5 }} {...talentSpacing} >\r\n            <SkillDisplayCard\r\n              talentKey={tKey}\r\n              subtitle={tText}\r\n            />\r\n          </Grid>\r\n        })}\r\n      </Grid>\r\n      {/* constellations for < 4 columns */}\r\n      {!grlg && <Grid item xs={12} md={12} lg={3} container spacing={1} >\r\n        <Grid item xs={12}>\r\n          <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\r\n        </Grid>\r\n        {constellationCards.map((c, i) => <Grid item key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} {...talentSpacing} >{c}</Grid>)}\r\n      </Grid>}\r\n    </Grid>\r\n  </>\r\n}\r\nfunction ReactionDisplay() {\r\n  const { data } = useContext(DataContext)\r\n  const reaction = data.getDisplay().reaction as { [key: string]: NodeDisplay }\r\n  return <CardLight sx={{ mb: 1 }}>\r\n    <CardContent>\r\n      <Grid container spacing={1}>\r\n        {Object.entries(reaction).map(([key, node]) => {\r\n          return <Grid item key={key}>\r\n            <CardDark><CardContent sx={{ p: 1, \"&:last-child\": { pb: 1 } }}>\r\n              <NodeFieldDisplay node={node} />\r\n            </CardContent></CardDark>\r\n          </Grid>\r\n        })}\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n\r\nconst talentLimits = [1, 1, 2, 4, 6, 8, 10]\r\ntype SkillDisplayCardProps = {\r\n  talentKey: TalentSheetElementKey,\r\n  subtitle: string,\r\n  onClickTitle?: (any) => any\r\n}\r\nfunction SkillDisplayCard({ talentKey, subtitle, onClickTitle }: SkillDisplayCardProps) {\r\n  const { data, character: { talent }, characterSheet, characterDispatch } = useContext(DataContext)\r\n\r\n  const actionWrapeprFunc = useCallback(\r\n    children => <CardActionArea onClick={onClickTitle}>{children}</CardActionArea>,\r\n    [onClickTitle],\r\n  )\r\n\r\n  let header: Displayable | null = null\r\n\r\n  if (talentKey in talent) {\r\n    const levelBoost = data.get(input.bonus[talentKey] as NumNode).value\r\n    const level = data.get(input.total[talentKey]).value\r\n    const asc = data.get(input.asc).value\r\n    const setTalentLevel = (tKey, newTalentLevelKey) => {\r\n      talent[tKey] = newTalentLevelKey\r\n      characterDispatch({ talent })\r\n    }\r\n    header = <DropdownButton fullWidth title={`Talent Lv. ${level}`} color={levelBoost ? \"info\" : \"primary\"} sx={{ borderRadius: 0 }}>\r\n      {range(1, talentLimits[asc]).map(i =>\r\n        <MenuItem key={i} selected={talent[talentKey] === (i)} disabled={talent[talentKey] === (i)} onClick={() => setTalentLevel(talentKey, i)}>Talent Lv. {i + levelBoost}</MenuItem>)}\r\n    </DropdownButton>\r\n  }\r\n  const talentSheet = characterSheet.getTalentOfKey(talentKey, data.get(input.charEle).value as ElementKey | undefined)\r\n\r\n  // Hide header if the header matches the current talent\r\n  const hideHeader = (section: DocumentSection): boolean => {\r\n    let headerAction = section.header?.action\r\n    if (headerAction && (typeof headerAction !== \"string\")) {\r\n      const key: string = headerAction.props.children.props.key18\r\n      return key.includes(talentKey)\r\n    }\r\n    return false\r\n  }\r\n\r\n  return <CardLight sx={{ height: \"100%\" }}>\r\n    {header}\r\n    <CardContent>\r\n      <ConditionalWrapper condition={!!onClickTitle} wrapper={actionWrapeprFunc} >\r\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\r\n          <Grid item>\r\n            <Box component=\"img\" src={talentSheet?.img} sx={{ width: 60, height: \"auto\" }} />\r\n          </Grid>\r\n          <Grid item flexGrow={1} sx={{ pl: 1 }}>\r\n            <Typography variant=\"h6\">{talentSheet?.name}</Typography>\r\n            <Typography variant=\"subtitle1\">{subtitle}</Typography>\r\n          </Grid>\r\n        </Grid>\r\n      </ConditionalWrapper>\r\n      {/* Display document sections */}\r\n      {talentSheet?.sections ? <DocumentDisplay sections={talentSheet.sections} hideDesc hideHeader={hideHeader} /> : null}\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\n","import { PersonAdd } from \"@mui/icons-material\";\r\nimport { CardContent, CardHeader, Divider, Grid, Typography } from \"@mui/material\";\r\nimport { Box } from \"@mui/system\";\r\nimport React, { useContext, useMemo } from 'react';\r\nimport CardLight from \"../../../Components/Card/CardLight\";\r\nimport CharacterCard from \"../../../Components/Character/CharacterCard\";\r\nimport CharacterAutocomplete from \"../../../Components/Character/CharacterAutocomplete\";\r\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\r\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\r\nimport InfoTooltip from \"../../../Components/InfoTooltip\";\r\nimport { ArtifactSheet } from \"../../../Data/Artifacts/ArtifactSheet\";\r\nimport { resonanceSheets } from \"../../../Data/Resonance\";\r\nimport { DataContext, dataContextObj } from \"../../../DataContext\";\r\nimport { uiInput as input } from \"../../../Formula\";\r\nimport { NodeDisplay } from \"../../../Formula/uiData\";\r\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\r\nimport useCharSelectionCallback from \"../../../ReactHooks/useCharSelectionCallback\";\r\nimport usePromise from \"../../../ReactHooks/usePromise\";\r\nimport { ElementKey } from \"../../../Types/consts\";\r\nimport { objPathValue, range } from \"../../../Util/Util\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nexport default function TabTeambuffs() {\r\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1} alignItems=\"stretch\">\r\n    <Grid container spacing={1}>\r\n      <Grid item xs={12} md={6} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <TeamBuffDisplay />\r\n        <ResonanceDisplay />\r\n      </Grid>\r\n      {range(0, 2).map(i => <Grid item xs={12} md={6} lg={3} key={i}>\r\n        <TeammateDisplay index={i} />\r\n      </Grid>)}\r\n    </Grid>\r\n  </Box>\r\n}\r\nexport function TeamBuffDisplay() {\r\n  const { data, oldData } = useContext(DataContext)\r\n  const teamBuffs = data.getTeamBuff()\r\n  const nodes: Array<[string[], NodeDisplay<number>]> = []\r\n  Object.entries(teamBuffs.total ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"total\", key], node]))\r\n  Object.entries(teamBuffs.premod ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"premod\", key], node]))\r\n  Object.entries(teamBuffs.enemy ?? {}).forEach(([key, node]) =>\r\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"enemy\", key], node]))\r\n  if (!nodes.length) return null\r\n  return <CardLight>\r\n    <CardContent>\r\n      Team Buffs\r\n    </CardContent>\r\n    <Divider />\r\n    <CardContent>\r\n      <Grid container>\r\n        {nodes.map(([path, n], i) => n && <Grid item xs={12} key={n.info.key} >\r\n          <NodeFieldDisplay node={n} oldValue={objPathValue(oldData?.getTeamBuff(), path)?.value} />\r\n        </Grid>)}\r\n      </Grid>\r\n    </CardContent>\r\n  </CardLight>\r\n}\r\nfunction ResonanceDisplay() {\r\n  const { data } = useContext(DataContext)\r\n  return <>\r\n    {resonanceSheets.map((res, i) => {\r\n      const icon = <InfoTooltip title={<Typography>{res.desc}</Typography>} />\r\n      const title = <span>{res.name} {icon}</span>\r\n      return <CardLight key={i} sx={{ opacity: res.canShow(data) ? 1 : 0.5, }}>\r\n        <CardHeader title={title} action={res.icon} titleTypographyProps={{ variant: \"subtitle2\" }} />\r\n        {res.canShow(data) && <Divider />}\r\n        {res.canShow(data) && <CardContent>\r\n          <DocumentDisplay sections={res.sections} teamBuffOnly hideDesc />\r\n        </CardContent>}\r\n      </CardLight>\r\n    })}\r\n  </>\r\n}\r\nfunction TeammateDisplay({ index }: { index: number }) {\r\n  const dataContext = useContext(DataContext)\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character: active, teamData, characterDispatch: activeCharacterDispatch } = dataContext\r\n  const activeCharacterKey = active.key\r\n  const characterKey = active.team[index]\r\n  const characterDispatch = useCharacterReducer(characterKey)\r\n  const onClickHandler = useCharSelectionCallback()\r\n\r\n  const dataBundle = teamData[characterKey]\r\n  const teamMateDataContext: dataContextObj | undefined = dataBundle && {\r\n    character: dataBundle.character,\r\n    characterSheet: dataBundle.characterSheet,\r\n    data: dataBundle.target,\r\n    teamData: teamData,\r\n    mainStatAssumptionLevel: 0,\r\n    characterDispatch\r\n  }\r\n  return <CardLight>\r\n    <CardContent>\r\n      <CharacterAutocomplete fullWidth value={characterKey}\r\n        onChange={charKey => activeCharacterDispatch({ type: \"team\", index, charKey })}\r\n        disable={ck => ck === activeCharacterKey || active.team.includes(ck)}\r\n        labelText={t(\"teammate\", { count: index + 1 })}\r\n        defaultText={t(\"none\")}\r\n        defaultIcon={<PersonAdd />}\r\n        showDefault\r\n      />\r\n    </CardContent>\r\n    {teamMateDataContext && <DataContext.Provider value={teamMateDataContext}>\r\n      <CharacterCard characterKey={characterKey}\r\n        onClickHeader={onClickHandler}\r\n        artifactChildren={<CharArtifactCondDisplay />}\r\n        weaponChildren={<CharWeaponCondDisplay />}\r\n        characterChildren={<CharTalentCondDisplay />}\r\n        isTeammateCard\r\n      />\r\n    </DataContext.Provider>}\r\n  </CardLight>\r\n\r\n}\r\nfunction CharArtifactCondDisplay() {\r\n  const { data, } = useContext(DataContext)\r\n  const artifactSheets = usePromise(ArtifactSheet.getAll, [])\r\n  const sections = useMemo(() => artifactSheets &&\r\n    Object.entries(ArtifactSheet.setEffects(artifactSheets, data))\r\n      .flatMap(([setKey, setNums]) =>\r\n        setNums.flatMap(sn => artifactSheets[setKey]!.setEffectDocument(sn)!))\r\n    , [artifactSheets, data])\r\n  if (!sections) return null\r\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\r\n}\r\nfunction CharWeaponCondDisplay() {\r\n  const { teamData, character: { key: charKey } } = useContext(DataContext)\r\n  const weaponSheet = teamData[charKey]!.weaponSheet\r\n  if (!weaponSheet.document) return null\r\n  return <DocumentDisplay sections={weaponSheet.document} teamBuffOnly={true} />\r\n}\r\nfunction CharTalentCondDisplay() {\r\n  const { data, teamData, character: { key: charKey } } = useContext(DataContext)\r\n  const characterSheet = teamData[charKey]!.characterSheet\r\n  const talent = characterSheet.getTalent(data.get(input.charEle).value as ElementKey)!\r\n  const sections = Object.values(talent.sheets).flatMap(sts => sts.sections)\r\n  if (!sections) return null\r\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\r\n}\r\n","import { Calculate, Checkroom, ExpandMore, FactCheck, Groups, Person } from '@mui/icons-material';\r\nimport { Accordion, AccordionDetails, AccordionSummary, Box, Button, ButtonGroup, Card, CardContent, CardHeader, Collapse, Divider, Grid, MenuItem, Skeleton, Tab, Tabs, Typography } from '@mui/material';\r\nimport { Suspense, useCallback, useContext, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Link as RouterLink, Navigate, Route, Routes, useMatch, useNavigate, useParams } from 'react-router-dom';\r\nimport CardDark from '../../Components/Card/CardDark';\r\nimport CardLight from '../../Components/Card/CardLight';\r\nimport { CharacterSelectionModal } from '../../Components/Character/CharacterSelectionModal';\r\nimport ThumbSide from '../../Components/Character/ThumbSide';\r\nimport CloseButton from '../../Components/CloseButton';\r\nimport ColorText from '../../Components/ColoredText';\r\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from '../../Components/CustomNumberInput';\r\nimport DropdownButton from '../../Components/DropdownMenu/DropdownButton';\r\nimport { EnemyExpandCard } from '../../Components/EnemyEditor';\r\nimport ExpandButton from '../../Components/ExpandButton';\r\nimport { HitModeToggle, InfusionAuraDropdown, ReactionToggle } from '../../Components/HitModeEditor';\r\nimport ImgIcon from '../../Components/Image/ImgIcon';\r\nimport { ambiguousLevel, ascensionMaxLevel, milestoneLevels } from '../../Data/LevelData';\r\nimport { sgt } from '../../Data/SheetUtil';\r\nimport { DataContext, dataContextObj, TeamData } from '../../DataContext';\r\nimport { getDisplayHeader, getDisplaySections } from '../../Formula/DisplayUtil';\r\nimport { DisplaySub } from '../../Formula/type';\r\nimport { NodeDisplay } from '../../Formula/uiData';\r\nimport KeyMap, { valueString } from '../../KeyMap';\r\nimport useCharacterReducer from '../../ReactHooks/useCharacterReducer';\r\nimport useCharSelectionCallback from '../../ReactHooks/useCharSelectionCallback';\r\nimport usePromise from '../../ReactHooks/usePromise';\r\nimport useTeamData from '../../ReactHooks/useTeamData';\r\nimport useTitle from '../../ReactHooks/useTitle';\r\nimport { allCharacterKeys, CharacterKey } from '../../Types/consts';\r\nimport { clamp } from '../../Util/Util';\r\nimport TabEquip from './Tabs/TabEquip';\r\nimport TabBuild from './Tabs/TabOptimize';\r\nimport TabOverview from './Tabs/TabOverview';\r\nimport TabTalent from './Tabs/TabTalent';\r\nimport TabTeambuffs from './Tabs/TabTeambuffs';\r\n\r\nexport default function CharacterDisplay() {\r\n  const navigate = useNavigate();\r\n  let { characterKey } = useParams<{ characterKey?: CharacterKey }>();\r\n  const invalidKey = !allCharacterKeys.includes(characterKey as any ?? \"\")\r\n  if (invalidKey)\r\n    return <Navigate to=\"/characters\" />\r\n  return <Box my={1} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    {characterKey && <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />}>\r\n      <CharacterDisplayCard characterKey={characterKey} onClose={() => navigate(\"/characters\")} />\r\n    </Suspense>}\r\n  </Box>\r\n}\r\n\r\ntype CharacterDisplayCardProps = {\r\n  characterKey: CharacterKey,\r\n  newteamData?: TeamData,\r\n  mainStatAssumptionLevel?: number,\r\n  onClose?: (any) => void,\r\n}\r\nfunction CharacterDisplayCard({ characterKey, newteamData, mainStatAssumptionLevel = 0, onClose }: CharacterDisplayCardProps) {\r\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\r\n  const { character, characterSheet, target: charUIData } = teamData?.[characterKey] ?? {}\r\n  let { params: { tab = \"overview\" } } = useMatch({ path: \"/characters/:charKey/:tab\", end: false }) ?? { params: { tab: \"overview\" } }\r\n  const { t } = useTranslation()\r\n  useTitle(`${t(`char_${characterKey}_gen:name`)} - ${t(`page_character:tabs.${tab}`)}`)\r\n  const characterDispatch = useCharacterReducer(character?.key ?? \"\")\r\n  const { compareData } = character ?? {}\r\n\r\n  const dataContextValue: dataContextObj | undefined = useMemo(() => {\r\n    if (!teamData || !character || !characterSheet || !charUIData) return undefined\r\n    return {\r\n      character,\r\n      characterSheet,\r\n      mainStatAssumptionLevel,\r\n      data: (newteamData ? newteamData[characterKey]!.target : charUIData),\r\n      teamData: (newteamData ? newteamData : teamData),\r\n      oldData: (compareData && newteamData) ? charUIData : undefined,\r\n      characterDispatch\r\n    }\r\n  }, [character, characterSheet, mainStatAssumptionLevel, newteamData, charUIData, teamData, characterDispatch, characterKey, compareData])\r\n\r\n  if (!teamData || !character || !characterSheet || !charUIData || !dataContextValue) return <></>\r\n\r\n  return <CardDark >\r\n    <DataContext.Provider value={dataContextValue}>\r\n      <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n        <Grid container spacing={1}>\r\n          <Grid item>\r\n            <CharSelectDropdown />\r\n          </Grid>\r\n          <Grid item flexGrow={1} />\r\n          {!!mainStatAssumptionLevel && <Grid item><Card sx={{ p: 1, bgcolor: t => t.palette.warning.dark }}><Typography><strong>Assume Main Stats are Level {mainStatAssumptionLevel}</strong></Typography></Card></Grid>}\r\n          {!!onClose && <Grid item>\r\n            <CloseButton onClick={onClose} />\r\n          </Grid>}\r\n        </Grid>\r\n        <CardLight>\r\n          <TabNav tab={tab} />\r\n        </CardLight>\r\n        <FormulaCalcCard />\r\n        <EnemyExpandCard />\r\n        <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={500} />}>\r\n          <Routes>\r\n            {/* Character Panel */}\r\n            <Route index element={<TabOverview />} />\r\n            <Route path=\"/talent\" element={<TabTalent />} />\r\n            <Route path=\"/equip\" element={<TabEquip />} />\r\n            <Route path=\"/teambuffs\" element={<TabTeambuffs />} />\r\n            <Route path=\"/optimize\" element={<TabBuild />} />\r\n          </Routes>\r\n        </Suspense>\r\n        <CardLight>\r\n          <TabNav tab={tab} />\r\n        </CardLight>\r\n      </CardContent>\r\n    </DataContext.Provider>\r\n  </CardDark>\r\n}\r\nfunction TabNav({ tab }: { tab: string }) {\r\n  const { t } = useTranslation(\"page_character\")\r\n  return <Tabs\r\n    value={tab}\r\n    variant=\"scrollable\"\r\n    allowScrollButtonsMobile\r\n    sx={{\r\n      \"& .MuiTab-root:hover\": {\r\n        transition: \"background-color 0.25s ease\",\r\n        backgroundColor: \"rgba(255,255,255,0.1)\"\r\n      },\r\n    }}\r\n  >\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"overview\" label={t(\"tabs.overview\")} icon={<Person />} component={RouterLink} to=\"\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"talent\" label={t(\"tabs.talent\")} icon={<FactCheck />} component={RouterLink} to=\"talent\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"equip\" label={t(\"tabs.equip\")} icon={<Checkroom />} component={RouterLink} to=\"equip\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"teambuffs\" label={t(\"tabs.teambuffs\")} icon={<Groups />} component={RouterLink} to=\"teambuffs\" />\r\n    <Tab sx={{ minWidth: \"20%\" }} value=\"optimize\" label={t(\"tabs.optimize\")} icon={<Calculate />} component={RouterLink} to=\"optimize\" />\r\n  </Tabs>\r\n}\r\n\r\nfunction CharSelectDropdown() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const { character, characterSheet, characterDispatch } = useContext(DataContext)\r\n  const [showModal, setshowModal] = useState(false)\r\n  const setCharacter = useCharSelectionCallback()\r\n  const setLevel = useCallback((level) => {\r\n    level = clamp(level, 1, 90)\r\n    const ascension = ascensionMaxLevel.findIndex(ascenML => level <= ascenML)\r\n    characterDispatch({ level, ascension })\r\n  }, [characterDispatch])\r\n  const setAscension = useCallback(() => {\r\n    if (!character) return\r\n    const { level = 1, ascension = 0 } = character\r\n    const lowerAscension = ascensionMaxLevel.findIndex(ascenML => level !== 90 && level === ascenML)\r\n    if (ascension === lowerAscension) characterDispatch({ ascension: ascension + 1 })\r\n    else characterDispatch({ ascension: lowerAscension })\r\n  }, [characterDispatch, character])\r\n  const { elementKey = \"anemo\", level = 1, ascension = 0 } = character\r\n  return <>\r\n    <CharacterSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={setCharacter} />\r\n    <Grid container spacing={1}>\r\n      <Grid item>\r\n        <Button color=\"info\" onClick={() => setshowModal(true)} startIcon={<ThumbSide src={characterSheet?.thumbImgSide} />} >{characterSheet?.name ?? t(\"selectCharacter\")}</Button>\r\n      </Grid>\r\n      <Grid item>\r\n        <ButtonGroup sx={{ bgcolor: t => t.palette.contentDark.main }} >\r\n          {characterSheet?.sheet && \"talents\" in characterSheet?.sheet && <DropdownButton title={<strong><ColorText color={elementKey}>{sgt(`element.${elementKey}`)}</ColorText></strong>}>\r\n            {Object.keys(characterSheet.sheet.talents).map(eleKey =>\r\n              <MenuItem key={eleKey} selected={elementKey === eleKey} disabled={elementKey === eleKey} onClick={() => characterDispatch({ elementKey: eleKey })}>\r\n                <strong><ColorText color={eleKey}>{sgt(`element.${eleKey}`)}</ColorText></strong></MenuItem>)}\r\n          </DropdownButton>}\r\n          <CustomNumberInputButtonGroupWrapper >\r\n            <CustomNumberInput onChange={setLevel} value={level}\r\n              startAdornment=\"Lv. \"\r\n              inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\" } }}\r\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }}\r\n              disabled={!characterSheet} />\r\n          </CustomNumberInputButtonGroupWrapper>\r\n          <Button sx={{ pl: 1 }} disabled={!ambiguousLevel(level) || !characterSheet} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\r\n          <DropdownButton title={t(\"selectLevel\")} disabled={!characterSheet}>\r\n            {milestoneLevels.map(([lv, as]) => {\r\n              const sameLevel = lv === ascensionMaxLevel[as]\r\n              const lvlstr = sameLevel ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevel[as]}`\r\n              const selected = lv === level && as === ascension\r\n              return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => characterDispatch({ level: lv, ascension: as })}>{lvlstr}</MenuItem>\r\n            })}\r\n          </DropdownButton>\r\n        </ButtonGroup>\r\n      </Grid>\r\n    </Grid>\r\n  </>\r\n}\r\n\r\nfunction FormulaCalcCard() {\r\n  const { t } = useTranslation(\"page_character\")\r\n  const [expanded, setexpanded] = useState(false)\r\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\r\n  return <CardLight>\r\n    <CardContent sx={{ display: \"flex\", gap: 1 }}>\r\n      <Grid container spacing={1}>\r\n        <Grid item><HitModeToggle size=\"small\" /></Grid>\r\n        <Grid item><InfusionAuraDropdown /></Grid>\r\n        <Grid item><ReactionToggle size=\"small\" /></Grid>\r\n      </Grid>\r\n      <Box display=\"flex\" gap={1} >\r\n        <Box>\r\n          <Typography variant='subtitle2' >{t(\"formulas\")} {\"&\"}</Typography>\r\n          <Typography variant='subtitle2' >{t(\"calculations\")}</Typography>\r\n        </Box>\r\n        <ExpandButton\r\n          expand={expanded}\r\n          onClick={toggle}\r\n          aria-expanded={expanded}\r\n          aria-label=\"show more\"\r\n          size=\"small\"\r\n          sx={{ p: 0 }}\r\n        >\r\n          <ExpandMore />\r\n        </ExpandButton>\r\n      </Box>\r\n    </CardContent>\r\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n      <CardContent sx={{ pt: 0 }}>\r\n        <CalculationDisplay />\r\n      </CardContent>\r\n    </Collapse>\r\n  </CardLight>\r\n}\r\n\r\nfunction CalculationDisplay() {\r\n  const { data } = useContext(DataContext)\r\n  const sections = getDisplaySections(data)\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />} >\r\n    <Box sx={{ mr: -1, mb: -1 }}>\r\n      {sections.map(([key, Nodes]) =>\r\n        <FormulaCalc key={key} displayNs={Nodes} sectionKey={key} />)}\r\n    </Box>\r\n  </Suspense>\r\n}\r\nfunction FormulaCalc({ sectionKey, displayNs }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\r\n  const { data } = useContext(DataContext)\r\n  const header = usePromise(getDisplayHeader(data, sectionKey), [data, sectionKey])\r\n  if (!header) return null\r\n  if (Object.entries(displayNs).every(([_, node]) => node.isEmpty)) return null\r\n  const { title, icon, action } = header\r\n  return <CardDark sx={{ mb: 1 }}>\r\n    <CardHeader avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action} titleTypographyProps={{ variant: \"subtitle1\" }} />\r\n    <Divider />\r\n    <CardContent>\r\n      {Object.entries(displayNs).map(([key, node]) =>\r\n        !node.isEmpty && <Accordion sx={{ bgcolor: \"contentLight.main\" }} key={key}>\r\n          <AccordionSummary expandIcon={<ExpandMore />}>\r\n            <Typography><ColorText color={node.info.variant}>{KeyMap.get(node.info.key ?? \"\")}</ColorText> <strong>{valueString(node.value, node.unit)}</strong></Typography>\r\n          </AccordionSummary>\r\n          <AccordionDetails>\r\n            {node.formulas.map((subform, i) => <Typography key={i}>{subform}</Typography>)}\r\n          </AccordionDetails>\r\n        </Accordion>)}\r\n    </CardContent>\r\n  </CardDark>\r\n}\r\n","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { BusinessCenter, Lock, LockOpen } from \"@mui/icons-material\"\r\nimport { Box, Button, ButtonGroup, CardActionArea, CardContent, IconButton, Skeleton, Tooltip, Typography } from \"@mui/material\"\r\nimport { Suspense, useCallback, useContext, useMemo } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport Assets from \"../Assets/Assets\"\r\nimport CardLight from \"../Components/Card/CardLight\"\r\nimport CharacterAutocomplete from '../Components/Character/CharacterAutocomplete'\r\nimport LocationName from \"../Components/Character/LocationName\"\r\nimport ConditionalWrapper from \"../Components/ConditionalWrapper\"\r\nimport ImgIcon from \"../Components/Image/ImgIcon\"\r\nimport { Stars } from \"../Components/StarDisplay\"\r\nimport StatIcon from \"../Components/StatIcon\"\r\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\"\r\nimport { ascensionMaxLevel } from \"../Data/LevelData\"\r\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\"\r\nimport { DatabaseContext } from \"../Database/Database\"\r\nimport { uiInput as input } from \"../Formula\"\r\nimport { computeUIData, dataObjForWeapon } from \"../Formula/api\"\r\nimport KeyMap, { valueString } from \"../KeyMap\"\r\nimport usePromise from \"../ReactHooks/usePromise\"\r\nimport useWeapon from \"../ReactHooks/useWeapon\"\r\nimport { CharacterKey } from \"../Types/consts\"\r\n\r\ntype WeaponCardProps = { weaponId: string, onClick?: (weaponId: string) => void, onEdit?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, canEquip?: boolean, extraButtons?: JSX.Element }\r\nexport default function WeaponCard({ weaponId, onClick, onEdit, onDelete, canEquip = false, extraButtons }: WeaponCardProps) {\r\n  const { t } = useTranslation([\"page_weapon\", \"ui\"]);\r\n  const { database } = useContext(DatabaseContext)\r\n  const databaseWeapon = useWeapon(weaponId)\r\n  const weapon = databaseWeapon\r\n  const weaponSheet = usePromise(weapon?.key ? WeaponSheet.get(weapon.key) : undefined, [weapon?.key])\r\n\r\n  const filter = useCallback(\r\n    (cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType,\r\n    [weaponSheet],\r\n  )\r\n\r\n  const wrapperFunc = useCallback(children => <CardActionArea onClick={() => onClick?.(weaponId)} >{children}</CardActionArea>, [onClick, weaponId],)\r\n  const falseWrapperFunc = useCallback(children => <Box >{children}</Box>, [])\r\n\r\n  const equipOnChar = useCallback((charKey: CharacterKey | \"\") => database.setWeaponLocation(weaponId, charKey), [database, weaponId],)\r\n\r\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\r\n\r\n  if (!weapon || !weaponSheet || !UIData) return null;\r\n  const { level, ascension, refinement, id, location = \"\", lock } = weapon\r\n  const weaponTypeKey = UIData.get(input.weapon.type).value!\r\n  const stats = [input.weapon.main, input.weapon.sub, input.weapon.sub2].map(x => UIData.get(x))\r\n  const img = ascension < 2 ? weaponSheet?.img : weaponSheet?.imgAwaken\r\n\r\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 300 }} />}>\r\n    <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\", justifyContent: \"space-between\" }}>\r\n      <ConditionalWrapper condition={!!onClick} wrapper={wrapperFunc} falseWrapper={falseWrapperFunc}>\r\n        <Box className={`grad-${weaponSheet.rarity}star`} sx={{ position: \"relative\", pt: 2, px: 2, }}>\r\n          {!onClick && <IconButton color=\"primary\" onClick={() => database.updateWeapon({ lock: !lock }, id)} sx={{ position: \"absolute\", right: 0, bottom: 0, zIndex: 2 }}>\r\n            {lock ? <Lock /> : <LockOpen />}\r\n          </IconButton>}\r\n          <Box sx={{ position: \"relative\", zIndex: 1 }}>\r\n            <Box component=\"div\" sx={{ display: \"flex\", alignItems: \"center\", gap: 1, mb: 1 }}>\r\n              <ImgIcon sx={{ fontSize: \"1.5em\" }} src={Assets.weaponTypes?.[weaponTypeKey]} />\r\n              <Typography noWrap sx={{ textAlign: \"center\", backgroundColor: \"rgba(100,100,100,0.35)\", borderRadius: \"1em\", px: 1 }}><strong>{weaponSheet.name}</strong></Typography>\r\n            </Box>\r\n            <Typography component=\"span\" variant=\"h5\">Lv. {level}</Typography>\r\n            <Typography component=\"span\" variant=\"h5\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\r\n            <Typography variant=\"h6\">Refinement <strong>{refinement}</strong></Typography>\r\n            <Typography><Stars stars={weaponSheet.rarity} colored /></Typography>\r\n          </Box>\r\n          <Box sx={{ height: \"100%\", position: \"absolute\", right: 0, top: 0 }}>\r\n            <Box\r\n              component=\"img\"\r\n              src={img ?? \"\"}\r\n              width=\"auto\"\r\n              height=\"100%\"\r\n              sx={{ float: \"right\" }}\r\n            />\r\n          </Box>\r\n        </Box>\r\n        <CardContent>\r\n          {stats.map(node => {\r\n            if (!node.info.key) return null\r\n            const displayVal = valueString(node.value, node.unit, !node.unit ? 0 : undefined)\r\n            return <Box key={node.info.key} sx={{ display: \"flex\" }}>\r\n              <Typography flexGrow={1}>{StatIcon[node.info.key!]} {KeyMap.get(node.info.key)}</Typography>\r\n              <Typography>{displayVal}</Typography>\r\n            </Box>\r\n          })}\r\n        </CardContent>\r\n      </ConditionalWrapper>\r\n      <Box sx={{ p: 1, display: \"flex\", gap: 1, justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n        {canEquip\r\n          ? <CharacterAutocomplete size=\"small\" sx={{ flexGrow: 1 }} disable={(v: any) => v === \"\"}\r\n            showDefault defaultIcon={<BusinessCenter />} defaultText={t(\"ui:inventory\")}\r\n            value={location} onChange={equipOnChar} filter={filter} disableClearable/>\r\n          : <LocationName location={location} />}\r\n        <ButtonGroup>\r\n          {!!onEdit && <Tooltip title={<Typography>{t`page_weapon:edit`}</Typography>} placement=\"top\" arrow>\r\n            <Button color=\"info\" onClick={() => onEdit(id)} >\r\n              <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\r\n            </Button>\r\n          </Tooltip>}\r\n          {!!onDelete && <Button color=\"error\" onClick={() => onDelete(id)} disabled={!!location || lock} >\r\n            <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\r\n          </Button>}\r\n          {extraButtons}\r\n        </ButtonGroup>\r\n      </Box>\r\n    </CardLight>\r\n  </Suspense>\r\n}\r\n","import { useContext, useEffect, useState } from \"react\";\r\nimport { DatabaseContext } from \"../Database/Database\";\r\n\r\nexport default function useWeapon(weaponID: string | undefined = \"\") {\r\n  const { database } = useContext(DatabaseContext)\r\n  const [weapon, setWeapon] = useState(database._getWeapon(weaponID))\r\n  useEffect(() => setWeapon(database._getWeapon(weaponID)), [database, weaponID])\r\n  useEffect(() =>\r\n    weaponID ? database.followWeapon(weaponID, setWeapon) : undefined,\r\n    [weaponID, setWeapon, database])\r\n  return weapon\r\n}\r\n","import { strPadLeft } from \"./Util\"\r\n\r\nexport const SECOND_MS = 1000\r\nexport const MINUTE_MS = 60 * SECOND_MS\r\nexport const HOUR_MS = 60 * MINUTE_MS\r\nexport const DAY_MS = 24 * HOUR_MS\r\n\r\nexport function msToUnits(ms: number) {\r\n  let milliseconds = ms % 1000\r\n  let seconds = Math.floor((ms / 1000) % 60)\r\n  let minutes = Math.floor((ms / (1000 * 60)) % 60)\r\n  let hours = Math.floor((ms / (1000 * 60 * 60)))\r\n  return { hours, minutes, seconds, milliseconds }\r\n}\r\nexport function timeString(ms: number) {\r\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\r\n  let { hours, minutes, seconds } = msToUnits(ms)\r\n  let timeText = \"Minutes\"\r\n  if (hours) timeText = \"Hours\"\r\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)} ${timeText}`;\r\n}\r\nexport function timeStringMs(ms: number) {\r\n  //shows only in terms of hours/minutes. there are better calculations for days using Date functions.\r\n  let { hours, minutes, seconds, milliseconds } = msToUnits(ms)\r\n  let timeText = \"Minutes\"\r\n  if (hours) timeText = \"Hours\"\r\n  return `${hours ? `${hours}:` : \"\"}${strPadLeft(minutes, '0', 2)}:${strPadLeft(seconds, '0', 2)}.${strPadLeft(milliseconds, '0', 3)} ${timeText}`;\r\n}\r\n","import { WeaponKey } from \"../Types/consts\";\r\nimport { ICachedWeapon } from \"../Types/weapon\";\r\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\";\r\nimport { FilterConfigs, SortConfigs } from \"./SortByFilters\";\r\nexport const weaponSortKeys = [\"level\", \"rarity\"]\r\nexport type WeaponSortKey = typeof weaponSortKeys[number]\r\n\r\nexport function weaponSortConfigs(weaponSheets: Record<WeaponKey, WeaponSheet>): SortConfigs<WeaponSortKey, ICachedWeapon> {\r\n  return {\r\n    level: {\r\n      getValue: wp => wp.level ?? 0,\r\n      tieBreaker: \"rarity\"\r\n    },\r\n    rarity: {\r\n      getValue: wp => weaponSheets?.[wp.key]?.rarity,\r\n      tieBreaker: \"level\"\r\n    }\r\n  }\r\n}\r\nexport function weaponFilterConfigs(weaponSheets: Record<WeaponKey, WeaponSheet>): FilterConfigs<\"rarity\" | \"weaponType\", ICachedWeapon> {\r\n  return {\r\n    rarity: (wp, filter) => filter.includes(weaponSheets?.[wp.key]?.rarity),\r\n    weaponType: (wp, filter) => filter.includes(weaponSheets?.[wp.key]?.weaponType),\r\n  }\r\n}\r\n"],"names":["ArtifactLevelSlider","levelLow","levelHigh","setLow","setHigh","setBoth","dark","disabled","showLevelText","useState","sliderLow","setsliderLow","sliderHigh","setsliderHigh","setSlider","useCallback","e","value","TypeError","l","h","useEffect","sx","width","display","alignItems","bgcolor","onChange","val","clamp","px","pl","undefined","inputProps","textAlign","startAdornment","flexGrow","mx","getAriaLabel","onChangeCommitted","valueLabelDisplay","min","max","step","marks","ConditionalSelector","conditional","Object","keys","states","length","SimpleConditionalSelector","ExclusiveConditionalSelector","MultipleConditionalSelector","useContext","DataContext","character","characterDispatch","data","setConditional","v","conditionalValues","deepClone","layeredAssignment","path","deletePropPath","conditionalValue","get","entries","stateKey","badge","getStateBadge","name","condName","getCondName","Button","fullWidth","size","borderRadius","color","onClick","startIcon","CheckBox","CheckBoxOutlineBlank","state","SqBadge","DropdownButton","title","MenuItem","selected","Divider","map","st","ButtonGroup","orientation","disableElevation","isSelected","isElement","disp","stateName","badgeColor","badgeText","props","children","ml","key","key18","ns","values","Translate","useBadge","ConditionalDisplay","fields","hideHeader","hideDesc","condVal","flatMap","CardDark","evalIfFunc","HeaderDisplay","header","CardContent","p","pb","DocumentDisplay","sections","teamBuffOnly","sectionDisplays","s","i","canShow","teamBuff","SectionDisplay","section","filter","Box","flexDirection","gap","FieldsSectionDisplay","TextSectionDisplay","hideDivider","text","icon","action","description","displayTitle","InfoTooltip","Typography","CardHeader","avatar","titleTypographyProps","variant","ExpandButton","styled","expand","other","theme","transform","marginLeft","transition","transitions","create","duration","shortest","DisabledButton","backgroundColor","palette","primary","secondary","TextButton","charCurves","objectMap","_charCurves","commonBasic","objectKeyMap","input","infusionNode","stringPrio","inferredHitEle","lookup","sword","claymore","polearm","catalyst","getTalentType","move","customDmgNode","base","additional","mergeData","hit","constant","ele","customShieldNode","shieldNode","prod","sum","one","customHealNode","healInc","healNode","dmgNode","lvlMultiplier","talentType","subscript","percent","flat","shieldNodeTalent","baseMultiplier","talentIndex","shieldElement","element","infoMut","healNodeTalent","dataObjForCharacterSheet","region","gen","curve","lvlCurve","basic","foundSpecial","charKey","weaponType","weaponTypeKey","premod","charEle","tally","reaction","reactions","physical_dmg_","stat","list","curves","push","ascensions","some","x","NaN","result","prefix","asConst","endsWith","info","slice","Error","special","allMainStatKeys","inferInfoMut","crystallizeMulti1","crystallizeElemas","frac","crystallizeHit","transMulti1","transMulti2","trans","transformativeReactions","multi","variants","swirl","anemo","electroSwirl","electro","pyroSwirl","pyro","cryoSwirl","cryo","hydroSwirl","hydro","shattered","geo","crystallize","fromEntries","absorbableEle","overloaded","electrocharged","superconduct","FlexButtonGroup","StatInput","placeholder","defaultValue","onValueChange","onReset","restProps","whiteSpace","CustomNumberInput","flexBasis","float","endAdornment","Replay","EnemyExpandCard","expanded","setexpanded","toggle","eLvlNode","eDefRed","eDefIgn","CardLight","Grid","container","item","spacing","Chip","label","KeyMap","allElementsWithPhy","EnemyResText","valueString","unit","ExpandMore","Collapse","in","timeout","unmountOnExit","pt","EnemyEditor","node","content","isFinite","uncoloredEleIcons","bsProps","xs","md","enemyOverride","eLvl","enemyLevel","enemyDefIgn_","enemyDefRed_","height","component","href","target","rel","t","contentLight","main","type","statKey","eleKey","elementImmunity","Number","MAX_VALUE","Infinity","faCheckSquare","faSquare","className","infusionVals","InfusionAuraDropdown","characterSheet","infusionAura","isMelee","sqBadgeStyle","fontSize","ReactionToggle","reactionMode","charEleKey","infusion","includes","SolidToggleButtonGroup","exclusive","baseColor","_","ToggleButton","HitModeToggle","hitMode","errHeader","talentMap","normal","charged","plunging","skill","burst","passive","passive1","passive2","passive3","range","getDisplayHeader","sectionKey","split","namespace","ArtifactSheet","sheet","defIconSrc","WeaponSheet","asc","img","imgAwaken","cKey","cEle","CharacterSheet","talentKey","talent","getTalentOfKey","actionText","getDisplaySections","getDisplay","nodes","every","isEmpty","weapon","startsWith","artifact","rest","k","SetEffectDisplay","setKey","setNumKey","conditionalsOnly","usePromise","document","setEffectDocument","StatDisplayComponent","mr","mb","Masonry","columns","sm","xl","Nodes","Section","displayNs","oldData","displayNsReads","useMemo","n","nodeKey","customRead","ImgIcon","m","src","FieldDisplay","oldValue","ListItem","useBoolState","initial","bool","setBool","onTrue","onFalse","ArtifactCardNano","artifactId","pSlotKey","slotKey","mainStatAssumptionLevel","showLocation","BGComponent","art","useArtifact","actionWrapperFunc","CardActionArea","useTheme","justifyContent","Assets","opacity","rarity","level","mainStatKey","substats","location","mainStatLevel","Math","mainStatUnit","levelVariant","floor","alpha","ConditionalWrapper","condition","wrapper","position","ArtifactSetSlotTooltip","slotIcons","maxHeight","maxWidth","pointerEvents","LocationIcon","overflow","bottom","zIndex","BootstrapTooltip","placement","disableInteractive","StatIcon","cacheValueString","Artifact","SubstatDisplay","numRolls","rolls","rollColor","alignContent","thumbImgSide","marginTop","BusinessCenter","WeaponCardNano","weaponId","useWeapon","weaponSheet","UIData","computeUIData","dataObjForWeapon","Skeleton","refinement","WeaponNameTooltip","hasRefinement","WeaponStat","BuildDisplayItem","index","compareBuild","extraButtons","database","DatabaseContext","dataContext","artifactSheets","newOld","setNewOld","close","equipBuild","window","confirm","newBuild","allSlotKeys","id","equipArtifacts","setWeaponLocation","currentlyEquipped","statProviderContext","setToSlots","set","Suspense","fallback","CompareArtifactModal","onClose","flexWrap","sort","slotarr1","slotarr","artifactSlotIcon","lg","oldId","equippedArtifacts","newId","ModalWrapper","open","containerProps","ArtifactCard","disableEditSetSlot","canExclude","canEquip","ChevronRight","CompareBuildButton","artId","useTranslation","show","onShow","onHide","characterKey","build","newArt","_getArt","artmap","slot","teamData","useTeamData","_getWeapon","Close","Tooltip","arrow","Difference","numToShowMap","ArtifactFilterDisplay","lazy","ArtifactSwapModal","onChangeId","clickHandler","filterOptionReducer","slotKeys","useReducer","initialFilterOption","filterOption","filterOptionDispatch","useForceUpdate","dbDirty","forceUpdate","followAnyArt","brPt","useMediaQueryUp","filterConfigs","artifactFilterConfigs","artIdList","filterFunc","filterFunction","_getArts","py","CloseButton","mt","rarityHandler","handleMultiSelect","allRarities","WeaponSwapModal","followAnyWeapon","weaponSheets","weaponFilterConfigs","sortConfigs","weaponSortConfigs","setRarity","weaponIdList","_getWeapons","sortFunction","star","stars","WeaponCard","WeaponEditor","equippedWeapon","setweaponId","showWeapon","hideWeapon","updateArt","hasEquipped","unequipArts","setEffects","grxl","useMediaQuery","breakpoints","up","artifactFields","setNumKeyArr","weaponDoc","footer","LargeWeaponSwapButton","onEdit","WeaponSwapButton","ArtifactSwapButton","editor","ArtSwapCard","onOpen","minHeight","setArtLocation","SwapHoriz","Worker_fn","Worker","filterFeasiblePerm","artSetPerm","pruneAll","minimum","arts","numTop","exclusion","forced","should","deps","pruneNodeRange","reaffine","pruneOrder","pruneArtRange","count","newArts","newNodes","forceRename","affineNodes","Set","topLevelAffine","visit","isAffine","add","operands","forEach","_op","op","has","dynKeys","forEachNodes","f","operation","accu","nonConst","assertUnreachable","current","nextDynKey","affine","affineMap","Map","reaffineArt","constantFold","dyn","mapFormulas","offsets","baseValue","progress","noRainbow","rainbow","noSwitchIn","noSwitchOut","newList","greaterEqual","greater","baseRange","wrap","artRanges","computeArtRange","otherArtRanges","addArtRange","a","read","newRange","computeNodeRange","nodeRange","operandRanges","threshold","pass","fail","newOperands","op1","op2","j","ranges","reads","_f","computeMinMax","allOperations","reduce","c","minMaxes","mergeBuilds","builds","maxNum","b","mergePlot","plots","scale","round","plot","filters","_artSets","artSets","available","kind","sets","exclusionToAllowed","populateShapes","indexOfShape","check","shape","check_free","remaining","rainbows","isolated","missing","rejected","required","allowedSet","allowedCounts","counts","find","groupped","used","requiredRainbows","usableRainbows","delete","replacing","allowedRainbows","shapes","noFilter","ArtifactSetConfig","useBuildSetting","artSetExclusion","buildSetting","buildSettingDispatch","setOpen","artSetKeyList","reverse","artSlotCount","sk","allowRainbow2","allowRainbow4","allow2","allow4","exclude2","exclude4","artifactCondCount","allArtifactSets","fakeDataContextObj","currentContext","artSet","resetArtConds","tconditional","setAllExclusion","setnum","exclude","artSetExclusion_","faChartLine","faBan","Settings","Trans","i18nKey","AllSetAllowExcludeCard","setNum","numAllow","numExclude","gutterBottom","num","endIcon","ArtifactSetCard","slotCount","large","setExclusionSet","slots","tot","set4CondNums","doc","paddingTop","parseInt","levels","AssumeFullLevelToggle","setmainStatAssumptionLevel","lvl","BonusStatsCard","bonusStatsKeys","bonusStats","Monospace","fontFamily","BorderLinearProgress","LinearProgress","BuildAlert","status","tested","skipped","failed","total","startTime","finishTime","characterName","hasTotal","generatingBuilds","unskipped","testedString","toLocaleString","unskippedString","skippedText","durationString","timeStringMs","performance","now","subtitle","Alert","severity","toFixed","ChartCard","chartData","plotBase","setPlotBase","showDownload","setshowDownload","showMin","setshowMin","statKeys","displayData","downloadData","increasingX","y","minimumData","point","last","pop","allData","sKey","Info","Download","DataDisplay","Chart","plotNode","valueNode","TextArea","resize","readOnly","JSON","stringify","selectionStart","selectionEnd","plotBaseUnit","valueUnit","ResponsiveContainer","ComposedChart","CartesianGrid","strokeDasharray","XAxis","dataKey","domain","tick","fill","tickFormatter","YAxis","allowDecimals","ZAxis","Legend","Scatter","line","lineType","isAnimationActive","Line","stroke","connectNulls","strokeWidth","artifactsSlotsToSelectMainStats","MainStatSelectionCard","mainStatKeys","numSel","cursor","WhiteButton","OptimizationTargetSelector","optimizationTarget","setTarget","setTargetHandler","TargetDisplayText","SelectorSection","MenuList","TargetSelectorMenuItem","NoTarget","displayHeader","objPathValue","style","textOverflow","defThreads","navigator","hardwareConcurrency","initialTabOptimizeDBState","equipmentPriority","threads","useOptimizeDBState","useDBState","UseEquipped","useEquippedArts","tempEquipmentPriority","setOptimizeDBState","ck","_getChar","setPrio","setPrioRank","fromIndex","toIndex","arr","splice","removePrio","addPrio","resetPrio","numAbove","indexOf","numUseEquippedChar","_getCharKeys","numUnlisted","SelectItem","rank","maxRank","setRank","onRemove","NewItem","onAdd","flexShrink","useCharacter","useCharSelectionCallback","KeyboardDoubleArrowUp","KeyboardArrowUp","KeyboardArrowDown","KeyboardDoubleArrowDown","CharacterCardPico","WeaponCardPico","aId","ArtifactCardPico","artifactObj","char","CharacterSelectionModal","onSelect","Add","UseExcluded","artsDirty","useExcludedArts","numExcludedArt","dynamic","setReadNodeKeys","dynamicData","allSubstatKeys","compactArtifacts","allowPartial","flower","plume","goblet","circlet","sands","mainStatVal","substat","accurateValue","TabBuild","initGlobalSettings","tcMode","buildStatus","setBuildStatus","setchartData","setArtsDirty","maxWorkers","setMaxWorkers","useCharacterReducer","onClickTeammate","compareData","noArtifact","buildDate","maxBuildsToShow","buildsArts","cancelToken","useRef","generateBuilds","fetchContinueWork","fetchPruningWork","fetchRequestWork","requestFilters","command","buildValues","unprunedFilters","next","done","minCount","minFilterCount","statFilters","cantTakeList","filteredArts","mainStats","getTeamData","workerData","uiDataForTeam","assign","optimizationTargetNode","targetNode","valueFilter","cancelled","Promise","r","setPerms","prepruneArts","optimize","plotBaseNode","Array","finalizing","maxRequestFilterInFlight","Symbol","iterator","idleWorkers","pruningID","finalizedList","worker","setup","maxBuilds","postMessage","countCommand","finalize","finalized","onmessage","pruned","prepruned","terminate","console","log","work","then","buildTimer","setInterval","any","all","results","clearInterval","plotData","artifactIds","Date","Link","RouterLink","to","CharacterCard","StatFilterCard","faCalculator","maxBuildsToShowList","BuildList","DataContextWrapper","join","TabOverview","navigate","useNavigate","ascension","constellation","tlvl","auto","tBoost","cardImg","pr","IconButton","favorite","Favorite","FavoriteBorder","colored","tKey","Badge","badgeContent","overlap","anchorOrigin","vertical","horizontal","padding","lineHeight","constellationName","team","MainStatsCards","mainSubKeys","mainReadNodes","mainEditKeys","otherStatReadNodes","otherStatKeys","miscStatReadNodes","amplifyingReactions","miscStatkeys","statBreakpoint","StatDisplayContent","extra","columnSpacing","rowSpacing","rn","specialNode","StatDisplayCard","editContent","statName","edit","setedit","faSave","faEdit","talentSpacing","CharacterTalentPane","grlg","constellationCards","SkillDisplayCard","onClickTitle","ReactionDisplay","tText","enabled","talentLimits","actionWrapeprFunc","levelBoost","newTalentLevelKey","talentSheet","headerAction","TabTeambuffs","TeamBuffDisplay","ResonanceDisplay","TeammateDisplay","teamBuffs","getTeamBuff","enemy","resonanceSheets","res","desc","active","activeCharacterDispatch","activeCharacterKey","onClickHandler","dataBundle","teamMateDataContext","CharacterAutocomplete","disable","labelText","defaultText","defaultIcon","PersonAdd","showDefault","onClickHeader","artifactChildren","CharArtifactCondDisplay","weaponChildren","CharWeaponCondDisplay","characterChildren","CharTalentCondDisplay","isTeammateCard","sn","getTalent","sheets","sts","CharacterDisplay","useParams","allCharacterKeys","my","CharacterDisplayCard","newteamData","charUIData","useMatch","end","params","tab","useTitle","dataContextValue","CharSelectDropdown","Card","warning","TabNav","FormulaCalcCard","Tabs","allowScrollButtonsMobile","Tab","minWidth","Person","FactCheck","Checkroom","Groups","Calculate","showModal","setshowModal","setCharacter","setLevel","ascensionMaxLevel","ascenML","setAscension","lowerAscension","elementKey","ThumbSide","contentDark","sgt","talents","ambiguousLevel","milestoneLevels","lv","as","lvlstr","CalculationDisplay","FormulaCalc","Accordion","AccordionSummary","expandIcon","AccordionDetails","formulas","subform","onDelete","cs","wrapperFunc","falseWrapperFunc","equipOnChar","lock","stats","falseWrapper","updateWeapon","right","noWrap","top","displayVal","disableClearable","faTrashAlt","weaponID","setWeapon","followWeapon","SECOND_MS","MINUTE_MS","HOUR_MS","DAY_MS","msToUnits","ms","milliseconds","seconds","minutes","hours","timeString","timeText","strPadLeft","weaponSortKeys","getValue","wp","tieBreaker"],"sourceRoot":""}